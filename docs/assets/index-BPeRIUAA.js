var j_=Object.defineProperty;var f0=n=>{throw TypeError(n)};var z_=(n,e,t)=>e in n?j_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var q=(n,e,t)=>z_(n,typeof e!="symbol"?e+"":e,t),sg=(n,e,t)=>e.has(n)||f0("Cannot "+t);var l=(n,e,t)=>(sg(n,e,"read from private field"),t?t.call(n):e.get(n)),S=(n,e,t)=>e.has(n)?f0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),m=(n,e,t,s)=>(sg(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),x=(n,e,t)=>(sg(n,e,"access private method"),t);var jt=(n,e,t,s)=>({set _(i){m(n,e,i,t)},get _(){return l(n,e,s)}});function B_(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function H_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var eA={exports:{}},Cp={},tA={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var id=Symbol.for("react.element"),U_=Symbol.for("react.portal"),$_=Symbol.for("react.fragment"),V_=Symbol.for("react.strict_mode"),W_=Symbol.for("react.profiler"),G_=Symbol.for("react.provider"),X_=Symbol.for("react.context"),q_=Symbol.for("react.forward_ref"),Y_=Symbol.for("react.suspense"),K_=Symbol.for("react.memo"),Q_=Symbol.for("react.lazy"),p0=Symbol.iterator;function J_(n){return n===null||typeof n!="object"?null:(n=p0&&n[p0]||n["@@iterator"],typeof n=="function"?n:null)}var nA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sA=Object.assign,iA={};function yc(n,e,t){this.props=n,this.context=e,this.refs=iA,this.updater=t||nA}yc.prototype.isReactComponent={};yc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};yc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function rA(){}rA.prototype=yc.prototype;function Ky(n,e,t){this.props=n,this.context=e,this.refs=iA,this.updater=t||nA}var Qy=Ky.prototype=new rA;Qy.constructor=Ky;sA(Qy,yc.prototype);Qy.isPureReactComponent=!0;var g0=Array.isArray,aA=Object.prototype.hasOwnProperty,Jy={current:null},oA={key:!0,ref:!0,__self:!0,__source:!0};function lA(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)aA.call(e,s)&&!oA.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:id,type:n,key:r,ref:a,props:i,_owner:Jy.current}}function Z_(n,e){return{$$typeof:id,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Zy(n){return typeof n=="object"&&n!==null&&n.$$typeof===id}function e1(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var m0=/\/+/g;function ig(n,e){return typeof n=="object"&&n!==null&&n.key!=null?e1(""+n.key):e.toString(36)}function Dd(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case id:case U_:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+ig(a,0):s,g0(i)?(t="",n!=null&&(t=n.replace(m0,"$&/")+"/"),Dd(i,e,t,"",function(u){return u})):i!=null&&(Zy(i)&&(i=Z_(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(m0,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",g0(n))for(var o=0;o<n.length;o++){r=n[o];var c=s+ig(r,o);a+=Dd(r,e,t,c,i)}else if(c=J_(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=s+ig(r,o++),a+=Dd(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function pd(n,e,t){if(n==null)return n;var s=[],i=0;return Dd(n,s,"","",function(r){return e.call(t,r,i++)}),s}function t1(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Yt={current:null},Fd={transition:null},n1={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:Fd,ReactCurrentOwner:Jy};function cA(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:pd,forEach:function(n,e,t){pd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return pd(n,function(){e++}),e},toArray:function(n){return pd(n,function(e){return e})||[]},only:function(n){if(!Zy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};le.Component=yc;le.Fragment=$_;le.Profiler=W_;le.PureComponent=Ky;le.StrictMode=V_;le.Suspense=Y_;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n1;le.act=cA;le.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=sA({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=Jy.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)aA.call(e,c)&&!oA.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:id,type:n.type,key:i,ref:r,props:s,_owner:a}};le.createContext=function(n){return n={$$typeof:X_,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:G_,_context:n},n.Consumer=n};le.createElement=lA;le.createFactory=function(n){var e=lA.bind(null,n);return e.type=n,e};le.createRef=function(){return{current:null}};le.forwardRef=function(n){return{$$typeof:q_,render:n}};le.isValidElement=Zy;le.lazy=function(n){return{$$typeof:Q_,_payload:{_status:-1,_result:n},_init:t1}};le.memo=function(n,e){return{$$typeof:K_,type:n,compare:e===void 0?null:e}};le.startTransition=function(n){var e=Fd.transition;Fd.transition={};try{n()}finally{Fd.transition=e}};le.unstable_act=cA;le.useCallback=function(n,e){return Yt.current.useCallback(n,e)};le.useContext=function(n){return Yt.current.useContext(n)};le.useDebugValue=function(){};le.useDeferredValue=function(n){return Yt.current.useDeferredValue(n)};le.useEffect=function(n,e){return Yt.current.useEffect(n,e)};le.useId=function(){return Yt.current.useId()};le.useImperativeHandle=function(n,e,t){return Yt.current.useImperativeHandle(n,e,t)};le.useInsertionEffect=function(n,e){return Yt.current.useInsertionEffect(n,e)};le.useLayoutEffect=function(n,e){return Yt.current.useLayoutEffect(n,e)};le.useMemo=function(n,e){return Yt.current.useMemo(n,e)};le.useReducer=function(n,e,t){return Yt.current.useReducer(n,e,t)};le.useRef=function(n){return Yt.current.useRef(n)};le.useState=function(n){return Yt.current.useState(n)};le.useSyncExternalStore=function(n,e,t){return Yt.current.useSyncExternalStore(n,e,t)};le.useTransition=function(){return Yt.current.useTransition()};le.version="18.3.1";tA.exports=le;var P=tA.exports;const uA=H_(P),s1=B_({__proto__:null,default:uA},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1=P,r1=Symbol.for("react.element"),a1=Symbol.for("react.fragment"),o1=Object.prototype.hasOwnProperty,l1=i1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c1={key:!0,ref:!0,__self:!0,__source:!0};function hA(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)o1.call(e,s)&&!c1.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:r1,type:n,key:r,ref:a,props:i,_owner:l1.current}}Cp.Fragment=a1;Cp.jsx=hA;Cp.jsxs=hA;eA.exports=Cp;var g=eA.exports,dA={exports:{}},Rn={},fA={exports:{}},pA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(I,V){var K=I.length;I.push(V);e:for(;0<K;){var oe=K-1>>>1,ie=I[oe];if(0<i(ie,V))I[oe]=V,I[K]=ie,K=oe;else break e}}function t(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var V=I[0],K=I.pop();if(K!==V){I[0]=K;e:for(var oe=0,ie=I.length,_e=ie>>>1;oe<_e;){var pt=2*(oe+1)-1,Ln=I[pt],Ee=pt+1,fe=I[Ee];if(0>i(Ln,K))Ee<ie&&0>i(fe,Ln)?(I[oe]=fe,I[Ee]=K,oe=Ee):(I[oe]=Ln,I[pt]=K,oe=pt);else if(Ee<ie&&0>i(fe,K))I[oe]=fe,I[Ee]=K,oe=Ee;else break e}}return V}function i(I,V){var K=I.sortIndex-V.sortIndex;return K!==0?K:I.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],h=1,d=null,f=3,p=!1,y=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var V=t(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=I)s(u),V.sortIndex=V.expirationTime,e(c,V);else break;V=t(u)}}function E(I){if(w=!1,b(I),!y)if(t(c)!==null)y=!0,z(C);else{var V=t(u);V!==null&&X(E,V.startTime-I)}}function C(I,V){y=!1,w&&(w=!1,v(N),N=-1),p=!0;var K=f;try{for(b(V),d=t(c);d!==null&&(!(d.expirationTime>V)||I&&!O());){var oe=d.callback;if(typeof oe=="function"){d.callback=null,f=d.priorityLevel;var ie=oe(d.expirationTime<=V);V=n.unstable_now(),typeof ie=="function"?d.callback=ie:d===t(c)&&s(c),b(V)}else s(c);d=t(c)}if(d!==null)var _e=!0;else{var pt=t(u);pt!==null&&X(E,pt.startTime-V),_e=!1}return _e}finally{d=null,f=K,p=!1}}var T=!1,k=null,N=-1,L=5,D=-1;function O(){return!(n.unstable_now()-D<L)}function j(){if(k!==null){var I=n.unstable_now();D=I;var V=!0;try{V=k(!0,I)}finally{V?ee():(T=!1,k=null)}}else T=!1}var ee;if(typeof A=="function")ee=function(){A(j)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ye=J.port2;J.port1.onmessage=j,ee=function(){ye.postMessage(null)}}else ee=function(){_(j,0)};function z(I){k=I,T||(T=!0,ee())}function X(I,V){N=_(function(){I(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,z(C))},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(I){switch(f){case 1:case 2:case 3:var V=3;break;default:V=f}var K=f;f=V;try{return I()}finally{f=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(I,V){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var K=f;f=I;try{return V()}finally{f=K}},n.unstable_scheduleCallback=function(I,V,K){var oe=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?oe+K:oe):K=oe,I){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=K+ie,I={id:h++,callback:V,priorityLevel:I,startTime:K,expirationTime:ie,sortIndex:-1},K>oe?(I.sortIndex=K,e(u,I),t(c)===null&&I===t(u)&&(w?(v(N),N=-1):w=!0,X(E,K-oe))):(I.sortIndex=ie,e(c,I),y||p||(y=!0,z(C))),I},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(I){var V=f;return function(){var K=f;f=V;try{return I.apply(this,arguments)}finally{f=K}}}})(pA);fA.exports=pA;var u1=fA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1=P,Nn=u1;function M(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gA=new Set,hu={};function So(n,e){cc(n,e),cc(n+"Capture",e)}function cc(n,e){for(hu[n]=e,n=0;n<e.length;n++)gA.add(e[n])}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zg=Object.prototype.hasOwnProperty,d1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y0={},v0={};function f1(n){return zg.call(v0,n)?!0:zg.call(y0,n)?!1:d1.test(n)?v0[n]=!0:(y0[n]=!0,!1)}function p1(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function g1(n,e,t,s){if(e===null||typeof e>"u"||p1(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kt(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){bt[n]=new Kt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];bt[e]=new Kt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){bt[n]=new Kt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){bt[n]=new Kt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){bt[n]=new Kt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){bt[n]=new Kt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){bt[n]=new Kt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){bt[n]=new Kt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){bt[n]=new Kt(n,5,!1,n.toLowerCase(),null,!1,!1)});var ev=/[\-:]([a-z])/g;function tv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ev,tv);bt[e]=new Kt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ev,tv);bt[e]=new Kt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ev,tv);bt[e]=new Kt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){bt[n]=new Kt(n,1,!1,n.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){bt[n]=new Kt(n,1,!1,n.toLowerCase(),null,!0,!0)});function nv(n,e,t,s){var i=bt.hasOwnProperty(e)?bt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(g1(e,t,i,s)&&(t=null),s||i===null?f1(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Hi=h1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gd=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),Oo=Symbol.for("react.fragment"),sv=Symbol.for("react.strict_mode"),Bg=Symbol.for("react.profiler"),mA=Symbol.for("react.provider"),yA=Symbol.for("react.context"),iv=Symbol.for("react.forward_ref"),Hg=Symbol.for("react.suspense"),Ug=Symbol.for("react.suspense_list"),rv=Symbol.for("react.memo"),Vi=Symbol.for("react.lazy"),vA=Symbol.for("react.offscreen"),w0=Symbol.iterator;function xc(n){return n===null||typeof n!="object"?null:(n=w0&&n[w0]||n["@@iterator"],typeof n=="function"?n:null)}var Be=Object.assign,rg;function Ic(n){if(rg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);rg=e&&e[1]||""}return`
`+rg+n}var ag=!1;function og(n,e){if(!n||ag)return"";ag=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{ag=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Ic(n):""}function m1(n){switch(n.tag){case 5:return Ic(n.type);case 16:return Ic("Lazy");case 13:return Ic("Suspense");case 19:return Ic("SuspenseList");case 0:case 2:case 15:return n=og(n.type,!1),n;case 11:return n=og(n.type.render,!1),n;case 1:return n=og(n.type,!0),n;default:return""}}function $g(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Oo:return"Fragment";case Fo:return"Portal";case Bg:return"Profiler";case sv:return"StrictMode";case Hg:return"Suspense";case Ug:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case yA:return(n.displayName||"Context")+".Consumer";case mA:return(n._context.displayName||"Context")+".Provider";case iv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case rv:return e=n.displayName||null,e!==null?e:$g(n.type)||"Memo";case Vi:e=n._payload,n=n._init;try{return $g(n(e))}catch{}}return null}function y1(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $g(e);case 8:return e===sv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function wA(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function v1(n){var e=wA(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function md(n){n._valueTracker||(n._valueTracker=v1(n))}function AA(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=wA(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function _f(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Vg(n,e){var t=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function A0(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=jr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function SA(n,e){e=e.checked,e!=null&&nv(n,"checked",e,!1)}function Wg(n,e){SA(n,e);var t=jr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Gg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Gg(n,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function S0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Gg(n,e,t){(e!=="number"||_f(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Dc=Array.isArray;function Ko(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+jr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Xg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function x0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(M(92));if(Dc(t)){if(1<t.length)throw Error(M(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:jr(t)}}function xA(n,e){var t=jr(e.value),s=jr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function b0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function bA(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?bA(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var yd,_A=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(yd=yd||document.createElement("div"),yd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=yd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function du(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var eu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w1=["Webkit","ms","Moz","O"];Object.keys(eu).forEach(function(n){w1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),eu[e]=eu[n]})});function EA(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||eu.hasOwnProperty(n)&&eu[n]?(""+e).trim():e+"px"}function CA(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=EA(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var A1=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yg(n,e){if(e){if(A1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function Kg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qg=null;function av(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Jg=null,Qo=null,Jo=null;function _0(n){if(n=od(n)){if(typeof Jg!="function")throw Error(M(280));var e=n.stateNode;e&&(e=Rp(e),Jg(n.stateNode,n.type,e))}}function kA(n){Qo?Jo?Jo.push(n):Jo=[n]:Qo=n}function TA(){if(Qo){var n=Qo,e=Jo;if(Jo=Qo=null,_0(n),e)for(n=0;n<e.length;n++)_0(e[n])}}function PA(n,e){return n(e)}function NA(){}var lg=!1;function RA(n,e,t){if(lg)return n(e,t);lg=!0;try{return PA(n,e,t)}finally{lg=!1,(Qo!==null||Jo!==null)&&(NA(),TA())}}function fu(n,e){var t=n.stateNode;if(t===null)return null;var s=Rp(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(M(231,e,typeof t));return t}var Zg=!1;if(Di)try{var bc={};Object.defineProperty(bc,"passive",{get:function(){Zg=!0}}),window.addEventListener("test",bc,bc),window.removeEventListener("test",bc,bc)}catch{Zg=!1}function S1(n,e,t,s,i,r,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var tu=!1,Ef=null,Cf=!1,em=null,x1={onError:function(n){tu=!0,Ef=n}};function b1(n,e,t,s,i,r,a,o,c){tu=!1,Ef=null,S1.apply(x1,arguments)}function _1(n,e,t,s,i,r,a,o,c){if(b1.apply(this,arguments),tu){if(tu){var u=Ef;tu=!1,Ef=null}else throw Error(M(198));Cf||(Cf=!0,em=u)}}function xo(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function MA(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function E0(n){if(xo(n)!==n)throw Error(M(188))}function E1(n){var e=n.alternate;if(!e){if(e=xo(n),e===null)throw Error(M(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return E0(i),n;if(r===s)return E0(i),e;r=r.sibling}throw Error(M(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(M(189))}}if(t.alternate!==s)throw Error(M(190))}if(t.tag!==3)throw Error(M(188));return t.stateNode.current===t?n:e}function LA(n){return n=E1(n),n!==null?IA(n):null}function IA(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=IA(n);if(e!==null)return e;n=n.sibling}return null}var DA=Nn.unstable_scheduleCallback,C0=Nn.unstable_cancelCallback,C1=Nn.unstable_shouldYield,k1=Nn.unstable_requestPaint,We=Nn.unstable_now,T1=Nn.unstable_getCurrentPriorityLevel,ov=Nn.unstable_ImmediatePriority,FA=Nn.unstable_UserBlockingPriority,kf=Nn.unstable_NormalPriority,P1=Nn.unstable_LowPriority,OA=Nn.unstable_IdlePriority,kp=null,Xs=null;function N1(n){if(Xs&&typeof Xs.onCommitFiberRoot=="function")try{Xs.onCommitFiberRoot(kp,n,void 0,(n.current.flags&128)===128)}catch{}}var ys=Math.clz32?Math.clz32:L1,R1=Math.log,M1=Math.LN2;function L1(n){return n>>>=0,n===0?32:31-(R1(n)/M1|0)|0}var vd=64,wd=4194304;function Fc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Tf(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=Fc(o):(r&=a,r!==0&&(s=Fc(r)))}else a=t&~i,a!==0?s=Fc(a):r!==0&&(s=Fc(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-ys(e),i=1<<t,s|=n[t],e&=~i;return s}function I1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D1(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-ys(r),o=1<<a,c=i[a];c===-1?(!(o&t)||o&s)&&(i[a]=I1(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function tm(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function jA(){var n=vd;return vd<<=1,!(vd&4194240)&&(vd=64),n}function cg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function rd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ys(e),n[e]=t}function F1(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ys(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function lv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-ys(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Ae=0;function zA(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var BA,cv,HA,UA,$A,nm=!1,Ad=[],Tr=null,Pr=null,Nr=null,pu=new Map,gu=new Map,Gi=[],O1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k0(n,e){switch(n){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gu.delete(e.pointerId)}}function _c(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=od(e),e!==null&&cv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function j1(n,e,t,s,i){switch(e){case"focusin":return Tr=_c(Tr,n,e,t,s,i),!0;case"dragenter":return Pr=_c(Pr,n,e,t,s,i),!0;case"mouseover":return Nr=_c(Nr,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return pu.set(r,_c(pu.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,gu.set(r,_c(gu.get(r)||null,n,e,t,s,i)),!0}return!1}function VA(n){var e=na(n.target);if(e!==null){var t=xo(e);if(t!==null){if(e=t.tag,e===13){if(e=MA(t),e!==null){n.blockedOn=e,$A(n.priority,function(){HA(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Od(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=sm(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);Qg=s,t.target.dispatchEvent(s),Qg=null}else return e=od(t),e!==null&&cv(e),n.blockedOn=t,!1;e.shift()}return!0}function T0(n,e,t){Od(n)&&t.delete(e)}function z1(){nm=!1,Tr!==null&&Od(Tr)&&(Tr=null),Pr!==null&&Od(Pr)&&(Pr=null),Nr!==null&&Od(Nr)&&(Nr=null),pu.forEach(T0),gu.forEach(T0)}function Ec(n,e){n.blockedOn===e&&(n.blockedOn=null,nm||(nm=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,z1)))}function mu(n){function e(i){return Ec(i,n)}if(0<Ad.length){Ec(Ad[0],n);for(var t=1;t<Ad.length;t++){var s=Ad[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Tr!==null&&Ec(Tr,n),Pr!==null&&Ec(Pr,n),Nr!==null&&Ec(Nr,n),pu.forEach(e),gu.forEach(e),t=0;t<Gi.length;t++)s=Gi[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Gi.length&&(t=Gi[0],t.blockedOn===null);)VA(t),t.blockedOn===null&&Gi.shift()}var Zo=Hi.ReactCurrentBatchConfig,Pf=!0;function B1(n,e,t,s){var i=Ae,r=Zo.transition;Zo.transition=null;try{Ae=1,uv(n,e,t,s)}finally{Ae=i,Zo.transition=r}}function H1(n,e,t,s){var i=Ae,r=Zo.transition;Zo.transition=null;try{Ae=4,uv(n,e,t,s)}finally{Ae=i,Zo.transition=r}}function uv(n,e,t,s){if(Pf){var i=sm(n,e,t,s);if(i===null)wg(n,e,s,Nf,t),k0(n,s);else if(j1(i,n,e,t,s))s.stopPropagation();else if(k0(n,s),e&4&&-1<O1.indexOf(n)){for(;i!==null;){var r=od(i);if(r!==null&&BA(r),r=sm(n,e,t,s),r===null&&wg(n,e,s,Nf,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else wg(n,e,s,null,t)}}var Nf=null;function sm(n,e,t,s){if(Nf=null,n=av(s),n=na(n),n!==null)if(e=xo(n),e===null)n=null;else if(t=e.tag,t===13){if(n=MA(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Nf=n,null}function WA(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T1()){case ov:return 1;case FA:return 4;case kf:case P1:return 16;case OA:return 536870912;default:return 16}default:return 16}}var Er=null,hv=null,jd=null;function GA(){if(jd)return jd;var n,e=hv,t=e.length,s,i="value"in Er?Er.value:Er.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return jd=i.slice(n,1<s?1-s:void 0)}function zd(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Sd(){return!0}function P0(){return!1}function Mn(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Sd:P0,this.isPropagationStopped=P0,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Sd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Sd)},persist:function(){},isPersistent:Sd}),e}var vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dv=Mn(vc),ad=Be({},vc,{view:0,detail:0}),U1=Mn(ad),ug,hg,Cc,Tp=Be({},ad,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Cc&&(Cc&&n.type==="mousemove"?(ug=n.screenX-Cc.screenX,hg=n.screenY-Cc.screenY):hg=ug=0,Cc=n),ug)},movementY:function(n){return"movementY"in n?n.movementY:hg}}),N0=Mn(Tp),$1=Be({},Tp,{dataTransfer:0}),V1=Mn($1),W1=Be({},ad,{relatedTarget:0}),dg=Mn(W1),G1=Be({},vc,{animationName:0,elapsedTime:0,pseudoElement:0}),X1=Mn(G1),q1=Be({},vc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Y1=Mn(q1),K1=Be({},vc,{data:0}),R0=Mn(K1),Q1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},J1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eE(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Z1[n])?!!e[n]:!1}function fv(){return eE}var tE=Be({},ad,{key:function(n){if(n.key){var e=Q1[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=zd(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?J1[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fv,charCode:function(n){return n.type==="keypress"?zd(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?zd(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nE=Mn(tE),sE=Be({},Tp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),M0=Mn(sE),iE=Be({},ad,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fv}),rE=Mn(iE),aE=Be({},vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),oE=Mn(aE),lE=Be({},Tp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),cE=Mn(lE),uE=[9,13,27,32],pv=Di&&"CompositionEvent"in window,nu=null;Di&&"documentMode"in document&&(nu=document.documentMode);var hE=Di&&"TextEvent"in window&&!nu,XA=Di&&(!pv||nu&&8<nu&&11>=nu),L0=" ",I0=!1;function qA(n,e){switch(n){case"keyup":return uE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function YA(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var jo=!1;function dE(n,e){switch(n){case"compositionend":return YA(e);case"keypress":return e.which!==32?null:(I0=!0,L0);case"textInput":return n=e.data,n===L0&&I0?null:n;default:return null}}function fE(n,e){if(jo)return n==="compositionend"||!pv&&qA(n,e)?(n=GA(),jd=hv=Er=null,jo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return XA&&e.locale!=="ko"?null:e.data;default:return null}}var pE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function D0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!pE[n.type]:e==="textarea"}function KA(n,e,t,s){kA(s),e=Rf(e,"onChange"),0<e.length&&(t=new dv("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var su=null,yu=null;function gE(n){oS(n,0)}function Pp(n){var e=Ho(n);if(AA(e))return n}function mE(n,e){if(n==="change")return e}var QA=!1;if(Di){var fg;if(Di){var pg="oninput"in document;if(!pg){var F0=document.createElement("div");F0.setAttribute("oninput","return;"),pg=typeof F0.oninput=="function"}fg=pg}else fg=!1;QA=fg&&(!document.documentMode||9<document.documentMode)}function O0(){su&&(su.detachEvent("onpropertychange",JA),yu=su=null)}function JA(n){if(n.propertyName==="value"&&Pp(yu)){var e=[];KA(e,yu,n,av(n)),RA(gE,e)}}function yE(n,e,t){n==="focusin"?(O0(),su=e,yu=t,su.attachEvent("onpropertychange",JA)):n==="focusout"&&O0()}function vE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Pp(yu)}function wE(n,e){if(n==="click")return Pp(e)}function AE(n,e){if(n==="input"||n==="change")return Pp(e)}function SE(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ws=typeof Object.is=="function"?Object.is:SE;function vu(n,e){if(ws(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!zg.call(e,i)||!ws(n[i],e[i]))return!1}return!0}function j0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function z0(n,e){var t=j0(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=j0(t)}}function ZA(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?ZA(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function eS(){for(var n=window,e=_f();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=_f(n.document)}return e}function gv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function xE(n){var e=eS(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&ZA(t.ownerDocument.documentElement,t)){if(s!==null&&gv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=z0(t,r);var a=z0(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var bE=Di&&"documentMode"in document&&11>=document.documentMode,zo=null,im=null,iu=null,rm=!1;function B0(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;rm||zo==null||zo!==_f(s)||(s=zo,"selectionStart"in s&&gv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),iu&&vu(iu,s)||(iu=s,s=Rf(im,"onSelect"),0<s.length&&(e=new dv("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=zo)))}function xd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Bo={animationend:xd("Animation","AnimationEnd"),animationiteration:xd("Animation","AnimationIteration"),animationstart:xd("Animation","AnimationStart"),transitionend:xd("Transition","TransitionEnd")},gg={},tS={};Di&&(tS=document.createElement("div").style,"AnimationEvent"in window||(delete Bo.animationend.animation,delete Bo.animationiteration.animation,delete Bo.animationstart.animation),"TransitionEvent"in window||delete Bo.transitionend.transition);function Np(n){if(gg[n])return gg[n];if(!Bo[n])return n;var e=Bo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in tS)return gg[n]=e[t];return n}var nS=Np("animationend"),sS=Np("animationiteration"),iS=Np("animationstart"),rS=Np("transitionend"),aS=new Map,H0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(n,e){aS.set(n,e),So(e,[n])}for(var mg=0;mg<H0.length;mg++){var yg=H0[mg],_E=yg.toLowerCase(),EE=yg[0].toUpperCase()+yg.slice(1);$r(_E,"on"+EE)}$r(nS,"onAnimationEnd");$r(sS,"onAnimationIteration");$r(iS,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(rS,"onTransitionEnd");cc("onMouseEnter",["mouseout","mouseover"]);cc("onMouseLeave",["mouseout","mouseover"]);cc("onPointerEnter",["pointerout","pointerover"]);cc("onPointerLeave",["pointerout","pointerover"]);So("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));So("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));So("onBeforeInput",["compositionend","keypress","textInput","paste"]);So("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));So("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));So("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oc));function U0(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,_1(s,e,void 0,n),n.currentTarget=null}function oS(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;U0(i,o,u),r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;U0(i,o,u),r=c}}}if(Cf)throw n=em,Cf=!1,em=null,n}function Te(n,e){var t=e[um];t===void 0&&(t=e[um]=new Set);var s=n+"__bubble";t.has(s)||(lS(e,n,2,!1),t.add(s))}function vg(n,e,t){var s=0;e&&(s|=4),lS(t,n,s,e)}var bd="_reactListening"+Math.random().toString(36).slice(2);function wu(n){if(!n[bd]){n[bd]=!0,gA.forEach(function(t){t!=="selectionchange"&&(CE.has(t)||vg(t,!1,n),vg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[bd]||(e[bd]=!0,vg("selectionchange",!1,e))}}function lS(n,e,t,s){switch(WA(e)){case 1:var i=B1;break;case 4:i=H1;break;default:i=uv}t=i.bind(null,e,t,n),i=void 0,!Zg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function wg(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=na(o),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}o=o.parentNode}}s=s.return}RA(function(){var u=r,h=av(t),d=[];e:{var f=aS.get(n);if(f!==void 0){var p=dv,y=n;switch(n){case"keypress":if(zd(t)===0)break e;case"keydown":case"keyup":p=nE;break;case"focusin":y="focus",p=dg;break;case"focusout":y="blur",p=dg;break;case"beforeblur":case"afterblur":p=dg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=N0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=V1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=rE;break;case nS:case sS:case iS:p=X1;break;case rS:p=oE;break;case"scroll":p=U1;break;case"wheel":p=cE;break;case"copy":case"cut":case"paste":p=Y1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=M0}var w=(e&4)!==0,_=!w&&n==="scroll",v=w?f!==null?f+"Capture":null:f;w=[];for(var A=u,b;A!==null;){b=A;var E=b.stateNode;if(b.tag===5&&E!==null&&(b=E,v!==null&&(E=fu(A,v),E!=null&&w.push(Au(A,E,b)))),_)break;A=A.return}0<w.length&&(f=new p(f,y,null,t,h),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==Qg&&(y=t.relatedTarget||t.fromElement)&&(na(y)||y[Fi]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=u,y=y?na(y):null,y!==null&&(_=xo(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(w=N0,E="onMouseLeave",v="onMouseEnter",A="mouse",(n==="pointerout"||n==="pointerover")&&(w=M0,E="onPointerLeave",v="onPointerEnter",A="pointer"),_=p==null?f:Ho(p),b=y==null?f:Ho(y),f=new w(E,A+"leave",p,t,h),f.target=_,f.relatedTarget=b,E=null,na(h)===u&&(w=new w(v,A+"enter",y,t,h),w.target=b,w.relatedTarget=_,E=w),_=E,p&&y)t:{for(w=p,v=y,A=0,b=w;b;b=To(b))A++;for(b=0,E=v;E;E=To(E))b++;for(;0<A-b;)w=To(w),A--;for(;0<b-A;)v=To(v),b--;for(;A--;){if(w===v||v!==null&&w===v.alternate)break t;w=To(w),v=To(v)}w=null}else w=null;p!==null&&$0(d,f,p,w,!1),y!==null&&_!==null&&$0(d,_,y,w,!0)}}e:{if(f=u?Ho(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=mE;else if(D0(f))if(QA)C=AE;else{C=vE;var T=yE}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=wE);if(C&&(C=C(n,u))){KA(d,C,t,h);break e}T&&T(n,f,u),n==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&Gg(f,"number",f.value)}switch(T=u?Ho(u):window,n){case"focusin":(D0(T)||T.contentEditable==="true")&&(zo=T,im=u,iu=null);break;case"focusout":iu=im=zo=null;break;case"mousedown":rm=!0;break;case"contextmenu":case"mouseup":case"dragend":rm=!1,B0(d,t,h);break;case"selectionchange":if(bE)break;case"keydown":case"keyup":B0(d,t,h)}var k;if(pv)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else jo?qA(n,t)&&(N="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(XA&&t.locale!=="ko"&&(jo||N!=="onCompositionStart"?N==="onCompositionEnd"&&jo&&(k=GA()):(Er=h,hv="value"in Er?Er.value:Er.textContent,jo=!0)),T=Rf(u,N),0<T.length&&(N=new R0(N,n,null,t,h),d.push({event:N,listeners:T}),k?N.data=k:(k=YA(t),k!==null&&(N.data=k)))),(k=hE?dE(n,t):fE(n,t))&&(u=Rf(u,"onBeforeInput"),0<u.length&&(h=new R0("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=k))}oS(d,e)})}function Au(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Rf(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=fu(n,t),r!=null&&s.unshift(Au(n,r,i)),r=fu(n,e),r!=null&&s.push(Au(n,r,i))),n=n.return}return s}function To(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function $0(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,i?(c=fu(t,r),c!=null&&a.unshift(Au(t,c,o))):i||(c=fu(t,r),c!=null&&a.push(Au(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var kE=/\r\n?/g,TE=/\u0000|\uFFFD/g;function V0(n){return(typeof n=="string"?n:""+n).replace(kE,`
`).replace(TE,"")}function _d(n,e,t){if(e=V0(e),V0(n)!==e&&t)throw Error(M(425))}function Mf(){}var am=null,om=null;function lm(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cm=typeof setTimeout=="function"?setTimeout:void 0,PE=typeof clearTimeout=="function"?clearTimeout:void 0,W0=typeof Promise=="function"?Promise:void 0,NE=typeof queueMicrotask=="function"?queueMicrotask:typeof W0<"u"?function(n){return W0.resolve(null).then(n).catch(RE)}:cm;function RE(n){setTimeout(function(){throw n})}function Ag(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),mu(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);mu(e)}function Rr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function G0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var wc=Math.random().toString(36).slice(2),Gs="__reactFiber$"+wc,Su="__reactProps$"+wc,Fi="__reactContainer$"+wc,um="__reactEvents$"+wc,ME="__reactListeners$"+wc,LE="__reactHandles$"+wc;function na(n){var e=n[Gs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Fi]||t[Gs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=G0(n);n!==null;){if(t=n[Gs])return t;n=G0(n)}return e}n=t,t=n.parentNode}return null}function od(n){return n=n[Gs]||n[Fi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ho(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(M(33))}function Rp(n){return n[Su]||null}var hm=[],Uo=-1;function Vr(n){return{current:n}}function Ne(n){0>Uo||(n.current=hm[Uo],hm[Uo]=null,Uo--)}function ke(n,e){Uo++,hm[Uo]=n.current,n.current=e}var zr={},Ot=Vr(zr),ln=Vr(!1),ho=zr;function uc(n,e){var t=n.type.contextTypes;if(!t)return zr;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function cn(n){return n=n.childContextTypes,n!=null}function Lf(){Ne(ln),Ne(Ot)}function X0(n,e,t){if(Ot.current!==zr)throw Error(M(168));ke(Ot,e),ke(ln,t)}function cS(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(M(108,y1(n)||"Unknown",i));return Be({},t,s)}function If(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||zr,ho=Ot.current,ke(Ot,n),ke(ln,ln.current),!0}function q0(n,e,t){var s=n.stateNode;if(!s)throw Error(M(169));t?(n=cS(n,e,ho),s.__reactInternalMemoizedMergedChildContext=n,Ne(ln),Ne(Ot),ke(Ot,n)):Ne(ln),ke(ln,t)}var si=null,Mp=!1,Sg=!1;function uS(n){si===null?si=[n]:si.push(n)}function IE(n){Mp=!0,uS(n)}function Wr(){if(!Sg&&si!==null){Sg=!0;var n=0,e=Ae;try{var t=si;for(Ae=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}si=null,Mp=!1}catch(i){throw si!==null&&(si=si.slice(n+1)),DA(ov,Wr),i}finally{Ae=e,Sg=!1}}return null}var $o=[],Vo=0,Df=null,Ff=0,Un=[],$n=0,fo=null,Ni=1,Ri="";function qr(n,e){$o[Vo++]=Ff,$o[Vo++]=Df,Df=n,Ff=e}function hS(n,e,t){Un[$n++]=Ni,Un[$n++]=Ri,Un[$n++]=fo,fo=n;var s=Ni;n=Ri;var i=32-ys(s)-1;s&=~(1<<i),t+=1;var r=32-ys(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Ni=1<<32-ys(e)+i|t<<i|s,Ri=r+n}else Ni=1<<r|t<<i|s,Ri=n}function mv(n){n.return!==null&&(qr(n,1),hS(n,1,0))}function yv(n){for(;n===Df;)Df=$o[--Vo],$o[Vo]=null,Ff=$o[--Vo],$o[Vo]=null;for(;n===fo;)fo=Un[--$n],Un[$n]=null,Ri=Un[--$n],Un[$n]=null,Ni=Un[--$n],Un[$n]=null}var Tn=null,kn=null,Ie=!1,gs=null;function dS(n,e){var t=Gn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Y0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Tn=n,kn=Rr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Tn=n,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=fo!==null?{id:Ni,overflow:Ri}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Gn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Tn=n,kn=null,!0):!1;default:return!1}}function dm(n){return(n.mode&1)!==0&&(n.flags&128)===0}function fm(n){if(Ie){var e=kn;if(e){var t=e;if(!Y0(n,e)){if(dm(n))throw Error(M(418));e=Rr(t.nextSibling);var s=Tn;e&&Y0(n,e)?dS(s,t):(n.flags=n.flags&-4097|2,Ie=!1,Tn=n)}}else{if(dm(n))throw Error(M(418));n.flags=n.flags&-4097|2,Ie=!1,Tn=n}}}function K0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Tn=n}function Ed(n){if(n!==Tn)return!1;if(!Ie)return K0(n),Ie=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!lm(n.type,n.memoizedProps)),e&&(e=kn)){if(dm(n))throw fS(),Error(M(418));for(;e;)dS(n,e),e=Rr(e.nextSibling)}if(K0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(M(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){kn=Rr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}kn=null}}else kn=Tn?Rr(n.stateNode.nextSibling):null;return!0}function fS(){for(var n=kn;n;)n=Rr(n.nextSibling)}function hc(){kn=Tn=null,Ie=!1}function vv(n){gs===null?gs=[n]:gs.push(n)}var DE=Hi.ReactCurrentBatchConfig;function kc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(M(309));var s=t.stateNode}if(!s)throw Error(M(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(M(284));if(!t._owner)throw Error(M(290,n))}return n}function Cd(n,e){throw n=Object.prototype.toString.call(e),Error(M(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Q0(n){var e=n._init;return e(n._payload)}function pS(n){function e(v,A){if(n){var b=v.deletions;b===null?(v.deletions=[A],v.flags|=16):b.push(A)}}function t(v,A){if(!n)return null;for(;A!==null;)e(v,A),A=A.sibling;return null}function s(v,A){for(v=new Map;A!==null;)A.key!==null?v.set(A.key,A):v.set(A.index,A),A=A.sibling;return v}function i(v,A){return v=Dr(v,A),v.index=0,v.sibling=null,v}function r(v,A,b){return v.index=b,n?(b=v.alternate,b!==null?(b=b.index,b<A?(v.flags|=2,A):b):(v.flags|=2,A)):(v.flags|=1048576,A)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,A,b,E){return A===null||A.tag!==6?(A=Tg(b,v.mode,E),A.return=v,A):(A=i(A,b),A.return=v,A)}function c(v,A,b,E){var C=b.type;return C===Oo?h(v,A,b.props.children,E,b.key):A!==null&&(A.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Vi&&Q0(C)===A.type)?(E=i(A,b.props),E.ref=kc(v,A,b),E.return=v,E):(E=Gd(b.type,b.key,b.props,null,v.mode,E),E.ref=kc(v,A,b),E.return=v,E)}function u(v,A,b,E){return A===null||A.tag!==4||A.stateNode.containerInfo!==b.containerInfo||A.stateNode.implementation!==b.implementation?(A=Pg(b,v.mode,E),A.return=v,A):(A=i(A,b.children||[]),A.return=v,A)}function h(v,A,b,E,C){return A===null||A.tag!==7?(A=uo(b,v.mode,E,C),A.return=v,A):(A=i(A,b),A.return=v,A)}function d(v,A,b){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Tg(""+A,v.mode,b),A.return=v,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case gd:return b=Gd(A.type,A.key,A.props,null,v.mode,b),b.ref=kc(v,null,A),b.return=v,b;case Fo:return A=Pg(A,v.mode,b),A.return=v,A;case Vi:var E=A._init;return d(v,E(A._payload),b)}if(Dc(A)||xc(A))return A=uo(A,v.mode,b,null),A.return=v,A;Cd(v,A)}return null}function f(v,A,b,E){var C=A!==null?A.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:o(v,A,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case gd:return b.key===C?c(v,A,b,E):null;case Fo:return b.key===C?u(v,A,b,E):null;case Vi:return C=b._init,f(v,A,C(b._payload),E)}if(Dc(b)||xc(b))return C!==null?null:h(v,A,b,E,null);Cd(v,b)}return null}function p(v,A,b,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(b)||null,o(A,v,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case gd:return v=v.get(E.key===null?b:E.key)||null,c(A,v,E,C);case Fo:return v=v.get(E.key===null?b:E.key)||null,u(A,v,E,C);case Vi:var T=E._init;return p(v,A,b,T(E._payload),C)}if(Dc(E)||xc(E))return v=v.get(b)||null,h(A,v,E,C,null);Cd(A,E)}return null}function y(v,A,b,E){for(var C=null,T=null,k=A,N=A=0,L=null;k!==null&&N<b.length;N++){k.index>N?(L=k,k=null):L=k.sibling;var D=f(v,k,b[N],E);if(D===null){k===null&&(k=L);break}n&&k&&D.alternate===null&&e(v,k),A=r(D,A,N),T===null?C=D:T.sibling=D,T=D,k=L}if(N===b.length)return t(v,k),Ie&&qr(v,N),C;if(k===null){for(;N<b.length;N++)k=d(v,b[N],E),k!==null&&(A=r(k,A,N),T===null?C=k:T.sibling=k,T=k);return Ie&&qr(v,N),C}for(k=s(v,k);N<b.length;N++)L=p(k,v,N,b[N],E),L!==null&&(n&&L.alternate!==null&&k.delete(L.key===null?N:L.key),A=r(L,A,N),T===null?C=L:T.sibling=L,T=L);return n&&k.forEach(function(O){return e(v,O)}),Ie&&qr(v,N),C}function w(v,A,b,E){var C=xc(b);if(typeof C!="function")throw Error(M(150));if(b=C.call(b),b==null)throw Error(M(151));for(var T=C=null,k=A,N=A=0,L=null,D=b.next();k!==null&&!D.done;N++,D=b.next()){k.index>N?(L=k,k=null):L=k.sibling;var O=f(v,k,D.value,E);if(O===null){k===null&&(k=L);break}n&&k&&O.alternate===null&&e(v,k),A=r(O,A,N),T===null?C=O:T.sibling=O,T=O,k=L}if(D.done)return t(v,k),Ie&&qr(v,N),C;if(k===null){for(;!D.done;N++,D=b.next())D=d(v,D.value,E),D!==null&&(A=r(D,A,N),T===null?C=D:T.sibling=D,T=D);return Ie&&qr(v,N),C}for(k=s(v,k);!D.done;N++,D=b.next())D=p(k,v,N,D.value,E),D!==null&&(n&&D.alternate!==null&&k.delete(D.key===null?N:D.key),A=r(D,A,N),T===null?C=D:T.sibling=D,T=D);return n&&k.forEach(function(j){return e(v,j)}),Ie&&qr(v,N),C}function _(v,A,b,E){if(typeof b=="object"&&b!==null&&b.type===Oo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case gd:e:{for(var C=b.key,T=A;T!==null;){if(T.key===C){if(C=b.type,C===Oo){if(T.tag===7){t(v,T.sibling),A=i(T,b.props.children),A.return=v,v=A;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Vi&&Q0(C)===T.type){t(v,T.sibling),A=i(T,b.props),A.ref=kc(v,T,b),A.return=v,v=A;break e}t(v,T);break}else e(v,T);T=T.sibling}b.type===Oo?(A=uo(b.props.children,v.mode,E,b.key),A.return=v,v=A):(E=Gd(b.type,b.key,b.props,null,v.mode,E),E.ref=kc(v,A,b),E.return=v,v=E)}return a(v);case Fo:e:{for(T=b.key;A!==null;){if(A.key===T)if(A.tag===4&&A.stateNode.containerInfo===b.containerInfo&&A.stateNode.implementation===b.implementation){t(v,A.sibling),A=i(A,b.children||[]),A.return=v,v=A;break e}else{t(v,A);break}else e(v,A);A=A.sibling}A=Pg(b,v.mode,E),A.return=v,v=A}return a(v);case Vi:return T=b._init,_(v,A,T(b._payload),E)}if(Dc(b))return y(v,A,b,E);if(xc(b))return w(v,A,b,E);Cd(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,A!==null&&A.tag===6?(t(v,A.sibling),A=i(A,b),A.return=v,v=A):(t(v,A),A=Tg(b,v.mode,E),A.return=v,v=A),a(v)):t(v,A)}return _}var dc=pS(!0),gS=pS(!1),Of=Vr(null),jf=null,Wo=null,wv=null;function Av(){wv=Wo=jf=null}function Sv(n){var e=Of.current;Ne(Of),n._currentValue=e}function pm(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function el(n,e){jf=n,wv=Wo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(an=!0),n.firstContext=null)}function Kn(n){var e=n._currentValue;if(wv!==n)if(n={context:n,memoizedValue:e,next:null},Wo===null){if(jf===null)throw Error(M(308));Wo=n,jf.dependencies={lanes:0,firstContext:n}}else Wo=Wo.next=n;return e}var sa=null;function xv(n){sa===null?sa=[n]:sa.push(n)}function mS(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,xv(e)):(t.next=i.next,i.next=t),e.interleaved=t,Oi(n,s)}function Oi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Wi=!1;function bv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Mi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Mr(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,he&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Oi(n,t)}return i=s.interleaved,i===null?(e.next=e,xv(s)):(e.next=i.next,i.next=e),s.interleaved=e,Oi(n,t)}function Bd(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,lv(n,t)}}function J0(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function zf(n,e,t,s){var i=n.updateQueue;Wi=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=c))}if(r!==null){var d=i.baseState;a=0,h=u=c=null,o=r;do{var f=o.lane,p=o.eventTime;if((s&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=n,w=o;switch(f=e,p=t,w.tag){case 1:if(y=w.payload,typeof y=="function"){d=y.call(p,d,f);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,f=typeof y=="function"?y.call(p,d,f):y,f==null)break e;d=Be({},d,f);break e;case 2:Wi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=p,c=d):h=h.next=p,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);go|=a,n.lanes=a,n.memoizedState=d}}function Z0(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(M(191,i));i.call(s)}}}var ld={},qs=Vr(ld),xu=Vr(ld),bu=Vr(ld);function ia(n){if(n===ld)throw Error(M(174));return n}function _v(n,e){switch(ke(bu,e),ke(xu,n),ke(qs,ld),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=qg(e,n)}Ne(qs),ke(qs,e)}function fc(){Ne(qs),Ne(xu),Ne(bu)}function vS(n){ia(bu.current);var e=ia(qs.current),t=qg(e,n.type);e!==t&&(ke(xu,n),ke(qs,t))}function Ev(n){xu.current===n&&(Ne(qs),Ne(xu))}var Oe=Vr(0);function Bf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xg=[];function Cv(){for(var n=0;n<xg.length;n++)xg[n]._workInProgressVersionPrimary=null;xg.length=0}var Hd=Hi.ReactCurrentDispatcher,bg=Hi.ReactCurrentBatchConfig,po=0,ze=null,st=null,dt=null,Hf=!1,ru=!1,_u=0,FE=0;function Et(){throw Error(M(321))}function kv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ws(n[t],e[t]))return!1;return!0}function Tv(n,e,t,s,i,r){if(po=r,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hd.current=n===null||n.memoizedState===null?BE:HE,n=t(s,i),ru){r=0;do{if(ru=!1,_u=0,25<=r)throw Error(M(301));r+=1,dt=st=null,e.updateQueue=null,Hd.current=UE,n=t(s,i)}while(ru)}if(Hd.current=Uf,e=st!==null&&st.next!==null,po=0,dt=st=ze=null,Hf=!1,e)throw Error(M(300));return n}function Pv(){var n=_u!==0;return _u=0,n}function Ts(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?ze.memoizedState=dt=n:dt=dt.next=n,dt}function Qn(){if(st===null){var n=ze.alternate;n=n!==null?n.memoizedState:null}else n=st.next;var e=dt===null?ze.memoizedState:dt.next;if(e!==null)dt=e,st=n;else{if(n===null)throw Error(M(310));st=n,n={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},dt===null?ze.memoizedState=dt=n:dt=dt.next=n}return dt}function Eu(n,e){return typeof e=="function"?e(n):e}function _g(n){var e=Qn(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var s=st,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,c=null,u=r;do{var h=u.lane;if((po&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,a=s):c=c.next=d,ze.lanes|=h,go|=h}u=u.next}while(u!==null&&u!==r);c===null?a=s:c.next=o,ws(s,e.memoizedState)||(an=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,ze.lanes|=r,go|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Eg(n){var e=Qn(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);ws(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function wS(){}function AS(n,e){var t=ze,s=Qn(),i=e(),r=!ws(s.memoizedState,i);if(r&&(s.memoizedState=i,an=!0),s=s.queue,Nv(bS.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||dt!==null&&dt.memoizedState.tag&1){if(t.flags|=2048,Cu(9,xS.bind(null,t,s,i,e),void 0,null),ft===null)throw Error(M(349));po&30||SS(t,e,i)}return i}function SS(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function xS(n,e,t,s){e.value=t,e.getSnapshot=s,_S(e)&&ES(n)}function bS(n,e,t){return t(function(){_S(e)&&ES(n)})}function _S(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ws(n,t)}catch{return!0}}function ES(n){var e=Oi(n,1);e!==null&&vs(e,n,1,-1)}function ew(n){var e=Ts();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:n},e.queue=n,n=n.dispatch=zE.bind(null,ze,n),[e.memoizedState,n]}function Cu(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function CS(){return Qn().memoizedState}function Ud(n,e,t,s){var i=Ts();ze.flags|=n,i.memoizedState=Cu(1|e,t,void 0,s===void 0?null:s)}function Lp(n,e,t,s){var i=Qn();s=s===void 0?null:s;var r=void 0;if(st!==null){var a=st.memoizedState;if(r=a.destroy,s!==null&&kv(s,a.deps)){i.memoizedState=Cu(e,t,r,s);return}}ze.flags|=n,i.memoizedState=Cu(1|e,t,r,s)}function tw(n,e){return Ud(8390656,8,n,e)}function Nv(n,e){return Lp(2048,8,n,e)}function kS(n,e){return Lp(4,2,n,e)}function TS(n,e){return Lp(4,4,n,e)}function PS(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function NS(n,e,t){return t=t!=null?t.concat([n]):null,Lp(4,4,PS.bind(null,e,n),t)}function Rv(){}function RS(n,e){var t=Qn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&kv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function MS(n,e){var t=Qn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&kv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function LS(n,e,t){return po&21?(ws(t,e)||(t=jA(),ze.lanes|=t,go|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,an=!0),n.memoizedState=t)}function OE(n,e){var t=Ae;Ae=t!==0&&4>t?t:4,n(!0);var s=bg.transition;bg.transition={};try{n(!1),e()}finally{Ae=t,bg.transition=s}}function IS(){return Qn().memoizedState}function jE(n,e,t){var s=Ir(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},DS(n))FS(e,t);else if(t=mS(n,e,t,s),t!==null){var i=Wt();vs(t,n,s,i),OS(t,e,s)}}function zE(n,e,t){var s=Ir(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(DS(n))FS(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,ws(o,a)){var c=e.interleaved;c===null?(i.next=i,xv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=mS(n,e,i,s),t!==null&&(i=Wt(),vs(t,n,s,i),OS(t,e,s))}}function DS(n){var e=n.alternate;return n===ze||e!==null&&e===ze}function FS(n,e){ru=Hf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function OS(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,lv(n,t)}}var Uf={readContext:Kn,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},BE={readContext:Kn,useCallback:function(n,e){return Ts().memoizedState=[n,e===void 0?null:e],n},useContext:Kn,useEffect:tw,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Ud(4194308,4,PS.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Ud(4194308,4,n,e)},useInsertionEffect:function(n,e){return Ud(4,2,n,e)},useMemo:function(n,e){var t=Ts();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Ts();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=jE.bind(null,ze,n),[s.memoizedState,n]},useRef:function(n){var e=Ts();return n={current:n},e.memoizedState=n},useState:ew,useDebugValue:Rv,useDeferredValue:function(n){return Ts().memoizedState=n},useTransition:function(){var n=ew(!1),e=n[0];return n=OE.bind(null,n[1]),Ts().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=ze,i=Ts();if(Ie){if(t===void 0)throw Error(M(407));t=t()}else{if(t=e(),ft===null)throw Error(M(349));po&30||SS(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,tw(bS.bind(null,s,r,n),[n]),s.flags|=2048,Cu(9,xS.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Ts(),e=ft.identifierPrefix;if(Ie){var t=Ri,s=Ni;t=(s&~(1<<32-ys(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=_u++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=FE++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},HE={readContext:Kn,useCallback:RS,useContext:Kn,useEffect:Nv,useImperativeHandle:NS,useInsertionEffect:kS,useLayoutEffect:TS,useMemo:MS,useReducer:_g,useRef:CS,useState:function(){return _g(Eu)},useDebugValue:Rv,useDeferredValue:function(n){var e=Qn();return LS(e,st.memoizedState,n)},useTransition:function(){var n=_g(Eu)[0],e=Qn().memoizedState;return[n,e]},useMutableSource:wS,useSyncExternalStore:AS,useId:IS,unstable_isNewReconciler:!1},UE={readContext:Kn,useCallback:RS,useContext:Kn,useEffect:Nv,useImperativeHandle:NS,useInsertionEffect:kS,useLayoutEffect:TS,useMemo:MS,useReducer:Eg,useRef:CS,useState:function(){return Eg(Eu)},useDebugValue:Rv,useDeferredValue:function(n){var e=Qn();return st===null?e.memoizedState=n:LS(e,st.memoizedState,n)},useTransition:function(){var n=Eg(Eu)[0],e=Qn().memoizedState;return[n,e]},useMutableSource:wS,useSyncExternalStore:AS,useId:IS,unstable_isNewReconciler:!1};function es(n,e){if(n&&n.defaultProps){e=Be({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function gm(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Be({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Ip={isMounted:function(n){return(n=n._reactInternals)?xo(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Wt(),i=Ir(n),r=Mi(s,i);r.payload=e,t!=null&&(r.callback=t),e=Mr(n,r,i),e!==null&&(vs(e,n,i,s),Bd(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Wt(),i=Ir(n),r=Mi(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Mr(n,r,i),e!==null&&(vs(e,n,i,s),Bd(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Wt(),s=Ir(n),i=Mi(t,s);i.tag=2,e!=null&&(i.callback=e),e=Mr(n,i,s),e!==null&&(vs(e,n,s,t),Bd(e,n,s))}};function nw(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!vu(t,s)||!vu(i,r):!0}function jS(n,e,t){var s=!1,i=zr,r=e.contextType;return typeof r=="object"&&r!==null?r=Kn(r):(i=cn(e)?ho:Ot.current,s=e.contextTypes,r=(s=s!=null)?uc(n,i):zr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ip,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function sw(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&Ip.enqueueReplaceState(e,e.state,null)}function mm(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},bv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=Kn(r):(r=cn(e)?ho:Ot.current,i.context=uc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(gm(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ip.enqueueReplaceState(i,i.state,null),zf(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function pc(n,e){try{var t="",s=e;do t+=m1(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Cg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function ym(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var $E=typeof WeakMap=="function"?WeakMap:Map;function zS(n,e,t){t=Mi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Vf||(Vf=!0,km=s),ym(n,e)},t}function BS(n,e,t){t=Mi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){ym(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){ym(n,e),typeof s!="function"&&(Lr===null?Lr=new Set([this]):Lr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function iw(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new $E;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=sC.bind(null,n,e,t),e.then(n,n))}function rw(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function aw(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Mi(-1,1),e.tag=2,Mr(t,e,1))),t.lanes|=1),n)}var VE=Hi.ReactCurrentOwner,an=!1;function Vt(n,e,t,s){e.child=n===null?gS(e,null,t,s):dc(e,n.child,t,s)}function ow(n,e,t,s,i){t=t.render;var r=e.ref;return el(e,i),s=Tv(n,e,t,s,r,i),t=Pv(),n!==null&&!an?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,ji(n,e,i)):(Ie&&t&&mv(e),e.flags|=1,Vt(n,e,s,i),e.child)}function lw(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!zv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,HS(n,e,r,s,i)):(n=Gd(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:vu,t(a,s)&&n.ref===e.ref)return ji(n,e,i)}return e.flags|=1,n=Dr(r,s),n.ref=e.ref,n.return=e,e.child=n}function HS(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(vu(r,s)&&n.ref===e.ref)if(an=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(an=!0);else return e.lanes=n.lanes,ji(n,e,i)}return vm(n,e,t,s,i)}function US(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(Xo,_n),_n|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ke(Xo,_n),_n|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,ke(Xo,_n),_n|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,ke(Xo,_n),_n|=s;return Vt(n,e,i,t),e.child}function $S(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function vm(n,e,t,s,i){var r=cn(t)?ho:Ot.current;return r=uc(e,r),el(e,i),t=Tv(n,e,t,s,r,i),s=Pv(),n!==null&&!an?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,ji(n,e,i)):(Ie&&s&&mv(e),e.flags|=1,Vt(n,e,t,i),e.child)}function cw(n,e,t,s,i){if(cn(t)){var r=!0;If(e)}else r=!1;if(el(e,i),e.stateNode===null)$d(n,e),jS(e,t,s),mm(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Kn(u):(u=cn(t)?ho:Ot.current,u=uc(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||c!==u)&&sw(e,a,s,u),Wi=!1;var f=e.memoizedState;a.state=f,zf(e,s,a,i),c=e.memoizedState,o!==s||f!==c||ln.current||Wi?(typeof h=="function"&&(gm(e,t,h,s),c=e.memoizedState),(o=Wi||nw(e,t,o,s,f,c,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,yS(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:es(e.type,o),a.props=u,d=e.pendingProps,f=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=Kn(c):(c=cn(t)?ho:Ot.current,c=uc(e,c));var p=t.getDerivedStateFromProps;(h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==c)&&sw(e,a,s,c),Wi=!1,f=e.memoizedState,a.state=f,zf(e,s,a,i);var y=e.memoizedState;o!==d||f!==y||ln.current||Wi?(typeof p=="function"&&(gm(e,t,p,s),y=e.memoizedState),(u=Wi||nw(e,t,u,s,f,y,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,y,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,y,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),a.props=s,a.state=y,a.context=c,s=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return wm(n,e,t,s,r,i)}function wm(n,e,t,s,i,r){$S(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&q0(e,t,!1),ji(n,e,r);s=e.stateNode,VE.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=dc(e,n.child,null,r),e.child=dc(e,null,o,r)):Vt(n,e,o,r),e.memoizedState=s.state,i&&q0(e,t,!0),e.child}function VS(n){var e=n.stateNode;e.pendingContext?X0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&X0(n,e.context,!1),_v(n,e.containerInfo)}function uw(n,e,t,s,i){return hc(),vv(i),e.flags|=256,Vt(n,e,t,s),e.child}var Am={dehydrated:null,treeContext:null,retryLane:0};function Sm(n){return{baseLanes:n,cachePool:null,transitions:null}}function WS(n,e,t){var s=e.pendingProps,i=Oe.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),ke(Oe,i&1),n===null)return fm(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=Op(a,s,0,null),n=uo(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=Sm(t),e.memoizedState=Am,n):Mv(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return WE(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Dr(i,c),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=Dr(o,r):(r=uo(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?Sm(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=Am,s}return r=n.child,n=r.sibling,s=Dr(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Mv(n,e){return e=Op({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function kd(n,e,t,s){return s!==null&&vv(s),dc(e,n.child,null,t),n=Mv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function WE(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=Cg(Error(M(422))),kd(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=Op({mode:"visible",children:s.children},i,0,null),r=uo(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&dc(e,n.child,null,a),e.child.memoizedState=Sm(a),e.memoizedState=Am,r);if(!(e.mode&1))return kd(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(M(419)),s=Cg(r,s,void 0),kd(n,e,a,s)}if(o=(a&n.childLanes)!==0,an||o){if(s=ft,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Oi(n,i),vs(s,n,i,-1))}return jv(),s=Cg(Error(M(421))),kd(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=iC.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,kn=Rr(i.nextSibling),Tn=e,Ie=!0,gs=null,n!==null&&(Un[$n++]=Ni,Un[$n++]=Ri,Un[$n++]=fo,Ni=n.id,Ri=n.overflow,fo=e),e=Mv(e,s.children),e.flags|=4096,e)}function hw(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),pm(n.return,e,t)}function kg(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function GS(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Vt(n,e,s.children,t),s=Oe.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&hw(n,t,e);else if(n.tag===19)hw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(ke(Oe,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Bf(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),kg(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Bf(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}kg(e,!0,t,null,r);break;case"together":kg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $d(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ji(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),go|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(M(153));if(e.child!==null){for(n=e.child,t=Dr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Dr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function GE(n,e,t){switch(e.tag){case 3:VS(e),hc();break;case 5:vS(e);break;case 1:cn(e.type)&&If(e);break;case 4:_v(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;ke(Of,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ke(Oe,Oe.current&1),e.flags|=128,null):t&e.child.childLanes?WS(n,e,t):(ke(Oe,Oe.current&1),n=ji(n,e,t),n!==null?n.sibling:null);ke(Oe,Oe.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return GS(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ke(Oe,Oe.current),s)break;return null;case 22:case 23:return e.lanes=0,US(n,e,t)}return ji(n,e,t)}var XS,xm,qS,YS;XS=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};xm=function(){};qS=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,ia(qs.current);var r=null;switch(t){case"input":i=Vg(n,i),s=Vg(n,s),r=[];break;case"select":i=Be({},i,{value:void 0}),s=Be({},s,{value:void 0}),r=[];break;case"textarea":i=Xg(n,i),s=Xg(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Mf)}Yg(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hu.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(o=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",n),r||o===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};YS=function(n,e,t,s){t!==s&&(e.flags|=4)};function Tc(n,e){if(!Ie)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Ct(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function XE(n,e,t){var s=e.pendingProps;switch(yv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return cn(e.type)&&Lf(),Ct(e),null;case 3:return s=e.stateNode,fc(),Ne(ln),Ne(Ot),Cv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Ed(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gs!==null&&(Nm(gs),gs=null))),xm(n,e),Ct(e),null;case 5:Ev(e);var i=ia(bu.current);if(t=e.type,n!==null&&e.stateNode!=null)qS(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(M(166));return Ct(e),null}if(n=ia(qs.current),Ed(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Gs]=e,s[Su]=r,n=(e.mode&1)!==0,t){case"dialog":Te("cancel",s),Te("close",s);break;case"iframe":case"object":case"embed":Te("load",s);break;case"video":case"audio":for(i=0;i<Oc.length;i++)Te(Oc[i],s);break;case"source":Te("error",s);break;case"img":case"image":case"link":Te("error",s),Te("load",s);break;case"details":Te("toggle",s);break;case"input":A0(s,r),Te("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Te("invalid",s);break;case"textarea":x0(s,r),Te("invalid",s)}Yg(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&_d(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&_d(s.textContent,o,n),i=["children",""+o]):hu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Te("scroll",s)}switch(t){case"input":md(s),S0(s,r,!0);break;case"textarea":md(s),b0(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Mf)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=bA(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[Gs]=e,n[Su]=s,XS(n,e,!1,!1),e.stateNode=n;e:{switch(a=Kg(t,s),t){case"dialog":Te("cancel",n),Te("close",n),i=s;break;case"iframe":case"object":case"embed":Te("load",n),i=s;break;case"video":case"audio":for(i=0;i<Oc.length;i++)Te(Oc[i],n);i=s;break;case"source":Te("error",n),i=s;break;case"img":case"image":case"link":Te("error",n),Te("load",n),i=s;break;case"details":Te("toggle",n),i=s;break;case"input":A0(n,s),i=Vg(n,s),Te("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=Be({},s,{value:void 0}),Te("invalid",n);break;case"textarea":x0(n,s),i=Xg(n,s),Te("invalid",n);break;default:i=s}Yg(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?CA(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&_A(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&du(n,c):typeof c=="number"&&du(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(hu.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Te("scroll",n):c!=null&&nv(n,r,c,a))}switch(t){case"input":md(n),S0(n,s,!1);break;case"textarea":md(n),b0(n);break;case"option":s.value!=null&&n.setAttribute("value",""+jr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Ko(n,!!s.multiple,r,!1):s.defaultValue!=null&&Ko(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Mf)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(n&&e.stateNode!=null)YS(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(M(166));if(t=ia(bu.current),ia(qs.current),Ed(e)){if(s=e.stateNode,t=e.memoizedProps,s[Gs]=e,(r=s.nodeValue!==t)&&(n=Tn,n!==null))switch(n.tag){case 3:_d(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&_d(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Gs]=e,e.stateNode=s}return Ct(e),null;case 13:if(Ne(Oe),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ie&&kn!==null&&e.mode&1&&!(e.flags&128))fS(),hc(),e.flags|=98560,r=!1;else if(r=Ed(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(M(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(M(317));r[Gs]=e}else hc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),r=!1}else gs!==null&&(Nm(gs),gs=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Oe.current&1?it===0&&(it=3):jv())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return fc(),xm(n,e),n===null&&wu(e.stateNode.containerInfo),Ct(e),null;case 10:return Sv(e.type._context),Ct(e),null;case 17:return cn(e.type)&&Lf(),Ct(e),null;case 19:if(Ne(Oe),r=e.memoizedState,r===null)return Ct(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Tc(r,!1);else{if(it!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Bf(n),a!==null){for(e.flags|=128,Tc(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ke(Oe,Oe.current&1|2),e.child}n=n.sibling}r.tail!==null&&We()>gc&&(e.flags|=128,s=!0,Tc(r,!1),e.lanes=4194304)}else{if(!s)if(n=Bf(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Tc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Ie)return Ct(e),null}else 2*We()-r.renderingStartTime>gc&&t!==1073741824&&(e.flags|=128,s=!0,Tc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=We(),e.sibling=null,t=Oe.current,ke(Oe,s?t&1|2:t&1),e):(Ct(e),null);case 22:case 23:return Ov(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?_n&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function qE(n,e){switch(yv(e),e.tag){case 1:return cn(e.type)&&Lf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return fc(),Ne(ln),Ne(Ot),Cv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ev(e),null;case 13:if(Ne(Oe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(M(340));hc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ne(Oe),null;case 4:return fc(),null;case 10:return Sv(e.type._context),null;case 22:case 23:return Ov(),null;case 24:return null;default:return null}}var Td=!1,Dt=!1,YE=typeof WeakSet=="function"?WeakSet:Set,U=null;function Go(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){Ue(n,e,s)}else t.current=null}function bm(n,e,t){try{t()}catch(s){Ue(n,e,s)}}var dw=!1;function KE(n,e){if(am=Pf,n=eS(),gv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var p;d!==t||i!==0&&d.nodeType!==3||(o=a+i),d!==r||s!==0&&d.nodeType!==3||(c=a+s),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===n)break t;if(f===t&&++u===i&&(o=a),f===r&&++h===s&&(c=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(om={focusedElem:n,selectionRange:t},Pf=!1,U=e;U!==null;)if(e=U,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,U=n;else for(;U!==null;){e=U;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,_=y.memoizedState,v=e.stateNode,A=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:es(e.type,w),_);v.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(E){Ue(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}return y=dw,dw=!1,y}function au(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&bm(e,t,r)}i=i.next}while(i!==s)}}function Dp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function _m(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function KS(n){var e=n.alternate;e!==null&&(n.alternate=null,KS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Gs],delete e[Su],delete e[um],delete e[ME],delete e[LE])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function QS(n){return n.tag===5||n.tag===3||n.tag===4}function fw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||QS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Em(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Mf));else if(s!==4&&(n=n.child,n!==null))for(Em(n,e,t),n=n.sibling;n!==null;)Em(n,e,t),n=n.sibling}function Cm(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(Cm(n,e,t),n=n.sibling;n!==null;)Cm(n,e,t),n=n.sibling}var At=null,ps=!1;function Ui(n,e,t){for(t=t.child;t!==null;)JS(n,e,t),t=t.sibling}function JS(n,e,t){if(Xs&&typeof Xs.onCommitFiberUnmount=="function")try{Xs.onCommitFiberUnmount(kp,t)}catch{}switch(t.tag){case 5:Dt||Go(t,e);case 6:var s=At,i=ps;At=null,Ui(n,e,t),At=s,ps=i,At!==null&&(ps?(n=At,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):At.removeChild(t.stateNode));break;case 18:At!==null&&(ps?(n=At,t=t.stateNode,n.nodeType===8?Ag(n.parentNode,t):n.nodeType===1&&Ag(n,t),mu(n)):Ag(At,t.stateNode));break;case 4:s=At,i=ps,At=t.stateNode.containerInfo,ps=!0,Ui(n,e,t),At=s,ps=i;break;case 0:case 11:case 14:case 15:if(!Dt&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&bm(t,e,a),i=i.next}while(i!==s)}Ui(n,e,t);break;case 1:if(!Dt&&(Go(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){Ue(t,e,o)}Ui(n,e,t);break;case 21:Ui(n,e,t);break;case 22:t.mode&1?(Dt=(s=Dt)||t.memoizedState!==null,Ui(n,e,t),Dt=s):Ui(n,e,t);break;default:Ui(n,e,t)}}function pw(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new YE),e.forEach(function(s){var i=rC.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function Jn(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:At=o.stateNode,ps=!1;break e;case 3:At=o.stateNode.containerInfo,ps=!0;break e;case 4:At=o.stateNode.containerInfo,ps=!0;break e}o=o.return}if(At===null)throw Error(M(160));JS(r,a,i),At=null,ps=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Ue(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZS(e,n),e=e.sibling}function ZS(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Jn(e,n),_s(n),s&4){try{au(3,n,n.return),Dp(3,n)}catch(w){Ue(n,n.return,w)}try{au(5,n,n.return)}catch(w){Ue(n,n.return,w)}}break;case 1:Jn(e,n),_s(n),s&512&&t!==null&&Go(t,t.return);break;case 5:if(Jn(e,n),_s(n),s&512&&t!==null&&Go(t,t.return),n.flags&32){var i=n.stateNode;try{du(i,"")}catch(w){Ue(n,n.return,w)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&SA(i,r),Kg(o,a);var u=Kg(o,r);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];h==="style"?CA(i,d):h==="dangerouslySetInnerHTML"?_A(i,d):h==="children"?du(i,d):nv(i,h,d,u)}switch(o){case"input":Wg(i,r);break;case"textarea":xA(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?Ko(i,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?Ko(i,!!r.multiple,r.defaultValue,!0):Ko(i,!!r.multiple,r.multiple?[]:"",!1))}i[Su]=r}catch(w){Ue(n,n.return,w)}}break;case 6:if(Jn(e,n),_s(n),s&4){if(n.stateNode===null)throw Error(M(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(w){Ue(n,n.return,w)}}break;case 3:if(Jn(e,n),_s(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{mu(e.containerInfo)}catch(w){Ue(n,n.return,w)}break;case 4:Jn(e,n),_s(n);break;case 13:Jn(e,n),_s(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Dv=We())),s&4&&pw(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Dt=(u=Dt)||h,Jn(e,n),Dt=u):Jn(e,n),_s(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(U=n,h=n.child;h!==null;){for(d=U=h;U!==null;){switch(f=U,p=f.child,f.tag){case 0:case 11:case 14:case 15:au(4,f,f.return);break;case 1:Go(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(w){Ue(s,t,w)}}break;case 5:Go(f,f.return);break;case 22:if(f.memoizedState!==null){mw(d);continue}}p!==null?(p.return=f,U=p):mw(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,c=d.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=EA("display",a))}catch(w){Ue(n,n.return,w)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(w){Ue(n,n.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jn(e,n),_s(n),s&4&&pw(n);break;case 21:break;default:Jn(e,n),_s(n)}}function _s(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(QS(t)){var s=t;break e}t=t.return}throw Error(M(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(du(i,""),s.flags&=-33);var r=fw(n);Cm(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=fw(n);Em(n,o,a);break;default:throw Error(M(161))}}catch(c){Ue(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function QE(n,e,t){U=n,ex(n)}function ex(n,e,t){for(var s=(n.mode&1)!==0;U!==null;){var i=U,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||Td;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||Dt;o=Td;var u=Dt;if(Td=a,(Dt=c)&&!u)for(U=i;U!==null;)a=U,c=a.child,a.tag===22&&a.memoizedState!==null?yw(i):c!==null?(c.return=a,U=c):yw(i);for(;r!==null;)U=r,ex(r),r=r.sibling;U=i,Td=o,Dt=u}gw(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,U=r):gw(n)}}function gw(n){for(;U!==null;){var e=U;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Dt||Dp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Dt)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:es(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&Z0(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Z0(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&mu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}Dt||e.flags&512&&_m(e)}catch(f){Ue(e,e.return,f)}}if(e===n){U=null;break}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}}function mw(n){for(;U!==null;){var e=U;if(e===n){U=null;break}var t=e.sibling;if(t!==null){t.return=e.return,U=t;break}U=e.return}}function yw(n){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Dp(4,e)}catch(c){Ue(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){Ue(e,i,c)}}var r=e.return;try{_m(e)}catch(c){Ue(e,r,c)}break;case 5:var a=e.return;try{_m(e)}catch(c){Ue(e,a,c)}}}catch(c){Ue(e,e.return,c)}if(e===n){U=null;break}var o=e.sibling;if(o!==null){o.return=e.return,U=o;break}U=e.return}}var JE=Math.ceil,$f=Hi.ReactCurrentDispatcher,Lv=Hi.ReactCurrentOwner,qn=Hi.ReactCurrentBatchConfig,he=0,ft=null,qe=null,xt=0,_n=0,Xo=Vr(0),it=0,ku=null,go=0,Fp=0,Iv=0,ou=null,rn=null,Dv=0,gc=1/0,ei=null,Vf=!1,km=null,Lr=null,Pd=!1,Cr=null,Wf=0,lu=0,Tm=null,Vd=-1,Wd=0;function Wt(){return he&6?We():Vd!==-1?Vd:Vd=We()}function Ir(n){return n.mode&1?he&2&&xt!==0?xt&-xt:DE.transition!==null?(Wd===0&&(Wd=jA()),Wd):(n=Ae,n!==0||(n=window.event,n=n===void 0?16:WA(n.type)),n):1}function vs(n,e,t,s){if(50<lu)throw lu=0,Tm=null,Error(M(185));rd(n,t,s),(!(he&2)||n!==ft)&&(n===ft&&(!(he&2)&&(Fp|=t),it===4&&Xi(n,xt)),un(n,s),t===1&&he===0&&!(e.mode&1)&&(gc=We()+500,Mp&&Wr()))}function un(n,e){var t=n.callbackNode;D1(n,e);var s=Tf(n,n===ft?xt:0);if(s===0)t!==null&&C0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&C0(t),e===1)n.tag===0?IE(vw.bind(null,n)):uS(vw.bind(null,n)),NE(function(){!(he&6)&&Wr()}),t=null;else{switch(zA(s)){case 1:t=ov;break;case 4:t=FA;break;case 16:t=kf;break;case 536870912:t=OA;break;default:t=kf}t=lx(t,tx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function tx(n,e){if(Vd=-1,Wd=0,he&6)throw Error(M(327));var t=n.callbackNode;if(tl()&&n.callbackNode!==t)return null;var s=Tf(n,n===ft?xt:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Gf(n,s);else{e=s;var i=he;he|=2;var r=sx();(ft!==n||xt!==e)&&(ei=null,gc=We()+500,co(n,e));do try{tC();break}catch(o){nx(n,o)}while(!0);Av(),$f.current=r,he=i,qe!==null?e=0:(ft=null,xt=0,e=it)}if(e!==0){if(e===2&&(i=tm(n),i!==0&&(s=i,e=Pm(n,i))),e===1)throw t=ku,co(n,0),Xi(n,s),un(n,We()),t;if(e===6)Xi(n,s);else{if(i=n.current.alternate,!(s&30)&&!ZE(i)&&(e=Gf(n,s),e===2&&(r=tm(n),r!==0&&(s=r,e=Pm(n,r))),e===1))throw t=ku,co(n,0),Xi(n,s),un(n,We()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(M(345));case 2:Yr(n,rn,ei);break;case 3:if(Xi(n,s),(s&130023424)===s&&(e=Dv+500-We(),10<e)){if(Tf(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Wt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=cm(Yr.bind(null,n,rn,ei),e);break}Yr(n,rn,ei);break;case 4:if(Xi(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-ys(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=We()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*JE(s/1960))-s,10<s){n.timeoutHandle=cm(Yr.bind(null,n,rn,ei),s);break}Yr(n,rn,ei);break;case 5:Yr(n,rn,ei);break;default:throw Error(M(329))}}}return un(n,We()),n.callbackNode===t?tx.bind(null,n):null}function Pm(n,e){var t=ou;return n.current.memoizedState.isDehydrated&&(co(n,e).flags|=256),n=Gf(n,e),n!==2&&(e=rn,rn=t,e!==null&&Nm(e)),n}function Nm(n){rn===null?rn=n:rn.push.apply(rn,n)}function ZE(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!ws(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xi(n,e){for(e&=~Iv,e&=~Fp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ys(e),s=1<<t;n[t]=-1,e&=~s}}function vw(n){if(he&6)throw Error(M(327));tl();var e=Tf(n,0);if(!(e&1))return un(n,We()),null;var t=Gf(n,e);if(n.tag!==0&&t===2){var s=tm(n);s!==0&&(e=s,t=Pm(n,s))}if(t===1)throw t=ku,co(n,0),Xi(n,e),un(n,We()),t;if(t===6)throw Error(M(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Yr(n,rn,ei),un(n,We()),null}function Fv(n,e){var t=he;he|=1;try{return n(e)}finally{he=t,he===0&&(gc=We()+500,Mp&&Wr())}}function mo(n){Cr!==null&&Cr.tag===0&&!(he&6)&&tl();var e=he;he|=1;var t=qn.transition,s=Ae;try{if(qn.transition=null,Ae=1,n)return n()}finally{Ae=s,qn.transition=t,he=e,!(he&6)&&Wr()}}function Ov(){_n=Xo.current,Ne(Xo)}function co(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,PE(t)),qe!==null)for(t=qe.return;t!==null;){var s=t;switch(yv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Lf();break;case 3:fc(),Ne(ln),Ne(Ot),Cv();break;case 5:Ev(s);break;case 4:fc();break;case 13:Ne(Oe);break;case 19:Ne(Oe);break;case 10:Sv(s.type._context);break;case 22:case 23:Ov()}t=t.return}if(ft=n,qe=n=Dr(n.current,null),xt=_n=e,it=0,ku=null,Iv=Fp=go=0,rn=ou=null,sa!==null){for(e=0;e<sa.length;e++)if(t=sa[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}sa=null}return n}function nx(n,e){do{var t=qe;try{if(Av(),Hd.current=Uf,Hf){for(var s=ze.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Hf=!1}if(po=0,dt=st=ze=null,ru=!1,_u=0,Lv.current=null,t===null||t.return===null){it=1,ku=e,qe=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=xt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=rw(a);if(p!==null){p.flags&=-257,aw(p,a,o,r,e),p.mode&1&&iw(r,u,e),e=p,c=u;var y=e.updateQueue;if(y===null){var w=new Set;w.add(c),e.updateQueue=w}else y.add(c);break e}else{if(!(e&1)){iw(r,u,e),jv();break e}c=Error(M(426))}}else if(Ie&&o.mode&1){var _=rw(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),aw(_,a,o,r,e),vv(pc(c,o));break e}}r=c=pc(c,o),it!==4&&(it=2),ou===null?ou=[r]:ou.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=zS(r,c,e);J0(r,v);break e;case 1:o=c;var A=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof A.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Lr===null||!Lr.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=BS(r,o,e);J0(r,E);break e}}r=r.return}while(r!==null)}rx(t)}catch(C){e=C,qe===t&&t!==null&&(qe=t=t.return);continue}break}while(!0)}function sx(){var n=$f.current;return $f.current=Uf,n===null?Uf:n}function jv(){(it===0||it===3||it===2)&&(it=4),ft===null||!(go&268435455)&&!(Fp&268435455)||Xi(ft,xt)}function Gf(n,e){var t=he;he|=2;var s=sx();(ft!==n||xt!==e)&&(ei=null,co(n,e));do try{eC();break}catch(i){nx(n,i)}while(!0);if(Av(),he=t,$f.current=s,qe!==null)throw Error(M(261));return ft=null,xt=0,it}function eC(){for(;qe!==null;)ix(qe)}function tC(){for(;qe!==null&&!C1();)ix(qe)}function ix(n){var e=ox(n.alternate,n,_n);n.memoizedProps=n.pendingProps,e===null?rx(n):qe=e,Lv.current=null}function rx(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=qE(t,e),t!==null){t.flags&=32767,qe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{it=6,qe=null;return}}else if(t=XE(t,e,_n),t!==null){qe=t;return}if(e=e.sibling,e!==null){qe=e;return}qe=e=n}while(e!==null);it===0&&(it=5)}function Yr(n,e,t){var s=Ae,i=qn.transition;try{qn.transition=null,Ae=1,nC(n,e,t,s)}finally{qn.transition=i,Ae=s}return null}function nC(n,e,t,s){do tl();while(Cr!==null);if(he&6)throw Error(M(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(M(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(F1(n,r),n===ft&&(qe=ft=null,xt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Pd||(Pd=!0,lx(kf,function(){return tl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=qn.transition,qn.transition=null;var a=Ae;Ae=1;var o=he;he|=4,Lv.current=null,KE(n,t),ZS(t,n),xE(om),Pf=!!am,om=am=null,n.current=t,QE(t),k1(),he=o,Ae=a,qn.transition=r}else n.current=t;if(Pd&&(Pd=!1,Cr=n,Wf=i),r=n.pendingLanes,r===0&&(Lr=null),N1(t.stateNode),un(n,We()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Vf)throw Vf=!1,n=km,km=null,n;return Wf&1&&n.tag!==0&&tl(),r=n.pendingLanes,r&1?n===Tm?lu++:(lu=0,Tm=n):lu=0,Wr(),null}function tl(){if(Cr!==null){var n=zA(Wf),e=qn.transition,t=Ae;try{if(qn.transition=null,Ae=16>n?16:n,Cr===null)var s=!1;else{if(n=Cr,Cr=null,Wf=0,he&6)throw Error(M(331));var i=he;for(he|=4,U=n.current;U!==null;){var r=U,a=r.child;if(U.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(U=u;U!==null;){var h=U;switch(h.tag){case 0:case 11:case 15:au(8,h,r)}var d=h.child;if(d!==null)d.return=h,U=d;else for(;U!==null;){h=U;var f=h.sibling,p=h.return;if(KS(h),h===u){U=null;break}if(f!==null){f.return=p,U=f;break}U=p}}}var y=r.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}U=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,U=a;else e:for(;U!==null;){if(r=U,r.flags&2048)switch(r.tag){case 0:case 11:case 15:au(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,U=v;break e}U=r.return}}var A=n.current;for(U=A;U!==null;){a=U;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,U=b;else e:for(a=A;U!==null;){if(o=U,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Dp(9,o)}}catch(C){Ue(o,o.return,C)}if(o===a){U=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,U=E;break e}U=o.return}}if(he=i,Wr(),Xs&&typeof Xs.onPostCommitFiberRoot=="function")try{Xs.onPostCommitFiberRoot(kp,n)}catch{}s=!0}return s}finally{Ae=t,qn.transition=e}}return!1}function ww(n,e,t){e=pc(t,e),e=zS(n,e,1),n=Mr(n,e,1),e=Wt(),n!==null&&(rd(n,1,e),un(n,e))}function Ue(n,e,t){if(n.tag===3)ww(n,n,t);else for(;e!==null;){if(e.tag===3){ww(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Lr===null||!Lr.has(s))){n=pc(t,n),n=BS(e,n,1),e=Mr(e,n,1),n=Wt(),e!==null&&(rd(e,1,n),un(e,n));break}}e=e.return}}function sC(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Wt(),n.pingedLanes|=n.suspendedLanes&t,ft===n&&(xt&t)===t&&(it===4||it===3&&(xt&130023424)===xt&&500>We()-Dv?co(n,0):Iv|=t),un(n,e)}function ax(n,e){e===0&&(n.mode&1?(e=wd,wd<<=1,!(wd&130023424)&&(wd=4194304)):e=1);var t=Wt();n=Oi(n,e),n!==null&&(rd(n,e,t),un(n,t))}function iC(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),ax(n,t)}function rC(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(M(314))}s!==null&&s.delete(e),ax(n,t)}var ox;ox=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ln.current)an=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return an=!1,GE(n,e,t);an=!!(n.flags&131072)}else an=!1,Ie&&e.flags&1048576&&hS(e,Ff,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;$d(n,e),n=e.pendingProps;var i=uc(e,Ot.current);el(e,t),i=Tv(null,e,s,n,i,t);var r=Pv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(s)?(r=!0,If(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,bv(e),i.updater=Ip,e.stateNode=i,i._reactInternals=e,mm(e,s,n,t),e=wm(null,e,s,!0,r,t)):(e.tag=0,Ie&&r&&mv(e),Vt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch($d(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=oC(s),n=es(s,n),i){case 0:e=vm(null,e,s,n,t);break e;case 1:e=cw(null,e,s,n,t);break e;case 11:e=ow(null,e,s,n,t);break e;case 14:e=lw(null,e,s,es(s.type,n),t);break e}throw Error(M(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:es(s,i),vm(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:es(s,i),cw(n,e,s,i,t);case 3:e:{if(VS(e),n===null)throw Error(M(387));s=e.pendingProps,r=e.memoizedState,i=r.element,yS(n,e),zf(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=pc(Error(M(423)),e),e=uw(n,e,s,t,i);break e}else if(s!==i){i=pc(Error(M(424)),e),e=uw(n,e,s,t,i);break e}else for(kn=Rr(e.stateNode.containerInfo.firstChild),Tn=e,Ie=!0,gs=null,t=gS(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hc(),s===i){e=ji(n,e,t);break e}Vt(n,e,s,t)}e=e.child}return e;case 5:return vS(e),n===null&&fm(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,lm(s,i)?a=null:r!==null&&lm(s,r)&&(e.flags|=32),$S(n,e),Vt(n,e,a,t),e.child;case 6:return n===null&&fm(e),null;case 13:return WS(n,e,t);case 4:return _v(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=dc(e,null,s,t):Vt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:es(s,i),ow(n,e,s,i,t);case 7:return Vt(n,e,e.pendingProps,t),e.child;case 8:return Vt(n,e,e.pendingProps.children,t),e.child;case 12:return Vt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,ke(Of,s._currentValue),s._currentValue=a,r!==null)if(ws(r.value,a)){if(r.children===i.children&&!ln.current){e=ji(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Mi(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),pm(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(M(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),pm(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Vt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,el(e,t),i=Kn(i),s=s(i),e.flags|=1,Vt(n,e,s,t),e.child;case 14:return s=e.type,i=es(s,e.pendingProps),i=es(s.type,i),lw(n,e,s,i,t);case 15:return HS(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:es(s,i),$d(n,e),e.tag=1,cn(s)?(n=!0,If(e)):n=!1,el(e,t),jS(e,s,i),mm(e,s,i,t),wm(null,e,s,!0,n,t);case 19:return GS(n,e,t);case 22:return US(n,e,t)}throw Error(M(156,e.tag))};function lx(n,e){return DA(n,e)}function aC(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(n,e,t,s){return new aC(n,e,t,s)}function zv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function oC(n){if(typeof n=="function")return zv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===iv)return 11;if(n===rv)return 14}return 2}function Dr(n,e){var t=n.alternate;return t===null?(t=Gn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gd(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")zv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Oo:return uo(t.children,i,r,e);case sv:a=8,i|=8;break;case Bg:return n=Gn(12,t,e,i|2),n.elementType=Bg,n.lanes=r,n;case Hg:return n=Gn(13,t,e,i),n.elementType=Hg,n.lanes=r,n;case Ug:return n=Gn(19,t,e,i),n.elementType=Ug,n.lanes=r,n;case vA:return Op(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case mA:a=10;break e;case yA:a=9;break e;case iv:a=11;break e;case rv:a=14;break e;case Vi:a=16,s=null;break e}throw Error(M(130,n==null?n:typeof n,""))}return e=Gn(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function uo(n,e,t,s){return n=Gn(7,n,s,e),n.lanes=t,n}function Op(n,e,t,s){return n=Gn(22,n,s,e),n.elementType=vA,n.lanes=t,n.stateNode={isHidden:!1},n}function Tg(n,e,t){return n=Gn(6,n,null,e),n.lanes=t,n}function Pg(n,e,t){return e=Gn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function lC(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cg(0),this.expirationTimes=cg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cg(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bv(n,e,t,s,i,r,a,o,c){return n=new lC(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Gn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},bv(r),n}function cC(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function cx(n){if(!n)return zr;n=n._reactInternals;e:{if(xo(n)!==n||n.tag!==1)throw Error(M(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(n.tag===1){var t=n.type;if(cn(t))return cS(n,t,e)}return e}function ux(n,e,t,s,i,r,a,o,c){return n=Bv(t,s,!0,n,i,r,a,o,c),n.context=cx(null),t=n.current,s=Wt(),i=Ir(t),r=Mi(s,i),r.callback=e??null,Mr(t,r,i),n.current.lanes=i,rd(n,i,s),un(n,s),n}function jp(n,e,t,s){var i=e.current,r=Wt(),a=Ir(i);return t=cx(t),e.context===null?e.context=t:e.pendingContext=t,e=Mi(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Mr(i,e,a),n!==null&&(vs(n,i,a,r),Bd(n,i,a)),a}function Xf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Aw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Hv(n,e){Aw(n,e),(n=n.alternate)&&Aw(n,e)}function uC(){return null}var hx=typeof reportError=="function"?reportError:function(n){console.error(n)};function Uv(n){this._internalRoot=n}zp.prototype.render=Uv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(M(409));jp(n,e,null,null)};zp.prototype.unmount=Uv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;mo(function(){jp(null,n,null,null)}),e[Fi]=null}};function zp(n){this._internalRoot=n}zp.prototype.unstable_scheduleHydration=function(n){if(n){var e=UA();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Gi.length&&e!==0&&e<Gi[t].priority;t++);Gi.splice(t,0,n),t===0&&VA(n)}};function $v(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Bp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Sw(){}function hC(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Xf(a);r.call(u)}}var a=ux(e,s,n,0,null,!1,!1,"",Sw);return n._reactRootContainer=a,n[Fi]=a.current,wu(n.nodeType===8?n.parentNode:n),mo(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var u=Xf(c);o.call(u)}}var c=Bv(n,0,!1,null,null,!1,!1,"",Sw);return n._reactRootContainer=c,n[Fi]=c.current,wu(n.nodeType===8?n.parentNode:n),mo(function(){jp(e,c,t,s)}),c}function Hp(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var c=Xf(a);o.call(c)}}jp(e,a,n,i)}else a=hC(t,e,n,i,s);return Xf(a)}BA=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Fc(e.pendingLanes);t!==0&&(lv(e,t|1),un(e,We()),!(he&6)&&(gc=We()+500,Wr()))}break;case 13:mo(function(){var s=Oi(n,1);if(s!==null){var i=Wt();vs(s,n,1,i)}}),Hv(n,1)}};cv=function(n){if(n.tag===13){var e=Oi(n,134217728);if(e!==null){var t=Wt();vs(e,n,134217728,t)}Hv(n,134217728)}};HA=function(n){if(n.tag===13){var e=Ir(n),t=Oi(n,e);if(t!==null){var s=Wt();vs(t,n,e,s)}Hv(n,e)}};UA=function(){return Ae};$A=function(n,e){var t=Ae;try{return Ae=n,e()}finally{Ae=t}};Jg=function(n,e,t){switch(e){case"input":if(Wg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=Rp(s);if(!i)throw Error(M(90));AA(s),Wg(s,i)}}}break;case"textarea":xA(n,t);break;case"select":e=t.value,e!=null&&Ko(n,!!t.multiple,e,!1)}};PA=Fv;NA=mo;var dC={usingClientEntryPoint:!1,Events:[od,Ho,Rp,kA,TA,Fv]},Pc={findFiberByHostInstance:na,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fC={bundleType:Pc.bundleType,version:Pc.version,rendererPackageName:Pc.rendererPackageName,rendererConfig:Pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=LA(n),n===null?null:n.stateNode},findFiberByHostInstance:Pc.findFiberByHostInstance||uC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{kp=Nd.inject(fC),Xs=Nd}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dC;Rn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$v(e))throw Error(M(200));return cC(n,e,null,t)};Rn.createRoot=function(n,e){if(!$v(n))throw Error(M(299));var t=!1,s="",i=hx;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Bv(n,1,!1,null,null,t,!1,s,i),n[Fi]=e.current,wu(n.nodeType===8?n.parentNode:n),new Uv(e)};Rn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(M(188)):(n=Object.keys(n).join(","),Error(M(268,n)));return n=LA(e),n=n===null?null:n.stateNode,n};Rn.flushSync=function(n){return mo(n)};Rn.hydrate=function(n,e,t){if(!Bp(e))throw Error(M(200));return Hp(null,n,e,!0,t)};Rn.hydrateRoot=function(n,e,t){if(!$v(n))throw Error(M(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=hx;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=ux(e,null,n,1,t??null,i,!1,r,a),n[Fi]=e.current,wu(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new zp(e)};Rn.render=function(n,e,t){if(!Bp(e))throw Error(M(200));return Hp(null,n,e,!1,t)};Rn.unmountComponentAtNode=function(n){if(!Bp(n))throw Error(M(40));return n._reactRootContainer?(mo(function(){Hp(null,null,n,!1,function(){n._reactRootContainer=null,n[Fi]=null})}),!0):!1};Rn.unstable_batchedUpdates=Fv;Rn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!Bp(t))throw Error(M(200));if(n==null||n._reactInternals===void 0)throw Error(M(38));return Hp(n,e,t,!1,s)};Rn.version="18.3.1-next-f1338f8080-20240426";function dx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dx)}catch(n){console.error(n)}}dx(),dA.exports=Rn;var pC=dA.exports,fx,xw=pC;fx=xw.createRoot,xw.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tu(){return Tu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Tu.apply(this,arguments)}var kr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(kr||(kr={}));const bw="popstate";function gC(n){n===void 0&&(n={});function e(i,r){let{pathname:a="/",search:o="",hash:c=""}=bo(i.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Rm("",{pathname:a,search:o,hash:c},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let c=i.location.href,u=c.indexOf("#");o=u===-1?c:c.slice(0,u)}return o+"#"+(typeof r=="string"?r:qf(r))}function s(i,r){Up(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(r)+")")}return yC(e,t,s,n)}function Ke(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Up(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mC(){return Math.random().toString(36).substr(2,8)}function _w(n,e){return{usr:n.state,key:n.key,idx:e}}function Rm(n,e,t,s){return t===void 0&&(t=null),Tu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?bo(e):e,{state:t,key:e&&e.key||s||mC()})}function qf(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function bo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function yC(n,e,t,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=kr.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(Tu({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function d(){o=kr.Pop;let _=h(),v=_==null?null:_-u;u=_,c&&c({action:o,location:w.location,delta:v})}function f(_,v){o=kr.Push;let A=Rm(w.location,_,v);t&&t(A,_),u=h()+1;let b=_w(A,u),E=w.createHref(A);try{a.pushState(b,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(E)}r&&c&&c({action:o,location:w.location,delta:1})}function p(_,v){o=kr.Replace;let A=Rm(w.location,_,v);t&&t(A,_),u=h();let b=_w(A,u),E=w.createHref(A);a.replaceState(b,"",E),r&&c&&c({action:o,location:w.location,delta:0})}function y(_){let v=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof _=="string"?_:qf(_);return A=A.replace(/ $/,"%20"),Ke(v,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,v)}let w={get action(){return o},get location(){return n(i,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(bw,d),c=_,()=>{i.removeEventListener(bw,d),c=null}},createHref(_){return e(i,_)},createURL:y,encodeLocation(_){let v=y(_);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:p,go(_){return a.go(_)}};return w}var Ew;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Ew||(Ew={}));function vC(n,e,t){return t===void 0&&(t="/"),wC(n,e,t)}function wC(n,e,t,s){let i=typeof e=="string"?bo(e):e,r=Vv(i.pathname||"/",t);if(r==null)return null;let a=px(n);AC(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=MC(r);o=PC(a[c],u)}return o}function px(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let i=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(Ke(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=Fr([s,c.relativePath]),h=t.concat(c);r.children&&r.children.length>0&&(Ke(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),px(r.children,e,h,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:kC(u,r.index),routesMeta:h})};return n.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let c of gx(r.path))i(r,a,c)}),e}function gx(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=gx(s.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&o.push(...a),o.map(c=>n.startsWith("/")&&c===""?"/":c)}function AC(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:TC(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const SC=/^:[\w-]+$/,xC=3,bC=2,_C=1,EC=10,CC=-2,Cw=n=>n==="*";function kC(n,e){let t=n.split("/"),s=t.length;return t.some(Cw)&&(s+=CC),e&&(s+=bC),t.filter(i=>!Cw(i)).reduce((i,r)=>i+(SC.test(r)?xC:r===""?_C:EC),s)}function TC(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function PC(n,e,t){let{routesMeta:s}=n,i={},r="/",a=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=NC({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Fr([r,d.pathname]),pathnameBase:OC(Fr([r,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(r=Fr([r,d.pathnameBase]))}return a}function NC(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=RC(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let w=o[d]||"";a=r.slice(0,r.length-w.length).replace(/(.)\/+$/,"$1")}const y=o[d];return p&&!y?u[f]=void 0:u[f]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:n}}function RC(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Up(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function MC(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Up(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Vv(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const LC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IC=n=>LC.test(n);function DC(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?bo(n):n,r;if(t)if(IC(t))r=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Up(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?r=kw(t.substring(1),"/"):r=kw(t,e)}else r=e;return{pathname:r,search:jC(s),hash:zC(i)}}function kw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Ng(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function FC(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function mx(n,e){let t=FC(n);return e?t.map((s,i)=>i===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function yx(n,e,t,s){s===void 0&&(s=!1);let i;typeof n=="string"?i=bo(n):(i=Tu({},n),Ke(!i.pathname||!i.pathname.includes("?"),Ng("?","pathname","search",i)),Ke(!i.pathname||!i.pathname.includes("#"),Ng("#","pathname","hash",i)),Ke(!i.search||!i.search.includes("#"),Ng("#","search","hash",i)));let r=n===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!s&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}o=d>=0?e[d]:"/"}let c=DC(i,o),u=a&&a!=="/"&&a.endsWith("/"),h=(r||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const Fr=n=>n.join("/").replace(/\/\/+/g,"/"),OC=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),jC=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,zC=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function BC(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const vx=["post","put","patch","delete"];new Set(vx);const HC=["get",...vx];new Set(HC);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pu(){return Pu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Pu.apply(this,arguments)}const Wv=P.createContext(null),UC=P.createContext(null),_o=P.createContext(null),$p=P.createContext(null),Gr=P.createContext({outlet:null,matches:[],isDataRoute:!1}),wx=P.createContext(null);function $C(n,e){let{relative:t}=e===void 0?{}:e;cd()||Ke(!1);let{basename:s,navigator:i}=P.useContext(_o),{hash:r,pathname:a,search:o}=bx(n,{relative:t}),c=a;return s!=="/"&&(c=a==="/"?s:Fr([s,a])),i.createHref({pathname:c,search:o,hash:r})}function cd(){return P.useContext($p)!=null}function Vp(){return cd()||Ke(!1),P.useContext($p).location}function Ax(n){P.useContext(_o).static||P.useLayoutEffect(n)}function Sx(){let{isDataRoute:n}=P.useContext(Gr);return n?nk():VC()}function VC(){cd()||Ke(!1);let n=P.useContext(Wv),{basename:e,future:t,navigator:s}=P.useContext(_o),{matches:i}=P.useContext(Gr),{pathname:r}=Vp(),a=JSON.stringify(mx(i,t.v7_relativeSplatPath)),o=P.useRef(!1);return Ax(()=>{o.current=!0}),P.useCallback(function(u,h){if(h===void 0&&(h={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let d=yx(u,JSON.parse(a),r,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Fr([e,d.pathname])),(h.replace?s.replace:s.push)(d,h.state,h)},[e,s,a,r,n])}function xx(){let{matches:n}=P.useContext(Gr),e=n[n.length-1];return e?e.params:{}}function bx(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=P.useContext(_o),{matches:i}=P.useContext(Gr),{pathname:r}=Vp(),a=JSON.stringify(mx(i,s.v7_relativeSplatPath));return P.useMemo(()=>yx(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function WC(n,e){return GC(n,e)}function GC(n,e,t,s){cd()||Ke(!1);let{navigator:i}=P.useContext(_o),{matches:r}=P.useContext(Gr),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=Vp(),h;if(e){var d;let _=typeof e=="string"?bo(e):e;c==="/"||(d=_.pathname)!=null&&d.startsWith(c)||Ke(!1),h=_}else h=u;let f=h.pathname||"/",p=f;if(c!=="/"){let _=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let y=vC(n,{pathname:p}),w=QC(y&&y.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:Fr([c,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Fr([c,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),r,t,s);return e&&w?P.createElement($p.Provider,{value:{location:Pu({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:kr.Pop}},w):w}function XC(){let n=tk(),e=BC(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:i},t):null,null)}const qC=P.createElement(XC,null);class YC extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?P.createElement(Gr.Provider,{value:this.props.routeContext},P.createElement(wx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KC(n){let{routeContext:e,match:t,children:s}=n,i=P.useContext(Wv);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),P.createElement(Gr.Provider,{value:e},s)}function QC(n,e,t,s){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||Ke(!1),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:p}=t,y=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||y){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,f)=>{let p,y=!1,w=null,_=null;t&&(p=o&&d.route.id?o[d.route.id]:void 0,w=d.route.errorElement||qC,c&&(u<0&&f===0?(sk("route-fallback"),y=!0,_=null):u===f&&(y=!0,_=d.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),A=()=>{let b;return p?b=w:y?b=_:d.route.Component?b=P.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=h,P.createElement(KC,{match:d,routeContext:{outlet:h,matches:v,isDataRoute:t!=null},children:b})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?P.createElement(YC,{location:t.location,revalidation:t.revalidation,component:w,error:p,children:A(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):A()},null)}var _x=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(_x||{}),Ex=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Ex||{});function JC(n){let e=P.useContext(Wv);return e||Ke(!1),e}function ZC(n){let e=P.useContext(UC);return e||Ke(!1),e}function ek(n){let e=P.useContext(Gr);return e||Ke(!1),e}function Cx(n){let e=ek(),t=e.matches[e.matches.length-1];return t.route.id||Ke(!1),t.route.id}function tk(){var n;let e=P.useContext(wx),t=ZC(),s=Cx();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function nk(){let{router:n}=JC(_x.UseNavigateStable),e=Cx(Ex.UseNavigateStable),t=P.useRef(!1);return Ax(()=>{t.current=!0}),P.useCallback(function(i,r){r===void 0&&(r={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Pu({fromRouteId:e},r)))},[n,e])}const Tw={};function sk(n,e,t){Tw[n]||(Tw[n]=!0)}function ik(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Kr(n){Ke(!1)}function rk(n){let{basename:e="/",children:t=null,location:s,navigationType:i=kr.Pop,navigator:r,static:a=!1,future:o}=n;cd()&&Ke(!1);let c=e.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:c,navigator:r,static:a,future:Pu({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof s=="string"&&(s=bo(s));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:y="default"}=s,w=P.useMemo(()=>{let _=Vv(h,c);return _==null?null:{location:{pathname:_,search:d,hash:f,state:p,key:y},navigationType:i}},[c,h,d,f,p,y,i]);return w==null?null:P.createElement(_o.Provider,{value:u},P.createElement($p.Provider,{children:t,value:w}))}function ak(n){let{children:e,location:t}=n;return WC(Mm(e),t)}new Promise(()=>{});function Mm(n,e){e===void 0&&(e=[]);let t=[];return P.Children.forEach(n,(s,i)=>{if(!P.isValidElement(s))return;let r=[...e,i];if(s.type===P.Fragment){t.push.apply(t,Mm(s.props.children,r));return}s.type!==Kr&&Ke(!1),!s.props.index||!s.props.children||Ke(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Mm(s.props.children,r)),t.push(a)}),t}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lm(){return Lm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Lm.apply(this,arguments)}function ok(n,e){if(n==null)return{};var t={},s=Object.keys(n),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function lk(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function ck(n,e){return n.button===0&&(!e||e==="_self")&&!lk(n)}const uk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hk="6";try{window.__reactRouterVersion=hk}catch{}const dk="startTransition",Pw=s1[dk];function fk(n){let{basename:e,children:t,future:s,window:i}=n,r=P.useRef();r.current==null&&(r.current=gC({window:i,v5Compat:!0}));let a=r.current,[o,c]=P.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},h=P.useCallback(d=>{u&&Pw?Pw(()=>c(d)):c(d)},[c,u]);return P.useLayoutEffect(()=>a.listen(h),[a,h]),P.useEffect(()=>ik(s),[s]),P.createElement(rk,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:s})}const pk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,on=P.forwardRef(function(e,t){let{onClick:s,relative:i,reloadDocument:r,replace:a,state:o,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,f=ok(e,uk),{basename:p}=P.useContext(_o),y,w=!1;if(typeof u=="string"&&gk.test(u)&&(y=u,pk))try{let b=new URL(window.location.href),E=u.startsWith("//")?new URL(b.protocol+u):new URL(u),C=Vv(E.pathname,p);E.origin===b.origin&&C!=null?u=C+E.search+E.hash:w=!0}catch{}let _=$C(u,{relative:i}),v=mk(u,{replace:a,state:o,target:c,preventScrollReset:h,relative:i,viewTransition:d});function A(b){s&&s(b),b.defaultPrevented||v(b)}return P.createElement("a",Lm({},f,{href:y||_,onClick:w||r?s:A,ref:t,target:c}))});var Nw;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Nw||(Nw={}));var Rw;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Rw||(Rw={}));function mk(n,e){let{target:t,replace:s,state:i,preventScrollReset:r,relative:a,viewTransition:o}=e===void 0?{}:e,c=Sx(),u=Vp(),h=bx(n,{relative:a});return P.useCallback(d=>{if(ck(d,t)){d.preventDefault();let f=s!==void 0?s:qf(u)===qf(h);c(n,{replace:f,state:i,preventScrollReset:r,relative:a,viewTransition:o})}},[u,c,h,s,i,t,n,r,a,o])}function yk(){return g.jsxs("div",{className:"landing",children:[g.jsxs("section",{className:"landing-hero",children:[g.jsxs("div",{className:"hero-copy",children:[g.jsx("p",{className:"eyebrow",children:"Literature Desk"}),g.jsx("h1",{children:"Write research notes the way you think  not the way databases demand"}),g.jsx("p",{className:"muted",children:"Instead of manually filling out forms, Literature Desk lets you paste raw notes or citations while AI extracts the structure you need and helps you explore connections across your work."}),g.jsx("div",{className:"cta-row",children:g.jsx(on,{to:"/tool",className:"primary-cta",children:"Open the tool"})})]}),g.jsxs("div",{className:"hero-visual",children:[g.jsxs("div",{className:"hero-card",children:[g.jsxs("div",{className:"hero-card-top",children:[g.jsx("span",{className:"pill",children:"Live extraction"}),g.jsx("span",{className:"pill",children:"Local AI"})]}),g.jsx("h2",{children:"Paste anything, get structured metadata."}),g.jsx("p",{className:"muted",children:"Turn abstracts, citations, and raw notes into a sortable literature index in seconds."}),g.jsxs("div",{className:"hero-metrics",children:[g.jsxs("div",{children:[g.jsx("h3",{children:"Free-form"}),g.jsx("span",{className:"muted",children:"Write naturally"})]}),g.jsxs("div",{children:[g.jsx("h3",{children:"Local-first"}),g.jsx("span",{className:"muted",children:"Private + offline"})]})]})]}),g.jsxs("div",{className:"hero-orbit","aria-hidden":"true",children:[g.jsx("span",{className:"orbit-dot"}),g.jsx("span",{className:"orbit-dot"}),g.jsx("span",{className:"orbit-dot"})]})]})]}),g.jsxs("section",{className:"landing-features",children:[g.jsxs("div",{className:"snapshots-header",children:[g.jsx("h2",{children:"Features"}),g.jsx("p",{className:"muted",children:"Purpose-built for literature reviews that stay focused and connected."})]}),g.jsxs("div",{className:"features-grid",children:[g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Free-form research notes"}),g.jsx("p",{className:"muted",children:"Write or paste notes, abstracts, or citations without worrying about structure."})]}),g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Automatic metadata extraction"}),g.jsx("p",{className:"muted",children:"AI extracts key details like authors, publication year, and links to build a live literature index."})]}),g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Search and query across your notes"}),g.jsx("p",{className:"muted",children:"Ask questions across your entire archive to surface themes, patterns, and connections."})]}),g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Literature timeline with trend tracking"}),g.jsx("p",{className:"muted",children:"Ollama extracts key terms from your notes so you can visualise how topics and ideas evolve over time."})]}),g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Smart paper recommendations"}),g.jsx("p",{className:"muted",children:"Suggests the next paper to read by analysing citations from uploaded PDFs, your research scope, and what you've already covered."})]}),g.jsxs("article",{className:"feature-card",children:[g.jsx("h3",{children:"Local-first and private"}),g.jsx("p",{className:"muted",children:"Runs entirely on your machine using Ollama - no paid APIs, no data leaving your system."})]})]})]}),g.jsxs("section",{className:"landing-preview",id:"tool-preview",children:[g.jsxs("div",{className:"snapshots-header",children:[g.jsx("h2",{children:"Tool preview"}),g.jsx("p",{className:"muted",children:"Exact components, pre-filled with example entries."})]}),g.jsx("div",{className:"landing-tool-preview",children:g.jsxs("div",{className:"grid-layout",children:[g.jsxs("div",{className:"column left-column",children:[g.jsxs("section",{className:"card note-card preview-card",children:[g.jsx("h2",{children:"New Research Note"}),g.jsx("p",{className:"muted",children:"Paste your raw note, abstract, or citation. The AI will extract the core details and log it for you."}),g.jsxs("form",{className:"note-form",onSubmit:n=>n.preventDefault(),children:[g.jsx("textarea",{defaultValue:`Nguyen et al. (2021) show that mixed-modality prompts improved recall in screening tasks.
Key variables: dataset size, prompt length, reviewer fatigue. DOI: 10.1234/example`,rows:8,readOnly:!0}),g.jsx("div",{className:"note-actions",children:g.jsx("button",{type:"button",disabled:!0,children:"Extract & Save"})})]}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Free-form research notes so you can capture ideas first and structure them later."})})]}),g.jsxs("section",{className:"card note-card preview-card",children:[g.jsx("h2",{children:"Literature Query"}),g.jsx("p",{className:"muted",children:"Ask questions about your saved notes. Ollama will answer using only your local database."}),g.jsxs("form",{className:"note-form",onSubmit:n=>n.preventDefault(),children:[g.jsx("textarea",{defaultValue:"What themes repeat across the last three vision-language papers?",rows:5,readOnly:!0}),g.jsxs("div",{className:"note-actions",children:[g.jsx("button",{type:"button",disabled:!0,children:"Ask"}),g.jsx("button",{type:"button",className:"clear-button",disabled:!0,children:"Clear answer"})]})]}),g.jsx("div",{className:"answer-box",children:"Methods emphasize prompt tuning, multi-view retrieval, and reducing review fatigue via auto-tagging."}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Search and query across your notes to surface themes, patterns, and connections."})})]})]}),g.jsxs("div",{className:"column right-column",children:[g.jsxs("section",{className:"card note-card preview-card",children:[g.jsx("h2",{children:"Research Scope"}),g.jsx("p",{className:"muted",children:"Define the boundaries of your review so notes stay aligned with your research question."}),g.jsxs("div",{className:"scope-tags",children:[g.jsx("span",{className:"keyword-chip",children:"vision-language"}),g.jsx("span",{className:"keyword-chip",children:"screening UX"}),g.jsx("span",{className:"keyword-chip",children:"metadata triage"}),g.jsx("span",{className:"keyword-chip",children:"2021-2024"})]}),g.jsx("textarea",{defaultValue:"Focus on HCI + ML tools that reduce reviewer fatigue during systematic screening. Exclude clinical-only datasets.",rows:4,readOnly:!0}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Set the guardrails for your review so every note stays on scope."})})]}),g.jsxs("section",{className:"card notepad-card preview-card",children:[g.jsx("div",{className:"table-header",children:g.jsx("h2",{children:"Notepad"})}),g.jsx("textarea",{className:"notepad-textarea",defaultValue:`- Build the screening rubric
- Ask advisor about dataset access
- Compare citation counts`,rows:6,readOnly:!0}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Track quick tasks and follow-ups while you read."})})]}),g.jsxs("section",{className:"card table-card preview-card",children:[g.jsxs("div",{className:"table-header",children:[g.jsx("h2",{children:"Literature Index"}),g.jsx("div",{className:"table-actions",children:g.jsxs("div",{className:"count-group",children:[g.jsx("span",{className:"count",children:"3 papers"}),g.jsx("button",{type:"button",className:"add-button",disabled:!0,children:"+"})]})})]}),g.jsx("div",{className:"table-wrap",children:g.jsxs("table",{children:[g.jsx("thead",{children:g.jsxs("tr",{children:[g.jsx("th",{className:"checkbox-cell",children:g.jsx("input",{type:"checkbox",checked:!0,readOnly:!0})}),g.jsx("th",{children:"Code"}),g.jsx("th",{children:"Author"}),g.jsx("th",{children:"Title"}),g.jsx("th",{children:"Link"}),g.jsx("th",{children:"Published"}),g.jsx("th",{children:"Citations"})]})}),g.jsx("tbody",{children:[{id:1,code:"N21",author:"Nguyen",title:"Prompting for Recall",published:"2021",citations:184},{id:2,code:"K22",author:"Keller",title:"Screening Workflows",published:"2022",citations:92},{id:3,code:"M23",author:"Moss",title:"Metadata Triage",published:"2023",citations:41}].map(n=>g.jsxs("tr",{children:[g.jsx("td",{className:"checkbox-cell",children:g.jsx("input",{type:"checkbox",checked:!0,readOnly:!0})}),g.jsx("td",{className:"code-cell",children:n.code}),g.jsx("td",{children:n.author}),g.jsx("td",{children:n.title}),g.jsx("td",{children:g.jsx("span",{className:"ghost-link",children:"Open"})}),g.jsx("td",{children:n.published}),g.jsx("td",{children:n.citations})]},n.id))})]})}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Automatic metadata extraction builds a live literature index for fast reference."})})]})]}),g.jsxs("section",{className:"card timeline-card full-width preview-card",children:[g.jsx("h2",{children:"Literature Timeline"}),g.jsx("p",{className:"muted",children:"A quick, visual sweep of your notes by date."}),g.jsx("div",{className:"timeline-track",children:[{id:1,year:"2021",code:"N21",title:"Prompting for Recall",keywords:["prompting","screening"]},{id:2,year:"2022",code:"K22",title:"Screening Workflows",keywords:["workflow","triage"]},{id:3,year:"2023",code:"M23",title:"Metadata Triage",keywords:["metadata","tags"]}].map(n=>g.jsxs("div",{className:"timeline-item",children:[g.jsx("div",{className:"timeline-dot"}),g.jsxs("div",{className:"timeline-meta",children:[g.jsx("span",{className:"timeline-year",children:n.year}),g.jsx("span",{className:"timeline-code",children:n.code})]}),g.jsx("div",{className:"timeline-title",children:n.title}),g.jsx("div",{className:"timeline-keywords",children:n.keywords.map(e=>g.jsx("span",{className:"keyword-chip",children:e},e))})]},n.id))}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Literature timeline with trend tracking to see how topics evolve over time."})})]}),g.jsxs("section",{className:"card detail-card preview-card full-width",children:[g.jsxs("div",{className:"detail-header",children:[g.jsxs("div",{children:[g.jsx("p",{className:"app-kicker",children:"Paper Detail"}),g.jsx("h2",{children:"Computing Machinery and Intelligence"})]}),g.jsxs("div",{className:"detail-header-actions",children:[g.jsx("button",{type:"button",className:"edit-toggle",disabled:!0,children:"End edit"}),g.jsx("span",{className:"ghost-link",children:"Back to dashboard"})]})]}),g.jsxs("dl",{className:"detail-list",children:[g.jsxs("div",{children:[g.jsx("dt",{children:"Author"}),g.jsx("dd",{children:g.jsx("input",{className:"detail-input",value:"Alan M. Turing",readOnly:!0})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Published"}),g.jsx("dd",{children:g.jsx("input",{className:"detail-input",value:"1950",readOnly:!0})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Citations"}),g.jsx("dd",{children:g.jsx("input",{className:"detail-input",value:"12000",readOnly:!0})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Link"}),g.jsx("dd",{children:g.jsx("input",{className:"detail-input",value:"https://doi.org/10.1093/mind/LIX.236.433",readOnly:!0})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Title"}),g.jsx("dd",{children:g.jsx("input",{className:"detail-input",value:"Computing Machinery and Intelligence",readOnly:!0})})]})]}),g.jsxs("div",{className:"detail-actions",children:[g.jsx("button",{type:"button",disabled:!0,children:"Save changes"}),g.jsx("span",{className:"muted",children:"Saved."})]}),g.jsxs("div",{className:"pdf-block",children:[g.jsx("h3",{children:"Paper PDF"}),g.jsxs("div",{className:"pdf-actions",children:[g.jsx("input",{type:"file",accept:"application/pdf",disabled:!0}),g.jsx("span",{className:"ghost-link",children:"Open PDF"}),g.jsx("span",{className:"muted",children:"turing1950.pdf"}),g.jsx("button",{type:"button",className:"ghost-link",disabled:!0,children:"Remove"})]})]}),g.jsxs("div",{className:"notes-block",children:[g.jsx("h3",{children:"Original Note"}),g.jsx("textarea",{className:"detail-input detail-textarea",value:`proposes the imitation game as a test for machine intelligence
focuses on behavioral criteria over internal mechanism
addresses objections: theological, consciousness, mathematical limits
predicts machines could pass with 30% success by 2000`,rows:4,readOnly:!0}),g.jsx("div",{className:"references-block",children:g.jsx("button",{type:"button",className:"ghost-link",disabled:!0,children:"Display references"})})]}),g.jsx("div",{className:"preview-overlay",children:g.jsx("p",{children:"Edit individual papers to refine metadata, notes, and links as your review evolves."})})]})]})})]}),g.jsxs("section",{className:"landing-cta",children:[g.jsxs("div",{children:[g.jsx("h2",{children:"Ready to build your literature desk?"}),g.jsx("p",{className:"muted",children:"Start with a note, add a paper manually, or query your archive in minutes."})]}),g.jsx(on,{to:"/tool",className:"primary-cta",children:"Launch the tool"})]})]})}var cu={};cu.d=(n,e)=>{for(var t in e)cu.o(e,t)&&!cu.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};cu.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Q=globalThis.pdfjsLib={};cu.d(Q,{AbortException:()=>Br,AnnotationEditorLayer:()=>Uy,AnnotationEditorParamsType:()=>ce,AnnotationEditorType:()=>te,AnnotationEditorUIManager:()=>vo,AnnotationLayer:()=>dP,AnnotationMode:()=>qi,ColorPicker:()=>ep,DOMSVGFactory:()=>e0,DrawLayer:()=>Wy,FeatureTest:()=>Gt,GlobalWorkerOptions:()=>Pi,ImageKind:()=>Xd,InvalidPDFException:()=>Dm,MissingPDFException:()=>Nu,OPS:()=>ts,OutputScale:()=>Om,PDFDataRangeTransport:()=>Tb,PDFDateString:()=>Kv,PDFWorker:()=>sl,PasswordResponses:()=>Sk,PermissionFlag:()=>Ak,PixelsPerInch:()=>Hr,RenderingCancelledException:()=>qv,TextLayer:()=>Ru,TouchManager:()=>Jf,UnexpectedResponseException:()=>Yf,Util:()=>G,VerbosityLevel:()=>Wp,XfaLayer:()=>Nb,build:()=>GT,createValidAbsoluteUrl:()=>Ek,fetchData:()=>Yp,getDocument:()=>OT,getFilenameFromUrl:()=>Ik,getPdfFilenameFromUrl:()=>Dk,getXfaPageViewport:()=>Fk,isDataScheme:()=>Kp,isPdfFile:()=>Yv,noContextMenu:()=>As,normalizeUnicode:()=>Rk,setLayerDimensions:()=>yo,shadow:()=>ae,stopEvent:()=>Cn,version:()=>WT});const Ft=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),kx=[1,0,0,1,0,0],Im=[.001,0,0,.001,0,0],vk=1e7,Rg=1.35,bn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},wk="pdfjs_internal_editor_",te={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ce={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Ak={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Xd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ze={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Nc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Wp={ERRORS:0,WARNINGS:1,INFOS:5},ts={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Sk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Gp=Wp.WARNINGS;function xk(n){Number.isInteger(n)&&(Gp=n)}function bk(){return Gp}function Xp(n){Gp>=Wp.INFOS&&console.log(`Info: ${n}`)}function ne(n){Gp>=Wp.WARNINGS&&console.log(`Warning: ${n}`)}function be(n){throw new Error(n)}function Ye(n,e){n||be(e)}function _k(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ek(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Nk(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(_k(s))return s}catch{}return null}function ae(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Xr=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Mw extends Xr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Mg extends Xr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Dm extends Xr{constructor(e){super(e,"InvalidPDFException")}}class Nu extends Xr{constructor(e){super(e,"MissingPDFException")}}class Yf extends Xr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class Ck extends Xr{constructor(e){super(e,"FormatError")}}class Br extends Xr{constructor(e){super(e,"AbortException")}}function Tx(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&be("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function qp(n){typeof n!="string"&&be("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function kk(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Gv(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function Tk(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Pk(){try{return new Function(""),!0}catch{return!1}}class Gt{static get isLittleEndian(){return ae(this,"isLittleEndian",Tk())}static get isEvalSupported(){return ae(this,"isEvalSupported",Pk())}static get isOffscreenCanvasSupported(){return ae(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ae(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ae(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ae(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return ae(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Lg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Li,qd,Fm;class G{static makeHexColor(e,t,s){return`#${Lg[e]}${Lg[t]}${Lg[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,c=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,u=o+c||1,h=o-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,c,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,c)):u=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],x(this,Li,Fm).call(this,e,s,r,o,t,i,a,c,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),u),x(this,Li,Fm).call(this,e,s,r,o,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),u),u}}Li=new WeakSet,qd=function(e,t,s,i,r,a,o,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,p=f*u,y=d*(d*(d*e+3*u*t)+3*f*s)+p*i,w=d*(d*(d*r+3*u*a)+3*f*o)+p*c;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],w),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],w)},Fm=function(e,t,s,i,r,a,o,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&x(this,Li,qd).call(this,e,t,s,i,r,a,o,c,-d/h,f);return}const p=h**2-4*d*u;if(p<0)return;const y=Math.sqrt(p),w=2*u;x(this,Li,qd).call(this,e,t,s,i,r,a,o,c,(-h+y)/w,f),x(this,Li,qd).call(this,e,t,s,i,r,a,o,c,(-h-y)/w,f)},S(G,Li);function Nk(n){return decodeURIComponent(escape(n))}let Ig=null,Lw=null;function Rk(n){return Ig||(Ig=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Lw=new Map([["","t"]])),n.replaceAll(Ig,(e,t,s)=>t?t.normalize("NFKC"):Lw.get(s))}function Mk(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Tx(n)}const Xv="pdfjs_internal_id_";function Lk(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Tx(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Qs="http://www.w3.org/2000/svg",ea=class ea{};q(ea,"CSS",96),q(ea,"PDF",72),q(ea,"PDF_TO_CSS_UNITS",ea.CSS/ea.PDF);let Hr=ea;async function Yp(n,e="text"){if(jc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class ud{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,d=0,f=0,p=1;break;case 90:h=0,d=1,f=1,p=0;break;case 270:h=0,d=-1,f=-1,p=0;break;case 0:h=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let y,w,_,v;h===0?(y=Math.abs(u-e[1])*s+r,w=Math.abs(c-e[0])*s+a,_=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(y=Math.abs(c-e[0])*s+r,w=Math.abs(u-e[1])*s+a,_=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[h*s,d*s,f*s,p*s,y-h*s*c-f*s*u,w-d*s*c-p*s*u],this.width=_,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return ae(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new ud({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return G.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=G.applyTransform([e[0],e[1]],this.transform),s=G.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return G.applyInverseTransform([e,t],this.transform)}}class qv extends Xr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Kp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Yv(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Ik(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Dk(n,e="document.pdf"){if(typeof n!="string")return e;if(Kp(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Iw{constructor(){q(this,"started",Object.create(null));q(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function jc(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function As(n){n.preventDefault()}function Cn(n){n.preventDefault(),n.stopPropagation()}var Lu;class Kv{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Lu)||m(this,Lu,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Lu).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,o+=d):u==="+"&&(a-=h,o-=d),new Date(Date.UTC(s,i,r,a,o,c))}}Lu=new WeakMap,S(Kv,Lu);function Fk(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new ud({viewBox:r,userUnit:1,scale:e,rotation:t})}function Qv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function Ok(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Qv(s))}e.remove()}function Me(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function Es(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function yo(n,e,t=!1,s=!0){if(e instanceof ud){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Gt.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Om{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Yi,ra,ns,aa,Iu,Du,op,Px,Xt,Nx,Rx,Yd,Mx,zm;const ti=class ti{constructor(e){S(this,Xt);S(this,Yi,null);S(this,ra,null);S(this,ns);S(this,aa,null);S(this,Iu,null);m(this,ns,e),l(ti,Du)||m(ti,Du,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=m(this,Yi,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,ns)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:t}),e.addEventListener("pointerdown",x(ti,op,Px),{signal:t});const s=m(this,aa,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,ns).toolbarPosition;if(i){const{style:r}=e,a=l(this,ns)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return x(this,Xt,Mx).call(this),e}get div(){return l(this,Yi)}hide(){var e;l(this,Yi).classList.add("hidden"),(e=l(this,ra))==null||e.hideDropdown()}show(){var e;l(this,Yi).classList.remove("hidden"),(e=l(this,Iu))==null||e.shown()}async addAltText(e){const t=await e.render();x(this,Xt,Yd).call(this,t),l(this,aa).prepend(t,l(this,Xt,zm)),m(this,Iu,e)}addColorPicker(e){m(this,ra,e);const t=e.renderButton();x(this,Xt,Yd).call(this,t),l(this,aa).prepend(t,l(this,Xt,zm))}remove(){var e;l(this,Yi).remove(),(e=l(this,ra))==null||e.destroy(),m(this,ra,null)}};Yi=new WeakMap,ra=new WeakMap,ns=new WeakMap,aa=new WeakMap,Iu=new WeakMap,Du=new WeakMap,op=new WeakSet,Px=function(e){e.stopPropagation()},Xt=new WeakSet,Nx=function(e){l(this,ns)._focusEventsAllowed=!1,Cn(e)},Rx=function(e){l(this,ns)._focusEventsAllowed=!0,Cn(e)},Yd=function(e){const t=l(this,ns)._uiManager._signal;e.addEventListener("focusin",x(this,Xt,Nx).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",x(this,Xt,Rx).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",As,{signal:t})},Mx=function(){const{editorType:e,_uiManager:t}=l(this,ns),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(ti,Du)[e]),x(this,Xt,Yd).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,aa).append(s)},zm=function(){const e=document.createElement("div");return e.className="divider",e},S(ti,op),S(ti,Du,null);let jm=ti;var Fu,oa,la,Ur,Lx,Ix,Dx;class jk{constructor(e){S(this,Ur);S(this,Fu,null);S(this,oa,null);S(this,la);m(this,la,e)}show(e,t,s){const[i,r]=x(this,Ur,Ix).call(this,t,s),{style:a}=l(this,oa)||m(this,oa,x(this,Ur,Lx).call(this));e.append(l(this,oa)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,oa).remove()}}Fu=new WeakMap,oa=new WeakMap,la=new WeakMap,Ur=new WeakSet,Lx=function(){const e=m(this,oa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",As,{signal:l(this,la)._signal});const t=m(this,Fu,document.createElement("div"));return t.className="buttons",e.append(t),x(this,Ur,Dx).call(this),e},Ix=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},Dx=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,la)._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("click",()=>{l(this,la).highlightSelection("floating_button")},{signal:s}),l(this,Fu).append(e)};function Kf(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var lp;class zk{constructor(){S(this,lp,0)}get id(){return`${wk}${jt(this,lp)._++}`}}lp=new WeakMap;var il,Ou,Nt,rl,Kd;const i0=class i0{constructor(){S(this,rl);S(this,il,Mk());S(this,Ou,0);S(this,Nt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ae(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return x(this,rl,Kd).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return x(this,rl,Kd).call(this,e,e)}async getFromBlob(e,t){const s=await t;return x(this,rl,Kd).call(this,e,s)}async getFromId(e){l(this,Nt)||m(this,Nt,new Map);const t=l(this,Nt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Nt)||m(this,Nt,new Map);let s=l(this,Nt).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,il)}_${jt(this,Ou)._++}`,refCounter:1,isSvg:!1},l(this,Nt).set(e,s),l(this,Nt).set(s.id,s),s}getSvgUrl(e){const t=l(this,Nt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,Nt)||m(this,Nt,new Map);const t=l(this,Nt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,il)}_`)}};il=new WeakMap,Ou=new WeakMap,Nt=new WeakMap,rl=new WeakSet,Kd=async function(e,t){l(this,Nt)||m(this,Nt,new Map);let s=l(this,Nt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,il)}_${jt(this,Ou)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Yp(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=i0._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((u,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,u()},a.onload=async()=>{const d=s.svgUrl=a.result;o.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ne(i),s=null}return l(this,Nt).set(e,s),s&&l(this,Nt).set(s.id,s),s};let Bm=i0;var $e,Ki,ju,De;class Bk{constructor(e=128){S(this,$e,[]);S(this,Ki,!1);S(this,ju);S(this,De,-1);m(this,ju,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),l(this,Ki))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,De)===-1){l(this,$e).length>0&&(l(this,$e).length=0),m(this,De,0),l(this,$e).push(c);return}if(a&&l(this,$e)[l(this,De)].type===r){o&&(c.undo=l(this,$e)[l(this,De)].undo),l(this,$e)[l(this,De)]=c;return}const u=l(this,De)+1;u===l(this,ju)?l(this,$e).splice(0,1):(m(this,De,u),u<l(this,$e).length&&l(this,$e).splice(u)),l(this,$e).push(c)}undo(){if(l(this,De)===-1)return;m(this,Ki,!0);const{undo:e,post:t}=l(this,$e)[l(this,De)];e(),t==null||t(),m(this,Ki,!1),m(this,De,l(this,De)-1)}redo(){if(l(this,De)<l(this,$e).length-1){m(this,De,l(this,De)+1),m(this,Ki,!0);const{cmd:e,post:t}=l(this,$e)[l(this,De)];e(),t==null||t(),m(this,Ki,!1)}}hasSomethingToUndo(){return l(this,De)!==-1}hasSomethingToRedo(){return l(this,De)<l(this,$e).length-1}cleanType(e){if(l(this,De)!==-1){for(let t=l(this,De);t>=0;t--)if(l(this,$e)[t].type!==e){l(this,$e).splice(t+1,l(this,De)-t),m(this,De,t);return}l(this,$e).length=0,m(this,De,-1)}}destroy(){m(this,$e,null)}}$e=new WeakMap,Ki=new WeakMap,ju=new WeakMap,De=new WeakMap;var cp,Fx;class hd{constructor(e){S(this,cp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Gt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(x(this,cp,Fx).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Cn(t))}}cp=new WeakSet,Fx=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const up=class up{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Ok(e),ae(this,"_colors",e)}convert(e){const t=Qv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return up._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?G.makeHexColor(...t):e}};q(up,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Hm=up;var al,hn,tt,gt,ol,ii,ll,Dn,Qi,ca,cl,ua,Ps,ss,ha,zu,Bu,ul,Hu,Ns,Ji,hl,Zi,Rs,hp,er,Uu,tr,da,$u,Vu,at,ve,ri,fa,Wu,Gu,nr,Ms,ai,Xu,Fn,F,Qd,Um,Ox,jx,Jd,zx,Bx,Hx,$m,Ux,Vm,Wm,$x,zt,Js,Vx,Wx,Gm,Gx,zc,Xm;const qo=class qo{constructor(e,t,s,i,r,a,o,c,u,h,d,f,p){S(this,F);S(this,al,new AbortController);S(this,hn,null);S(this,tt,new Map);S(this,gt,new Map);S(this,ol,null);S(this,ii,null);S(this,ll,null);S(this,Dn,new Bk);S(this,Qi,null);S(this,ca,null);S(this,cl,0);S(this,ua,new Set);S(this,Ps,null);S(this,ss,null);S(this,ha,new Set);q(this,"_editorUndoBar",null);S(this,zu,!1);S(this,Bu,!1);S(this,ul,!1);S(this,Hu,null);S(this,Ns,null);S(this,Ji,null);S(this,hl,null);S(this,Zi,!1);S(this,Rs,null);S(this,hp,new zk);S(this,er,!1);S(this,Uu,!1);S(this,tr,null);S(this,da,null);S(this,$u,null);S(this,Vu,null);S(this,at,te.NONE);S(this,ve,new Set);S(this,ri,null);S(this,fa,null);S(this,Wu,null);S(this,Gu,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});S(this,nr,[0,0]);S(this,Ms,null);S(this,ai,null);S(this,Xu,null);S(this,Fn,null);const y=this._signal=l(this,al).signal;m(this,ai,e),m(this,Xu,t),m(this,ol,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:y}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),i._on("setpreference",this.onSetPreference.bind(this),{signal:y}),i._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:y}),x(this,F,zx).call(this),x(this,F,$x).call(this),x(this,F,$m).call(this),m(this,ii,r.annotationStorage),m(this,Hu,r.filterFactory),m(this,fa,a),m(this,hl,o||null),m(this,zu,c),m(this,Bu,u),m(this,ul,h),m(this,Vu,d||null),this.viewParameters={realScale:Hr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const e=qo.prototype,t=a=>l(a,ai).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ae(this,"_keyboardManager",new hd([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ai).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ai).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=l(this,Fn))==null||e.resolve(),m(this,Fn,null),(t=l(this,al))==null||t.abort(),m(this,al,null),this._signal=null;for(const a of l(this,gt).values())a.destroy();l(this,gt).clear(),l(this,tt).clear(),l(this,ha).clear(),m(this,hn,null),l(this,ve).clear(),l(this,Dn).destroy(),(s=l(this,ol))==null||s.destroy(),(i=l(this,Rs))==null||i.hide(),m(this,Rs,null),l(this,Ns)&&(clearTimeout(l(this,Ns)),m(this,Ns,null)),l(this,Ms)&&(clearTimeout(l(this,Ms)),m(this,Ms,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,Vu)}get useNewAltTextFlow(){return l(this,Bu)}get useNewAltTextWhenAddingImage(){return l(this,ul)}get hcmFilter(){return ae(this,"hcmFilter",l(this,fa)?l(this,Hu).addHCMFilter(l(this,fa).foreground,l(this,fa).background):"none")}get direction(){return ae(this,"direction",getComputedStyle(l(this,ai)).direction)}get highlightColors(){return ae(this,"highlightColors",l(this,hl)?new Map(l(this,hl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ae(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,ca,e)}setMainHighlightColorPicker(e){m(this,$u,e)}editAltText(e,t=!1){var s;(s=l(this,ol))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":m(this,ul,t);break}}onPageChanging({pageNumber:e}){m(this,cl,e-1)}focusMainContainer(){l(this,ai).focus()}findParent(e,t){for(const s of l(this,gt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){l(this,Xu).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,ha).add(e)}removeShouldRescale(e){l(this,ha).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Hr.PDF_TO_CSS_UNITS;for(const s of l(this,ha))s.onScaleChanging();(t=l(this,ca))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),u=x(this,F,Qd).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const d=x(this,F,Um).call(this,u),f=l(this,at)===te.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(te.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,ii)&&!l(this,ii).has(e.id)&&l(this,ii).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,Zi)&&(m(this,Zi,!1),x(this,F,Jd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,ve))if(t.div.contains(e)){m(this,da,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,da))return;const[e,t]=l(this,da);m(this,da,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){x(this,F,$m).call(this),x(this,F,Vm).call(this)}removeEditListeners(){x(this,F,Ux).call(this),x(this,F,Wm).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,ss))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,ss))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,hn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,ve)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,ss))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)x(this,F,Gm).call(this,c);x(this,F,Xm).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,at)!==te.NONE&&!this.isEditorHandlingKeyboard&&qo._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Zi)&&(m(this,Zi,!1),x(this,F,Jd).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(x(this,F,Bx).call(this),x(this,F,Vm).call(this),x(this,F,zt).call(this,{isEditing:l(this,at)!==te.NONE,isEmpty:x(this,F,zc).call(this),hasSomethingToUndo:l(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:l(this,Dn).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,F,Hx).call(this),x(this,F,Wm).call(this),x(this,F,zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,ss)){m(this,ss,e);for(const t of l(this,ss))x(this,F,Js).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,hp).id}get currentLayer(){return l(this,gt).get(l(this,cl))}getLayer(e){return l(this,gt).get(e)}get currentPageIndex(){return l(this,cl)}addLayer(e){l(this,gt).set(e.pageIndex,e),l(this,er)?e.enable():e.disable()}removeLayer(e){l(this,gt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(l(this,at)!==e&&!(l(this,Fn)&&(await l(this,Fn).promise,!l(this,Fn)))){if(m(this,Fn,Promise.withResolvers()),m(this,at,e),e===te.NONE){this.setEditingState(!1),x(this,F,Wx).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,Fn).resolve();return}this.setEditingState(!0),await x(this,F,Vx).call(this),this.unselectAll();for(const r of l(this,gt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,Fn).resolve();return}for(const r of l(this,tt).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,Fn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,at)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(l(this,ss)){switch(e){case ce.CREATE:this.currentLayer.addNewEditor();return;case ce.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,$u))==null||s.updateColor(t);break;case ce.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,Wu)||m(this,Wu,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,ve))i.updateParams(e,t);for(const i of l(this,ss))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of l(this,tt).values())a.editorType===e&&a.show(t);(((r=l(this,Wu))==null?void 0:r.get(ce.HIGHLIGHT_SHOW_ALL))??!0)!==t&&x(this,F,Js).call(this,[[ce.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,Uu)!==e){m(this,Uu,e);for(const t of l(this,gt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,tt).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,tt).get(e)}addEditor(e){l(this,tt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,Ns)&&clearTimeout(l(this,Ns)),m(this,Ns,setTimeout(()=>{this.focusMainContainer(),m(this,Ns,null)},0))),l(this,tt).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,ua).has(e.annotationElementId))&&((t=l(this,ii))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,ua).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,ua).has(e)}removeDeletedAnnotationElement(e){l(this,ua).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,hn)!==e&&(m(this,hn,e),e&&x(this,F,Js).call(this,e.propertiesToUpdate))}updateUI(e){l(this,F,Gx)===e&&x(this,F,Js).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){x(this,F,Js).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,ve).has(e)){l(this,ve).delete(e),e.unselect(),x(this,F,zt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,ve).add(e),e.select(),x(this,F,Js).call(this,e.propertiesToUpdate),x(this,F,zt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,ca))==null||t.commitOrRemove();for(const s of l(this,ve))s!==e&&s.unselect();l(this,ve).clear(),l(this,ve).add(e),e.select(),x(this,F,Js).call(this,e.propertiesToUpdate),x(this,F,zt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,ve).has(e)}get firstSelectedEditor(){return l(this,ve).values().next().value}unselect(e){e.unselect(),l(this,ve).delete(e),x(this,F,zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,ve).size!==0}get isEnterHandled(){return l(this,ve).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,Dn).undo(),x(this,F,zt).call(this,{hasSomethingToUndo:l(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,F,zc).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,Dn).redo(),x(this,F,zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Dn).hasSomethingToRedo(),isEmpty:x(this,F,zc).call(this)})}addCommands(e){l(this,Dn).add(e),x(this,F,zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,F,zc).call(this)})}cleanUndoStack(e){l(this,Dn).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,ve)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)x(this,F,Gm).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,hn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,hn)||this.hasSelection}selectAll(){for(const e of l(this,ve))e.commit();x(this,F,Xm).call(this,l(this,tt).values())}unselectAll(){var e;if(!(l(this,hn)&&(l(this,hn).commitOrRemove(),l(this,at)!==te.NONE))&&!((e=l(this,ca))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,ve))t.unselect();l(this,ve).clear(),x(this,F,zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,nr)[0]+=e,l(this,nr)[1]+=t;const[i,r]=l(this,nr),a=[...l(this,ve)],o=1e3;l(this,Ms)&&clearTimeout(l(this,Ms)),m(this,Ms,setTimeout(()=>{m(this,Ms,null),l(this,nr)[0]=l(this,nr)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,tt).has(c.id)&&c.translateInPage(i,r)},undo:()=>{for(const c of a)l(this,tt).has(c.id)&&c.translateInPage(-i,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Ps,new Map);for(const e of l(this,ve))l(this,Ps).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Ps))return!1;this.disableUserSelect(!1);const e=l(this,Ps);m(this,Ps,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(l(this,tt).has(i.id)){const c=l(this,gt).get(o);c?i._setParentAndPosition(c,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Ps))for(const s of l(this,Ps).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,ve).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,hn)===e}getActive(){return l(this,hn)}getMode(){return l(this,at)}get imageManager(){return ae(this,"imageManager",new Bm)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,d,f)=>({x:(h-i)/a,y:1-(u+d-s)/r,width:f/a,height:d/r});break;case"180":o=(u,h,d,f)=>({x:1-(u+d-s)/r,y:1-(h+f-i)/a,width:d/r,height:f/a});break;case"270":o=(u,h,d,f)=>({x:1-(h+f-i)/a,y:(u-s)/r,width:f/a,height:d/r});break;default:o=(u,h,d,f)=>({x:(u-s)/r,y:(h-i)/a,width:d/r,height:f/a});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:p,width:y,height:w}of d.getClientRects())y===0||w===0||c.push(o(f,p,y,w))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,ll)||m(this,ll,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,ll))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,ll))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,ii).getRawValue(t);s&&(l(this,at)===te.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};al=new WeakMap,hn=new WeakMap,tt=new WeakMap,gt=new WeakMap,ol=new WeakMap,ii=new WeakMap,ll=new WeakMap,Dn=new WeakMap,Qi=new WeakMap,ca=new WeakMap,cl=new WeakMap,ua=new WeakMap,Ps=new WeakMap,ss=new WeakMap,ha=new WeakMap,zu=new WeakMap,Bu=new WeakMap,ul=new WeakMap,Hu=new WeakMap,Ns=new WeakMap,Ji=new WeakMap,hl=new WeakMap,Zi=new WeakMap,Rs=new WeakMap,hp=new WeakMap,er=new WeakMap,Uu=new WeakMap,tr=new WeakMap,da=new WeakMap,$u=new WeakMap,Vu=new WeakMap,at=new WeakMap,ve=new WeakMap,ri=new WeakMap,fa=new WeakMap,Wu=new WeakMap,Gu=new WeakMap,nr=new WeakMap,Ms=new WeakMap,ai=new WeakMap,Xu=new WeakMap,Fn=new WeakMap,F=new WeakSet,Qd=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Um=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,gt).values())if(s.hasTextLayer(e))return s;return null},Ox=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=x(this,F,Qd).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,Rs)||m(this,Rs,new jk(this)),l(this,Rs).show(s,i,this.direction==="ltr"))},jx=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,ri)&&((r=l(this,Rs))==null||r.hide(),m(this,ri,null),x(this,F,zt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,ri))return;const i=x(this,F,Qd).call(this,e).closest(".textLayer");if(!i){l(this,ri)&&((a=l(this,Rs))==null||a.hide(),m(this,ri,null),x(this,F,zt).call(this,{hasSelectedText:!1}));return}if((o=l(this,Rs))==null||o.hide(),m(this,ri,t),x(this,F,zt).call(this,{hasSelectedText:!0}),!(l(this,at)!==te.HIGHLIGHT&&l(this,at)!==te.NONE)&&(l(this,at)===te.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Zi,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,at)===te.HIGHLIGHT?x(this,F,Um).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&x(this,F,Jd).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},Jd=function(e=""){l(this,at)===te.HIGHLIGHT?this.highlightSelection(e):l(this,zu)&&x(this,F,Ox).call(this)},zx=function(){document.addEventListener("selectionchange",x(this,F,jx).bind(this),{signal:this._signal})},Bx=function(){if(l(this,Ji))return;m(this,Ji,new AbortController);const e=this.combinedSignal(l(this,Ji));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Hx=function(){var e;(e=l(this,Ji))==null||e.abort(),m(this,Ji,null)},$m=function(){if(l(this,tr))return;m(this,tr,new AbortController);const e=this.combinedSignal(l(this,tr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Ux=function(){var e;(e=l(this,tr))==null||e.abort(),m(this,tr,null)},Vm=function(){if(l(this,Qi))return;m(this,Qi,new AbortController);const e=this.combinedSignal(l(this,Qi));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Wm=function(){var e;(e=l(this,Qi))==null||e.abort(),m(this,Qi,null)},$x=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},zt=function(e){Object.entries(e).some(([s,i])=>l(this,Gu)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Gu),e)}),l(this,at)===te.HIGHLIGHT&&e.hasSelectedEditor===!1&&x(this,F,Js).call(this,[[ce.HIGHLIGHT_FREE,!0]]))},Js=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Vx=async function(){if(!l(this,er)){m(this,er,!0);const e=[];for(const t of l(this,gt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,tt).values())t.enable()}},Wx=function(){if(this.unselectAll(),l(this,er)){m(this,er,!1);for(const e of l(this,gt).values())e.disable();for(const e of l(this,tt).values())e.disable()}},Gm=function(e){const t=l(this,gt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Gx=function(){let e=null;for(e of l(this,ve));return e},zc=function(){if(l(this,tt).size===0)return!0;if(l(this,tt).size===1)for(const e of l(this,tt).values())return e.isEmpty();return!1},Xm=function(e){for(const t of l(this,ve))t.unselect();l(this,ve).clear();for(const t of e)t.isEmpty()||(l(this,ve).add(t),t.select());x(this,F,zt).call(this,{hasSelectedEditor:this.hasSelection})},q(qo,"TRANSLATE_SMALL",1),q(qo,"TRANSLATE_BIG",10);let vo=qo;var ot,Ls,is,dl,Is,dn,fl,Ds,en,oi,pa,Fs,sr,ms,Bc,Zd;const Bt=class Bt{constructor(e){S(this,ms);S(this,ot,null);S(this,Ls,!1);S(this,is,null);S(this,dl,null);S(this,Is,null);S(this,dn,null);S(this,fl,!1);S(this,Ds,null);S(this,en,null);S(this,oi,null);S(this,pa,null);S(this,Fs,!1);m(this,en,e),m(this,Fs,e._uiManager.useNewAltTextFlow),l(Bt,sr)||m(Bt,sr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Bt._l10n??(Bt._l10n=e)}async render(){const e=m(this,is,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=m(this,dl,document.createElement("span"));e.append(t),l(this,Fs)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Bt,sr).missing),t.setAttribute("data-l10n-id",l(Bt,sr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,en)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,en)._uiManager.editAltText(l(this,en)),l(this,Fs)&&l(this,en)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,ms,Bc)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(m(this,fl,!0),i(r))},{signal:s}),await x(this,ms,Zd).call(this),e}finish(){l(this,is)&&(l(this,is).focus({focusVisible:l(this,fl)}),m(this,fl,!1))}isEmpty(){return l(this,Fs)?l(this,ot)===null:!l(this,ot)&&!l(this,Ls)}hasData(){return l(this,Fs)?l(this,ot)!==null||!!l(this,oi):this.isEmpty()}get guessedText(){return l(this,oi)}async setGuessedText(e){l(this,ot)===null&&(m(this,oi,e),m(this,pa,await Bt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),x(this,ms,Zd).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,Fs)||l(this,ot)){(t=l(this,Ds))==null||t.remove(),m(this,Ds,null);return}if(!l(this,Ds)){const s=m(this,Ds,document.createElement("div"));s.className="noAltTextBadge",l(this,en).div.append(s)}l(this,Ds).classList.toggle("hidden",!e)}serialize(e){let t=l(this,ot);return!e&&l(this,oi)===t&&(t=l(this,pa)),{altText:t,decorative:l(this,Ls),guessedText:l(this,oi),textWithDisclaimer:l(this,pa)}}get data(){return{altText:l(this,ot),decorative:l(this,Ls)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(m(this,oi,s),m(this,pa,i)),!(l(this,ot)===e&&l(this,Ls)===t)&&(r||(m(this,ot,e),m(this,Ls,t)),x(this,ms,Zd).call(this))}toggle(e=!1){l(this,is)&&(!e&&l(this,dn)&&(clearTimeout(l(this,dn)),m(this,dn,null)),l(this,is).disabled=!e)}shown(){l(this,en)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,ms,Bc)}})}destroy(){var e,t;(e=l(this,is))==null||e.remove(),m(this,is,null),m(this,dl,null),m(this,Is,null),(t=l(this,Ds))==null||t.remove(),m(this,Ds,null)}};ot=new WeakMap,Ls=new WeakMap,is=new WeakMap,dl=new WeakMap,Is=new WeakMap,dn=new WeakMap,fl=new WeakMap,Ds=new WeakMap,en=new WeakMap,oi=new WeakMap,pa=new WeakMap,Fs=new WeakMap,sr=new WeakMap,ms=new WeakSet,Bc=function(){return l(this,ot)&&"added"||l(this,ot)===null&&this.guessedText&&"review"||"missing"},Zd=async function(){var i,r,a;const e=l(this,is);if(!e)return;if(l(this,Fs)){if(e.classList.toggle("done",!!l(this,ot)),e.setAttribute("data-l10n-id",l(Bt,sr)[l(this,ms,Bc)]),(i=l(this,dl))==null||i.setAttribute("data-l10n-id",l(Bt,sr)[`${l(this,ms,Bc)}-label`]),!l(this,ot)){(r=l(this,Is))==null||r.remove();return}}else{if(!l(this,ot)&&!l(this,Ls)){e.classList.remove("done"),(a=l(this,Is))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,Is);if(!t){m(this,Is,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,en).id}`;const o=100,c=l(this,en)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,dn)),m(this,dn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(this,dn,setTimeout(()=>{m(this,dn,null),l(this,Is).classList.add("show"),l(this,en)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,dn)&&(clearTimeout(l(this,dn)),m(this,dn,null)),(u=l(this,Is))==null||u.classList.remove("show")},{signal:c})}l(this,Ls)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,ot)),t.parentNode||e.append(t);const s=l(this,en).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},S(Bt,sr,null),q(Bt,"_l10n",null);let Qf=Bt;var qu,ga,Yu,Ku,Qu,Ju,Zu,pl,li,ma,ir,zi,Xx,qx,qm;const r0=class r0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){S(this,zi);S(this,qu);S(this,ga,!1);S(this,Yu,null);S(this,Ku);S(this,Qu);S(this,Ju);S(this,Zu);S(this,pl);S(this,li,null);S(this,ma);S(this,ir,null);m(this,qu,e),m(this,Yu,s),m(this,Ku,t),m(this,Qu,i),m(this,Ju,r),m(this,Zu,a),m(this,ma,new AbortController),m(this,pl,AbortSignal.any([o,l(this,ma).signal])),e.addEventListener("touchstart",x(this,zi,Xx).bind(this),{passive:!1,signal:l(this,pl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ae(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,ma))==null||e.abort(),m(this,ma,null)}};qu=new WeakMap,ga=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,Qu=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,pl=new WeakMap,li=new WeakMap,ma=new WeakMap,ir=new WeakMap,zi=new WeakSet,Xx=function(e){var i,r,a;if((i=l(this,Ku))!=null&&i.call(this)||e.touches.length<2)return;if(!l(this,ir)){m(this,ir,new AbortController);const o=AbortSignal.any([l(this,pl),l(this,ir).signal]),c=l(this,qu),u={signal:o,passive:!1};c.addEventListener("touchmove",x(this,zi,qx).bind(this),u),c.addEventListener("touchend",x(this,zi,qm).bind(this),u),c.addEventListener("touchcancel",x(this,zi,qm).bind(this),u),(r=l(this,Qu))==null||r.call(this)}if(Cn(e),e.touches.length!==2||(a=l(this,Yu))!=null&&a.call(this)){m(this,li,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),m(this,li,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},qx=function(e){var E;if(!l(this,li)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,c=l(this,li),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,p=d-u,y=f-h,w=a-i,_=o-r,v=Math.hypot(w,_)||1,A=Math.hypot(p,y)||1;if(!l(this,ga)&&Math.abs(A-v)<=r0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,ga)){m(this,ga,!0);return}const b=[(i+a)/2,(r+o)/2];(E=l(this,Ju))==null||E.call(this,b,A,v)},qm=function(e){var t;l(this,ir).abort(),m(this,ir,null),(t=l(this,Zu))==null||t.call(this),l(this,li)&&(e.preventDefault(),m(this,li,null),m(this,ga,!1))};let Jf=r0;var ya,rs,Pe,gl,rr,eh,va,mt,wa,ci,ar,th,Aa,fn,nh,Sa,ui,Os,ml,yl,On,xa,sh,dp,Y,Ym,ih,Km,ef,Yx,Kx,Qm,tf,Jm,Qx,Jx,Zx,Zm,eb,ey,tb,nb,sb,ty,Hc;const se=class se{constructor(e){S(this,Y);S(this,ya,null);S(this,rs,null);S(this,Pe,null);S(this,gl,!1);S(this,rr,null);S(this,eh,"");S(this,va,!1);S(this,mt,null);S(this,wa,null);S(this,ci,null);S(this,ar,null);S(this,th,"");S(this,Aa,!1);S(this,fn,null);S(this,nh,!1);S(this,Sa,!1);S(this,ui,!1);S(this,Os,null);S(this,ml,0);S(this,yl,0);S(this,On,null);S(this,xa,null);q(this,"_editToolbar",null);q(this,"_initialOptions",Object.create(null));q(this,"_initialData",null);q(this,"_isVisible",!0);q(this,"_uiManager",null);q(this,"_focusEventsAllowed",!0);S(this,sh,!1);S(this,dp,se._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=se.prototype._resizeWithKeyboard,t=vo.TRANSLATE_SMALL,s=vo.TRANSLATE_BIG;return ae(this,"_resizerKeyboardManager",new hd([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],se.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ae(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Hk({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(se._l10n??(se._l10n=e),se._l10nResizer||(se._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),se._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);se._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){be("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,sh)}set _isDraggable(e){var t;m(this,sh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,dp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):x(this,Y,Hc).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,Aa)?m(this,Aa,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){x(this,Y,Ym).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,fn)||m(this,fn,[this.x,this.y,this.width,this.height]),x(this,Y,Ym).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,fn)||m(this,fn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,u]=this.getBaseTranslation();a+=c,o+=u;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,fn)&&(l(this,fn)[0]!==this.x||l(this,fn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,fn)&&(l(this,fn)[2]!==this.width||l(this,fn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=se,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-c,a));break;case 90:r=Math.max(0,Math.min(s-c,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(c,a));break;case 270:r=Math.min(s,Math.max(c,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[u,h]=this.getBaseTranslation();r+=u,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return x(s=se,ih,Km).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return x(s=se,ih,Km).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,va)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,va)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!l(this,va)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Pe))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,Sa)?this._editToolbar:(this._editToolbar=new jm(this),this.div.append(this._editToolbar.render()),l(this,Pe)&&await this._editToolbar.addAltText(l(this,Pe)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Pe))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Pe)||(Qf.initialize(se._l10n),m(this,Pe,new Qf(this)),l(this,ya)&&(l(this,Pe).data=l(this,ya),m(this,ya,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Pe))==null?void 0:e.data}set altTextData(e){l(this,Pe)&&(l(this,Pe).data=e)}get guessedAltText(){var e;return(e=l(this,Pe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Pe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Pe))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Pe)&&!l(this,Pe).isEmpty()}hasAltTextData(){var e;return((e=l(this,Pe))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,gl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),x(this,Y,ey).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),Kf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,xa)||m(this,xa,new Jf({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:x(this,Y,Qx).bind(this),onPinching:x(this,Y,Jx).bind(this),onPinchEnd:x(this,Y,Zx).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Gt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(m(this,Aa,!0),this._isDraggable){x(this,Y,eb).call(this,e);return}x(this,Y,Zm).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,Os)&&clearTimeout(l(this,Os)),m(this,Os,setTimeout(()=>{var e;m(this,Os,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,u=e/i,h=t/i,d=this.x*r,f=this.y*a,p=this.width*r,y=this.height*a;switch(s){case 0:return[d+u+o,a-f-h-y+c,d+u+p+o,a-f-h+c];case 90:return[d+h+o,a-f+u+c,d+h+y+o,a-f+u+p+c];case 180:return[d-u-p+o,a-f+h+c,d-u+o,a-f+h+y+c];case 270:return[d-h-y+o,a-f-u-p+c,d-h+o,a-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,o,c];case 90:return[s,t-i,c,o];case 180:return[r,t-i,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){m(this,Sa,!0)}disableEditMode(){m(this,Sa,!1)}isInEditMode(){return l(this,Sa)}shouldGetKeyboardEvents(){return l(this,ui)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){x(this,Y,ey).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){be("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,m(i,ya,e.accessibilityData);const[r,a]=i.pageDimensions,[o,c,u,h]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=c/a,i.width=u/r,i.height=h/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,ar))==null||e.abort(),m(this,ar,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,Os)&&(clearTimeout(l(this,Os)),m(this,Os,null)),x(this,Y,Hc).call(this),this.removeEditToolbar(),l(this,On)){for(const s of l(this,On).values())clearTimeout(s);m(this,On,null)}this.parent=null,(t=l(this,xa))==null||t.destroy(),m(this,xa,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,Y,Yx).call(this),l(this,mt).classList.remove("hidden"),Kf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,ci,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,mt).children;if(!l(this,rs)){m(this,rs,Array.from(t));const a=x(this,Y,tb).bind(this),o=x(this,Y,nb).bind(this),c=this._uiManager._signal;for(const u of l(this,rs)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",x(this,Y,sb).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",se._l10nResizer[h])}}const s=l(this,rs)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,rs).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)l(this,mt).append(l(this,mt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)l(this,mt).firstChild.before(l(this,mt).lastChild);let a=0;for(const o of t){const u=l(this,rs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",se._l10nResizer[u])}}x(this,Y,ty).call(this,0),m(this,ui,!0),l(this,mt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,ui)&&x(this,Y,Jm).call(this,l(this,th),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){x(this,Y,Hc).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Pe))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=l(this,mt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Pe))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,nh)}set isEditing(e){m(this,nh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){m(this,va,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,On)||m(this,On,new Map);const{action:s}=e;let i=l(this,On).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,On).delete(s),l(this,On).size===0&&m(this,On,null)},se._telemetryTimeout),l(this,On).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,gl,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,gl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};ya=new WeakMap,rs=new WeakMap,Pe=new WeakMap,gl=new WeakMap,rr=new WeakMap,eh=new WeakMap,va=new WeakMap,mt=new WeakMap,wa=new WeakMap,ci=new WeakMap,ar=new WeakMap,th=new WeakMap,Aa=new WeakMap,fn=new WeakMap,nh=new WeakMap,Sa=new WeakMap,ui=new WeakMap,Os=new WeakMap,ml=new WeakMap,yl=new WeakMap,On=new WeakMap,xa=new WeakMap,sh=new WeakMap,dp=new WeakMap,Y=new WeakSet,Ym=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},ih=new WeakSet,Km=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},ef=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Yx=function(){if(l(this,mt))return;m(this,mt,document.createElement("div")),l(this,mt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,mt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",x(this,Y,Kx).bind(this,s),{signal:t}),i.addEventListener("contextmenu",As,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,mt))},Kx=function(e,t){var h;t.preventDefault();const{isMac:s}=Gt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=l(this,Pe))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,m(this,wa,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,Y,Jm).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Cn,{passive:!1,signal:a}),window.addEventListener("contextmenu",As,{signal:a}),m(this,ci,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=l(this,Pe))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=c,x(this,Y,tf).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},Qm=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},tf=function(){if(!l(this,ci))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,ci);m(this,ci,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===s&&c===i||this.addCommands({cmd:x(this,Y,Qm).bind(this,r,a,o,c),undo:x(this,Y,Qm).bind(this,e,t,s,i),mustExec:!0})},Jm=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,u=se.MIN_SIZE/s,h=se.MIN_SIZE/i,d=x(this,Y,ef).call(this,this.rotation),f=(z,X)=>[d[0]*z+d[2]*X,d[1]*z+d[3]*X],p=x(this,Y,ef).call(this,360-this.rotation),y=(z,X)=>[p[0]*z+p[2]*X,p[1]*z+p[3]*X];let w,_,v=!1,A=!1;switch(e){case"topLeft":v=!0,w=(z,X)=>[0,0],_=(z,X)=>[z,X];break;case"topMiddle":w=(z,X)=>[z/2,0],_=(z,X)=>[z/2,X];break;case"topRight":v=!0,w=(z,X)=>[z,0],_=(z,X)=>[0,X];break;case"middleRight":A=!0,w=(z,X)=>[z,X/2],_=(z,X)=>[0,X/2];break;case"bottomRight":v=!0,w=(z,X)=>[z,X],_=(z,X)=>[0,0];break;case"bottomMiddle":w=(z,X)=>[z/2,X],_=(z,X)=>[z/2,0];break;case"bottomLeft":v=!0,w=(z,X)=>[0,X],_=(z,X)=>[z,0];break;case"middleLeft":A=!0,w=(z,X)=>[0,X/2],_=(z,X)=>[z,X/2];break}const b=w(o,c),E=_(o,c);let C=f(...E);const T=se._round(r+C[0]),k=se._round(a+C[1]);let N=1,L=1,D,O;if(t.fromKeyboard)({deltaX:D,deltaY:O}=t);else{const{screenX:z,screenY:X}=t,[I,V]=l(this,wa);[D,O]=this.screenToPageTranslation(z-I,X-V),l(this,wa)[0]=z,l(this,wa)[1]=X}if([D,O]=y(D/s,O/i),v){const z=Math.hypot(o,c);N=L=Math.max(Math.min(Math.hypot(E[0]-b[0]-D,E[1]-b[1]-O)/z,1/o,1/c),u/o,h/c)}else A?N=Math.max(u,Math.min(1,Math.abs(E[0]-b[0]-D)))/o:L=Math.max(h,Math.min(1,Math.abs(E[1]-b[1]-O)))/c;const j=se._round(o*N),ee=se._round(c*L);C=f(..._(j,ee));const J=T-C[0],ye=k-C[1];l(this,fn)||m(this,fn,[this.x,this.y,this.width,this.height]),this.width=j,this.height=ee,this.x=J,this.y=ye,this.setDims(s*j,i*ee),this.fixAndSetPosition(),this._onResizing()},Qx=function(){var e;m(this,ci,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Pe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Jx=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=x(this,Y,ef).call(this,this.rotation),o=(T,k)=>[a[0]*T+a[2]*k,a[1]*T+a[3]*k],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,p=this.height,y=se.MIN_SIZE/c,w=se.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),y/f,w/p);const _=se._round(f*r),v=se._round(p*r);if(_===f&&v===p)return;l(this,fn)||m(this,fn,[h,d,f,p]);const A=o(f/2,p/2),b=se._round(h+A[0]),E=se._round(d+A[1]),C=o(_/2,v/2);this.x=b-C[0],this.y=E-C[1],this.width=_,this.height=v,this.setDims(c*_,u*v),this.fixAndSetPosition(),this._onResizing()},Zx=function(){var e;(e=l(this,Pe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),x(this,Y,tf).call(this)},Zm=function(e){const{isMac:t}=Gt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},eb=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=u=>{i.abort(),m(this,rr,null),m(this,Aa,!1),this._uiManager.endDragSession()||x(this,Y,Zm).call(this,u),s&&this._onStopDragging()};t&&(m(this,ml,e.clientX),m(this,yl,e.clientY),m(this,rr,e.pointerId),m(this,eh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==l(this,rr)){Cn(u);return}const[p,y]=this.screenToPageTranslation(h-l(this,ml),d-l(this,yl));m(this,ml,h),m(this,yl,d),this._uiManager.dragSelectedEditors(p,y)},a),window.addEventListener("touchmove",Cn,a),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,eh)&&(l(this,xa)||u.isPrimary)&&o(u),Cn(u)},a));const c=u=>{if(!l(this,rr)||l(this,rr)===u.pointerId){o(u);return}Cn(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},ey=function(){if(l(this,ar)||!this.div)return;m(this,ar,new AbortController);const e=this._uiManager.combinedSignal(l(this,ar));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},tb=function(e){se._resizerKeyboardManager.exec(this,e)},nb=function(e){var t;l(this,ui)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,mt)&&x(this,Y,Hc).call(this)},sb=function(e){m(this,th,l(this,ui)?e:"")},ty=function(e){if(l(this,rs))for(const t of l(this,rs))t.tabIndex=e},Hc=function(){m(this,ui,!1),x(this,Y,ty).call(this,-1),x(this,Y,tf).call(this)},S(se,ih),q(se,"_l10n",null),q(se,"_l10nResizer",null),q(se,"_borderLineWidth",-1),q(se,"_colorManager",new Hm),q(se,"_zIndex",1),q(se,"_telemetryTimeout",1e3);let je=se;class Hk extends je{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Dw=3285377520,In=4294901760,Cs=65535;class ib{constructor(e){this.h1=e?e&4294967295:Dw,this.h2=e?e&4294967295:Dw}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let w=0,_=e.length;w<_;w++){const v=e.charCodeAt(w);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,p=d&Cs,y=f&Cs;for(let w=0;w<i;w++)w&1?(o=a[w],o=o*d&In|o*p&Cs,o=o<<15|o>>>17,o=o*f&In|o*y&Cs,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[w],c=c*d&In|c*p&Cs,c=c<<15|c>>>17,c=c*f&In|c*y&Cs,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*d&In|o*p&Cs,o=o<<15|o>>>17,o=o*f&In|o*y&Cs,i&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&In|e*36045&Cs,t=t*4283543511&In|((t<<16|e>>>16)*2950163797&In)>>>16,e^=t>>>1,e=e*444984403&In|e*60499&Cs,t=t*3301882366&In|((t<<16|e>>>16)*3120437893&In)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ny=Object.freeze({map:null,hash:"",transfer:void 0});var ba,_a,lt,fp,rb;class Jv{constructor(){S(this,fp);S(this,ba,!1);S(this,_a,null);S(this,lt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,lt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,lt).get(e)}remove(e){if(l(this,lt).delete(e),l(this,lt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,lt).values())if(t instanceof je)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,lt).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,l(this,lt).set(e,t);i&&x(this,fp,rb).call(this),t instanceof je&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,lt).has(e)}getAll(){return l(this,lt).size>0?Gv(l(this,lt)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return l(this,lt).size}resetModified(){l(this,ba)&&(m(this,ba,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ab(this)}get serializable(){if(l(this,lt).size===0)return ny;const e=new Map,t=new ib,s=[],i=Object.create(null);let r=!1;for(const[a,o]of l(this,lt)){const c=o instanceof je?o.serialize(!1,i):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:ny}get editorStats(){let e=null;const t=new Map;for(const s of l(this,lt).values()){if(!(s instanceof je))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){m(this,_a,null)}get modifiedIds(){if(l(this,_a))return l(this,_a);const e=[];for(const t of l(this,lt).values())!(t instanceof je)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return m(this,_a,{ids:new Set(e),hash:e.join(",")})}}ba=new WeakMap,_a=new WeakMap,lt=new WeakMap,fp=new WeakSet,rb=function(){l(this,ba)||(m(this,ba,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var rh;class ab extends Jv{constructor(t){super();S(this,rh);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);m(this,rh,{map:a,hash:i,transfer:r})}get print(){be("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,rh)}get modifiedIds(){return ae(this,"modifiedIds",{ids:new Set,hash:""})}}rh=new WeakMap;var vl;class Uk{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){S(this,vl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,vl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,vl).has(e.loadedName))){if(Ye(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),l(this,vl).add(s),t==null||t(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}be("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ne(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ae(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Ft||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ae(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ye(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ae(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,T,k){const N=E.substring(0,C),L=E.substring(C+T);return N+k+L}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function h(E,C){if(++u>30){ne("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,E,C))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const y=16,w=1482184792;let _=s(f,y);for(r=0,a=d.length-3;r<a;r+=4)_=_-w+s(d,r)|0;r<d.length&&(_=_-w+s(d+"XXX",r)|0),f=i(f,y,4,kk(_));const v=`url(data:font/opentype;base64,${btoa(f)});`,A=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(A);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const E of[e.loadedName,d]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,b.append(C)}this._document.body.append(b),h(d,()=>{b.remove(),t.complete()})}}vl=new WeakMap;class $k{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Lk(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){ne(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const Rd={DATA:1,ERROR:2},Xe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Fw(){}function Jt(n){if(n instanceof Br||n instanceof Dm||n instanceof Nu||n instanceof Mw||n instanceof Yf||n instanceof Mg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||be('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Br(n.message);case"InvalidPDFException":return new Dm(n.message);case"MissingPDFException":return new Nu(n.message);case"PasswordException":return new Mw(n.message,n.code);case"UnexpectedResponseException":return new Yf(n.message,n.status);case"UnknownErrorException":return new Mg(n.message,n.details)}return new Mg(n.message,n.toString())}var wl,Yn,ob,lb,cb,nf;class Uc{constructor(e,t,s){S(this,Yn);S(this,wl,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",x(this,Yn,ob).bind(this),{signal:l(this,wl).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:o,stream:Xe.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Ye(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Xe.CANCEL,streamId:r,reason:Jt(u)}),h.promise}},s)}destroy(){var e;(e=l(this,wl))==null||e.abort(),m(this,wl,null)}}wl=new WeakMap,Yn=new WeakSet,ob=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){x(this,Yn,cb).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Rd.DATA)i.resolve(e.data);else if(e.callback===Rd.ERROR)i.reject(Jt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:Rd.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:Rd.ERROR,callbackId:e.callbackId,reason:Jt(a)})});return}if(e.streamId){x(this,Yn,lb).call(this,e);return}t(e.data)},lb=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Xe.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Xe.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Ye(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Xe.ERROR,streamId:t,reason:Jt(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Xe.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Xe.START_COMPLETE,streamId:t,reason:Jt(u)})})},cb=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Xe.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Jt(e.reason));break;case Xe.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Jt(e.reason));break;case Xe.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Xe.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||Fw).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Xe.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Xe.PULL_COMPLETE,streamId:t,reason:Jt(u)})});break;case Xe.ENQUEUE:if(Ye(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Xe.CLOSE:if(Ye(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),x(this,Yn,nf).call(this,a,t);break;case Xe.ERROR:Ye(a,"error should have stream controller"),a.controller.error(Jt(e.reason)),x(this,Yn,nf).call(this,a,t);break;case Xe.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Jt(e.reason)),x(this,Yn,nf).call(this,a,t);break;case Xe.CANCEL:if(!o)break;const c=Jt(e.reason);Promise.try(o.onCancel||Fw,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Xe.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Xe.CANCEL_COMPLETE,streamId:t,reason:Jt(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},nf=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var ah;class ub{constructor({enableHWA:e=!1}){S(this,ah,!1);m(this,ah,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,ah)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){be("Abstract method `_createCanvas` called.")}}ah=new WeakMap;class Vk extends ub{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class hb{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){be("Abstract method `_fetch` called.")}}class db extends hb{async _fetch(e){const t=await Yp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):qp(t)}}class fb{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Ea,Al,hi,di,Rt,Ca,ka,B,Tt,$c,Po,sf,No,pb,sy,Ro,Vc,Wc,iy,Gc;class Wk extends fb{constructor({docId:t,ownerDocument:s=globalThis.document}){super();S(this,B);S(this,Ea);S(this,Al);S(this,hi);S(this,di);S(this,Rt);S(this,Ca);S(this,ka,0);m(this,di,t),m(this,Rt,s)}addFilter(t){if(!t)return"none";let s=l(this,B,Tt).get(t);if(s)return s;const[i,r,a]=x(this,B,sf).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=l(this,B,Tt).get(o),s)return l(this,B,Tt).set(t,s),s;const c=`g_${l(this,di)}_transfer_map_${jt(this,ka)._++}`,u=x(this,B,No).call(this,c);l(this,B,Tt).set(t,u),l(this,B,Tt).set(o,u);const h=x(this,B,Ro).call(this,c);return x(this,B,Wc).call(this,i,r,a,h),u}addHCMFilter(t,s){var y;const i=`${t}-${s}`,r="base";let a=l(this,B,$c).get(r);if((a==null?void 0:a.key)===i||(a?((y=a.filter)==null||y.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},l(this,B,$c).set(r,a)),!t||!s))return a.url;const o=x(this,B,Gc).call(this,t);t=G.makeHexColor(...o);const c=x(this,B,Gc).call(this,s);if(s=G.makeHexColor(...c),l(this,B,Po).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let w=0;w<=255;w++){const _=w/255;u[w]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),d=`g_${l(this,di)}_hcm_filter`,f=a.filter=x(this,B,Ro).call(this,d);x(this,B,Wc).call(this,h,h,h,f),x(this,B,sy).call(this,f);const p=(w,_)=>{const v=o[w]/255,A=c[w]/255,b=new Array(_+1);for(let E=0;E<=_;E++)b[E]=v+E/_*(A-v);return b.join(",")};return x(this,B,Wc).call(this,p(0,5),p(1,5),p(2,5),f),a.url=x(this,B,No).call(this,d),a.url}addAlphaFilter(t){let s=l(this,B,Tt).get(t);if(s)return s;const[i]=x(this,B,sf).call(this,[t]),r=`alpha_${i}`;if(s=l(this,B,Tt).get(r),s)return l(this,B,Tt).set(t,s),s;const a=`g_${l(this,di)}_alpha_map_${jt(this,ka)._++}`,o=x(this,B,No).call(this,a);l(this,B,Tt).set(t,o),l(this,B,Tt).set(r,o);const c=x(this,B,Ro).call(this,a);return x(this,B,iy).call(this,i,c),o}addLuminosityFilter(t){let s=l(this,B,Tt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=x(this,B,sf).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,B,Tt).get(r),s)return l(this,B,Tt).set(t,s),s;const a=`g_${l(this,di)}_luminosity_map_${jt(this,ka)._++}`,o=x(this,B,No).call(this,a);l(this,B,Tt).set(t,o),l(this,B,Tt).set(r,o);const c=x(this,B,Ro).call(this,a);return x(this,B,pb).call(this,c),t&&x(this,B,iy).call(this,i,c),o}addHighlightHCMFilter(t,s,i,r,a){var A;const o=`${s}-${i}-${r}-${a}`;let c=l(this,B,$c).get(t);if((c==null?void 0:c.key)===o||(c?((A=c.filter)==null||A.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,B,$c).set(t,c)),!s||!i))return c.url;const[u,h]=[s,i].map(x(this,B,Gc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,y]=[r,a].map(x(this,B,Gc).bind(this));f<d&&([d,f,p,y]=[f,d,y,p]),l(this,B,Po).style.color="";const w=(b,E,C)=>{const T=new Array(256),k=(f-d)/C,N=b/255,L=(E-b)/(255*C);let D=0;for(let O=0;O<=C;O++){const j=Math.round(d+O*k),ee=N+O*L;for(let J=D;J<=j;J++)T[J]=ee;D=j+1}for(let O=D;O<256;O++)T[O]=T[D-1];return T.join(",")},_=`g_${l(this,di)}_hcm_${t}_filter`,v=c.filter=x(this,B,Ro).call(this,_);return x(this,B,sy).call(this,v),x(this,B,Wc).call(this,w(p[0],y[0],5),w(p[1],y[1],5),w(p[2],y[2],5),v),c.url=x(this,B,No).call(this,_),c.url}destroy(t=!1){var s,i,r,a;t&&((s=l(this,Ca))!=null&&s.size)||((i=l(this,hi))==null||i.parentNode.parentNode.remove(),m(this,hi,null),(r=l(this,Al))==null||r.clear(),m(this,Al,null),(a=l(this,Ca))==null||a.clear(),m(this,Ca,null),m(this,ka,0))}}Ea=new WeakMap,Al=new WeakMap,hi=new WeakMap,di=new WeakMap,Rt=new WeakMap,Ca=new WeakMap,ka=new WeakMap,B=new WeakSet,Tt=function(){return l(this,Al)||m(this,Al,new Map)},$c=function(){return l(this,Ca)||m(this,Ca,new Map)},Po=function(){if(!l(this,hi)){const t=l(this,Rt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Rt).createElementNS(Qs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),m(this,hi,l(this,Rt).createElementNS(Qs,"defs")),t.append(i),i.append(l(this,hi)),l(this,Rt).body.append(t)}return l(this,hi)},sf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,i,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,o[u]=i[u]/255,c[u]=r[u]/255;return[a.join(","),o.join(","),c.join(",")]},No=function(t){if(l(this,Ea)===void 0){m(this,Ea,"");const s=l(this,Rt).URL;s!==l(this,Rt).baseURI&&(Kp(s)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Ea,s.split("#",1)[0]))}return`url(${l(this,Ea)}#${t})`},pb=function(t){const s=l(this,Rt).createElementNS(Qs,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},sy=function(t){const s=l(this,Rt).createElementNS(Qs,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Ro=function(t){const s=l(this,Rt).createElementNS(Qs,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,B,Po).append(s),s},Vc=function(t,s,i){const r=l(this,Rt).createElementNS(Qs,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Wc=function(t,s,i,r){const a=l(this,Rt).createElementNS(Qs,"feComponentTransfer");r.append(a),x(this,B,Vc).call(this,a,"feFuncR",t),x(this,B,Vc).call(this,a,"feFuncG",s),x(this,B,Vc).call(this,a,"feFuncB",i)},iy=function(t,s){const i=l(this,Rt).createElementNS(Qs,"feComponentTransfer");s.append(i),x(this,B,Vc).call(this,i,"feFuncA",t)},Gc=function(t){return l(this,B,Po).style.color=t,Qv(getComputedStyle(l(this,B,Po)).getPropertyValue("color"))};class gb{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){be("Abstract method `_fetch` called.")}}class mb extends gb{async _fetch(e){const t=await Yp(e,"arraybuffer");return new Uint8Array(t)}}Ft&&ne("Please use the `legacy` build in Node.js environments.");async function yb(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class Gk extends fb{}class Xk extends ub{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class qk extends hb{async _fetch(e){return yb(e)}}class Yk extends gb{async _fetch(e){return yb(e)}}const It={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ry(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Zv{getPattern(){be("Abstract method `getPattern` called.")}}class Kk extends Zv{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===It.STROKE||i===It.FILL){const a=t.current.getClippedPathBoundingBox(i,Me(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=G.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),ry(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else ry(e,this._bbox),r=this._createGradient(e);return r}}function Dg(n,e,t,s,i,r,a,o){const c=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=a,a=o,o=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f);const p=(c[t]+e.offsetX)*e.scaleX,y=(c[t+1]+e.offsetY)*e.scaleY,w=(c[s]+e.offsetX)*e.scaleX,_=(c[s+1]+e.offsetY)*e.scaleY,v=(c[i]+e.offsetX)*e.scaleX,A=(c[i+1]+e.offsetY)*e.scaleY;if(y>=A)return;const b=u[r],E=u[r+1],C=u[r+2],T=u[a],k=u[a+1],N=u[a+2],L=u[o],D=u[o+1],O=u[o+2],j=Math.round(y),ee=Math.round(A);let J,ye,z,X,I,V,K,oe;for(let ie=j;ie<=ee;ie++){if(ie<_){const fe=ie<y?0:(y-ie)/(y-_);J=p-(p-w)*fe,ye=b-(b-T)*fe,z=E-(E-k)*fe,X=C-(C-N)*fe}else{let fe;ie>A?fe=1:_===A?fe=0:fe=(_-ie)/(_-A),J=w-(w-v)*fe,ye=T-(T-L)*fe,z=k-(k-D)*fe,X=N-(N-O)*fe}let _e;ie<y?_e=0:ie>A?_e=1:_e=(y-ie)/(y-A),I=p-(p-v)*_e,V=b-(b-L)*_e,K=E-(E-D)*_e,oe=C-(C-O)*_e;const pt=Math.round(Math.min(J,I)),Ln=Math.round(Math.max(J,I));let Ee=d*ie+pt*4;for(let fe=pt;fe<=Ln;fe++)_e=(J-fe)/(J-I),_e<0?_e=0:_e>1&&(_e=1),h[Ee++]=ye-(ye-V)*_e|0,h[Ee++]=z-(z-K)*_e|0,h[Ee++]=X-(X-oe)*_e|0,h[Ee++]=255}}function Qk(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(s.length/o)-1,u=o-1;for(r=0;r<c;r++){let h=r*o;for(let d=0;d<u;d++,h++)Dg(n,t,s[h],s[h+1],s[h+o],i[h],i[h+1],i[h+o]),Dg(n,t,s[h+o+1],s[h+1],s[h+o],i[h+o+1],i[h+1],i[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Dg(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class Jk extends Zv{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),p=u/d,y=h/f,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/p,scaleY:1/y},_=d+2*2,v=f+2*2,A=s.getCanvas("mesh",_,v),b=A.context,E=b.createImageData(d,f);if(t){const T=E.data;for(let k=0,N=T.length;k<N;k+=4)T[k]=t[0],T[k+1]=t[1],T[k+2]=t[2],T[k+3]=255}for(const T of this._figures)Qk(E,T,w);return b.putImageData(E,2,2),{canvas:A.canvas,offsetX:o-2*p,offsetY:c-2*y,scaleX:p,scaleY:y}}getPattern(e,t,s,i){ry(e,this._bbox);let r;if(i===It.SHADING)r=G.singularValueDecompose2dScale(Me(e));else if(r=G.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=G.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===It.SHADING?null:this._background,t.cachedCanvases);return i!==It.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Zk extends Zv{getPattern(){return"hotpink"}}function eT(n){switch(n[0]){case"RadialAxial":return new Kk(n);case"Mesh":return new Jk(n);case"Dummy":return new Zk}throw new Error(`Unknown IR type: ${n[0]}`)}const Ow={COLORED:1,UNCOLORED:2},pp=class pp{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Xp("TilingType: "+r);const h=t[0],d=t[1],f=t[2],p=t[3],y=f-h,w=p-d,_=G.singularValueDecompose2dScale(this.matrix),v=G.singularValueDecompose2dScale(this.baseTransform),A=_[0]*v[0],b=_[1]*v[1];let E=y,C=w,T=!1,k=!1;const N=Math.ceil(c*A),L=Math.ceil(u*b),D=Math.ceil(y*A),O=Math.ceil(w*b);N>=D?E=c:T=!0,L>=O?C=u:k=!0;const j=this.getSizeAndScale(E,this.ctx.canvas.width,A),ee=this.getSizeAndScale(C,this.ctx.canvas.height,b),J=e.cachedCanvases.getCanvas("pattern",j.size,ee.size),ye=J.context,z=o.createCanvasGraphics(ye);if(z.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(z,i,a),ye.translate(-j.scale*h,-ee.scale*d),z.transform(j.scale,0,0,ee.scale,0,0),ye.save(),this.clipBbox(z,h,d,f,p),z.baseTransform=Me(z.ctx),z.executeOperatorList(s),z.endDrawing(),ye.restore(),T||k){const X=J.canvas;T&&(E=c),k&&(C=u);const I=this.getSizeAndScale(E,this.ctx.canvas.width,A),V=this.getSizeAndScale(C,this.ctx.canvas.height,b),K=I.size,oe=V.size,ie=e.cachedCanvases.getCanvas("pattern-workaround",K,oe),_e=ie.context,pt=T?Math.floor(y/c):0,Ln=k?Math.floor(w/u):0;for(let Ee=0;Ee<=pt;Ee++)for(let fe=0;fe<=Ln;fe++)_e.drawImage(X,K*Ee,oe*fe,K,oe,0,0,K,oe);return{canvas:ie.canvas,scaleX:I.scale,scaleY:V.scale,offsetX:h,offsetY:d}}return{canvas:J.canvas,scaleX:j.scale,scaleY:ee.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,s){const i=Math.max(pp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(Me(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case Ow.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Ow.UNCOLORED:const o=G.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new Ck(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==It.SHADING&&(r=G.transform(r,t.baseTransform),this.matrix&&(r=G.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};q(pp,"MAX_PATTERN_SIZE",3e3);let ay=pp;function tT({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Gt.isLittleEndian?4278190080:255,[c,u]=a?[r,o]:[o,r],h=s>>3,d=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let y=0;y<i;y++){for(const _=e+h;e<_;e++){const v=e<f?n[e]:255;t[p++]=v&128?u:c,t[p++]=v&64?u:c,t[p++]=v&32?u:c,t[p++]=v&16?u:c,t[p++]=v&8?u:c,t[p++]=v&4?u:c,t[p++]=v&2?u:c,t[p++]=v&1?u:c}if(d===0)continue;const w=e<f?n[e++]:255;for(let _=0;_<d;_++)t[p++]=w&1<<7-_?u:c}return{srcPos:e,destPos:p}}const jw=16,zw=100,nT=15,Bw=10,Hw=1e3,sn=16;function sT(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,c){e.transform(s,i,r,a,o,c),this.__originalTransform(s,i,r,a,o,c)},n.setTransform=function(s,i,r,a,o,c){e.setTransform(s,i,r,a,o,c),this.__originalSetTransform(s,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class iT{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Md(n,e,t,s,i,r,a,o,c,u){const[h,d,f,p,y,w]=Me(n);if(d===0&&f===0){const A=a*h+y,b=Math.round(A),E=o*p+w,C=Math.round(E),T=(a+c)*h+y,k=Math.abs(Math.round(T)-b)||1,N=(o+u)*p+w,L=Math.abs(Math.round(N)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(p),b,C),n.drawImage(e,t,s,i,r,0,0,k,L),n.setTransform(h,d,f,p,y,w),[k,L]}if(h===0&&p===0){const A=o*f+y,b=Math.round(A),E=a*d+w,C=Math.round(E),T=(o+u)*f+y,k=Math.abs(Math.round(T)-b)||1,N=(a+c)*d+w,L=Math.abs(Math.round(N)-C)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,b,C),n.drawImage(e,t,s,i,r,0,0,L,k),n.setTransform(h,d,f,p,y,w),[L,k]}n.drawImage(e,t,s,i,r,a,o,c,u);const _=Math.hypot(h,d),v=Math.hypot(f,p);return[_*c,v*u]}function rT(n){const{width:e,height:t}=n;if(e>Hw||t>Hw)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,u;const h=e+7&-8;let d=new Uint8Array(h*t),f=0;for(const v of n.data){let A=128;for(;A>0;)d[f++]=v&A?0:255,A>>=1}let p=0;for(f=0,d[f]!==0&&(a[0]=1,++p),c=1;c<e;c++)d[f]!==d[f+1]&&(a[c]=d[f]?2:1,++p),f++;for(d[f]!==0&&(a[c]=2,++p),o=1;o<t;o++){f=o*h,u=o*r,d[f-h]!==d[f]&&(a[u]=d[f]?1:8,++p);let v=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<e;c++)v=(v>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),i[v]&&(a[u+c]=i[v],++p),f++;if(d[f-h]!==d[f]&&(a[u+c]=d[f]?2:4,++p),p>s)return null}for(f=h*(t-1),u=o*r,d[f]!==0&&(a[u]=8,++p),c=1;c<e;c++)d[f]!==d[f+1]&&(a[u+c]=d[f]?4:8,++p),f++;if(d[f]!==0&&(a[u+c]=4,++p),p>s)return null;const y=new Int32Array([0,r,-1,0,-r,0,0,0,1]),w=new Path2D;for(o=0;p&&o<=t;o++){let v=o*r;const A=v+e;for(;v<A&&!a[v];)v++;if(v===A)continue;w.moveTo(v%r,o);const b=v;let E=a[v];do{const C=y[E];do v+=C;while(!a[v]);const T=a[v];T!==5&&T!==10?(E=T,a[v]=0):(E=T&51*E>>4,a[v]&=E>>2|E<<2),w.lineTo(v%r,v/r|0),a[v]||--p}while(b!==v);--o}return d=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(w),v.beginPath(),v.restore()}}class Uw{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=kx,this.textMatrixScale=1,this.fontMatrix=Im,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=kt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=G.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=G.applyTransform(t,e),i=G.applyTransform(t.slice(2),e),r=G.applyTransform([t[0],t[3]],e),a=G.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){G.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,c,u,h){const d=G.bezierBoundingBox(t,s,i,r,a,o,c,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=It.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===It.STROKE){t||be("Stroke bounding box must include transform.");const i=G.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=G.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=It.FILL,t=null){return G.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function $w(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%sn,r=(t-i)/sn,a=i===0?r:r+1,o=n.createImageData(s,sn);let c=0,u;const h=e.data,d=o.data;let f,p,y,w;if(e.kind===Xd.GRAYSCALE_1BPP){const _=h.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),A=v.length,b=s+7>>3,E=4294967295,C=Gt.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(y=f<r?sn:i,u=0,p=0;p<y;p++){const T=_-c;let k=0;const N=T>b?s:T*8-7,L=N&-8;let D=0,O=0;for(;k<L;k+=8)O=h[c++],v[u++]=O&128?E:C,v[u++]=O&64?E:C,v[u++]=O&32?E:C,v[u++]=O&16?E:C,v[u++]=O&8?E:C,v[u++]=O&4?E:C,v[u++]=O&2?E:C,v[u++]=O&1?E:C;for(;k<N;k++)D===0&&(O=h[c++],D=128),v[u++]=O&D?E:C,D>>=1}for(;u<A;)v[u++]=0;n.putImageData(o,0,f*sn)}}else if(e.kind===Xd.RGBA_32BPP){for(p=0,w=s*sn*4,f=0;f<r;f++)d.set(h.subarray(c,c+w)),c+=w,n.putImageData(o,0,p),p+=sn;f<a&&(w=s*i*4,d.set(h.subarray(c,c+w)),n.putImageData(o,0,p))}else if(e.kind===Xd.RGB_24BPP)for(y=sn,w=s*y,f=0;f<a;f++){for(f>=r&&(y=i,w=s*y),u=0,p=w;p--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;n.putImageData(o,0,f*sn)}else throw new Error(`bad image kind: ${e.kind}`)}function Vw(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%sn,r=(t-i)/sn,a=i===0?r:r+1,o=n.createImageData(s,sn);let c=0;const u=e.data,h=o.data;for(let d=0;d<a;d++){const f=d<r?sn:i;({srcPos:c}=tT({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),n.putImageData(o,0,d*sn)}}function Rc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Ld(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Ft){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Ww(n,e){if(e)return!0;const t=G.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Hr.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const aT=["butt","round","square"],oT=["miter","round","bevel"],lT={},Gw={};var Ss,oy,ly,cy;const a0=class a0{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},c,u){S(this,Ss);this.ctx=e,this.current=new Uw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new iT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Me(this.compositeCtx))}this.ctx.save(),Ld(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Me(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const u=c-o>Bw&&typeof s=="function",h=u?Date.now()+nT:0;let d=0;const f=this.commonObjs,p=this.objs;let y;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(y=a[o],y!==ts.dependency)this[y].apply(this,r[o]);else for(const w of r[o]){const _=w.startsWith("g_")?f:p;if(!_.has(w))return _.get(w,s),o}if(o++,o===c)return o;if(u&&++d>Bw){if(Date.now()>h)return s(),o;d=0}}}endDrawing(){x(this,Ss,oy).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),x(this,Ss,ly).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,c=i,u="prescale1",h,d;for(;r>2&&o>1||a>2&&c>1;){let f=o,p=c;r>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/f),a>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/p),h=this.cachedCanvases.getCanvas(u,f,p),d=h.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,o,c,0,0,f,p),e=h.canvas,o=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=Me(t);let c,u,h,d;if((e.bitmap||e.data)&&e.count>1){const N=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(N),c||(c=new Map,this._cachedBitmapsMap.set(N,c));const L=c.get(u);if(L&&!a){const D=Math.round(Math.min(o[0],o[2])+o[4]),O=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:L,offsetX:D,offsetY:O}}h=L}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,i),Vw(d.context,e));let f=G.transform(o,[1/s,0,0,-1/i,0,0]);f=G.transform(f,[1,0,0,1,0,-i]);const[p,y,w,_]=G.getAxialAlignedBoundingBox([0,0,s,i],f),v=Math.round(w-p)||1,A=Math.round(_-y)||1,b=this.cachedCanvases.getCanvas("fillCanvas",v,A),E=b.context,C=p,T=y;E.translate(-C,-T),E.transform(...f),h||(h=this._scaleImage(d.canvas,Es(E)),h=h.img,c&&a&&c.set(u,h)),E.imageSmoothingEnabled=Ww(Me(E),e.interpolate),Md(E,h,0,0,h.width,h.height,0,0,s,i),E.globalCompositeOperation="source-in";const k=G.transform(Es(E),[1,0,0,1,-C,-T]);return E.fillStyle=a?r.getPattern(t,this,k,It.FILL):r,E.fillRect(0,0,s,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,b.canvas)),{canvas:b.canvas,offsetX:Math.round(C),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=aT[e]}setLineJoin(e){this.ctx.lineJoin=oT[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Me(this.suspendedCtx)),Rc(this.suspendedCtx,r),sT(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,c=i[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,s,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,c,u,h,d){let f=e.canvas,p=c-h,y=u-d;if(a){const _=G.makeHexColor(...a);if(p<0||y<0||p+s>f.width||y+i>f.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),A=v.context;A.drawImage(f,-p,-y),A.globalCompositeOperation="destination-atop",A.fillStyle=_,A.fillRect(0,0,s,i),A.globalCompositeOperation="source-over",f=v.canvas,p=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(p,y,s,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=_,e.fillRect(p,y,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(c,u,s,i),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(f,p,y,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode?(Rc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,c,u;const h=Me(i),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?s.slice(0):null;for(let p=0,y=0,w=e.length;p<w;p++)switch(e[p]|0){case ts.rectangle:a=t[y++],o=t[y++];const _=t[y++],v=t[y++],A=a+_,b=o+v;i.moveTo(a,o),_===0||v===0?i.lineTo(A,b):(i.lineTo(A,o),i.lineTo(A,b),i.lineTo(a,b)),d||r.updateRectMinMax(h,[a,o,A,b]),i.closePath();break;case ts.moveTo:a=t[y++],o=t[y++],i.moveTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ts.lineTo:a=t[y++],o=t[y++],i.lineTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ts.curveTo:c=a,u=o,a=t[y+4],o=t[y+5],i.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],a,o),r.updateCurvePathMinMax(h,c,u,t[y],t[y+1],t[y+2],t[y+3],a,o,f),y+=6;break;case ts.curveTo2:c=a,u=o,i.bezierCurveTo(a,o,t[y],t[y+1],t[y+2],t[y+3]),r.updateCurvePathMinMax(h,c,u,a,o,t[y],t[y+1],t[y+2],t[y+3],f),a=t[y+2],o=t[y+3],y+=4;break;case ts.curveTo3:c=a,u=o,a=t[y+2],o=t[y+3],i.bezierCurveTo(t[y],t[y+1],a,o,a,o),r.updateCurvePathMinMax(h,c,u,t[y],t[y+1],a,o,a,o,f),y+=4;break;case ts.closePath:i.closePath();break}d&&r.updateScalingPathMinMax(h,f),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Es(t),It.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Es(t),It.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=lT}eoClip(){this.pendingClip=Gw}beginText(){this.current.textMatrix=kx,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(c,-c));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Im,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const c=s.italic?"italic":"normal";let u=t;t<jw?u=jw:t>zw&&(u=zw),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=u&kt.FILL_STROKE_MASK,f=!!(u&kt.ADD_TO_PATH_FLAG),p=o.patternFill&&!c.missingFile,y=o.patternStroke&&!c.missingFile;let w;if((c.disableFontFace||f||p||y)&&(w=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||y){if(a.save(),a.translate(t,s),a.scale(h,-h),d===kt.FILL||d===kt.FILL_STROKE)if(i){const _=a.getTransform();a.setTransform(...i),a.fill(x(this,Ss,cy).call(this,w,_,i))}else a.fill(w);if(d===kt.STROKE||d===kt.FILL_STROKE)if(r){const _=a.getTransform();a.setTransform(...r),a.stroke(x(this,Ss,cy).call(this,w,_,r))}else a.lineWidth/=h,a.stroke(w);a.restore()}else(d===kt.FILL||d===kt.FILL_STROKE)&&a.fillText(e,t,s),(d===kt.STROKE||d===kt.FILL_STROKE)&&a.strokeText(e,t,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Me(a),x:t,y:s,fontSize:h,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ae(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,f=s.vertical,p=f?1:-1,y=s.defaultVMetrics,w=i*t.fontMatrix[0],_=t.textRenderingMode===kt.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let v,A;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,Es(r),It.FILL);v=Me(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,Es(r),It.STROKE);A=Me(r),r.restore(),r.strokeStyle=k}let b=t.lineWidth;const E=t.textMatrixScale;if(E===0||b===0){const k=t.textRenderingMode&kt.FILL_STROKE_MASK;(k===kt.STROKE||k===kt.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=E;if(a!==1&&(r.scale(a,a),b/=a),r.lineWidth=b,s.isInvalidPDFjsFont){const k=[];let N=0;for(const L of e)k.push(L.unicode),N+=L.width;r.fillText(k.join(""),0,0),t.x+=N*w*h,r.restore(),this.compose();return}let C=0,T;for(T=0;T<d;++T){const k=e[T];if(typeof k=="number"){C+=p*k*i/1e3;continue}let N=!1;const L=(k.isSpace?c:0)+o,D=k.fontChar,O=k.accent;let j,ee,J=k.width;if(f){const z=k.vmetric||y,X=-(k.vmetric?z[1]:J*.5)*w,I=z[2]*w;J=z?-z[0]:J,j=X/a,ee=(C+I)/a}else j=C/a,ee=0;if(s.remeasure&&J>0){const z=r.measureText(D).width*1e3/i*a;if(J<z&&this.isFontSubpixelAAEnabled){const X=J/z;N=!0,r.save(),r.scale(X,1),j/=X}else J!==z&&(j+=(J-z)/2e3*i/a)}if(this.contentVisible&&(k.isInFont||s.missingFile)){if(_&&!O)r.fillText(D,j,ee);else if(this.paintChar(D,j,ee,v,A),O){const z=j+i*O.offset.x/a,X=ee-i*O.offset.y/a;this.paintChar(O.fontChar,z,X,v,A)}}const ye=f?J*w-L*u:J*w+L*u;C+=ye,N&&r.restore()}f?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||Im,f=e.length,p=s.textRenderingMode===kt.INVISIBLE;let y,w,_,v;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),y=0;y<f;++y){if(w=e[y],typeof w=="number"){v=o*w*r/1e3,this.ctx.translate(v,0),s.x+=v*h;continue}const A=(w.isSpace?u:0)+c,b=i.charProcOperatorList[w.operatorListId];if(!b){ne(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(r,r),t.transform(...d),this.executeOperatorList(b),this.restore()),_=G.applyTransform([w.width,0],d)[0]*r+A,t.translate(_,0),s.x+=_*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||Me(this.ctx),r={createCanvasGraphics:a=>new a0(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ay(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=G.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=G.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=eT(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Es(t),It.SHADING);const i=Es(t);if(i){const{width:r,height:a}=t.canvas,[o,c,u,h]=G.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,c,u-o,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){be("Should not call beginInlineImage")}beginImageData(){be("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Me(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(Me(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Xp("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const s=Me(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=G.getAxialAlignedBoundingBox(e.bbox,Me(t));const r=[0,0,t.canvas.width,t.canvas.height];i=G.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-a,-o),f.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Rc(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Me(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=G.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(x(this,Ss,oy).call(this),Ld(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,u]=G.singularValueDecompose2dScale(Me(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),f=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,o*u),Ld(this.ctx)}else Ld(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Uw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),x(this,Ss,ly).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=rT(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=Me(o);o.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=a.length;h<d;h+=2){const f=G.transform(c,[t,s,i,r,a[h],a[h+1]]),[p,y]=G.applyTransform([0,0],f);o.drawImage(u.canvas,p,y)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),d=h.context;d.save();const f=this.getObject(a,r);Vw(d,f),d.globalCompositeOperation="source-in",d.fillStyle=i?s.getPattern(d,this,Es(t),It.FILL):s,d.fillRect(0,0,o,c),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),Md(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ne("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let u=0,h=i.length;u<h;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Ft){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,s).context;$w(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,Es(i));i.imageSmoothingEnabled=Ww(Me(i),e.interpolate),Md(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;$w(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),Md(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Gw?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Me(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=o=1/c;else{const h=c*e;a=o=h<1?1/h:1}else if(e===0)a=1/c,o=1/u;else{const h=c*e,d=u*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)a=h/c,o=u/c;else{const d=e*c;a=h>d?h/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ss=new WeakSet,oy=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ly=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},cy=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let nl=a0;for(const n in ts)nl.prototype[n]!==void 0&&(nl.prototype[ts[n]]=nl.prototype[n]);var oh,lh;class Pi{static get workerPort(){return l(this,oh)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,oh,e)}static get workerSrc(){return l(this,lh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,lh,e)}}oh=new WeakMap,lh=new WeakMap,S(Pi,oh,null),S(Pi,lh,"");var Ta,ch;class cT{constructor({parsedData:e,rawData:t}){S(this,Ta);S(this,ch);m(this,Ta,e),m(this,ch,t)}getRaw(){return l(this,ch)}get(e){return l(this,Ta).get(e)??null}getAll(){return Gv(l(this,Ta))}has(e){return l(this,Ta).has(e)}}Ta=new WeakMap,ch=new WeakMap;const Mo=Symbol("INTERNAL");var uh,hh,dh,Sl;class uT{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){S(this,uh,!1);S(this,hh,!1);S(this,dh,!1);S(this,Sl,!0);m(this,uh,!!(e&bn.DISPLAY)),m(this,hh,!!(e&bn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,dh))return l(this,Sl);if(!l(this,Sl))return!1;const{print:e,view:t}=this.usage;return l(this,uh)?(t==null?void 0:t.viewState)!=="OFF":l(this,hh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Mo&&be("Internal method `_setVisible` called."),m(this,dh,s),m(this,Sl,t)}}uh=new WeakMap,hh=new WeakMap,dh=new WeakMap,Sl=new WeakMap;var or,we,xl,bl,fh,uy;class hT{constructor(e,t=bn.DISPLAY){S(this,fh);S(this,or,null);S(this,we,new Map);S(this,xl,null);S(this,bl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,bl,e.order);for(const s of e.groups)l(this,we).set(s.id,new uT(t,s));if(e.baseState==="OFF")for(const s of l(this,we).values())s._setVisible(Mo,!1);for(const s of e.on)l(this,we).get(s)._setVisible(Mo,!0);for(const s of e.off)l(this,we).get(s)._setVisible(Mo,!1);m(this,xl,this.getHash())}}isVisible(e){if(l(this,we).size===0)return!0;if(!e)return Xp("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,we).has(e.id)?l(this,we).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return x(this,fh,uy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,we).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,we).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,we).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,we).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,we).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,we).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,we).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,we).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,we).get(e);if(!i){ne(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=l(this,we).get(o))==null||r._setVisible(Mo,!1,!0));i._setVisible(Mo,!!t,!0),m(this,or,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,we).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}m(this,or,null)}get hasInitialVisibility(){return l(this,xl)===null||this.getHash()===l(this,xl)}getOrder(){return l(this,we).size?l(this,bl)?l(this,bl).slice():[...l(this,we).keys()]:null}getGroups(){return l(this,we).size>0?Gv(l(this,we)):null}getGroup(e){return l(this,we).get(e)||null}getHash(){if(l(this,or)!==null)return l(this,or);const e=new ib;for(const[t,s]of l(this,we))e.update(`${t}:${s.visible}`);return m(this,or,e.hexdigest())}}or=new WeakMap,we=new WeakMap,xl=new WeakMap,bl=new WeakMap,fh=new WeakSet,uy=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=x(this,fh,uy).call(this,r);else if(l(this,we).has(r))a=l(this,we).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class dT{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ye(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Ye(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ye(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new fT(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new pT(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class fT{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Yv(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pT{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function gT(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=u(h),r(h)}if(t=a(n),t){const h=u(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),p=qp(d);d=f.decode(p),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function a(h){const d=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(h))!==null;){let[,w,_,v]=f;if(w=parseInt(w,10),w in d){if(w===0)break;continue}d[w]=[_,v]}const y=[];for(let w=0;w<d.length&&w in d;++w){let[_,v]=d[w];v=o(v),_&&(v=unescape(v),w===0&&(v=c(v))),y.push(v)}return y.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),y=h.slice(d+1).replace(/^[^']*'/,"");return i(f,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,y){if(p==="q"||p==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,_){return String.fromCharCode(parseInt(_,16))}),i(f,y);try{y=atob(y)}catch{}return i(f,y)})}return""}function vb(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Qp(n){try{return new URL(n).origin}catch{}return null}function wb({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Ab(n){const e=n.get("Content-Disposition");if(e){let t=gT(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Yv(t))return t}return null}function Jp(n,e){return n===404||n===0&&e.startsWith("file:")?new Nu('Missing PDF "'+e+'".'):new Yf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function Sb(n){return n===200||n===206}function xb(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function bb(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Xw{constructor(e){q(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=vb(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new mT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new yT(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class mT{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,xb(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Qp(r.url),!Sb(r.status))throw Jp(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=wb({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=Ab(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Br("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:bb(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class yT{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,xb(r,this._withCredentials,this._abortController)).then(o=>{const c=Qp(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!Sb(o.status))throw Jp(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:bb(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Fg=200,Og=206;function vT(n){const e=n.response;return typeof e!="string"?e:qp(e).buffer}class wT{constructor({url:e,httpHeaders:t,withCredentials:s}){q(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=vb(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Og):i.expectedStatus=Fg,t.responseType="arraybuffer",Ye(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Fg;if(!(r===Fg&&s.expectedStatus===Og)&&r!==s.expectedStatus){s.onError(i.status);return}const o=vT(i);if(r===Og){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:o}):(ne('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class AT{constructor(e){this._source=e,this._manager=new wT(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ye(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ST(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new xT(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class ST{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Qp(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=wb({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Ab(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Jp(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class xT{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Qp((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Jp(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const bT=/^[a-z][a-z0-9\-+.]+:/i;function _T(n){if(bT.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class ET{constructor(e){this.source=e,this.url=_T(e.url),Ye(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new CT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new kT(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class CT{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Nu(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Br("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class kT{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const TT=1e5,Qt=30,PT=.8;var Zw,lr,tn,ph,gh,Pa,fi,mh,yh,Na,_l,El,cr,Cl,vh,kl,Ra,wh,Ah,Ma,La,Sh,ur,Tl,Bi,_b,Eb,hy,Pn,rf,dy,Cb,kb;const et=class et{constructor({textContentSource:e,container:t,viewport:s}){S(this,Bi);S(this,lr,Promise.withResolvers());S(this,tn,null);S(this,ph,!1);S(this,gh,!!((Zw=globalThis.FontInspector)!=null&&Zw.enabled));S(this,Pa,null);S(this,fi,null);S(this,mh,0);S(this,yh,0);S(this,Na,null);S(this,_l,null);S(this,El,0);S(this,cr,0);S(this,Cl,Object.create(null));S(this,vh,[]);S(this,kl,null);S(this,Ra,[]);S(this,wh,new WeakMap);S(this,Ah,null);var c;if(e instanceof ReadableStream)m(this,kl,e);else if(typeof e=="object")m(this,kl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,tn,m(this,_l,t)),m(this,cr,s.scale*(globalThis.devicePixelRatio||1)),m(this,El,s.rotation),m(this,fi,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;m(this,Ah,[1,0,0,-1,-a,o+r]),m(this,yh,i),m(this,mh,r),x(c=et,Pn,Cb).call(c),yo(t,s),l(this,lr).promise.finally(()=>{l(et,Tl).delete(this),m(this,fi,null),m(this,Cl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Gt.platform;return ae(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,Na).read().then(({value:t,done:s})=>{if(s){l(this,lr).resolve();return}l(this,Pa)??m(this,Pa,t.lang),Object.assign(l(this,Cl),t.styles),x(this,Bi,_b).call(this,t.items),e()},l(this,lr).reject)};return m(this,Na,l(this,kl).getReader()),l(et,Tl).add(this),e(),l(this,lr).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==l(this,El)&&(t==null||t(),m(this,El,i),yo(l(this,_l),{rotation:i})),s!==l(this,cr)){t==null||t(),m(this,cr,s);const a={div:null,properties:null,ctx:x(r=et,Pn,rf).call(r,l(this,Pa))};for(const o of l(this,Ra))a.properties=l(this,wh).get(o),a.div=o,x(this,Bi,hy).call(this,a)}}cancel(){var t;const e=new Br("TextLayer task cancelled.");(t=l(this,Na))==null||t.cancel(e).catch(()=>{}),m(this,Na,null),l(this,lr).reject(e)}get textDivs(){return l(this,Ra)}get textContentItemsStr(){return l(this,vh)}static cleanup(){if(!(l(this,Tl).size>0)){l(this,Ma).clear();for(const{canvas:e}of l(this,La).values())e.remove();l(this,La).clear()}}};lr=new WeakMap,tn=new WeakMap,ph=new WeakMap,gh=new WeakMap,Pa=new WeakMap,fi=new WeakMap,mh=new WeakMap,yh=new WeakMap,Na=new WeakMap,_l=new WeakMap,El=new WeakMap,cr=new WeakMap,Cl=new WeakMap,vh=new WeakMap,kl=new WeakMap,Ra=new WeakMap,wh=new WeakMap,Ah=new WeakMap,Ma=new WeakMap,La=new WeakMap,Sh=new WeakMap,ur=new WeakMap,Tl=new WeakMap,Bi=new WeakSet,_b=function(e){var i,r;if(l(this,ph))return;(r=l(this,fi)).ctx??(r.ctx=x(i=et,Pn,rf).call(i,l(this,Pa)));const t=l(this,Ra),s=l(this,vh);for(const a of e){if(t.length>TT){ne("Ignoring additional textDivs for performance reasons."),m(this,ph,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,tn);m(this,tn,document.createElement("span")),l(this,tn).classList.add("markedContent"),a.id!==null&&l(this,tn).setAttribute("id",`${a.id}`),o.append(l(this,tn))}else a.type==="endMarkedContent"&&m(this,tn,l(this,tn).parentNode);continue}s.push(a.str),x(this,Bi,Eb).call(this,a)}},Eb=function(e){var w;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ra).push(t);const i=G.transform(l(this,Ah),e.transform);let r=Math.atan2(i[1],i[0]);const a=l(this,Cl)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,gh)&&a.fontSubstitution||a.fontFamily;o=et.fontFamilyMap.get(o)||o;const c=Math.hypot(i[2],i[3]),u=c*x(w=et,Pn,kb).call(w,o,l(this,Pa));let h,d;r===0?(h=i[4],d=i[5]-u):(h=i[4]+u*Math.sin(r),d=i[5]-u*Math.cos(r));const f="calc(var(--scale-factor)*",p=t.style;l(this,tn)===l(this,_l)?(p.left=`${(100*h/l(this,yh)).toFixed(2)}%`,p.top=`${(100*d/l(this,mh)).toFixed(2)}%`):(p.left=`${f}${h.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(l(et,ur)*c).toFixed(2)}px)`,p.fontFamily=o,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,gh)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);_!==v&&Math.max(_,v)/Math.min(_,v)>1.5&&(y=!0)}if(y&&(s.canvasWidth=a.vertical?e.height:e.width),l(this,wh).set(t,s),l(this,fi).div=t,l(this,fi).properties=s,x(this,Bi,hy).call(this,l(this,fi)),s.hasText&&l(this,tn).append(t),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),l(this,tn).append(_)}},hy=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(l(et,ur)>1&&(a=`scale(${1/l(et,ur)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;x(o=et,Pn,dy).call(o,i,h*l(this,cr),c);const{width:d}=i.measureText(t.textContent);d>0&&(a=`scaleX(${u*l(this,cr)/d}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Pn=new WeakSet,rf=function(e=null){let t=l(this,La).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,La).set(e,t),l(this,Sh).set(t,{size:0,family:""})}return t},dy=function(e,t,s){const i=l(this,Sh).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},Cb=function(){if(l(this,ur)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,ur,e.getBoundingClientRect().height),e.remove()},kb=function(e,t){const s=l(this,Ma).get(e);if(s)return s;const i=x(this,Pn,rf).call(this,t);i.canvas.width=i.canvas.height=Qt,x(this,Pn,dy).call(this,i,Qt,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return l(this,Ma).set(e,h),i.canvas.width=i.canvas.height=0,h}i.strokeStyle="red",i.clearRect(0,0,Qt,Qt),i.strokeText("g",0,0);let c=i.getImageData(0,0,Qt,Qt).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/Qt);break}i.clearRect(0,0,Qt,Qt),i.strokeText("A",0,Qt),c=i.getImageData(0,0,Qt,Qt).data,a=0;for(let h=0,d=c.length;h<d;h+=4)if(c[h]>0){a=Qt-Math.floor(h/4/Qt);break}i.canvas.width=i.canvas.height=0;const u=a?a/(a+o):PT;return l(this,Ma).set(e,u),u},S(et,Pn),S(et,Ma,new Map),S(et,La,new Map),S(et,Sh,new WeakMap),S(et,ur,null),S(et,Tl,new Set);let Ru=et;class Mu{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Mu.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const NT=65536,RT=100,MT=5e3,LT=Ft?Xk:Vk,IT=Ft?qk:db,DT=Ft?Gk:Wk,FT=Ft?Yk:mb;function OT(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new fy,{docId:t}=e,s=n.url?jT(n.url):null,i=n.data?zT(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof Tb?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:NT;let h=n.worker instanceof sl?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Kp(n.docBaseUrl)?n.docBaseUrl:null,p=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,w=n.CMapReaderFactory||IT,_=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||FT,A=n.stopAtErrors!==!0,b=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ft,T=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ft&&(Gt.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ft,L=n.fontExtraProperties===!0,D=n.enableXfa===!0,O=n.ownerDocument||globalThis.document,j=n.disableRange===!0,ee=n.disableStream===!0,J=n.disableAutoFetch===!0,ye=n.pdfBug===!0,z=n.CanvasFactory||LT,X=n.FilterFactory||DT,I=n.enableHWA===!0,V=c?c.length:n.length??NaN,K=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ft&&!N,oe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:w===db&&v===mb&&p&&_&&jc(p,document.baseURI)&&jc(_,document.baseURI),ie=null;xk(d);const _e={canvasFactory:new z({ownerDocument:O,enableHWA:I}),filterFactory:new X({docId:t,ownerDocument:O}),cMapReaderFactory:oe?null:new w({baseUrl:p,isCompressed:y}),standardFontDataFactory:oe?null:new v({baseUrl:_})};if(!h){const Ee={verbosity:d,port:Pi.workerPort};h=Ee.port?sl.fromPort(Ee):new sl(Ee),e._worker=h}const pt={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:J,rangeChunkSize:u,length:V,docBaseUrl:f,enableXfa:D,evaluatorOptions:{maxImageSize:b,disableFontFace:N,ignoreErrors:A,isEvalSupported:E,isOffscreenCanvasSupported:C,isImageDecoderSupported:T,canvasMaxAreaInBytes:k,fontExtraProperties:L,useSystemFonts:K,cMapUrl:oe?p:null,standardFontDataUrl:oe?_:null}},Ln={disableFontFace:N,fontExtraProperties:L,ownerDocument:O,pdfBug:ye,styleElement:ie,loadingParams:{disableAutoFetch:J,enableXfa:D}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ee=h.messageHandler.sendWithPromise("GetDocRequest",pt,i?[i.buffer]:null);let fe;if(c)fe=new dT(c,{disableRange:j,disableStream:ee});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Ks;if(Ft)if(jc(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Ks=Xw}else Ks=ET;else Ks=jc(s)?Xw:AT;fe=new Ks({url:s,length:V,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:j,disableStream:ee})}return Ee.then(Ks=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Co=new Uc(t,Ks,h.port),Ac=new $T(Co,e,fe,Ln,_e);e._transport=Ac,Co.send("Ready",null)})}).catch(e._capability.reject),e}function jT(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Ft&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function zT(n){if(Ft&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return qp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function qw(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var gp;const mp=class mp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${jt(mp,gp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};gp=new WeakMap,S(mp,gp,0);let fy=mp;class Tb{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){be("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class BT{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var hr,pi,Vn,Lo,af;class HT{constructor(e,t,s,i=!1){S(this,Vn);S(this,hr,null);S(this,pi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Iw:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Pb,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new ud({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=qi.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const f=this._transport.getRenderingIntent(s,i,h,d),{renderingIntent:p,cacheKey:y}=f;m(this,pi,!1),x(this,Vn,af).call(this),o||(o=this._transport.getOptionalContentConfig(p));let w=this._intentStates.get(y);w||(w=Object.create(null),this._intentStates.set(y,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const _=!!(p&bn.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(f));const v=T=>{var k;w.renderTasks.delete(A),(this._maybeCleanupAfterRender||_)&&m(this,pi,!0),x(this,Vn,Lo).call(this,!_),T?(A.capability.reject(T),this._abortOperatorList({intentState:w,reason:T instanceof Error?T:new Error(T)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new gy({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:u});(w.renderTasks||(w.renderTasks=new Set)).add(A);const b=A.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([T,k])=>{var N;if(this.destroyed){v();return}if((N=this._stats)==null||N.time("Rendering"),!(k.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:T,optionalContentConfig:k}),A.operatorListChanged()}).catch(v),b}getOperatorList({intent:e="display",annotationMode:t=qi.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Mu.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:u}){if(u){s(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,pi,!1),x(this,Vn,af).call(this),Promise.all(e)}cleanup(e=!1){m(this,pi,!0);const t=x(this,Vn,Lo).call(this,!1);return e&&t&&this._stats&&(this._stats=new Iw),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&x(this,Vn,Lo).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();x(this,Vn,Lo).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof qv){let i=RT;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Br(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}hr=new WeakMap,pi=new WeakMap,Vn=new WeakSet,Lo=function(e=!1){if(x(this,Vn,af).call(this),!l(this,pi)||this.destroyed)return!1;if(e)return m(this,hr,setTimeout(()=>{m(this,hr,null),x(this,Vn,Lo).call(this,!1)},MT)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,pi,!1),!0},af=function(){l(this,hr)&&(clearTimeout(l(this,hr)),m(this,hr,null))};var gi,yp;class UT{constructor(){S(this,gi,new Map);S(this,yp,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,yp).then(()=>{for(const[i]of l(this,gi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,gi).set(t,i)}removeEventListener(e,t){const s=l(this,gi).get(t);s==null||s(),l(this,gi).delete(t)}terminate(){for(const[,e]of l(this,gi))e==null||e();l(this,gi).clear()}}gi=new WeakMap,yp=new WeakMap;var vp,Ia,Da,Pl,of,Nl,lf;const Re=class Re{constructor({name:e=null,port:t=null,verbosity:s=bk()}={}){S(this,Pl);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=l(Re,Da))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(Re,Da)||m(Re,Da,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Uc("main","worker",e),this._messageHandler.on("ready",function(){}),x(this,Pl,of).call(this)}_initialize(){if(l(Re,Ia)||l(Re,Nl,lf)){this._setupFakeWorker();return}let{workerSrc:e}=Re;try{Re._isSameOrigin(window.location.href,e)||(e=Re._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Uc("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,x(this,Pl,of).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Xp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Re,Ia)||(ne("Setting up fake worker."),m(Re,Ia,!0)),Re._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new UT;this._port=t;const s=`fake${jt(Re,vp)._++}`,i=new Uc(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new Uc(s,s+"_worker",t),x(this,Pl,of).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(Re,Da))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=l(this,Da))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Re(e)}static get workerSrc(){if(Pi.workerSrc)return Pi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ae(this,"_setupFakeWorkerGlobal",(async()=>l(this,Nl,lf)?l(this,Nl,lf):(await import(this.workerSrc)).WorkerMessageHandler)())}};vp=new WeakMap,Ia=new WeakMap,Da=new WeakMap,Pl=new WeakSet,of=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Nl=new WeakSet,lf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},S(Re,Nl),S(Re,vp,0),S(Re,Ia,!1),S(Re,Da),Ft&&(m(Re,Ia,!0),Pi.workerSrc||(Pi.workerSrc="./pdf.worker.mjs")),Re._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},Re._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let sl=Re;var mi,js,Rl,Ml,yi,Fa,Xc;class $T{constructor(e,t,s,i,r){S(this,Fa);S(this,mi,new Map);S(this,js,new Map);S(this,Rl,new Map);S(this,Ml,new Map);S(this,yi,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Pb,this.fontLoader=new Uk({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ae(this,"annotationStorage",new Jv)}getRenderingIntent(e,t=qi.ENABLE,s=null,i=!1,r=!1){let a=bn.DISPLAY,o=ny;switch(e){case"any":a=bn.ANY;break;case"display":break;case"print":a=bn.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=a&bn.PRINT&&s instanceof ab?s:this.annotationStorage;switch(t){case qi.DISABLE:a+=bn.ANNOTATIONS_DISABLE;break;case qi.ENABLE:break;case qi.ENABLE_FORMS:a+=bn.ANNOTATIONS_FORMS;break;case qi.ENABLE_STORAGE:a+=bn.ANNOTATIONS_STORAGE,o=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=bn.IS_EDITING),r&&(a+=bn.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,yi))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,js).values())e.push(i._destroy());l(this,js).clear(),l(this,Rl).clear(),l(this,Ml).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,mi).clear(),this.filterFactory.destroy(),Ru.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Br("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Ye(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Ye(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Ye(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}Ye(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new BT(s,this))}),e.on("DocException",s=>{t._capability.reject(Jt(s))}),e.on("PasswordRequest",s=>{m(this,yi,Promise.withResolvers());try{if(!t.onPassword)throw Jt(s);const i=r=>{r instanceof Error?l(this,yi).reject(r):l(this,yi).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,yi).reject(i)}return l(this,yi).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,js).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const p=r.error;ne(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const h=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,y)=>globalThis.FontInspector.fontAdded(p,y):null,d=new $k(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=r;Ye(f,"The imageRef must be defined.");for(const p of l(this,js).values())for(const[,y]of p.objs)if((y==null?void 0:y.ref)===f)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const o=l(this,js).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>vk&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Rl).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Ml).set(r.refStr,e);const a=new HT(t,r,this,this._params.pdfBug);return l(this,js).set(t,a),a});return l(this,Rl).set(t,i),i}getPageIndex(e){return qw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return x(this,Fa,Xc).call(this,"GetFieldObjects")}hasJSActions(){return x(this,Fa,Xc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return x(this,Fa,Xc).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return x(this,Fa,Xc).call(this,"GetOptionalContentConfig").then(t=>new hT(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,mi).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new cT(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,mi).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,js).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,mi).clear(),this.filterFactory.destroy(!0),Ru.cleanup()}}cachedPageNumber(e){if(!qw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Ml).get(t)??null}}mi=new WeakMap,js=new WeakMap,Rl=new WeakMap,Ml=new WeakMap,yi=new WeakMap,Fa=new WeakSet,Xc=function(e,t=null){const s=l(this,mi).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,mi).set(e,i),i};const Mc=Symbol("INITIAL_DATA");var pn,xh,py;class Pb{constructor(){S(this,xh);S(this,pn,Object.create(null))}get(e,t=null){if(t){const i=x(this,xh,py).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,pn)[e];if(!s||s.data===Mc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,pn)[e];return!!t&&t.data!==Mc}delete(e){const t=l(this,pn)[e];return!t||t.data===Mc?!1:(delete l(this,pn)[e],!0)}resolve(e,t=null){const s=x(this,xh,py).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,pn)){const{data:s}=l(this,pn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,pn,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,pn)){const{data:t}=l(this,pn)[e];t!==Mc&&(yield[e,t])}}}pn=new WeakMap,xh=new WeakSet,py=function(e){var t;return(t=l(this,pn))[e]||(t[e]={...Promise.withResolvers(),data:Mc})};var dr;class VT{constructor(e){S(this,dr,null);m(this,dr,e),this.onContinue=null}get promise(){return l(this,dr).capability.promise}cancel(e=0){l(this,dr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,dr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,dr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}dr=new WeakMap;var fr,Oa;const ta=class ta{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){S(this,fr,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new VT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(ta,Oa).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(ta,Oa).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new nl(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,fr)&&(window.cancelAnimationFrame(l(this,fr)),m(this,fr,null)),l(ta,Oa).delete(this._canvas),this.callback(e||new qv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,fr,window.requestAnimationFrame(()=>{m(this,fr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(ta,Oa).delete(this._canvas),this.callback())))}};fr=new WeakMap,Oa=new WeakMap,S(ta,Oa,new WeakSet);let gy=ta;const WT="4.10.38",GT="f9bea397f";function Yw(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Lc(n){return Math.max(0,Math.min(255,255*n))}class Kw{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Lc(e),[e,e,e]}static G_HTML([e]){const t=Yw(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Lc)}static RGB_HTML(e){return`#${e.map(Yw).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Lc(1-Math.min(1,e+i)),Lc(1-Math.min(1,s+i)),Lc(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class XT{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){be("Abstract method `_createSVG` called.")}}class e0 extends XT{_createSVG(e){return document.createElementNS(Qs,e)}}class Nb{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var d,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);a.append(p),o&&Mu.shouldBuildText(i.name)&&u.push(p)}return{textDivs:u}}const h=[[i,-1,a]];for(;h.length>0;){const[p,y,w]=h.at(-1);if(y+1===p.children.length){h.pop();continue}const _=p.children[++h.at(-1)[1]];if(_===null)continue;const{name:v}=_;if(v==="#text"){const b=document.createTextNode(_.value);u.push(b),w.append(b);continue}const A=(d=_==null?void 0:_.attributes)!=null&&d.xmlns?document.createElementNS(_.attributes.xmlns,v):document.createElement(v);if(w.append(A),_.attributes&&this.setAttributes({html:A,element:_,storage:t,intent:r,linkService:s}),((f=_.children)==null?void 0:f.length)>0)h.push([_,-1,A]);else if(_.value){const b=document.createTextNode(_.value);o&&Mu.shouldBuildText(v)&&u.push(b),A.append(b)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const dd=1e3,qT=9,wo=new WeakSet;function Or(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class YT{static create(e){switch(e.data.annotationType){case Ze.LINK:return new Rb(e);case Ze.TEXT:return new KT(e);case Ze.WIDGET:switch(e.data.fieldType){case"Tx":return new QT(e);case"Btn":return e.data.radioButton?new Ib(e):e.data.checkBox?new ZT(e):new eP(e);case"Ch":return new tP(e);case"Sig":return new JT(e)}return new Eo(e);case Ze.POPUP:return new yy(e);case Ze.FREETEXT:return new zb(e);case Ze.LINE:return new sP(e);case Ze.SQUARE:return new iP(e);case Ze.CIRCLE:return new rP(e);case Ze.POLYLINE:return new Bb(e);case Ze.CARET:return new oP(e);case Ze.INK:return new t0(e);case Ze.POLYGON:return new aP(e);case Ze.HIGHLIGHT:return new Hb(e);case Ze.UNDERLINE:return new lP(e);case Ze.SQUIGGLY:return new cP(e);case Ze.STRIKEOUT:return new uP(e);case Ze.STAMP:return new Ub(e);case Ze.FILEATTACHMENT:return new hP(e);default:return new Ge(e)}}}var ja,Ll,Il,bh,my;const o0=class o0{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){S(this,bh);S(this,ja,null);S(this,Ll,!1);S(this,Il,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return o0._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,ja)||m(this,ja,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&x(this,bh,my).call(this,t),(s=l(this,Il))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,ja)&&(x(this,bh,my).call(this,l(this,ja).rect),(e=l(this,Il))==null||e.popup.resetEdited(),m(this,ja,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Eo||(r.tabIndex=dd);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof yy){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:o,height:c}=Or(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(w>0||_>0){const A=`calc(${w}px * var(--scale-factor)) / calc(${_}px * var(--scale-factor))`;a.borderRadius=A}else if(this instanceof Ib){const A=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=A}switch(t.borderStyle.style){case Nc.SOLID:a.borderStyle="solid";break;case Nc.DASHED:a.borderStyle="dashed";break;case Nc.BEVELED:ne("Unimplemented border style: beveled");break;case Nc.INSET:ne("Unimplemented border style: inset");break;case Nc.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(m(this,Ll,!0),a.borderColor=G.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=G.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:p}=i.rawDims;a.left=`${100*(u[0]-f)/h}%`,a.top=`${100*(u[1]-p)/d}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(a.width=`${100*o/h}%`,a.height=`${100*c/d}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=Or(this.data.rect);let o,c;e%180===0?(o=100*r/s,c=100*a/i):(o=100*a/s,c=100*r/i),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=Kw[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:Kw[`${a}_rgb`](o)})};return ae(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,_,v,A]=e.subarray(2,6);if(i===w&&r===_&&t===v&&s===A)return}const{style:a}=this.container;let o;if(l(this,Ll)){const{borderColor:w,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const p=h.createElement("clipPath"),y=`clippath_${this.data.id}`;p.setAttribute("id",y),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let w=2,_=e.length;w<_;w+=8){const v=e[w],A=e[w+1],b=e[w+2],E=e[w+3],C=h.createElement("rect"),T=(b-t)/c,k=(r-A)/u,N=(v-b)/c,L=(A-E)/u;C.setAttribute("x",T),C.setAttribute("y",k),C.setAttribute("width",N),C.setAttribute("height",L),p.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${k}" width="${N}" height="${L}"/>`)}l(this,Ll)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=m(this,Il,new yy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){be("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!wo.has(u)){ne(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&wo.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};ja=new WeakMap,Ll=new WeakMap,Il=new WeakMap,bh=new WeakSet,my=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:h}=Or(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*h/a}%`):this.setRotation(i)};let Ge=o0;var En,Qr,Mb,Lb;class Rb extends Ge{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});S(this,En);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(x(this,En,Mb).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(x(this,En,Lb).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&x(this,En,Qr).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),x(this,En,Qr).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),x(this,En,Qr).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),x(this,En,Qr).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var d;i==null||i();const{fields:r,refs:a,include:o}=s,c=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const y=this._fieldObjects[p]||[];for(const{id:w}of y)f.add(w)}for(const p of Object.values(this._fieldObjects))for(const y of p)f.has(y.id)===o&&c.push(y)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:p}=f;switch(h.push(p),f.type){case"text":{const w=f.defaultValue||"";u.setValue(p,{value:w});break}case"checkbox":case"radiobutton":{const w=f.defaultValue===f.exportValues;u.setValue(p,{value:w});break}case"combobox":case"listbox":{const w=f.defaultValue||"";u.setValue(p,{value:w});break}default:continue}const y=document.querySelector(`[data-element-id="${p}"]`);if(y){if(!wo.has(y)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}En=new WeakSet,Qr=function(){this.container.setAttribute("data-internal-link","")},Mb=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},x(this,En,Qr).call(this)},Lb=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),x(this,En,Qr).call(this)};class KT extends Ge{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Eo extends Ge{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Gt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":G.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||qT,r=e.style;let a;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(Rg*i))||1,d=u/h;a=Math.min(i,c(d/Rg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,c(u/Rg))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=G.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class QT extends Eo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),wo.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=dd,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=h.userValue=p,h.formattedValue=null});let d=f=>{const{formattedValue:p}=h;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var w;if(h.focused)return;const{target:y}=p;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const y={value(w){h.userValue=w.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:_}=w.detail;h.formattedValue=_,_!=null&&w.target!==document.activeElement&&(w.target.value=_),e.setValue(t,{formattedValue:_})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var b;const{charLimit:_}=w.detail,{target:v}=w;if(_===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",_);let A=h.userValue;!A||A.length<=_||(A=A.slice(0,_),v.value=h.userValue=A,e.setValue(t,{value:A}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(y,p)}),s.addEventListener("keydown",p=>{var _;h.commitKey=1;let y=-1;if(p.key==="Escape"?y=0:p.key==="Enter"&&!this.data.multiLine?y=2:p.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:w}=p.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:y,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=d;d=null,s.addEventListener("blur",p=>{var w,_;if(!h.focused||!p.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(h.focused=!1);const{value:y}=p.target;h.userValue=y,h.lastCommittedValue!==y&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var C;h.lastCommittedValue=null;const{data:y,target:w}=p,{value:_,selectionStart:v,selectionEnd:A}=w;let b=v,E=A;switch(p.inputType){case"deleteWordBackward":{const T=_.substring(0,v).match(/\w*[^\w]*$/);T&&(b-=T[0].length);break}case"deleteWordForward":{const T=_.substring(v).match(/^[^\w]*\w*/);T&&(E+=T[0].length);break}case"deleteContentBackward":v===A&&(b-=1);break;case"deleteContentForward":v===A&&(E+=1);break}p.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:y||"",willCommit:!1,selStart:b,selEnd:E}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&s.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class JT extends Eo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ZT extends Eo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return wo.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=dd,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ib extends Eo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(wo.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=dd,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class eP extends Rb{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class tP extends Eo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");wo.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=dd;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),a=()=>{h.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,y=>y.selected).map(y=>y[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=o(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const d={value(f){a==null||a();const p=f.detail.value,y=new Set(Array.isArray(p)?p:[p]);for(const w of i.options)w.selected=y.has(w.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,y=f.detail.remove;p[y].selected=!1,i.remove(y),p.length>0&&Array.prototype.findIndex.call(p,_=>_.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(f){const{index:p,displayValue:y,exportValue:w}=f.detail.insert,_=i.children[p],v=document.createElement("option");v.textContent=y,v.value=w,_?_.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const y of p){const{displayValue:w,exportValue:_}=y,v=document.createElement("option");v.textContent=w,v.value=_,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const y of f.target.options)y.selected=p.has(y.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("input",h=>{var p;const d=o(!0),f=o(!1);e.setValue(t,{value:d}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class yy extends Ge{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ge._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new nP({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Xv}${s}`).join(",")),this.container}}var Dl,wp,Ap,Fl,za,He,vi,Ol,_h,Eh,jl,wi,as,Ai,Ch,Si,kh,Ba,Ha,xe,cf,vy,Db,Fb,Ob,jb,uf,hf,wy;class nP{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:u,parentRect:h,open:d}){S(this,xe);S(this,Dl,x(this,xe,Ob).bind(this));S(this,wp,x(this,xe,wy).bind(this));S(this,Ap,x(this,xe,hf).bind(this));S(this,Fl,x(this,xe,uf).bind(this));S(this,za,null);S(this,He,null);S(this,vi,null);S(this,Ol,null);S(this,_h,null);S(this,Eh,null);S(this,jl,null);S(this,wi,!1);S(this,as,null);S(this,Ai,null);S(this,Ch,null);S(this,Si,null);S(this,kh,null);S(this,Ba,null);S(this,Ha,!1);var f;m(this,He,e),m(this,kh,i),m(this,vi,a),m(this,Si,o),m(this,Eh,c),m(this,za,t),m(this,Ch,u),m(this,jl,h),m(this,_h,s),m(this,Ol,Kv.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Fl)),p.addEventListener("mouseenter",l(this,Ap)),p.addEventListener("mouseleave",l(this,wp)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Dl));l(this,He).hidden=!0,d&&x(this,xe,uf).call(this)}render(){if(l(this,as))return;const e=m(this,as,document.createElement("div"));if(e.className="popup",l(this,za)){const r=e.style.outlineColor=G.makeHexColor(...l(this,za));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=G.makeHexColor(...l(this,za).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,kh),e.append(t),l(this,Ol)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Ol).valueOf()})),t.append(r)}const i=l(this,xe,cf);if(i)Nb.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,vi));e.append(r)}l(this,He).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,Ba)||m(this,Ba,{contentsObj:l(this,vi),richText:l(this,Si)}),e&&m(this,Ai,null),t&&(m(this,Si,x(this,xe,Fb).call(this,t)),m(this,vi,null)),(s=l(this,as))==null||s.remove(),m(this,as,null)}resetEdited(){var e;l(this,Ba)&&({contentsObj:jt(this,vi)._,richText:jt(this,Si)._}=l(this,Ba),m(this,Ba,null),(e=l(this,as))==null||e.remove(),m(this,as,null),m(this,Ai,null))}forceHide(){m(this,Ha,this.isVisible),l(this,Ha)&&(l(this,He).hidden=!0)}maybeShow(){l(this,Ha)&&(l(this,as)||x(this,xe,hf).call(this),m(this,Ha,!1),l(this,He).hidden=!1)}get isVisible(){return l(this,He).hidden===!1}}Dl=new WeakMap,wp=new WeakMap,Ap=new WeakMap,Fl=new WeakMap,za=new WeakMap,He=new WeakMap,vi=new WeakMap,Ol=new WeakMap,_h=new WeakMap,Eh=new WeakMap,jl=new WeakMap,wi=new WeakMap,as=new WeakMap,Ai=new WeakMap,Ch=new WeakMap,Si=new WeakMap,kh=new WeakMap,Ba=new WeakMap,Ha=new WeakMap,xe=new WeakSet,cf=function(){const e=l(this,Si),t=l(this,vi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,Si).html||null},vy=function(){var e,t,s;return((s=(t=(e=l(this,xe,cf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},Db=function(){var e,t,s;return((s=(t=(e=l(this,xe,cf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},Fb=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,xe,Db),fontSize:l(this,xe,vy)?`calc(${l(this,xe,vy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},Ob=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,wi))&&x(this,xe,uf).call(this)},jb=function(){if(l(this,Ai)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Eh);let a=!!l(this,jl),o=a?l(this,jl):l(this,Ch);for(const y of l(this,_h))if(!o||G.intersect(y.data.rect,o)!==null){o=y.data.rect,a=!0;break}const c=G.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=c[0]+h,f=c[1];m(this,Ai,[100*(d-i)/t,100*(f-r)/s]);const{style:p}=l(this,He);p.left=`${l(this,Ai)[0]}%`,p.top=`${l(this,Ai)[1]}%`},uf=function(){m(this,wi,!l(this,wi)),l(this,wi)?(x(this,xe,hf).call(this),l(this,He).addEventListener("click",l(this,Fl)),l(this,He).addEventListener("keydown",l(this,Dl))):(x(this,xe,wy).call(this),l(this,He).removeEventListener("click",l(this,Fl)),l(this,He).removeEventListener("keydown",l(this,Dl)))},hf=function(){l(this,as)||this.render(),this.isVisible?l(this,wi)&&l(this,He).classList.add("focused"):(x(this,xe,jb).call(this),l(this,He).hidden=!1,l(this,He).style.zIndex=parseInt(l(this,He).style.zIndex)+1e3)},wy=function(){l(this,He).classList.remove("focused"),!(l(this,wi)||!this.isVisible)&&(l(this,He).hidden=!0,l(this,He).style.zIndex=parseInt(l(this,He).style.zIndex)-1e3)};class zb extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=te.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Th;class sP extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Th,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Or(t.rect),r=this.svgFactory.create(s,i,!0),a=m(this,Th,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Th)}addHighlightArea(){this.container.classList.add("highlightArea")}}Th=new WeakMap;var Ph;class iP extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Ph,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Or(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=m(this,Ph,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Ph)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ph=new WeakMap;var Nh;class rP extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Nh,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Or(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=m(this,Nh,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Nh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nh=new WeakMap;var Rh;class Bb extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Rh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=Or(t),c=this.svgFactory.create(a,o,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const p=s[d]-t[0],y=t[3]-s[d+1];u.push(`${p},${y}`)}u=u.join(" ");const h=m(this,Rh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Rh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rh=new WeakMap;class aP extends Bb{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class oP extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Mh,Ua,Lh,Ay;class t0 extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Lh);S(this,Mh,null);S(this,Ua,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?te.HIGHLIGHT:te.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:u}=x(this,Lh,Ay).call(this,s,t),h=this.svgFactory.create(c,u,!0),d=m(this,Mh,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let f=0,p=i.length;f<p;f++){const y=this.svgFactory.createElement(this.svgElementName);l(this,Ua).push(y),y.setAttribute("points",i[f].join(",")),d.append(y)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=l(this,Mh);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,c=l(this,Ua).length;o<c;o++)l(this,Ua)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:u}=x(this,Lh,Ay).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,Ua)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mh=new WeakMap,Ua=new WeakMap,Lh=new WeakSet,Ay=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class Hb extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=te.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class lP extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class cP extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class uP extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ub extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=te.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ih,Dh,Sy;class hP extends Ge{constructor(t){var i;super(t,{isRenderable:!0});S(this,Dh);S(this,Ih,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",x(this,Dh,Sy).bind(this)),m(this,Ih,i);const{isMac:r}=Gt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&x(this,Dh,Sy).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,Ih)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ih=new WeakMap,Dh=new WeakSet,Sy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Fh,$a,Va,Oh,Ao,$b,xy;class dP{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){S(this,Ao);S(this,Fh,null);S(this,$a,null);S(this,Va,new Map);S(this,Oh,null);this.div=e,m(this,Fh,t),m(this,$a,s),m(this,Oh,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,Va).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;yo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new e0,annotationStorage:e.annotationStorage||new Jv,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===Ze.POPUP;if(c){const d=i.get(o.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=Or(o.rect);if(d<=0||f<=0)continue}r.data=o;const u=YT.create(r);if(!u.isRenderable)continue;if(!c&&o.popupRef){const d=i.get(o.popupRef);d?d.push(u):i.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await x(this,Ao,$b).call(this,h,o.id),u._isEditable&&(l(this,Va).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}x(this,Ao,xy).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,yo(t,{rotation:e.rotation}),x(this,Ao,xy).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,Va).values())}getEditableAnnotation(e){return l(this,Va).get(e)}}Fh=new WeakMap,$a=new WeakMap,Va=new WeakMap,Oh=new WeakMap,Ao=new WeakSet,$b=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${Xv}${t}`,r=await((a=l(this,Oh))==null?void 0:a.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(o=l(this,Fh))==null||o.moveElementInDOM(this.div,e,s,!1)},xy=function(){if(!l(this,$a))return;const e=this.div;for(const[t,s]of l(this,$a)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}l(this,$a).clear()};const Id=/\r\n?|\n/g;var os,gn,jh,Wa,mn,Qe,Vb,Wb,Gb,df,Ii,ff,pf,Xb,_y,qb;const Ce=class Ce extends je{constructor(t){super({...t,name:"freeTextEditor"});S(this,Qe);S(this,os);S(this,gn,"");S(this,jh,`${this.id}-editor`);S(this,Wa,null);S(this,mn);m(this,os,t.color||Ce._defaultColor||je._defaultLineColor),m(this,mn,t.fontSize||Ce._defaultFontSize)}static get _keyboardManager(){const t=Ce.prototype,s=a=>a.isEmpty(),i=vo.TRANSLATE_SMALL,r=vo.TRANSLATE_BIG;return ae(this,"_keyboardManager",new hd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){je.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case ce.FREETEXT_SIZE:Ce._defaultFontSize=s;break;case ce.FREETEXT_COLOR:Ce._defaultColor=s;break}}updateParams(t,s){switch(t){case ce.FREETEXT_SIZE:x(this,Qe,Vb).call(this,s);break;case ce.FREETEXT_COLOR:x(this,Qe,Wb).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ce.FREETEXT_SIZE,Ce._defaultFontSize],[ce.FREETEXT_COLOR,Ce._defaultColor||je._defaultLineColor]]}get propertiesToUpdate(){return[[ce.FREETEXT_SIZE,l(this,mn)],[ce.FREETEXT_COLOR,l(this,os)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ce._internalPadding*t,-(Ce._internalPadding+l(this,mn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(te.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,Wa,new AbortController);const t=this._uiManager.combinedSignal(l(this,Wa));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,jh)),this._isDraggable=!0,(t=l(this,Wa))==null||t.abort(),m(this,Wa,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,gn),s=m(this,gn,x(this,Qe,Gb).call(this).trimEnd());if(t===s)return;const i=r=>{if(m(this,gn,r),!r){this.remove();return}x(this,Qe,pf).call(this),this._uiManager.rebuild(this),x(this,Qe,df).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),x(this,Qe,df).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ce._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,jh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,mn)}px * var(--scale-factor))`,i.color=l(this,os),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Kf(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,p]=this.pageTranslation;let y,w;switch(this.rotation){case 0:y=t+(o[0]-f)/h,w=s+this.height-(o[1]-p)/d;break;case 90:y=t+(o[0]-f)/h,w=s-(o[1]-p)/d,[c,u]=[u,-c];break;case 180:y=t-this.width+(o[0]-f)/h,w=s-(o[1]-p)/d,[c,u]=[-c,-u];break;case 270:y=t+(o[0]-f-this.height*d)/h,w=s+(o[1]-p-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(y*r,w*a,c,u)}else this.setAt(t*r,s*a,this.width*r,this.height*a);x(this,Qe,pf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,w,_;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=x(y=Ce,Ii,_y).call(y,s.getData("text")||"").replaceAll(Id,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(Id,"")),v!==this.editorDiv){let A=h;for(const b of this.editorDiv.childNodes){if(b===v){A=d;continue}A.push(x(w=Ce,Ii,ff).call(w,b))}}h.push(c.nodeValue.slice(0,u).replaceAll(Id,""))}else if(c===this.editorDiv){let v=h,A=0;for(const b of this.editorDiv.childNodes)A++===u&&(v=d),v.push(x(_=Ce,Ii,ff).call(_,b))}m(this,gn,`${h.join(`
`)}${r}${d.join(`
`)}`),x(this,Qe,pf).call(this);const f=new Range;let p=h.reduce((v,A)=>v+A.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const A=v.nodeValue.length;if(p<=A){f.setStart(v,p),f.setEnd(v,p);break}p-=A}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof zb){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:p},textContent:y,textPosition:w,parent:{page:{pageNumber:_}}}=t;if(!y||y.length===0)return null;r=t={annotationType:te.FREETEXT,color:Array.from(u),fontSize:c,value:y.join(`
`),position:w,pageIndex:_-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:p}}const a=await super.deserialize(t,s,i);return m(a,mn,t.fontSize),m(a,os,G.makeHexColor(...t.color)),m(a,gn,x(o=Ce,Ii,_y).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Ce._internalPadding*this.parentScale,i=this.getRect(s,s),r=je._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,os)),a={annotationType:te.FREETEXT,color:r,fontSize:l(this,mn),value:x(this,Qe,Xb).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!x(this,Qe,qb).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,mn)}px * var(--scale-factor))`,i.color=l(this,os),s.replaceChildren();for(const a of l(this,gn).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=Ce._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,gn)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};os=new WeakMap,gn=new WeakMap,jh=new WeakMap,Wa=new WeakMap,mn=new WeakMap,Qe=new WeakSet,Vb=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,mn))*this.parentScale),m(this,mn,r),x(this,Qe,df).call(this)},i=l(this,mn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Wb=function(t){const s=r=>{m(this,os,this.editorDiv.style.color=r)},i=l(this,os);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Gb=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(x(i=Ce,Ii,ff).call(i,r)),s=r);return t.join(`
`)},df=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Ii=new WeakSet,ff=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Id,"")},pf=function(){if(this.editorDiv.replaceChildren(),!!l(this,gn))for(const t of l(this,gn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Xb=function(){return l(this,gn).replaceAll(""," ")},_y=function(t){return t.replaceAll(" ","")},qb=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},S(Ce,Ii),q(Ce,"_freeTextDefaultContent",""),q(Ce,"_internalPadding",0),q(Ce,"_defaultColor",null),q(Ce,"_defaultFontSize",10),q(Ce,"_type","freetext"),q(Ce,"_editorType",te.FREETEXT);let by=Ce;class H{toSVGPath(){be("Abstract method `toSVGPath` must be implemented.")}get box(){be("Abstract getter `box` must be implemented.")}serialize(e,t){be("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}q(H,"PRECISION",1e-4);var yn,ls,zl,Bl,zs,re,Ga,Xa,zh,Bh,Hl,Ul,pr,Hh,Sp,xp,rt,qc,Yb,Kb,Qb,Jb,Zb,e_;const ni=class ni{constructor({x:e,y:t},s,i,r,a,o=0){S(this,rt);S(this,yn);S(this,ls,[]);S(this,zl);S(this,Bl);S(this,zs,[]);S(this,re,new Float32Array(18));S(this,Ga);S(this,Xa);S(this,zh);S(this,Bh);S(this,Hl);S(this,Ul);S(this,pr,[]);m(this,yn,s),m(this,Ul,r*i),m(this,Bl,a),l(this,re).set([NaN,NaN,NaN,NaN,e,t],6),m(this,zl,o),m(this,Bh,l(ni,Hh)*i),m(this,zh,l(ni,xp)*i),m(this,Hl,i),l(this,pr).push(e,t)}isEmpty(){return isNaN(l(this,re)[8])}add({x:e,y:t}){var L;m(this,Ga,e),m(this,Xa,t);const[s,i,r,a]=l(this,yn);let[o,c,u,h]=l(this,re).subarray(8,12);const d=e-u,f=t-h,p=Math.hypot(d,f);if(p<l(this,zh))return!1;const y=p-l(this,Bh),w=y/p,_=w*d,v=w*f;let A=o,b=c;o=u,c=h,u+=_,h+=v,(L=l(this,pr))==null||L.push(e,t);const E=-v/y,C=_/y,T=E*l(this,Ul),k=C*l(this,Ul);return l(this,re).set(l(this,re).subarray(2,8),0),l(this,re).set([u+T,h+k],4),l(this,re).set(l(this,re).subarray(14,18),12),l(this,re).set([u-T,h-k],16),isNaN(l(this,re)[6])?(l(this,zs).length===0&&(l(this,re).set([o+T,c+k],2),l(this,zs).push(NaN,NaN,NaN,NaN,(o+T-s)/r,(c+k-i)/a),l(this,re).set([o-T,c-k],14),l(this,ls).push(NaN,NaN,NaN,NaN,(o-T-s)/r,(c-k-i)/a)),l(this,re).set([A,b,o,c,u,h],6),!this.isEmpty()):(l(this,re).set([A,b,o,c,u,h],6),Math.abs(Math.atan2(b-c,A-o)-Math.atan2(v,_))<Math.PI/2?([o,c,u,h]=l(this,re).subarray(2,6),l(this,zs).push(NaN,NaN,NaN,NaN,((o+u)/2-s)/r,((c+h)/2-i)/a),[o,c,A,b]=l(this,re).subarray(14,18),l(this,ls).push(NaN,NaN,NaN,NaN,((A+o)/2-s)/r,((b+c)/2-i)/a),!0):([A,b,o,c,u,h]=l(this,re).subarray(0,6),l(this,zs).push(((A+5*o)/6-s)/r,((b+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),[u,h,o,c,A,b]=l(this,re).subarray(12,18),l(this,ls).push(((A+5*o)/6-s)/r,((b+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,zs),t=l(this,ls);if(isNaN(l(this,re)[6])&&!this.isEmpty())return x(this,rt,Yb).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);x(this,rt,Qb).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return x(this,rt,Kb).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new t_(e,t,s,i,r,a)}getOutlines(){var d;const e=l(this,zs),t=l(this,ls),s=l(this,re),[i,r,a,o]=l(this,yn),c=new Float32Array((((d=l(this,pr))==null?void 0:d.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,pr)[f]-i)/a,c[f+1]=(l(this,pr)[f+1]-r)/o;if(c[c.length-2]=(l(this,Ga)-i)/a,c[c.length-1]=(l(this,Xa)-r)/o,isNaN(s[6])&&!this.isEmpty())return x(this,rt,Jb).call(this,c);const u=new Float32Array(l(this,zs).length+24+l(this,ls).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}h=x(this,rt,e_).call(this,u,h);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[f+p],u[h+1]=t[f+p+1],h+=2}return x(this,rt,Zb).call(this,u,h),this.newFreeDrawOutline(u,c,l(this,yn),l(this,Hl),l(this,zl),l(this,Bl))}};yn=new WeakMap,ls=new WeakMap,zl=new WeakMap,Bl=new WeakMap,zs=new WeakMap,re=new WeakMap,Ga=new WeakMap,Xa=new WeakMap,zh=new WeakMap,Bh=new WeakMap,Hl=new WeakMap,Ul=new WeakMap,pr=new WeakMap,Hh=new WeakMap,Sp=new WeakMap,xp=new WeakMap,rt=new WeakSet,qc=function(){const e=l(this,re).subarray(4,6),t=l(this,re).subarray(16,18),[s,i,r,a]=l(this,yn);return[(l(this,Ga)+(e[0]-t[0])/2-s)/r,(l(this,Xa)+(e[1]-t[1])/2-i)/a,(l(this,Ga)+(t[0]-e[0])/2-s)/r,(l(this,Xa)+(t[1]-e[1])/2-i)/a]},Yb=function(){const[e,t,s,i]=l(this,yn),[r,a,o,c]=x(this,rt,qc).call(this);return`M${(l(this,re)[2]-e)/s} ${(l(this,re)[3]-t)/i} L${(l(this,re)[4]-e)/s} ${(l(this,re)[5]-t)/i} L${r} ${a} L${o} ${c} L${(l(this,re)[16]-e)/s} ${(l(this,re)[17]-t)/i} L${(l(this,re)[14]-e)/s} ${(l(this,re)[15]-t)/i} Z`},Kb=function(e){const t=l(this,ls);e.push(`L${t[4]} ${t[5]} Z`)},Qb=function(e){const[t,s,i,r]=l(this,yn),a=l(this,re).subarray(4,6),o=l(this,re).subarray(16,18),[c,u,h,d]=x(this,rt,qc).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${u} L${h} ${d} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},Jb=function(e){const t=l(this,re),[s,i,r,a]=l(this,yn),[o,c,u,h]=x(this,rt,qc).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,l(this,yn),l(this,Hl),l(this,zl),l(this,Bl))},Zb=function(e,t){const s=l(this,ls);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},e_=function(e,t){const s=l(this,re).subarray(4,6),i=l(this,re).subarray(16,18),[r,a,o,c]=l(this,yn),[u,h,d,f]=x(this,rt,qc).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c],t),t+=24},S(ni,Hh,8),S(ni,Sp,2),S(ni,xp,l(ni,Hh)+l(ni,Sp));let Zf=ni;var $l,qa,xi,Uh,vn,$h,Ve,bp,n_;class t_ extends H{constructor(t,s,i,r,a,o){super();S(this,bp);S(this,$l);S(this,qa,new Float32Array(4));S(this,xi);S(this,Uh);S(this,vn);S(this,$h);S(this,Ve);m(this,Ve,t),m(this,vn,s),m(this,$l,i),m(this,$h,r),m(this,xi,a),m(this,Uh,o),this.lastPoint=[NaN,NaN],x(this,bp,n_).call(this,o);const[c,u,h,d]=l(this,qa);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const t=[`M${l(this,Ve)[4]} ${l(this,Ve)[5]}`];for(let s=6,i=l(this,Ve).length;s<i;s+=6){if(isNaN(l(this,Ve)[s])){t.push(`L${l(this,Ve)[s+4]} ${l(this,Ve)[s+5]}`);continue}t.push(`C${l(this,Ve)[s]} ${l(this,Ve)[s+1]} ${l(this,Ve)[s+2]} ${l(this,Ve)[s+3]} ${l(this,Ve)[s+4]} ${l(this,Ve)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,c=r-s;let u,h;switch(a){case 0:u=H._rescale(l(this,Ve),t,r,o,-c),h=H._rescale(l(this,vn),t,r,o,-c);break;case 90:u=H._rescaleAndSwap(l(this,Ve),t,s,o,c),h=H._rescaleAndSwap(l(this,vn),t,s,o,c);break;case 180:u=H._rescale(l(this,Ve),i,s,-o,c),h=H._rescale(l(this,vn),i,s,-o,c);break;case 270:u=H._rescaleAndSwap(l(this,Ve),i,r,-o,-c),h=H._rescaleAndSwap(l(this,vn),i,r,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return l(this,qa)}newOutliner(t,s,i,r,a,o=0){return new Zf(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=l(this,qa),[c,u,h,d]=l(this,$l),f=a*h,p=o*d,y=i*h+c,w=r*d+u,_=this.newOutliner({x:l(this,vn)[0]*f+y,y:l(this,vn)[1]*p+w},l(this,$l),l(this,$h),t,l(this,Uh),s??l(this,xi));for(let v=2;v<l(this,vn).length;v+=2)_.add({x:l(this,vn)[v]*f+y,y:l(this,vn)[v+1]*p+w});return _.getOutlines()}}$l=new WeakMap,qa=new WeakMap,xi=new WeakMap,Uh=new WeakMap,vn=new WeakMap,$h=new WeakMap,Ve=new WeakMap,bp=new WeakSet,n_=function(t){const s=l(this,Ve);let i=s[4],r=s[5],a=i,o=r,c=i,u=r,h=i,d=r;const f=t?Math.max:Math.min;for(let y=6,w=s.length;y<w;y+=6){if(isNaN(s[y]))a=Math.min(a,s[y+4]),o=Math.min(o,s[y+5]),c=Math.max(c,s[y+4]),u=Math.max(u,s[y+5]),d<s[y+5]?(h=s[y+4],d=s[y+5]):d===s[y+5]&&(h=f(h,s[y+4]));else{const _=G.bezierBoundingBox(i,r,...s.slice(y,y+6));a=Math.min(a,_[0]),o=Math.min(o,_[1]),c=Math.max(c,_[2]),u=Math.max(u,_[3]),d<_[3]?(h=_[2],d=_[3]):d===_[3]&&(h=f(h,_[2]))}i=s[y+4],r=s[y+5]}const p=l(this,qa);p[0]=a-l(this,xi),p[1]=o-l(this,xi),p[2]=c-a+2*l(this,xi),p[3]=u-o+2*l(this,xi),this.lastPoint=[h,d]};var Vh,Wh,gr,cs,qt,s_,gf,i_,r_,Cy;class Ey{constructor(e,t=0,s=0,i=!0){S(this,qt);S(this,Vh);S(this,Wh);S(this,gr,[]);S(this,cs,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const u=10**-4;for(const{x:_,y:v,width:A,height:b}of e){const E=Math.floor((_-t)/u)*u,C=Math.ceil((_+A+t)/u)*u,T=Math.floor((v-t)/u)*u,k=Math.ceil((v+b+t)/u)*u,N=[E,T,k,!0],L=[C,T,k,!1];l(this,gr).push(N,L),r=Math.min(r,E),a=Math.max(a,C),o=Math.min(o,T),c=Math.max(c,k)}const h=a-r+2*s,d=c-o+2*s,f=r-s,p=o-s,y=l(this,gr).at(i?-1:-2),w=[y[0],y[2]];for(const _ of l(this,gr)){const[v,A,b]=_;_[0]=(v-f)/h,_[1]=(A-p)/d,_[2]=(b-p)/d}m(this,Vh,new Float32Array([f,p,h,d])),m(this,Wh,w)}getOutlines(){l(this,gr).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,gr))t[3]?(e.push(...x(this,qt,Cy).call(this,t)),x(this,qt,i_).call(this,t)):(x(this,qt,r_).call(this,t),e.push(...x(this,qt,Cy).call(this,t)));return x(this,qt,s_).call(this,e)}}Vh=new WeakMap,Wh=new WeakMap,gr=new WeakMap,cs=new WeakMap,qt=new WeakSet,s_=function(e){const t=[],s=new Set;for(const a of e){const[o,c,u]=a;t.push([o,c,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,c,u,h,d]=a;s.delete(a);let f=o,p=c;for(r=[o,u],i.push(r);;){let y;if(s.has(h))y=h;else if(s.has(d))y=d;else break;s.delete(y),[o,c,u,h,d]=y,f!==o&&(r.push(f,p,o,p===c?c:u),f=o),p=p===c?u:c}r.push(f,p)}return new fP(i,l(this,Vh),l(this,Wh))},gf=function(e){const t=l(this,cs);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},i_=function([,e,t]){const s=x(this,qt,gf).call(this,e);l(this,cs).splice(s,0,[e,t])},r_=function([,e,t]){const s=x(this,qt,gf).call(this,e);for(let i=s;i<l(this,cs).length;i++){const[r,a]=l(this,cs)[i];if(r!==e)break;if(r===e&&a===t){l(this,cs).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=l(this,cs)[i];if(r!==e)break;if(r===e&&a===t){l(this,cs).splice(i,1);return}}},Cy=function(e){const[t,s,i]=e,r=[[t,s,i]],a=x(this,qt,gf).call(this,i);for(let o=0;o<a;o++){const[c,u]=l(this,cs)[o];for(let h=0,d=r.length;h<d;h++){const[,f,p]=r[h];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,p>u&&r.push([t,u,p])}}}return r};var Gh,Vl;class fP extends H{constructor(t,s,i){super();S(this,Gh);S(this,Vl);m(this,Vl,t),m(this,Gh,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Vl)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],c=s[a+1];o===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],c=i-t,u=r-s;for(const h of l(this,Vl)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*c,d[f+1]=r-h[f+1]*u;o.push(d)}return o}get box(){return l(this,Gh)}get classNamesForOutlining(){return["highlightOutline"]}}Gh=new WeakMap,Vl=new WeakMap;class ky extends Zf{newFreeDrawOutline(e,t,s,i,r,a){return new pP(e,t,s,i,r,a)}}class pP extends t_{newOutliner(e,t,s,i,r,a=0){return new ky(e,t,s,i,r,a)}}var us,Ya,Wl,nt,Xh,Gl,qh,Yh,mr,hs,Xl,Kh,Se,Ty,Py,Ny,Jr,a_,$i;const Zt=class Zt{constructor({editor:e=null,uiManager:t=null}){S(this,Se);S(this,us,null);S(this,Ya,null);S(this,Wl);S(this,nt,null);S(this,Xh,!1);S(this,Gl,!1);S(this,qh,null);S(this,Yh);S(this,mr,null);S(this,hs,null);S(this,Xl);var s;e?(m(this,Gl,!1),m(this,Xl,ce.HIGHLIGHT_COLOR),m(this,qh,e)):(m(this,Gl,!0),m(this,Xl,ce.HIGHLIGHT_DEFAULT_COLOR)),m(this,hs,(e==null?void 0:e._uiManager)||t),m(this,Yh,l(this,hs)._eventBus),m(this,Wl,(e==null?void 0:e.color)||((s=l(this,hs))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(Zt,Kh)||m(Zt,Kh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ae(this,"_keyboardManager",new hd([[["Escape","mac+Escape"],Zt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Zt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Zt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Zt.prototype._moveToPrevious],[["Home","mac+Home"],Zt.prototype._moveToBeginning],[["End","mac+End"],Zt.prototype._moveToEnd]]))}renderButton(){const e=m(this,us,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,hs)._signal;e.addEventListener("click",x(this,Se,Jr).bind(this),{signal:t}),e.addEventListener("keydown",x(this,Se,Ny).bind(this),{signal:t});const s=m(this,Ya,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Wl),e.append(s),e}renderMainDropdown(){const e=m(this,nt,x(this,Se,Ty).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,us)){x(this,Se,Jr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&x(this,Se,Py).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,Se,$i)){x(this,Se,Jr).call(this,e);return}if(e.target===l(this,us)){(t=l(this,nt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,nt))==null?void 0:t.firstChild)||e.target===l(this,us)){l(this,Se,$i)&&this._hideDropdownFromKeyboard();return}l(this,Se,$i)||x(this,Se,Jr).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,Se,$i)){x(this,Se,Jr).call(this,e);return}(t=l(this,nt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,Se,$i)){x(this,Se,Jr).call(this,e);return}(t=l(this,nt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,nt))==null||e.classList.add("hidden"),(t=l(this,mr))==null||t.abort(),m(this,mr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Gl)){if(!l(this,Se,$i)){(e=l(this,qh))==null||e.unselect();return}this.hideDropdown(),l(this,us).focus({preventScroll:!0,focusVisible:l(this,Xh)})}}updateColor(e){if(l(this,Ya)&&(l(this,Ya).style.backgroundColor=e),!l(this,nt))return;const t=l(this,hs).highlightColors.values();for(const s of l(this,nt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,us))==null||e.remove(),m(this,us,null),m(this,Ya,null),(t=l(this,nt))==null||t.remove(),m(this,nt,null)}};us=new WeakMap,Ya=new WeakMap,Wl=new WeakMap,nt=new WeakMap,Xh=new WeakMap,Gl=new WeakMap,qh=new WeakMap,Yh=new WeakMap,mr=new WeakMap,hs=new WeakMap,Xl=new WeakMap,Kh=new WeakMap,Se=new WeakSet,Ty=function(){const e=document.createElement("div"),t=l(this,hs)._signal;e.addEventListener("contextmenu",As,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,hs).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(Zt,Kh)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,Wl)),r.addEventListener("click",x(this,Se,Py).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",x(this,Se,Ny).bind(this),{signal:t}),e},Py=function(e,t){t.stopPropagation(),l(this,Yh).dispatch("switchannotationeditorparams",{source:this,type:l(this,Xl),value:e})},Ny=function(e){Zt._keyboardManager.exec(this,e)},Jr=function(e){if(l(this,Se,$i)){this.hideDropdown();return}if(m(this,Xh,e.detail===0),l(this,mr)||(m(this,mr,new AbortController),window.addEventListener("pointerdown",x(this,Se,a_).bind(this),{signal:l(this,hs).combinedSignal(l(this,mr))})),l(this,nt)){l(this,nt).classList.remove("hidden");return}const t=m(this,nt,x(this,Se,Ty).call(this));l(this,us).append(t)},a_=function(e){var t;(t=l(this,nt))!=null&&t.contains(e.target)||this.hideDropdown()},$i=function(){return l(this,nt)&&!l(this,nt).classList.contains("hidden")},S(Zt,Kh,null);let ep=Zt;var ql,Qh,bi,Ka,Yl,nn,Jh,Zh,Qa,jn,wn,yt,Kl,_i,Mt,Ql,zn,ed,Z,Ry,mf,o_,l_,c_,My,Zr,Wn,Io,u_,yf,Yc,h_,d_,f_,p_,g_;const me=class me extends je{constructor(t){super({...t,name:"highlightEditor"});S(this,Z);S(this,ql,null);S(this,Qh,0);S(this,bi);S(this,Ka,null);S(this,Yl,null);S(this,nn,null);S(this,Jh,null);S(this,Zh,0);S(this,Qa,null);S(this,jn,null);S(this,wn,null);S(this,yt,!1);S(this,Kl,null);S(this,_i);S(this,Mt,null);S(this,Ql,"");S(this,zn);S(this,ed,"");this.color=t.color||me._defaultColor,m(this,zn,t.thickness||me._defaultThickness),m(this,_i,t.opacity||me._defaultOpacity),m(this,bi,t.boxes||null),m(this,ed,t.methodOfCreation||""),m(this,Ql,t.text||""),this._isDraggable=!1,t.highlightId>-1?(m(this,yt,!0),x(this,Z,mf).call(this,t),x(this,Z,Zr).call(this)):l(this,bi)&&(m(this,ql,t.anchorNode),m(this,Qh,t.anchorOffset),m(this,Jh,t.focusNode),m(this,Zh,t.focusOffset),x(this,Z,Ry).call(this),x(this,Z,Zr).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=me.prototype;return ae(this,"_keyboardManager",new hd([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,yt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,zn),methodOfCreation:l(this,ed)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;je.initialize(t,s),me._defaultColor||(me._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case ce.HIGHLIGHT_DEFAULT_COLOR:me._defaultColor=s;break;case ce.HIGHLIGHT_THICKNESS:me._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,Kl)}updateParams(t,s){switch(t){case ce.HIGHLIGHT_COLOR:x(this,Z,o_).call(this,s);break;case ce.HIGHLIGHT_THICKNESS:x(this,Z,l_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ce.HIGHLIGHT_DEFAULT_COLOR,me._defaultColor],[ce.HIGHLIGHT_THICKNESS,me._defaultThickness]]}get propertiesToUpdate(){return[[ce.HIGHLIGHT_COLOR,this.color||me._defaultColor],[ce.HIGHLIGHT_THICKNESS,l(this,zn)||me._defaultThickness],[ce.HIGHLIGHT_FREE,l(this,yt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(m(this,Yl,new ep({editor:this})),t.addColorPicker(l(this,Yl))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,Z,Yc).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,x(this,Z,Yc).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){x(this,Z,My).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,Z,Zr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?x(this,Z,My).call(this):t&&(x(this,Z,Zr).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;l(this,yt)?(t=(t-this.rotation+360)%360,i=x(r=me,Wn,Io).call(r,l(this,jn).box,t)):i=x(a=me,Wn,Io).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,wn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Mt),{bbox:x(o=me,Wn,Io).call(o,l(this,nn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,Ql)&&(t.setAttribute("aria-label",l(this,Ql)),t.setAttribute("role","mark")),l(this,yt)?t.classList.add("free"):this.div.addEventListener("keydown",x(this,Z,u_).bind(this),{signal:this._uiManager._signal});const s=m(this,Qa,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Ka);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Kf(this,l(this,Qa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:x(this,Z,yf).call(this,!0);break;case 1:case 3:x(this,Z,yf).call(this,!1);break}}select(){var t;super.select(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Mt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Mt),{rootClass:{selected:!1}}),l(this,yt)||x(this,Z,yf).call(this,!1))}get _mustFixPosition(){return!l(this,yt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,wn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Mt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:c,width:u,height:h}=i.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),p=y=>{d.abort(),x(this,Wn,p_).call(this,t,y)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",Cn,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",As,{signal:f}),i.addEventListener("pointermove",x(this,Wn,f_).bind(this,t),{signal:f}),this._freeHighlight=new ky({x:r,y:a},[o,c,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var w,_,v,A;let r=null;if(t instanceof Hb){const{data:{quadPoints:b,rect:E,rotation:C,id:T,color:k,opacity:N,popupRef:L},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),opacity:N,quadPoints:b,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:L}}else if(t instanceof t0){const{data:{inkLists:b,rect:E,rotation:C,id:T,color:k,borderStyle:{rawWidth:N},popupRef:L},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),thickness:N,inkLists:b,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:L}}const{color:a,quadPoints:o,inkLists:c,opacity:u}=t,h=await super.deserialize(t,s,i);h.color=G.makeHexColor(...a),m(h,_i,u||1),c&&m(h,zn,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[d,f]=h.pageDimensions,[p,y]=h.pageTranslation;if(o){const b=m(h,bi,[]);for(let E=0;E<o.length;E+=8)b.push({x:(o[E]-p)/d,y:1-(o[E+1]-y)/f,width:(o[E+2]-o[E])/d,height:(o[E+1]-o[E+5])/f});x(w=h,Z,Ry).call(w),x(_=h,Z,Zr).call(_),h.rotate(h.rotation)}else if(c){m(h,yt,!0);const b=c[0],E={x:b[0]-p,y:f-(b[1]-y)},C=new ky(E,[0,0,d,f],1,l(h,zn)/2,!0,.001);for(let N=0,L=b.length;N<L;N+=2)E.x=b[N]-p,E.y=f-(b[N+1]-y),C.add(E);const{id:T,clipPathId:k}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);x(v=h,Z,mf).call(v,{highlightOutlines:C.getOutlines(),highlightId:T,clipPathId:k}),x(A=h,Z,Zr).call(A)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=je._colorManager.convert(this.color),r={annotationType:te.HIGHLIGHT,color:i,opacity:l(this,_i),thickness:l(this,zn),quadPoints:x(this,Z,h_).call(this),outlines:x(this,Z,d_).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:x(this,Z,Yc).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!x(this,Z,g_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ql=new WeakMap,Qh=new WeakMap,bi=new WeakMap,Ka=new WeakMap,Yl=new WeakMap,nn=new WeakMap,Jh=new WeakMap,Zh=new WeakMap,Qa=new WeakMap,jn=new WeakMap,wn=new WeakMap,yt=new WeakMap,Kl=new WeakMap,_i=new WeakMap,Mt=new WeakMap,Ql=new WeakMap,zn=new WeakMap,ed=new WeakMap,Z=new WeakSet,Ry=function(){const t=new Ey(l(this,bi),.001);m(this,jn,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,jn).box;const s=new Ey(l(this,bi),.0025,.001,this._uiManager.direction==="ltr");m(this,nn,s.getOutlines());const{lastPoint:i}=l(this,nn);m(this,Kl,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},mf=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var d,f;if(m(this,jn,t),m(this,nn,t.getNewOutline(l(this,zn)/2+1.5,.0025)),s>=0)m(this,wn,s),m(this,Ka,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),m(this,Mt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,nn).box,path:{d:l(this,nn).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,wn),{bbox:x(d=me,Wn,Io).call(d,l(this,jn).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Mt),{bbox:x(f=me,Wn,Io).call(f,l(this,nn).box,p),path:{d:l(this,nn).toSVGPath()}})}const[a,o,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=u;break;case 90:{const[p,y]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*y/p,this.height=u*p/y;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[p,y]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*y/p,this.height=u*p/y;break}}const{lastPoint:h}=l(this,nn);m(this,Kl,[(h[0]-a)/c,(h[1]-o)/u])},o_=function(t){const s=(a,o)=>{var c,u;this.color=a,m(this,_i,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,wn),{root:{fill:a,"fill-opacity":o}}),(u=l(this,Yl))==null||u.updateColor(a)},i=this.color,r=l(this,_i);this.addCommands({cmd:s.bind(this,t,me._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},l_=function(t){const s=l(this,zn),i=r=>{m(this,zn,r),x(this,Z,c_).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},c_=function(t){if(!l(this,yt))return;x(this,Z,mf).call(this,{highlightOutlines:l(this,jn).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},My=function(){l(this,wn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,wn)),m(this,wn,null),this.parent.drawLayer.remove(l(this,Mt)),m(this,Mt,null))},Zr=function(t=this.parent){l(this,wn)===null&&({id:jt(this,wn)._,clipPathId:jt(this,Ka)._}=t.drawLayer.draw({bbox:l(this,jn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,_i)},rootClass:{highlight:!0,free:l(this,yt)},path:{d:l(this,jn).toSVGPath()}},!1,!0),m(this,Mt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,yt)},bbox:l(this,nn).box,path:{d:l(this,nn).toSVGPath()}},l(this,yt))),l(this,Qa)&&(l(this,Qa).style.clipPath=l(this,Ka)))},Wn=new WeakSet,Io=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},u_=function(t){me._keyboardManager.exec(this,t)},yf=function(t){if(!l(this,ql))return;const s=window.getSelection();t?s.setPosition(l(this,ql),l(this,Qh)):s.setPosition(l(this,Jh),l(this,Zh))},Yc=function(){return l(this,yt)?this.rotation:0},h_=function(){if(l(this,yt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=l(this,bi),o=new Float32Array(a.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of a){const p=u*t+i,y=(1-h)*s+r;o[c]=o[c+4]=p,o[c+1]=o[c+3]=y,o[c+2]=o[c+6]=p+d*t,o[c+5]=o[c+7]=y-f*s,c+=8}return o},d_=function(t){return l(this,jn).serialize(t,x(this,Z,Yc).call(this))},f_=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},p_=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},g_=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},S(me,Wn),q(me,"_defaultColor",null),q(me,"_defaultOpacity",1),q(me,"_defaultThickness",12),q(me,"_type","highlight"),q(me,"_editorType",te.HIGHLIGHT),q(me,"_freeHighlightId",-1),q(me,"_freeHighlight",null),q(me,"_freeHighlightClipId","");let tp=me;var Ja;class gP{constructor(){S(this,Ja,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,Ja)[e]=t}toSVGProperties(){const e=l(this,Ja);return m(this,Ja,Object.create(null)),{root:e}}reset(){m(this,Ja,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){be("Not implemented")}}Ja=new WeakMap;var An,Jl,ct,Za,eo,yr,vr,wr,to,de,Iy,Dy,Fy,Kc,m_,vf,Qc,Do;const $=class $ extends je{constructor(t){super(t);S(this,de);S(this,An,null);S(this,Jl);q(this,"_drawId",null);m(this,Jl,t.mustBeCommitted||!1),t.drawOutlines&&(x(this,de,Iy).call(this,t),x(this,de,Kc).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){be("Not implemented")}static get typesMap(){be("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l($,ct).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=c=>{var h;r.updateProperty(s,c);const u=l(this,An).updateProperty(s,c);u&&x(this,de,Qc).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,$._mergeSVGProperties(l(this,An).getPathResizingSVGProperties(x(this,de,vf).call(this)),{bbox:x(this,de,Do).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,$._mergeSVGProperties(l(this,An).getPathResizedSVGProperties(x(this,de,vf).call(this)),{bbox:x(this,de,Do).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:x(this,de,Do).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,$._mergeSVGProperties(l(this,An).getPathTranslatedSVGProperties(x(this,de,vf).call(this),this.parentDimensions),{bbox:x(this,de,Do).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,Jl)&&(m(this,Jl,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){x(this,de,Fy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,de,Kc).call(this),x(this,de,Qc).call(this,l(this,An).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),x(this,de,Fy).call(this)):t&&(this._uiManager.addShouldRescale(this),x(this,de,Kc).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,$._mergeSVGProperties({bbox:x(this,de,Do).call(this)},l(this,An).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&x(this,de,Qc).call(this,l(this,An).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){be("Not implemented")}static startDrawing(t,s,i,r){var _;const{target:a,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=r;if(l($,vr)&&l($,vr)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:p}=a.getBoundingClientRect(),y=m($,Za,new AbortController),w=t.combinedSignal(y);if(l($,yr)||m($,yr,u),l($,vr)??m($,vr,h),window.addEventListener("pointerup",v=>{var A;l($,yr)===v.pointerId?this._endDraw(v):(A=l($,wr))==null||A.delete(v.pointerId)},{signal:w}),window.addEventListener("pointercancel",v=>{var A;l($,yr)===v.pointerId?this._currentParent.endDrawingSession():(A=l($,wr))==null||A.delete(v.pointerId)},{signal:w}),window.addEventListener("pointerdown",v=>{l($,vr)===v.pointerType&&((l($,wr)||m($,wr,new Set)).add(v.pointerId),l($,ct).isCancellable()&&(l($,ct).removeLastElement(),l($,ct).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",As,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",v=>{v.timeStamp===l($,to)&&Cn(v)},{signal:w}),t.toggleDrawing(),(_=s._editorUndoBar)==null||_.hide(),l($,ct)){t.drawLayer.updateProperties(this._currentDrawId,l($,ct).startNew(o,c,f,p,d));return}s.updateUIForDefaultProperties(this),m($,ct,this.createDrawerInstance(o,c,f,p,d)),m($,eo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l($,eo).toSVGProperties(),l($,ct).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(m($,to,-1),!l($,ct))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l($,yr)===r){if(((a=l($,wr))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l($,ct).add(s,i)),m($,to,t.timeStamp),Cn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,m($,ct,null),m($,eo,null),m($,vr,null),m($,to,NaN)),l($,Za)&&(l($,Za).abort(),m($,Za,null),m($,yr,NaN),m($,wr,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,l($,ct).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l($,ct),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:ce.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(ce.DRAW_STEP),!l($,ct).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l($,ct).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:l($,eo),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){be("Not implemented")}static async deserialize(t,s,i){var d,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=s.viewport,u=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),x(d=h,de,Iy).call(d,{drawOutlines:u}),x(f=h,de,Kc).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,An).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};An=new WeakMap,Jl=new WeakMap,ct=new WeakMap,Za=new WeakMap,eo=new WeakMap,yr=new WeakMap,vr=new WeakMap,wr=new WeakMap,to=new WeakMap,de=new WeakSet,Iy=function({drawOutlines:t,drawId:s,drawingOptions:i}){m(this,An,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=x(this,de,Dy).call(this,t,this.parent),x(this,de,Qc).call(this,t.box)},Dy=function(t,s){const{id:i}=s.drawLayer.draw($._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Fy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Kc=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=x(this,de,Dy).call(this,l(this,An),t)}},m_=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},vf=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},Qc=function(t){if([this.x,this.y,this.width,this.height]=x(this,de,m_).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Do=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,u]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},q($,"_currentDrawId",-1),q($,"_currentParent",null),S($,ct,null),S($,Za,null),S($,eo,null),S($,yr,NaN),S($,vr,null),S($,wr,null),S($,to,NaN),q($,"_INNER_MARGIN",3);let Ly=$;var Bs,ut,ht,no,Zl,Ht,vt,Bn,so,io,ro,ec,wf;class mP{constructor(e,t,s,i,r,a){S(this,ec);S(this,Bs,new Float64Array(6));S(this,ut);S(this,ht);S(this,no);S(this,Zl);S(this,Ht);S(this,vt,"");S(this,Bn,0);S(this,so,new np);S(this,io);S(this,ro);m(this,io,s),m(this,ro,i),m(this,no,r),m(this,Zl,a),[e,t]=x(this,ec,wf).call(this,e,t);const o=m(this,ut,[NaN,NaN,NaN,NaN,e,t]);m(this,Ht,[e,t]),m(this,ht,[{line:o,points:l(this,Ht)}]),l(this,Bs).set(o,0)}updateProperty(e,t){e==="stroke-width"&&m(this,Zl,t)}isEmpty(){return!l(this,ht)||l(this,ht).length===0}isCancellable(){return l(this,Ht).length<=10}add(e,t){[e,t]=x(this,ec,wf).call(this,e,t);const[s,i,r,a]=l(this,Bs).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,io)*o,l(this,ro)*c)<=2?null:(l(this,Ht).push(e,t),isNaN(s)?(l(this,Bs).set([r,a,e,t],2),l(this,ut).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,Bs)[0])&&l(this,ut).splice(6,6),l(this,Bs).set([s,i,r,a,e,t],0),l(this,ut).push(...H.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,Ht).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){m(this,io,s),m(this,ro,i),m(this,no,r),[e,t]=x(this,ec,wf).call(this,e,t);const a=m(this,ut,[NaN,NaN,NaN,NaN,e,t]);m(this,Ht,[e,t]);const o=l(this,ht).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,ht).push({line:a,points:l(this,Ht)}),l(this,Bs).set(a,0),m(this,Bn,0),this.toSVGPath(),null}getLastElement(){return l(this,ht).at(-1)}setLastElement(e){return l(this,ht)?(l(this,ht).push(e),m(this,ut,e.line),m(this,Ht,e.points),m(this,Bn,0),{path:{d:this.toSVGPath()}}):l(this,so).setLastElement(e)}removeLastElement(){if(!l(this,ht))return l(this,so).removeLastElement();l(this,ht).pop(),m(this,vt,"");for(let e=0,t=l(this,ht).length;e<t;e++){const{line:s,points:i}=l(this,ht)[e];m(this,ut,s),m(this,Ht,i),m(this,Bn,0),this.toSVGPath()}return{path:{d:l(this,vt)}}}toSVGPath(){const e=H.svgRound(l(this,ut)[4]),t=H.svgRound(l(this,ut)[5]);if(l(this,Ht).length===2)return m(this,vt,`${l(this,vt)} M ${e} ${t} Z`),l(this,vt);if(l(this,Ht).length<=6){const i=l(this,vt).lastIndexOf("M");m(this,vt,`${l(this,vt).slice(0,i)} M ${e} ${t}`),m(this,Bn,6)}if(l(this,Ht).length===4){const i=H.svgRound(l(this,ut)[10]),r=H.svgRound(l(this,ut)[11]);return m(this,vt,`${l(this,vt)} L ${i} ${r}`),m(this,Bn,12),l(this,vt)}const s=[];l(this,Bn)===0&&(s.push(`M ${e} ${t}`),m(this,Bn,6));for(let i=l(this,Bn),r=l(this,ut).length;i<r;i+=6){const[a,o,c,u,h,d]=l(this,ut).slice(i,i+6).map(H.svgRound);s.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}return m(this,vt,l(this,vt)+s.join(" ")),m(this,Bn,l(this,ut).length),l(this,vt)}getOutlines(e,t,s,i){const r=l(this,ht).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,so).build(l(this,ht),e,t,s,l(this,no),l(this,Zl),i),m(this,Bs,null),m(this,ut,null),m(this,ht,null),m(this,vt,null),l(this,so)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Bs=new WeakMap,ut=new WeakMap,ht=new WeakMap,no=new WeakMap,Zl=new WeakMap,Ht=new WeakMap,vt=new WeakMap,Bn=new WeakMap,so=new WeakMap,io=new WeakMap,ro=new WeakMap,ec=new WeakSet,wf=function(e,t){return H._normalizePoint(e,t,l(this,io),l(this,ro),l(this,no))};var Ut,td,nd,Sn,Hs,Us,tc,nc,sc,St,Zs,y_,v_,w_;const l0=class l0 extends H{constructor(){super(...arguments);S(this,St);S(this,Ut);S(this,td,0);S(this,nd);S(this,Sn);S(this,Hs);S(this,Us);S(this,tc);S(this,nc);S(this,sc)}build(t,s,i,r,a,o,c){m(this,Hs,s),m(this,Us,i),m(this,tc,r),m(this,nc,a),m(this,sc,o),m(this,nd,c??0),m(this,Sn,t),x(this,St,v_).call(this)}setLastElement(t){return l(this,Sn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Sn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Sn)){if(t.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,c,u,h,d]=s.subarray(i,i+6).map(H.svgRound);t.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],c=[],[u,h,d,f]=x(this,St,y_).call(this);let p,y,w,_,v,A,b,E,C;switch(l(this,nc)){case 0:C=H._rescale,p=t,y=s+r,w=i,_=-r,v=t+u*i,A=s+(1-h-f)*r,b=t+(u+d)*i,E=s+(1-h)*r;break;case 90:C=H._rescaleAndSwap,p=t,y=s,w=i,_=r,v=t+h*i,A=s+u*r,b=t+(h+f)*i,E=s+(u+d)*r;break;case 180:C=H._rescale,p=t+i,y=s,w=-i,_=r,v=t+(1-u-d)*i,A=s+h*r,b=t+(1-u)*i,E=s+(h+f)*r;break;case 270:C=H._rescaleAndSwap,p=t+i,y=s+r,w=-i,_=-r,v=t+(1-h-f)*i,A=s+(1-u-d)*r,b=t+(1-h)*i,E=s+(1-u)*r;break}for(const{line:T,points:k}of l(this,Sn))o.push(C(T,p,y,w,_,a?new Array(T.length):null)),c.push(C(k,p,y,w,_,a?new Array(k.length):null));return{lines:o,points:c,rect:[v,A,b,E]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:c},rotation:u,thickness:h}){const d=[];let f,p,y,w,_;switch(u){case 0:_=H._rescale,f=-t/i,p=s/r+1,y=1/i,w=-1/r;break;case 90:_=H._rescaleAndSwap,f=-s/r,p=-t/i,y=1/r,w=1/i;break;case 180:_=H._rescale,f=t/i+1,p=-s/r,y=-1/i,w=1/r;break;case 270:_=H._rescaleAndSwap,f=s/r+1,p=t/i+1,y=-1/r,w=-1/i;break}if(!o){o=[];for(const A of c){const b=A.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const E=new Float32Array(3*(b-2));o.push(E);let[C,T,k,N]=A.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,T],0);for(let L=4;L<b;L+=2){const D=A[L],O=A[L+1];E.set(H.createBezierPoints(C,T,k,N,D,O),(L-2)*3),[C,T,k,N]=[k,N,D,O]}}}for(let A=0,b=o.length;A<b;A++)d.push({line:_(o[A].map(E=>E??NaN),f,p,y,w),points:_(c[A].map(E=>E??NaN),f,p,y,w)});const v=new l0;return v.build(d,i,r,1,u,h,a),v}get box(){return l(this,Ut)}updateProperty(t,s){return t==="stroke-width"?x(this,St,w_).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=x(this,St,Zs).call(this);m(this,Hs,t),m(this,Us,s),m(this,tc,i);const[o,c]=x(this,St,Zs).call(this),u=o-r,h=c-a,d=l(this,Ut);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return m(this,td,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,Ut).map(H.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,Ut);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,Ut);let i=0,r=0,a=0,o=0,c=0,u=0;switch(l(this,td)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,o=-1,c=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=x(this,St,Zs).call(this),[c,u,h,d]=l(this,Ut);if(Math.abs(h-a)<=H.PRECISION||Math.abs(d-o)<=H.PRECISION){const _=t+i/2-(c+h/2),v=s+r/2-(u+d/2);return{path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${_} ${v})`}}}const f=(i-2*a)/(h-2*a),p=(r-2*o)/(d-2*o),y=h/i,w=d/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${w}) translate(${H.svgRound(a)} ${H.svgRound(o)}) scale(${f} ${p}) translate(${H.svgRound(-a)} ${H.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=x(this,St,Zs).call(this),c=l(this,Ut),[u,h,d,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(d-a)<=H.PRECISION||Math.abs(f-o)<=H.PRECISION){const v=t+i/2-(u+d/2),A=s+r/2-(h+f/2);for(const{line:b,points:E}of l(this,Sn))H._translate(b,v,A,b),H._translate(E,v,A,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*a)/(d-2*a),y=(r-2*o)/(f-2*o),w=-p*(u+a)+t+a,_=-y*(h+o)+s+o;if(p!==1||y!==1||w!==0||_!==0)for(const{line:v,points:A}of l(this,Sn))H._rescale(v,w,_,p,y,v),H._rescale(A,w,_,p,y,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=l(this,Ut),c=t-o[0],u=s-o[1];if(l(this,Hs)===r&&l(this,Us)===a)for(const{line:h,points:d}of l(this,Sn))H._translate(h,c,u,h),H._translate(d,c,u,d);else{const h=l(this,Hs)/r,d=l(this,Us)/a;m(this,Hs,r),m(this,Us,a);for(const{line:f,points:p}of l(this,Sn))H._rescale(f,c,u,h,d,f),H._rescale(p,c,u,h,d,p);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,Ut);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t[0])} ${H.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Ut=new WeakMap,td=new WeakMap,nd=new WeakMap,Sn=new WeakMap,Hs=new WeakMap,Us=new WeakMap,tc=new WeakMap,nc=new WeakMap,sc=new WeakMap,St=new WeakSet,Zs=function(t=l(this,sc)){const s=l(this,nd)+t/2*l(this,tc);return l(this,nc)%180===0?[s/l(this,Hs),s/l(this,Us)]:[s/l(this,Us),s/l(this,Hs)]},y_=function(){const[t,s,i,r]=l(this,Ut),[a,o]=x(this,St,Zs).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},v_=function(){const t=m(this,Ut,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Sn)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[h,d]=r.subarray(c,c+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=r[4],o=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,p,y,w]=r.subarray(c,c+6);G.bezierBoundingBox(a,o,h,d,f,p,y,w,t),a=y,o=w}}const[s,i]=x(this,St,Zs).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},w_=function(t){const[s,i]=x(this,St,Zs).call(this);m(this,sc,t);const[r,a]=x(this,St,Zs).call(this),[o,c]=[r-s,a-i],u=l(this,Ut);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};let np=l0;var ic;const c0=class c0 extends gP{constructor(t){super();S(this,ic);m(this,ic,t),super.updateProperties({fill:"none",stroke:je._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,ic).realScale),super.updateSVGProperty(t,s)}clone(){const t=new c0(l(this,ic));return t.updateAll(this),t}};ic=new WeakMap;let Oy=c0;var _p,A_;const Yo=class Yo extends Ly{constructor(t){super({...t,name:"inkEditor"});S(this,_p);this._willKeepAspectRatio=!0}static initialize(t,s){je.initialize(t,s),this._defaultDrawingOptions=new Oy(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ae(this,"typesMap",new Map([[ce.INK_THICKNESS,"stroke-width"],[ce.INK_COLOR,"stroke"],[ce.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new mP(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return np.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof t0){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:y},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:te.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:o},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:u,id:h,deleted:!1,popupRef:y}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Yo.getDefaultDrawingOptions({stroke:G.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:te.INK,color:je._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!x(this,_p,A_).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};_p=new WeakSet,A_=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},q(Yo,"_type","ink"),q(Yo,"_editorType",te.INK),q(Yo,"_defaultDrawingOptions",null);let jy=Yo;var Fe,wt,Ar,Ei,Sr,rc,$s,Vs,xn,ac,ge,Jc,Zc,Af,By,Sf,Hy,xf,S_;const uu=class uu extends je{constructor(t){super({...t,name:"stampEditor"});S(this,ge);S(this,Fe,null);S(this,wt,null);S(this,Ar,null);S(this,Ei,null);S(this,Sr,null);S(this,rc,"");S(this,$s,null);S(this,Vs,null);S(this,xn,!1);S(this,ac,!1);m(this,Ei,t.bitmapUrl),m(this,Sr,t.bitmapFile)}static initialize(t,s){je.initialize(t,s)}static get supportedTypes(){return ae(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return ae(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(te.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,wt)&&(m(this,Fe,null),this._uiManager.imageManager.deleteId(l(this,wt)),(t=l(this,$s))==null||t.remove(),m(this,$s,null),l(this,Vs)&&(clearTimeout(l(this,Vs)),m(this,Vs,null))),super.remove()}rebuild(){if(!this.parent){l(this,wt)&&x(this,ge,Af).call(this);return}super.rebuild(),this.div!==null&&(l(this,wt)&&l(this,$s)===null&&x(this,ge,Af).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,Ar)||l(this,Fe)||l(this,Ei)||l(this,Sr)||l(this,wt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,Fe)?x(this,ge,By).call(this):x(this,ge,Af).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Vs)!==null&&clearTimeout(l(this,Vs)),m(this,Vs,setTimeout(()=>{m(this,Vs,null),x(this,ge,Hy).call(this)},200))}copyCanvas(t,s,i=!1){var p;t||(t=224);const{width:r,height:a}=l(this,Fe),o=new Om;let c=l(this,Fe),u=r,h=a,d=null;if(s){if(r>s||a>s){const N=Math.min(s/r,s/a);u=Math.floor(r*N),h=Math.floor(a*N)}d=document.createElement("canvas");const y=d.width=Math.ceil(u*o.sx),w=d.height=Math.ceil(h*o.sy);l(this,xn)||(c=x(this,ge,Sf).call(this,y,w));const _=d.getContext("2d");_.filter=this._uiManager.hcmFilter;let v="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",A="#42414d");const b=15,E=b*o.sx,C=b*o.sy,T=new OffscreenCanvas(E*2,C*2),k=T.getContext("2d");k.fillStyle=v,k.fillRect(0,0,E*2,C*2),k.fillStyle=A,k.fillRect(0,0,E,C),k.fillRect(E,C,E,C),_.fillStyle=_.createPattern(T,"repeat"),_.fillRect(0,0,y,w),_.drawImage(c,0,0,c.width,c.height,0,0,y,w)}let f=null;if(i){let y,w;if(o.symmetric&&c.width<t&&c.height<t)y=c.width,w=c.height;else if(c=l(this,Fe),r>t||a>t){const A=Math.min(t/r,t/a);y=Math.floor(r*A),w=Math.floor(a*A),l(this,xn)||(c=x(this,ge,Sf).call(this,y,w))}const v=new OffscreenCanvas(y,w).getContext("2d",{willReadFrequently:!0});v.drawImage(c,0,0,c.width,c.height,0,0,y,w),f={width:y,height:w,data:v.getImageData(0,0,y,w).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return l(this,$s)}static async deserialize(t,s,i){var w;let r=null;if(t instanceof Ub){const{data:{rect:_,rotation:v,id:A,structParent:b,popupRef:E},container:C,parent:{page:{pageNumber:T}}}=t,k=C.querySelector("canvas"),N=i.imageManager.getFromCanvas(C.id,k);k.remove();const L=((w=await s._structTree.getAriaAttributes(`${Xv}${A}`))==null?void 0:w.get("aria-label"))||"";r=t={annotationType:te.STAMP,bitmapId:N.id,bitmap:N.bitmap,pageIndex:T-1,rect:_.slice(0),rotation:v,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:L},isSvg:!1,structParent:b,popupRef:E}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&i.imageManager.isValidId(h)?(m(a,wt,h),c&&m(a,Fe,c)):m(a,Ei,u),m(a,xn,d);const[p,y]=a.pageDimensions;return a.width=(o[2]-o[0])/p,a.height=(o[3]-o[1])/y,a.annotationElementId=t.id||null,f&&(a.altTextData=f),a._initialData=r,m(a,ac,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:te.STAMP,bitmapId:l(this,wt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,xn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=x(this,ge,xf).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=x(this,ge,S_).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=l(this,xn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,wt)))s.stamps.set(l(this,wt),{area:o,serialized:i}),i.bitmap=x(this,ge,xf).call(this,!1);else if(l(this,xn)){const c=s.stamps.get(l(this,wt));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=x(this,ge,xf).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Fe=new WeakMap,wt=new WeakMap,Ar=new WeakMap,Ei=new WeakMap,Sr=new WeakMap,rc=new WeakMap,$s=new WeakMap,Vs=new WeakMap,xn=new WeakMap,ac=new WeakMap,ge=new WeakSet,Jc=function(t,s=!1){if(!t){this.remove();return}m(this,Fe,t.bitmap),s||(m(this,wt,t.id),m(this,xn,t.isSvg)),t.file&&m(this,rc,t.file.name),x(this,ge,By).call(this)},Zc=function(){if(m(this,Ar,null),this._uiManager.enableWaiting(!1),!!l(this,$s)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Af=function(){if(l(this,wt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,wt)).then(i=>x(this,ge,Jc).call(this,i,!0)).finally(()=>x(this,ge,Zc).call(this));return}if(l(this,Ei)){const i=l(this,Ei);m(this,Ei,null),this._uiManager.enableWaiting(!0),m(this,Ar,this._uiManager.imageManager.getFromUrl(i).then(r=>x(this,ge,Jc).call(this,r)).finally(()=>x(this,ge,Zc).call(this)));return}if(l(this,Sr)){const i=l(this,Sr);m(this,Sr,null),this._uiManager.enableWaiting(!0),m(this,Ar,this._uiManager.imageManager.getFromFile(i).then(r=>x(this,ge,Jc).call(this,r)).finally(()=>x(this,ge,Zc).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=uu.supportedTypesStr;const s=this._uiManager._signal;m(this,Ar,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,ge,Jc).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>x(this,ge,Zc).call(this))),t.click()},By=function(){var d;const{div:t}=this;let{width:s,height:i}=l(this,Fe);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const f=Math.min(o*r/s,o*a/i);s*=f,i*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/a),this._uiManager.enableWaiting(!1);const h=m(this,$s,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),x(this,ge,Hy).call(this),l(this,ac)||(this.parent.addUndoableEditor(this),m(this,ac,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,rc)&&h.setAttribute("aria-label",l(this,rc))},Sf=function(t,s){const{width:i,height:r}=l(this,Fe);let a=i,o=r,c=l(this,Fe);for(;a>2*t||o>2*s;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(c,0,0,u,h,0,0,a,o),c=d.transferToImageBitmap()}return c},Hy=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Om,o=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),u=l(this,$s);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=l(this,xn)?l(this,Fe):x(this,ge,Sf).call(this,o,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,c)},xf=function(t){if(t){if(l(this,xn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,wt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,Fe),s.getContext("2d").drawImage(l(this,Fe),0,0),s.toDataURL()}if(l(this,xn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Hr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Hr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,Fe),0,0,l(this,Fe).width,l(this,Fe).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,Fe))},S_=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},q(uu,"_type","stamp"),q(uu,"_editorType",te.STAMP);let zy=uu;var ao,oc,Ws,xr,Ci,Hn,br,lc,oo,ds,ki,Lt,Ti,W,_r,Le,x_,ks,$y,Vy,bf;const Zn=class Zn{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:u,l10n:h}){S(this,Le);S(this,ao);S(this,oc,!1);S(this,Ws,null);S(this,xr,null);S(this,Ci,null);S(this,Hn,new Map);S(this,br,!1);S(this,lc,!1);S(this,oo,!1);S(this,ds,null);S(this,ki,null);S(this,Lt,null);S(this,Ti,null);S(this,W);const d=[...l(Zn,_r).values()];if(!Zn._initialized){Zn._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),m(this,W,e),this.pageIndex=t,this.div=s,m(this,ao,r),m(this,Ws,a),this.viewport=u,m(this,Lt,c),this.drawLayer=o,this._structTree=i,l(this,W).addLayer(this)}get isEmpty(){return l(this,Hn).size===0}get isInvisible(){return this.isEmpty&&l(this,W).getMode()===te.NONE}updateToolbar(e){l(this,W).updateToolbar(e)}updateMode(e=l(this,W).getMode()){switch(x(this,Le,bf).call(this),e){case te.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case te.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case te.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(Zn,_r).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Lt))==null?void 0:t.div)}setEditingState(e){l(this,W).setEditingState(e)}addCommands(e){l(this,W).addCommands(e)}cleanUndoStack(e){l(this,W).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,Ws))==null||t.div.classList.toggle("disabled",!e)}async enable(){m(this,oo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,Hn).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,W).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,Ws)){m(this,oo,!1);return}const t=l(this,Ws).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,W).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}m(this,oo,!1)}disable(){var i;m(this,lc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Hn).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,Ws)){const r=l(this,Ws).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,W).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,W).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}x(this,Le,bf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(Zn,_r).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,lc,!1)}getEditableAnnotation(e){var t;return((t=l(this,Ws))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,W).getActive()!==e&&l(this,W).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Lt))!=null&&e.div&&!l(this,Ti)){m(this,Ti,new AbortController);const t=l(this,W).combinedSignal(l(this,Ti));l(this,Lt).div.addEventListener("pointerdown",x(this,Le,x_).bind(this),{signal:t}),l(this,Lt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Lt))!=null&&e.div&&l(this,Ti)&&(l(this,Ti).abort(),m(this,Ti,null),l(this,Lt).div.classList.remove("highlighting"))}enableClick(){if(l(this,xr))return;m(this,xr,new AbortController);const e=l(this,W).combinedSignal(l(this,xr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,xr))==null||e.abort(),m(this,xr,null)}attach(e){l(this,Hn).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,W).isDeletedAnnotationElement(t)&&l(this,W).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Hn).delete(e.id),(t=l(this,ao))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,lc)&&e.annotationElementId&&l(this,W).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,W).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,W).addDeletedAnnotationElement(e.annotationElementId),je.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,W).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,oo)),l(this,W).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,Ci)&&(e._focusEventsAllowed=!1,m(this,Ci,setTimeout(()=>{m(this,Ci,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,W)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,ao))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,W).getId()}combinedSignal(e){return l(this,W).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Le,ks))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,W).updateToolbar(e),l(this,W).updateMode(e);const{offsetX:s,offsetY:i}=x(this,Le,Vy).call(this),r=this.getNextId(),a=x(this,Le,$y).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,W),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(Zn,_r).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,W)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=x(this,Le,$y).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,W),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(x(this,Le,Vy).call(this),!0)}setSelected(e){l(this,W).setSelected(e)}toggleSelected(e){l(this,W).toggleSelected(e)}unselect(e){l(this,W).unselect(e)}pointerup(e){var s;const{isMac:t}=Gt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,br)&&(m(this,br,!1),!((s=l(this,Le,ks))!=null&&s.isDrawer&&l(this,Le,ks).supportMultipleDrawings))){if(!l(this,oc)){m(this,oc,!0);return}if(l(this,W).getMode()===te.STAMP){l(this,W).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(l(this,W).getMode()===te.HIGHLIGHT&&this.enableTextSelection(),l(this,br)){m(this,br,!1);return}const{isMac:t}=Gt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(m(this,br,!0),(i=l(this,Le,ks))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,W).getActive();m(this,oc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,ds)){l(this,Le,ks).startDrawing(this,l(this,W),!1,e);return}l(this,W).setCurrentDrawingSession(this),m(this,ds,new AbortController);const t=l(this,W).combinedSignal(l(this,ds));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,ki,null),this.commitOrRemove())},{signal:t}),l(this,Le,ks).startDrawing(this,l(this,W),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&m(this,ki,t);return}l(this,ki)&&setTimeout(()=>{var t;(t=l(this,ki))==null||t.focus(),m(this,ki,null)},0)}endDrawingSession(e=!1){return l(this,ds)?(l(this,W).setCurrentDrawingSession(null),l(this,ds).abort(),m(this,ds,null),m(this,ki,null),l(this,Le,ks).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,W).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,ds)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,ds)&&l(this,Le,ks).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,W).getActive())==null?void 0:e.parent)===this&&(l(this,W).commitOrRemove(),l(this,W).setActiveEditor(null)),l(this,Ci)&&(clearTimeout(l(this,Ci)),m(this,Ci,null));for(const s of l(this,Hn).values())(t=l(this,ao))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Hn).clear(),l(this,W).removeLayer(this)}render({viewport:e}){this.viewport=e,yo(this.div,e);for(const t of l(this,W).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,W).commitOrRemove(),x(this,Le,bf).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,yo(this.div,{rotation:s}),t!==s)for(const i of l(this,Hn).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,W).viewParameters.realScale}};ao=new WeakMap,oc=new WeakMap,Ws=new WeakMap,xr=new WeakMap,Ci=new WeakMap,Hn=new WeakMap,br=new WeakMap,lc=new WeakMap,oo=new WeakMap,ds=new WeakMap,ki=new WeakMap,Lt=new WeakMap,Ti=new WeakMap,W=new WeakMap,_r=new WeakMap,Le=new WeakSet,x_=function(e){l(this,W).unselectAll();const{target:t}=e;if(t===l(this,Lt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Lt).div.contains(t)){const{isMac:s}=Gt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,W).showAllEditors("highlight",!0,!0),l(this,Lt).div.classList.add("free"),this.toggleDrawing(),tp.startHighlighting(this,l(this,W).direction==="ltr",{target:l(this,Lt).div,x:e.x,y:e.y}),l(this,Lt).div.addEventListener("pointerup",()=>{l(this,Lt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,W)._signal}),e.preventDefault()}},ks=function(){return l(Zn,_r).get(l(this,W).getMode())},$y=function(e){const t=l(this,Le,ks);return t?new t.prototype.constructor(e):null},Vy=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+o)/2-e,h=(a+c)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},bf=function(){for(const e of l(this,Hn).values())e.isEmpty()&&e.remove()},q(Zn,"_initialized",!1),S(Zn,_r,new Map([by,jy,zy,tp].map(e=>[e._editorType,e])));let Uy=Zn;var fs,sd,$t,lo,Ep,b_,Ys,Gy,__,Xy;const Pt=class Pt{constructor({pageIndex:e}){S(this,Ys);S(this,fs,null);S(this,sd,0);S(this,$t,new Map);S(this,lo,new Map);this.pageIndex=e}setParent(e){if(!l(this,fs)){m(this,fs,e);return}if(l(this,fs)!==e){if(l(this,$t).size>0)for(const t of l(this,$t).values())t.remove(),e.append(t);m(this,fs,e)}}static get _svgFactory(){return ae(this,"_svgFactory",new e0)}draw(e,t=!1,s=!1){const i=jt(this,sd)._++,r=x(this,Ys,Gy).call(this),a=Pt._svgFactory.createElement("defs");r.append(a);const o=Pt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,lo).set(i,o);const u=s?x(this,Ys,__).call(this,a,c):null,h=Pt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,$t).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=jt(this,sd)._++,i=x(this,Ys,Gy).call(this),r=Pt._svgFactory.createElement("defs");i.append(r);const a=Pt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const d=Pt._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Pt._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=Pt._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=Pt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,$t).set(s,i),s}finalizeDraw(e,t){l(this,lo).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,$t).get(e):e;if(o){if(s&&x(this,Ys,Xy).call(this,o,s),i&&x(c=Pt,Ep,b_).call(c,o,i),r){const{classList:u}=o;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(a){const h=o.firstChild.firstChild;x(this,Ys,Xy).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=l(this,$t).get(e);s&&(l(t,fs).append(s),l(this,$t).delete(e),l(t,$t).set(e,s))}remove(e){l(this,lo).delete(e),l(this,fs)!==null&&(l(this,$t).get(e).remove(),l(this,$t).delete(e))}destroy(){m(this,fs,null);for(const e of l(this,$t).values())e.remove();l(this,$t).clear(),l(this,lo).clear()}};fs=new WeakMap,sd=new WeakMap,$t=new WeakMap,lo=new WeakMap,Ep=new WeakSet,b_=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Ys=new WeakSet,Gy=function(){const e=Pt._svgFactory.create(1,1,!0);return l(this,fs).append(e),e.setAttribute("aria-hidden",!0),e},__=function(e,t){const s=Pt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Pt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},Xy=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},S(Pt,Ep);let Wy=Pt;globalThis.pdfjsTestingUtils={HighlightOutliner:Ey};Q.AbortException;Q.AnnotationEditorLayer;Q.AnnotationEditorParamsType;Q.AnnotationEditorType;Q.AnnotationEditorUIManager;Q.AnnotationLayer;Q.AnnotationMode;Q.ColorPicker;Q.DOMSVGFactory;Q.DrawLayer;Q.FeatureTest;var yP=Q.GlobalWorkerOptions;Q.ImageKind;Q.InvalidPDFException;Q.MissingPDFException;Q.OPS;Q.OutputScale;Q.PDFDataRangeTransport;Q.PDFDateString;Q.PDFWorker;Q.PasswordResponses;Q.PermissionFlag;Q.PixelsPerInch;Q.RenderingCancelledException;Q.TextLayer;Q.TouchManager;Q.UnexpectedResponseException;Q.Util;Q.VerbosityLevel;Q.XfaLayer;Q.build;Q.createValidAbsoluteUrl;Q.fetchData;var vP=Q.getDocument;Q.getFilenameFromUrl;Q.getPdfFilenameFromUrl;Q.getXfaPageViewport;Q.isDataScheme;Q.isPdfFile;Q.noContextMenu;Q.normalizeUnicode;Q.setLayerDimensions;Q.shadow;Q.stopEvent;Q.version;const wP=""+new URL("pdf.worker.min-yatZIOMy.mjs",import.meta.url).href,AP="fyp-io",SP=3,sp="papers",ip="sticky_notes",rp="meeting_minutes",Zp="http://localhost:11434",eg="llama3.1",Qw={author:"Doe et al.",title:"Dummy Paper for Debugging",url:"https://example.com/paper",published_date:"2023",citation_count:42,note:"This is a placeholder note so you can test the UI without extraction."};function n0(){return new Promise((n,e)=>{const t=indexedDB.open(AP,SP);t.onupgradeneeded=()=>{const s=t.result;s.objectStoreNames.contains(sp)||s.createObjectStore(sp,{keyPath:"id",autoIncrement:!0}),s.objectStoreNames.contains(ip)||s.createObjectStore(ip,{keyPath:"id",autoIncrement:!0}),s.objectStoreNames.contains(rp)||s.createObjectStore(rp,{keyPath:"id",autoIncrement:!0})},t.onsuccess=()=>n(t.result),t.onerror=()=>e(t.error)})}async function Xn(n,e){const t=await n0();return new Promise((s,i)=>{const r=t.transaction(sp,n),a=r.objectStore(sp),o=e(a);r.oncomplete=()=>s(o),r.onerror=()=>i(r.error)})}async function s0(n,e){const t=await n0();return new Promise((s,i)=>{const r=t.transaction(ip,n),a=r.objectStore(ip),o=e(a);r.oncomplete=()=>s(o),r.onerror=()=>i(r.error)})}async function tg(n,e){const t=await n0();return new Promise((s,i)=>{const r=t.transaction(rp,n),a=r.objectStore(rp),o=e(a);r.oncomplete=()=>s(o),r.onerror=()=>i(r.error)})}function qy(n){try{return JSON.parse(n)}catch{const t=n.match(/\{[\s\S]*\}/);if(!t)return{};try{return JSON.parse(t[0])}catch{return{}}}}function xP(n){const e=qy(n);if(Array.isArray(e))return e;const t=n.match(/\[[\s\S]*\]/);if(t){const s=qy(t[0]);return Array.isArray(s)?s:[]}return[]}let Jw=!1;async function E_(n){const e=await n.arrayBuffer();Jw||(yP.workerSrc=wP,Jw=!0);const t=await vP({data:e}).promise;let s="";for(let i=1;i<=t.numPages;i+=1){const a=(await(await t.getPage(i)).getTextContent()).items.map(o=>"str"in o?o.str:"").join(" ");s+=`${a}
`}return s.trim()}function Yy(n){if(!n||typeof n!="string")return[];const e=["references","bibliography","works cited","literature cited"],t=n.toLowerCase();let s=-1;for(const h of e){const d=t.lastIndexOf(h);if(d!==-1){s=d;break}}if(s===-1){const h=n.split(`
`),d=h.findIndex(f=>/^\s*(\[\d+\]|\d+\.)/.test(f));if(d===-1)return[];s=h.slice(0,d).join(`
`).length}const i=n.slice(s).split(`
`).slice(1).join(`
`).trim();if(!i)return[];const r=i.split(`
`).map(h=>h.replace(/\s+/g," ").trim()).filter(Boolean).filter(h=>!/^\d+$/.test(h)).filter(h=>!/^\.*$/.test(h)).filter(h=>!/rspa\.royalsocietypublishing\.org/i.test(h)).filter(h=>!/^Downloaded from/i.test(h)),a=[];let o="";for(const h of r)(/^\s*(\[\d+\]|\d+\.)/.test(h)||/^\s*\d+\)/.test(h)||/^[A-Z][a-z]+,\s*[A-Z]/.test(h)||/^\s*[A-Z][a-z]+(?:\s+[A-Z][a-z]+)*\s+et al\./.test(h))&&o?(a.push(o.trim()),o=h):o=o?`${o} ${h}`:h;o&&a.push(o.trim());let c=a;const u=a.join(`
`).split(/\s*(?=\[\d+\]\s+)/);if(u.length>1)c=u;else if(a.length<=1){const h=i.replace(/\s+/g," ").split(/\s*(?=\d+\.\s+)/);h.length>1&&(c=h)}return c.map(h=>h.replace(/\s+/g," ").replace(/^\d+\.\s*/,"").trim()).filter(Boolean).slice(0,150)}function bP(n){if(!n||typeof n!="string")return"X";const e=n.trim().split(/[^a-zA-Z]+/).filter(Boolean);return e.length===0?"X":e.length===1?e[0][0].toUpperCase():`${e[0][0]}${e[1][0]}`.toUpperCase()}function ap(n,e){const t=bP(n);let s=1;for(;e.has(`${t}${s}`);)s+=1;return`${t}${s}`}async function _P(n){var a;const e=`You are a strict JSON generator.
Extract the paper metadata from the note below.
Return ONLY a JSON object with keys: author, title, url, published_date, citation_count.
If a field is unknown, use an empty string or null for citation_count.

NOTE:
${n}`,t=await fetch(`${Zp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:eg,messages:[{role:"user",content:e}],stream:!1})});if(!t.ok){const o=await t.text();throw new Error(`Ollama error ${t.status}: ${o}`)}const s=await t.json(),i=((a=s==null?void 0:s.message)==null?void 0:a.content)||"{}",r=qy(i);return{author:typeof r.author=="string"?r.author.trim():"",title:typeof r.title=="string"?r.title.trim():"",url:typeof r.url=="string"?r.url.trim():"",published_date:typeof r.published_date=="string"?r.published_date.trim():"",citation_count:typeof r.citation_count=="number"?r.citation_count:r.citation_count===null?null:Number.isFinite(Number(r.citation_count))?Number(r.citation_count):null}}async function EP(n,e){var o;const t=e.trim();if(!t)throw new Error("Question required");const s=n.slice(0,20).map(c=>({id:c.id,code:c.code,author:c.author,title:c.title,url:c.url,published_date:c.published_date,citation_count:c.citation_count,note:c.note})),i=`You answer questions using only the provided literature notes.
Do not mention author names, titles, or URLs in your answer.
Always include citations for any claim, using this format: [code: <code>].
If the answer is not in the notes, say you don't have enough information and do not invent citations.

NOTES:
${JSON.stringify(s,null,2)}

QUESTION:
${t}`,r=await fetch(`${Zp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:eg,messages:[{role:"user",content:i}],stream:!1})});if(!r.ok){const c=await r.text();throw new Error(`Ollama error ${r.status}: ${c}`)}const a=await r.json();return((o=a==null?void 0:a.message)==null?void 0:o.content)||""}async function CP(n){var o;const e=n.trim();if(!e)return[];const t=`Extract 5-8 short keywords or phrases from the note.
Return ONLY a JSON array of strings.
Avoid full sentences.

NOTE:
${e}`,s=await fetch(`${Zp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:eg,messages:[{role:"user",content:t}],stream:!1})});if(!s.ok){const c=await s.text();throw new Error(`Ollama error ${s.status}: ${c}`)}const i=await s.json(),r=((o=i==null?void 0:i.message)==null?void 0:o.content)||"[]",a=xP(r);return[...new Set(a.map(c=>String(c).trim()).filter(Boolean))].slice(0,8)}async function kP(n,e){var c;const t=e.flatMap(u=>Array.isArray(u.references)?u.references:[]).map(u=>String(u).trim()).filter(Boolean),s=e.map(u=>u.title).filter(Boolean);if(t.length===0)return[];const i=`You are selecting papers to read next.
Use ONLY the provided references list.
Use the research scope and existing titles to decide relevance.
Return 10 references, one per line.

RESEARCH SCOPE:
${n||"No scope provided."}

EXISTING TITLES:
${s.join(`
`)}

REFERENCES:
${t.join(`
`)}`,r=await fetch(`${Zp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:eg,messages:[{role:"user",content:i}],stream:!1})});if(!r.ok){const u=await r.text();throw new Error(`Ollama error ${r.status}: ${u}`)}const a=await r.json();return(((c=a==null?void 0:a.message)==null?void 0:c.content)||"").split(`
`).map(u=>u.trim()).filter(Boolean).slice(0,10)}async function TP(n){const e=await Xn("readonly",r=>new Promise((a,o)=>{const c=r.getAll();c.onsuccess=()=>a(c.result),c.onerror=()=>o(c.error)})),t=new Set(e.map(r=>r.code).filter(Boolean)),s=await _P(n),i={code:ap(s.author,t),...s,note:n,created_at:new Date().toISOString()};await Xn("readwrite",r=>{r.add(i)})}async function PP(n){const e=await Xn("readonly",a=>new Promise((o,c)=>{const u=a.getAll();u.onsuccess=()=>o(u.result),u.onerror=()=>c(u.error)})),t=new Set(e.map(a=>a.code).filter(Boolean)),s=n.citation_count,i=s===""||s===null||s===void 0?null:Number.isFinite(Number(s))?Number(s):null,r={code:ap(n.author,t),author:n.author||"",title:n.title||"",url:n.url||"",published_date:n.published_date||"",citation_count:i,note:n.note||"",created_at:new Date().toISOString()};await Xn("readwrite",a=>{a.add(r)})}async function NP(){let n=await Xn("readonly",s=>new Promise((i,r)=>{const a=s.getAll();a.onsuccess=()=>i(a.result),a.onerror=()=>r(a.error)}));n.length===0&&(await Xn("readwrite",s=>{s.add({...Qw,code:ap(Qw.author,new Set),created_at:new Date().toISOString()})}),n=await Xn("readonly",s=>new Promise((i,r)=>{const a=s.getAll();a.onsuccess=()=>i(a.result),a.onerror=()=>r(a.error)})));const e=new Set(n.map(s=>s.code).filter(Boolean)),t=[];return n.forEach(s=>{if(!s.code){const i=ap(s.author,e);e.add(i),t.push({...s,code:i})}}),t.length>0&&(await Xn("readwrite",s=>{t.forEach(i=>s.put(i))}),n=n.map(s=>t.find(i=>i.id===s.id)||s)),[...n].sort((s,i)=>i.id-s.id)}async function C_(n){const e=await Xn("readonly",t=>new Promise((s,i)=>{const r=t.get(Number(n));r.onsuccess=()=>s(r.result),r.onerror=()=>i(r.error)}));if(!e)throw new Error("Not found");return e}async function RP(n,e){const t=await E_(e),s=Yy(t);return mc(n,{pdf_blob:e,pdf_name:e.name,pdf_text:t,references:s})}async function MP(n){return mc(n,{pdf_blob:null,pdf_name:"",pdf_text:"",references:[]})}async function LP(n){const e=await C_(n);if(!e)throw new Error("Not found");if(e.pdf_blob&&!e.pdf_text){const t=await E_(e.pdf_blob),s=Yy(t);return mc(n,{pdf_text:t,references:s})}if(!Array.isArray(e.references)||e.references.length===0){const t=Yy(e.pdf_text||"");return t.length===0?e:mc(n,{references:t})}return e}async function mc(n,e){const t=await Xn("readonly",i=>new Promise((r,a)=>{const o=i.get(Number(n));o.onsuccess=()=>r(o.result),o.onerror=()=>a(o.error)}));if(!t)throw new Error("Not found");const s={...t,...e};return await Xn("readwrite",i=>{i.put(s)}),s}async function IP(n){const e=[...new Set(n.map(t=>Number(t)).filter(t=>Number.isInteger(t)))];e.length!==0&&await Xn("readwrite",t=>{e.forEach(s=>t.delete(s))})}async function DP(){return s0("readonly",n=>new Promise((e,t)=>{const s=n.getAll();s.onsuccess=()=>e(s.result||[]),s.onerror=()=>t(s.error)}))}async function jg(n){const e={text:n,created_at:new Date().toISOString()};return s0("readwrite",t=>new Promise((s,i)=>{const r=t.add(e);r.onsuccess=()=>s({...e,id:r.result}),r.onerror=()=>i(r.error)}))}async function FP(n){const e=[...new Set(n.map(t=>Number(t)).filter(t=>Number.isInteger(t)))];e.length!==0&&await s0("readwrite",t=>{e.forEach(s=>t.delete(s))})}async function OP(){return tg("readonly",n=>new Promise((e,t)=>{const s=n.getAll();s.onsuccess=()=>e(s.result||[]),s.onerror=()=>t(s.error)}))}async function jP({title:n,meeting_date:e,notes:t}){const s={title:n,meeting_date:e,notes:t,created_at:new Date().toISOString()};return tg("readwrite",i=>new Promise((r,a)=>{const o=i.add(s);o.onsuccess=()=>r({...s,id:o.result}),o.onerror=()=>a(o.error)}))}async function k_(n){return tg("readonly",e=>new Promise((t,s)=>{const i=e.get(Number(n));i.onsuccess=()=>t(i.result||null),i.onerror=()=>s(i.error)}))}async function zP(n,e){const t=await k_(n);if(!t)throw new Error("Not found");const s={...t,...e,updated_at:new Date().toISOString()};return await tg("readwrite",i=>{i.put(s)}),s}function BP({stickyNotes:n=[]}){const[e,t]=P.useState(""),[s,i]=P.useState([]),[r,a]=P.useState([]),[o,c]=P.useState("idle"),[u,h]=P.useState(""),[d,f]=P.useState(""),[p,y]=P.useState(!1),[w,_]=P.useState("idle"),[v,A]=P.useState(""),[b,E]=P.useState(""),[C,T]=P.useState(""),[k,N]=P.useState("idle"),[L,D]=P.useState(""),[O,j]=P.useState({author:"",title:"",url:"",published_date:"",citation_count:"",note:""}),[ee,J]=P.useState([]),[ye,z]=P.useState(""),[X,I]=P.useState(!0),[V,K]=P.useState({key:"created_at",direction:"desc"}),[oe,ie]=P.useState([]),[_e,pt]=P.useState("idle"),[Ln,Ee]=P.useState(""),[fe,Ks]=P.useState([]),Co=P.useRef(null),Ac=P.useRef(new Set);async function fd(){try{const R=await NP();i(R),a(ue=>ue.filter(pe=>R.some(Je=>Je.id===pe)))}catch{h("Could not load papers.")}}P.useEffect(()=>{fd()},[]),P.useEffect(()=>{let R=!1;async function ue(){try{const pe=await OP();if(!R){const Je=[...pe].sort((_t,xs)=>_t.meeting_date&&xs.meeting_date?xs.meeting_date.localeCompare(_t.meeting_date):(xs.created_at||"").localeCompare(_t.created_at||""));Ks(Je)}}catch{R||Ks([])}}return ue(),()=>{R=!0}},[]),P.useEffect(()=>{const R=localStorage.getItem("fyp-io-todo");R!==null&&f(R)},[]),P.useEffect(()=>{const R=localStorage.getItem("fyp-io-scope");R!==null&&(z(R),I(!0))},[]),P.useEffect(()=>{localStorage.setItem("fyp-io-todo",d)},[d]);const ng=s.length>0&&r.length===s.length,u0=r.length>0&&!ng;P.useEffect(()=>{Co.current&&(Co.current.indeterminate=u0)},[u0]),P.useEffect(()=>{let R=!1;async function ue(){for(const pe of s){if(R)return;if(!(!pe.note||Array.isArray(pe.keywords)&&pe.keywords.length>0)&&!Ac.current.has(pe.id)){Ac.current.add(pe.id),J(Je=>[...new Set([...Je,pe.id])]);try{const Je=await CP(pe.note);await mc(pe.id,{keywords:Je}),i(_t=>_t.map(xs=>xs.id===pe.id?{...xs,keywords:Je}:xs))}catch{}finally{Ac.current.delete(pe.id),R||J(Je=>Je.filter(_t=>_t!==pe.id))}break}}}return ue(),()=>{R=!0}},[s]);async function T_(R){if(R.preventDefault(),h(""),!e.trim()){h("Write a note first so I can extract metadata.");return}try{c("loading"),await TP(e.trim()),t(""),await fd()}catch{h("Extraction failed. Check Ollama and CORS, then try again.")}finally{c("idle")}}function P_(){if(ng){a([]);return}a(s.map(R=>R.id))}function N_(R){a(ue=>ue.includes(R)?ue.filter(pe=>pe!==R):[...ue,R])}async function R_(){if(r.length!==0)try{c("loading"),await IP(r),a([]),await fd()}catch{h("Failed to delete selected papers.")}finally{c("idle")}}function M_(R){z(R),I(!1)}function L_(){localStorage.setItem("fyp-io-scope",ye),I(!0)}function h0(R){K(ue=>ue.key!==R?{key:R,direction:"desc"}:{key:R,direction:ue.direction==="asc"?"desc":"asc"})}function d0(R){const ue=String(R||"").match(/\d{4}/);return ue?Number(ue[0]):null}const I_=[...s].sort((R,ue)=>{const pe=V.direction==="asc"?1:-1;if(V.key==="published_date"){const Je=d0(R.published_date)??0,_t=d0(ue.published_date)??0;return(Je-_t)*pe}if(V.key==="citation_count"){const Je=Number.isFinite(Number(R.citation_count))?Number(R.citation_count):-1,_t=Number.isFinite(Number(ue.citation_count))?Number(ue.citation_count):-1;return(Je-_t)*pe}return(R.id-ue.id)*pe});async function D_(){Ee(""),ie([]),pt("loading");try{const R=await kP(ye,s);ie(R),R.length===0&&Ee("No references available to suggest from.");const ue=document.getElementById("next-paper-suggestions");ue&&ue.scrollIntoView({behavior:"smooth",block:"start"})}catch{Ee("Suggestion failed. Check Ollama and try again.")}finally{pt("idle")}}function ko(R,ue){j(pe=>({...pe,[R]:ue})),A("")}async function F_(){if(!O.title.trim()&&!O.note.trim()){A("Add at least a title or a note.");return}try{_("loading"),await PP({...O,author:O.author.trim(),title:O.title.trim(),url:O.url.trim(),published_date:O.published_date.trim(),note:O.note.trim()}),j({author:"",title:"",url:"",published_date:"",citation_count:"",note:""}),y(!1),await fd()}catch{A("Failed to add paper.")}finally{_("idle")}}async function O_(R){if(R.preventDefault(),D(""),T(""),!b.trim()){D("Ask a question first.");return}try{N("loading");const ue=await EP(s,b);T(ue||"No answer returned.")}catch{D("Query failed. Check Ollama and try again.")}finally{N("idle")}}return g.jsxs("div",{className:"grid-layout",children:[g.jsxs("div",{className:"column left-column",children:[g.jsxs("section",{className:"card intro-card",children:[g.jsx("h2",{children:"Literature Desk"}),g.jsx("p",{className:"muted",children:"This page is for capturing research notes, extracting metadata, and keeping a living index of your sources."})]}),g.jsxs("section",{className:"card note-card",children:[g.jsx("h2",{children:"New Research Note"}),g.jsx("p",{className:"muted",children:"Paste your raw note, abstract, or citation. The AI will extract the core details and log it for you."}),g.jsxs("form",{onSubmit:T_,className:"note-form",children:[g.jsx("textarea",{value:e,onChange:R=>t(R.target.value),placeholder:"Example: Smith et al. (2022) found that... DOI: ...",rows:10}),g.jsxs("div",{className:"note-actions",children:[g.jsx("button",{type:"submit",disabled:o==="loading",children:o==="loading"?"Extracting":"Extract & Save"}),u?g.jsx("span",{className:"error",children:u}):null]})]})]}),g.jsxs("section",{className:"card note-card query-card",children:[g.jsx("h2",{children:"Literature Query"}),g.jsx("p",{className:"muted",children:"Ask questions about your saved notes. Ollama will answer using only your local database."}),g.jsxs("form",{onSubmit:O_,className:"note-form",children:[g.jsx("textarea",{value:b,onChange:R=>E(R.target.value),placeholder:"Example: What are common themes across my notes?",rows:6}),g.jsxs("div",{className:"note-actions",children:[g.jsx("button",{type:"submit",disabled:k==="loading",children:k==="loading"?"Thinking":"Ask"}),g.jsx("button",{type:"button",className:"clear-button",onClick:()=>T(""),disabled:!C,children:"Clear answer"}),L?g.jsx("span",{className:"error",children:L}):null]})]}),C?g.jsx("div",{className:"answer-box",children:C}):null]}),g.jsxs("section",{className:"card minutes-card",children:[g.jsx("div",{className:"table-header",children:g.jsx("h2",{children:"Supervisor meeting minutes"})}),g.jsx(on,{to:"/meeting-minutes/new",className:"ghost-link notepad-link minutes-link",children:"Add new minutes"}),g.jsx("p",{className:"muted",children:"Capture quick meeting notes and keep a running log."}),fe.length>0?g.jsx("div",{className:"minutes-tabs",children:fe.map(R=>g.jsxs(on,{to:`/meeting-minutes/${R.id}`,className:"minutes-tab",children:[g.jsx("span",{className:"minutes-date",children:R.meeting_date||"No date"}),g.jsx("span",{className:"minutes-title",children:R.title||"Untitled"})]},R.id))}):g.jsx("p",{className:"muted",children:"No minutes yet. Add your first meeting recap."})]})]}),g.jsxs("div",{className:"column right-column",children:[g.jsxs("section",{className:"card scope-card",children:[g.jsx("div",{className:"table-header",children:g.jsx("h2",{children:"Research Scope"})}),g.jsx("textarea",{className:"notepad-textarea",value:ye,onChange:R=>M_(R.target.value),placeholder:"Define the scope and purpose of your research...",rows:5}),g.jsx("div",{className:"note-actions",children:g.jsx("button",{type:"button",onClick:L_,disabled:X,children:X?"Saved":"Save scope"})})]}),g.jsxs("section",{className:"card notepad-card",children:[g.jsxs("div",{className:"table-header",children:[g.jsx("h2",{children:"Notepad"}),g.jsx(on,{to:"/sticky-notes",className:"ghost-link notepad-link",children:"Open sticky notes"})]}),g.jsx("textarea",{className:"notepad-textarea",value:d,onChange:R=>f(R.target.value),placeholder:"Write your to-do list here...",rows:6})]}),g.jsxs("section",{className:"card table-card",children:[g.jsxs("div",{className:"table-header",children:[g.jsx("h2",{children:"Literature Index"}),g.jsxs("div",{className:"table-actions",children:[r.length>0?g.jsxs("button",{type:"button",className:"danger-button",disabled:o==="loading",onClick:R_,children:["Delete selected (",r.length,")"]}):null,g.jsx("button",{type:"button",className:"suggest-button",onClick:D_,children:"Suggest my next paper"}),g.jsxs("div",{className:"count-group",children:[g.jsxs("span",{className:"count",children:[s.length," papers"]}),g.jsx("button",{type:"button",className:"add-button",onClick:()=>y(R=>!R),"aria-label":"Add paper manually",title:"Add paper",children:"+"})]})]})]}),p?g.jsxs("div",{className:"manual-form",children:[g.jsxs("div",{className:"manual-grid",children:[g.jsx("input",{className:"detail-input",placeholder:"Author",value:O.author,onChange:R=>ko("author",R.target.value)}),g.jsx("input",{className:"detail-input",placeholder:"Title",value:O.title,onChange:R=>ko("title",R.target.value)}),g.jsx("input",{className:"detail-input",placeholder:"URL",value:O.url,onChange:R=>ko("url",R.target.value)}),g.jsx("input",{className:"detail-input",placeholder:"Published",value:O.published_date,onChange:R=>ko("published_date",R.target.value)}),g.jsx("input",{className:"detail-input",type:"number",min:"0",placeholder:"Citations",value:O.citation_count,onChange:R=>ko("citation_count",R.target.value)})]}),g.jsx("textarea",{className:"detail-input detail-textarea",placeholder:"Note",value:O.note,onChange:R=>ko("note",R.target.value),rows:4}),g.jsxs("div",{className:"manual-actions",children:[g.jsx("button",{type:"button",onClick:F_,disabled:w==="loading",children:w==="loading"?"Saving":"Add paper"}),g.jsx("button",{type:"button",className:"ghost-link",onClick:()=>y(!1),children:"Cancel"}),v?g.jsx("span",{className:"error",children:v}):null]})]}):null,g.jsx("div",{className:"table-wrap",children:g.jsxs("table",{children:[g.jsx("thead",{children:g.jsxs("tr",{children:[g.jsx("th",{className:"checkbox-cell",children:g.jsx("input",{ref:Co,type:"checkbox",checked:ng,onChange:P_,"aria-label":"Select all papers"})}),g.jsx("th",{children:"Code"}),g.jsx("th",{children:"Author"}),g.jsx("th",{children:"Title"}),g.jsx("th",{children:"Link"}),g.jsx("th",{children:g.jsxs("button",{type:"button",className:"sort-button",onClick:()=>h0("published_date"),children:["Published",g.jsx("span",{className:"sort-arrow",children:V.key==="published_date"?V.direction==="asc"?"":"":""})]})}),g.jsx("th",{children:g.jsxs("button",{type:"button",className:"sort-button",onClick:()=>h0("citation_count"),children:["Citations",g.jsx("span",{className:"sort-arrow",children:V.key==="citation_count"?V.direction==="asc"?"":"":""})]})})]})}),g.jsx("tbody",{children:s.length===0?g.jsx("tr",{children:g.jsx("td",{colSpan:"7",className:"empty",children:"No notes yet. Add one to populate your table."})}):I_.map(R=>g.jsxs("tr",{children:[g.jsx("td",{className:"checkbox-cell",children:g.jsx("input",{type:"checkbox",checked:r.includes(R.id),onChange:()=>N_(R.id),"aria-label":`Select ${R.title||"paper"}`})}),g.jsx("td",{className:"code-cell",children:R.code||""}),g.jsx("td",{children:g.jsx(on,{to:`/paper/${R.id}`,className:"row-link",children:R.author||"Unknown"})}),g.jsx("td",{children:R.title||"Untitled"}),g.jsx("td",{children:R.url?g.jsx("a",{href:R.url,target:"_blank",rel:"noreferrer",children:"Open"}):""}),g.jsx("td",{children:R.published_date||""}),g.jsx("td",{children:R.citation_count===null||R.citation_count===void 0?"":R.citation_count})]},R.id))})]})})]})]}),g.jsxs("section",{className:"card timeline-card full-width",children:[g.jsx("h2",{children:"Literature Timeline"}),g.jsx("p",{className:"muted",children:"A quick, visual sweep of your notes by date."}),g.jsx("div",{className:"timeline-track",children:s.length===0?g.jsx("p",{className:"muted",children:"Add papers to see them plotted here."}):[...s].slice().sort((R,ue)=>{const pe=xs=>{const Sc=String(xs||"").match(/\d{4}/);return Sc?Number(Sc[0]):null},Je=pe(R.published_date)??pe(R.created_at)??0,_t=pe(ue.published_date)??pe(ue.created_at)??0;return Je-_t}).map(R=>{const ue=R.published_date||R.created_at||"",pe=String(ue).match(/\d{4}/),Je=pe?pe[0]:"",_t=R.note||"",Sc=_t.split(`
`).map(bs=>bs.trim()).filter(Boolean).filter(bs=>/^[-*]/.test(bs));return Sc.length?Sc.map(bs=>bs.replace(/^[-*]\s*/,"")).slice(0,2):_t.split(new RegExp("(?<=[.!?])\\s+")).map(bs=>bs.trim()).filter(Boolean).slice(0,2),g.jsxs("div",{className:"timeline-item",children:[g.jsx("div",{className:"timeline-dot"}),g.jsxs("div",{className:"timeline-meta",children:[g.jsx("span",{className:"timeline-year",children:Je}),g.jsx("span",{className:"timeline-code",children:R.code||""})]}),g.jsx("div",{className:"timeline-title",children:R.title||"Untitled"}),Array.isArray(R.keywords)&&R.keywords.length>0?g.jsx("div",{className:"timeline-keywords",children:R.keywords.map(bs=>g.jsx("span",{className:"keyword-chip",children:bs},bs))}):g.jsx("p",{className:"muted",children:ee.includes(R.id)?"Extracting keywords":"No keywords yet."})]},R.id)})})]}),g.jsxs("section",{className:"card info-card full-width suggested-card",id:"next-paper-suggestions",children:[g.jsx("h2",{children:"Suggested Next Papers"}),g.jsx("p",{className:"muted",children:"Ollama is analysing references from uploaded papers..."}),_e==="loading"?g.jsx("p",{className:"muted",children:"Working on suggestions..."}):null,Ln?g.jsx("p",{className:"error",children:Ln}):null,oe.length>0?g.jsx("div",{className:"references-list",children:oe.join(`
`)}):null]}),g.jsxs("section",{className:"card info-card full-width",id:"ollama-info",children:[g.jsx("h2",{children:"What is Ollama?"}),g.jsx("p",{className:"muted",children:"Ollama runs language models on your machine. This app connects to it locally so you can extract metadata without a paid API."}),g.jsxs("div",{className:"info-list",children:[g.jsx("span",{className:"info-label",children:"Download"}),g.jsxs("span",{children:["Install from ",g.jsx("a",{href:"https://ollama.com",target:"_blank",rel:"noreferrer",children:"ollama.com"}),"."]})]}),g.jsxs("div",{className:"info-list",children:[g.jsx("span",{className:"info-label",children:"Start"}),g.jsx("span",{children:"Run `ollama serve` to start the local API."})]}),g.jsxs("div",{className:"info-list",children:[g.jsx("span",{className:"info-label",children:"Model"}),g.jsx("span",{children:"Pull a model: `ollama pull llama3.1`."})]}),g.jsxs("div",{className:"info-list",children:[g.jsx("span",{className:"info-label",children:"CORS"}),g.jsx("span",{children:'For GitHub Pages: `OLLAMA_ORIGINS="https://clarabollengandolfo.github.io" ollama serve`.'})]})]})]})}function HP(){const[n,e]=P.useState(""),[t,s]=P.useState(""),[i,r]=P.useState(""),[a,o]=P.useState("idle"),[c,u]=P.useState(""),h=Sx();async function d(f){if(f.preventDefault(),u(""),!t||!n.trim()){u("Add a date and title.");return}try{o("saving"),await jP({title:n.trim(),meeting_date:t,notes:i.trim()}),h("/tool")}catch{u("Could not save meeting minutes.")}finally{o("idle")}}return g.jsxs("section",{className:"card minutes-card",children:[g.jsx("div",{className:"table-header",children:g.jsx("h2",{children:"Supervisor meeting minutes"})}),g.jsx("p",{className:"muted",children:"Log a quick summary of what you discussed and any follow-ups."}),g.jsxs("form",{className:"minutes-form",onSubmit:d,children:[g.jsxs("div",{className:"minutes-grid",children:[g.jsx("input",{className:"detail-input",type:"date",value:t,onChange:f=>s(f.target.value)}),g.jsx("input",{className:"detail-input",placeholder:"Meeting title",value:n,onChange:f=>e(f.target.value)})]}),g.jsx("textarea",{className:"detail-input detail-textarea",placeholder:"Notes from the meeting...",value:i,onChange:f=>r(f.target.value),rows:8}),g.jsxs("div",{className:"note-actions",children:[g.jsx("button",{type:"submit",disabled:a==="saving",children:a==="saving"?"Saving":"Save minutes"}),c?g.jsx("span",{className:"error",children:c}):null]})]})]})}function UP(){const{id:n}=xx(),[e,t]=P.useState(null),[s,i]=P.useState(!1),[r,a]=P.useState({meeting_date:"",title:"",notes:""}),[o,c]=P.useState("idle"),[u,h]=P.useState("");P.useEffect(()=>{let p=!1;async function y(){h("");try{const w=await k_(n);p||(t(w),w&&a({meeting_date:w.meeting_date||"",title:w.title||"",notes:w.notes||""}))}catch{p||h("Could not load meeting minutes.")}}return y(),()=>{p=!0}},[n]);function d(p,y){a(w=>({...w,[p]:y}))}async function f(){if(e){if(!r.meeting_date||!r.title.trim()){h("Add a date and title.");return}c("saving"),h("");try{const p=await zP(e.id,{meeting_date:r.meeting_date,title:r.title.trim(),notes:r.notes.trim()});t(p),i(!1)}catch{h("Could not save updates.")}finally{c("idle")}}}return!e&&!u?g.jsx("section",{className:"card minutes-card",children:g.jsx("p",{className:"muted",children:"Loading minutes..."})}):e?g.jsxs("section",{className:"card minutes-card",children:[g.jsxs("div",{className:"table-header",children:[g.jsx("h2",{children:"Supervisor meeting minutes"}),g.jsxs("div",{className:"sticky-notes-actions",children:[g.jsx("button",{type:"button",className:"ghost-link",onClick:()=>i(p=>!p),children:s?"Cancel":"Edit"}),g.jsx(on,{to:"/tool",className:"ghost-link",children:"Back to tool"})]})]}),s?g.jsxs("div",{className:"minutes-form",children:[g.jsxs("div",{className:"minutes-grid",children:[g.jsx("input",{className:"detail-input",type:"date",value:r.meeting_date,onChange:p=>d("meeting_date",p.target.value)}),g.jsx("input",{className:"detail-input",placeholder:"Meeting title",value:r.title,onChange:p=>d("title",p.target.value)})]}),g.jsx("textarea",{className:"detail-input detail-textarea",placeholder:"Notes from the meeting...",value:r.notes,onChange:p=>d("notes",p.target.value),rows:10}),g.jsxs("div",{className:"note-actions",children:[g.jsx("button",{type:"button",onClick:f,disabled:o==="saving",children:o==="saving"?"Saving":"Save changes"}),u?g.jsx("span",{className:"error",children:u}):null]})]}):g.jsxs("div",{className:"minutes-detail",children:[g.jsxs("div",{className:"minutes-meta",children:[g.jsx("span",{className:"minutes-date",children:e.meeting_date||"No date"}),g.jsx("span",{className:"minutes-title",children:e.title||"Untitled"})]}),g.jsx("div",{className:"minutes-notes",children:e.notes||"No notes yet."})]})]}):g.jsxs("section",{className:"card minutes-card",children:[g.jsx("p",{className:"error",children:u||"Minutes not found."}),g.jsx(on,{to:"/tool",className:"ghost-link",children:"Back to tool"})]})}function $P(){const{id:n}=xx(),[e,t]=P.useState(null),[s,i]=P.useState(null),[r,a]=P.useState("idle"),[o,c]=P.useState(""),[u,h]=P.useState(""),[d,f]=P.useState(!1),[p,y]=P.useState(""),[w,_]=P.useState("idle"),[v,A]=P.useState(""),[b,E]=P.useState(!1);function C(j){return{author:j.author||"",title:j.title||"",url:j.url||"",published_date:j.published_date||"",citation_count:j.citation_count===null||j.citation_count===void 0?"":String(j.citation_count),note:j.note||""}}const T=P.useMemo(()=>!s||!e?!1:s.author!==(e.author||"")||s.title!==(e.title||"")||s.url!==(e.url||"")||s.published_date!==(e.published_date||"")||s.citation_count!==(e.citation_count===null||e.citation_count===void 0?"":String(e.citation_count))||s.note!==(e.note||""),[s,e]);P.useEffect(()=>{async function j(){try{const ee=await C_(n);t(ee),i(C(ee))}catch{c("Could not load paper.")}}j()},[n]),P.useEffect(()=>{if(!(e!=null&&e.pdf_blob)){y("");return}const j=URL.createObjectURL(e.pdf_blob);return y(j),()=>{URL.revokeObjectURL(j)}},[e==null?void 0:e.pdf_blob]),P.useEffect(()=>{if(!(e&&b&&e.pdf_blob&&(!e.pdf_text||!Array.isArray(e.references)||e.references.length===0)))return;let ee=!1;async function J(){try{const ye=await LP(e.id);ee||(t(ye),i(C(ye)))}catch{}}return J(),()=>{ee=!0}},[e,b]);function k(j,ee){i(J=>({...J,[j]:ee})),h("")}function N(){if(!d){f(!0);return}f(!1),i(C(e))}async function L(j){var J;const ee=(J=j.target.files)==null?void 0:J[0];if(!(!ee||!e)){_("loading"),A("");try{const ye=await RP(e.id,ee);t(ye),i(C(ye))}catch{A("Failed to attach PDF.")}finally{_("idle"),j.target.value=""}}}async function D(){if(e){_("loading"),A("");try{const j=await MP(e.id);t(j),i(C(j)),E(!1)}catch{A("Failed to remove PDF.")}finally{_("idle")}}}async function O(){if(!(!s||!e||!T)){a("saving"),c(""),h("");try{const j=await mc(e.id,{author:s.author.trim(),title:s.title.trim(),url:s.url.trim(),published_date:s.published_date.trim(),citation_count:s.citation_count===""?null:Number(s.citation_count),note:s.note.trim()});t(j),i(C(j)),h("Saved.")}catch{c("Could not save changes.")}finally{a("idle")}}}return o?g.jsxs("div",{className:"card detail-card",children:[g.jsx("p",{className:"error",children:o}),g.jsx(on,{to:"/",className:"ghost-link",children:"Back to dashboard"})]}):!e||!s?g.jsx("div",{className:"card detail-card",children:g.jsx("p",{className:"muted",children:"Loading paper"})}):g.jsxs("div",{className:"card detail-card",children:[g.jsxs("div",{className:"detail-header",children:[g.jsxs("div",{children:[g.jsx("p",{className:"app-kicker",children:"Paper Detail"}),g.jsx("h2",{children:(d?s.title:e.title)||"Untitled"})]}),g.jsxs("div",{className:"detail-header-actions",children:[g.jsx("button",{type:"button",className:"edit-toggle",onClick:N,children:d?"End edit":"Edit"}),g.jsx(on,{to:"/",className:"ghost-link",children:"Back to dashboard"})]})]}),g.jsxs("dl",{className:"detail-list",children:[g.jsxs("div",{children:[g.jsx("dt",{children:"Author"}),g.jsx("dd",{children:d?g.jsx("input",{className:"detail-input",value:s.author,onChange:j=>k("author",j.target.value),placeholder:"Unknown"}):g.jsx("span",{children:e.author||"Unknown"})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Published"}),g.jsx("dd",{children:d?g.jsx("input",{className:"detail-input",value:s.published_date,onChange:j=>k("published_date",j.target.value),placeholder:""}):g.jsx("span",{children:e.published_date||""})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Citations"}),g.jsx("dd",{children:d?g.jsx("input",{className:"detail-input",type:"number",min:"0",value:s.citation_count,onChange:j=>k("citation_count",j.target.value),placeholder:""}):g.jsx("span",{children:e.citation_count===null||e.citation_count===void 0?"":e.citation_count})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Link"}),g.jsx("dd",{children:d?g.jsx("input",{className:"detail-input",value:s.url,onChange:j=>k("url",j.target.value),placeholder:""}):e.url?g.jsx("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.url}):g.jsx("span",{children:""})})]}),g.jsxs("div",{children:[g.jsx("dt",{children:"Title"}),g.jsx("dd",{children:d?g.jsx("input",{className:"detail-input",value:s.title,onChange:j=>k("title",j.target.value),placeholder:"Untitled"}):g.jsx("span",{children:e.title||"Untitled"})})]})]}),d?g.jsxs("div",{className:"detail-actions",children:[g.jsx("button",{type:"button",onClick:O,disabled:!T||r==="saving",children:r==="saving"?"Saving":"Save changes"}),u?g.jsx("span",{className:"muted",children:u}):null,o?g.jsx("span",{className:"error",children:o}):null]}):null,g.jsxs("div",{className:"pdf-block",children:[g.jsx("h3",{children:"Paper PDF"}),g.jsxs("div",{className:"pdf-actions",children:[g.jsx("input",{type:"file",accept:"application/pdf",onChange:L}),p?g.jsx("a",{href:p,target:"_blank",rel:"noreferrer",children:"Open PDF"}):null,e.pdf_name?g.jsx("span",{className:"muted",children:e.pdf_name}):null,e.pdf_name?g.jsx("button",{type:"button",className:"ghost-link",onClick:D,disabled:w==="loading",children:"Remove"}):null]}),w==="loading"?g.jsx("p",{className:"muted",children:"Extracting text..."}):null,v?g.jsx("p",{className:"error",children:v}):null]}),g.jsxs("div",{className:"notes-block",children:[g.jsx("h3",{children:"Original Note"}),d?g.jsx("textarea",{className:"detail-input detail-textarea",value:s.note,onChange:j=>k("note",j.target.value),rows:6}):g.jsx("p",{className:"note-text",children:e.note||""}),g.jsxs("div",{className:"references-block",children:[g.jsx("button",{type:"button",className:"ghost-link",onClick:()=>E(j=>!j),children:b?"Hide references":"Display references"}),b?e.references&&e.references.length>0?g.jsx("div",{className:"references-list",children:e.references.join(`
`)}):g.jsx("p",{className:"muted",children:e.pdf_name?"No references found in this PDF.":"Please upload the paper."}):null]})]})]})}function VP({stickyNotes:n=[],onDeleteStickyNotes:e}){const[t,s]=P.useState(!1),[i,r]=P.useState([]),a=P.useMemo(()=>new Set(i),[i]);function o(u){r(h=>h.includes(u)?h.filter(d=>d!==u):[...h,u])}async function c(){!e||i.length===0||(await e(i),r([]),s(!1))}return g.jsxs("section",{className:"card sticky-notes-page",children:[g.jsxs("div",{className:"table-header",children:[g.jsx("h2",{children:"Sticky Notes"}),g.jsxs("div",{className:"sticky-notes-actions",children:[n.length>0?g.jsxs(g.Fragment,{children:[g.jsx("button",{type:"button",className:"ghost-link",onClick:()=>{s(u=>!u),r([])},children:t?"Done selecting":"Select"}),g.jsx("button",{type:"button",className:"danger-button",disabled:!t||i.length===0,onClick:c,children:"Delete selected"})]}):null,g.jsx(on,{to:"/tool",className:"ghost-link",children:"Back to tool"})]})]}),g.jsx("p",{className:"muted",children:"All quick thoughts captured from the sticky note panel."}),n.length>0?g.jsx("div",{className:"sticky-notes-grid",children:n.map(u=>{const h=u.created_at?new Date(u.created_at):null,d=h&&!Number.isNaN(h.getTime())?`${h.toLocaleDateString()} ${h.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"";return g.jsxs("article",{className:"sticky-note-card",children:[t?g.jsxs("label",{className:"sticky-note-select",children:[g.jsx("input",{type:"checkbox",checked:a.has(u.id),onChange:()=>o(u.id),"aria-label":`Select sticky note ${u.id}`}),g.jsx("span",{children:"Select"})]}):null,g.jsx("p",{children:u.text}),d?g.jsx("span",{className:"muted",children:d}):null]},u.id)})}):g.jsx("p",{className:"muted",children:"No sticky notes yet. Add one from the top-right icon."})]})}function WP(){const[n,e]=P.useState("idle"),[t,s]=P.useState("");async function i(){e("loading"),s("");try{const a=await fetch("http://localhost:11434/api/tags");if(!a.ok)throw new Error(`Ollama returned ${a.status}`);const o=await a.json(),c=Array.isArray(o==null?void 0:o.models)?o.models.length:0;e("success"),s(c>0?`${c} model(s)`:"No models")}catch{e("error"),s("Not reachable")}}function r(){const a=document.getElementById("ollama-info");a&&a.scrollIntoView({behavior:"smooth",block:"start"})}return g.jsxs("div",{className:"ollama-widget",children:[g.jsxs("div",{className:"ollama-widget-header",children:[g.jsx("span",{children:"Ollama"}),g.jsx("button",{type:"button",className:"info-icon",onClick:r,"aria-label":"Learn about Ollama",children:"i"})]}),g.jsx("button",{type:"button",onClick:i,disabled:n==="loading",children:n==="loading"?"Checking":"Test"}),t?g.jsx("span",{className:n==="error"?"error":"muted",children:t}):null]})}function GP(){const[n,e]=P.useState(!1),[t,s]=P.useState(""),[i,r]=P.useState([]);P.useEffect(()=>{let c=!1;async function u(){try{const h=await DP();if(c)return;if(h.length>0){r(h);return}const d=localStorage.getItem("fyp-io-sticky-notes");if(d)try{const p=JSON.parse(d);if(Array.isArray(p)&&p.length>0){const y=[];for(const w of p)w&&w.text&&y.push(await jg(String(w.text)));if(!c&&y.length>0){r(y);return}}}catch{}const f=await jg("Capture quick thoughts while you read.");c||r([f])}catch{c||r([])}}return u(),()=>{c=!0}},[]);async function a(){const c=t.trim();if(c)try{const u=await jg(c);r(h=>[u,...h]),s("")}catch{}}async function o(c){if(c.length)try{await FP(c),r(u=>u.filter(h=>!c.includes(h.id)))}catch{}}return g.jsxs("div",{className:"app-shell",children:[g.jsxs("header",{className:"app-header",children:[g.jsxs("div",{children:[g.jsx("a",{href:"https://clarabollengandolfo.github.io/",className:"profile-button",target:"_blank",rel:"noreferrer",children:"clara bollen gandolfo"}),g.jsx("h1",{className:"app-title",children:"Literature Desk"})]}),g.jsxs("div",{className:"app-header-actions",children:[g.jsx(WP,{}),g.jsxs("nav",{children:[g.jsx(on,{to:"/",className:"ghost-link",children:"Home"}),g.jsx(on,{to:"/tool",className:"ghost-link",children:"Tool"})]}),g.jsx("button",{type:"button",className:"sticky-icon-button",onClick:()=>e(c=>!c),"aria-label":"Open sticky notes",children:g.jsxs("svg",{viewBox:"0 0 64 64","aria-hidden":"true",className:"sticky-icon",children:[g.jsx("path",{d:"M12 6h32l12 12v34H12V6z",fill:"#ffffff"}),g.jsx("path",{d:"M44 6v14h14",fill:"#ffffff"}),g.jsx("path",{d:"M12 6h32l12 12v34H12V6zM44 6v14h14",fill:"none",stroke:"#1c1c1c",strokeWidth:"2.4"}),g.jsx("path",{d:"M18 18h20",stroke:"#1c1c1c",strokeWidth:"2.2","stroke-linecap":"round"}),g.jsx("path",{d:"M18 26h24",stroke:"#1c1c1c",strokeWidth:"2.2","stroke-linecap":"round"})]})}),g.jsx("a",{href:"https://www.overleaf.com/project/6967b6d7653766a341e88fa5",className:"report-button",target:"_blank",rel:"noreferrer",children:"Report"})]})]}),n?g.jsxs("div",{className:"sticky-panel",role:"dialog","aria-label":"Sticky notes",children:[g.jsxs("div",{className:"sticky-panel-header",children:[g.jsx("h2",{children:"Sticky notes"}),g.jsx("button",{type:"button",className:"ghost-link",onClick:()=>e(!1),children:"Close"})]}),g.jsx("textarea",{className:"sticky-textarea",value:t,onChange:c=>s(c.target.value),placeholder:"Jot a thought...",rows:4}),g.jsx("div",{className:"note-actions",children:g.jsx("button",{type:"button",onClick:a,children:"Add to notes"})}),g.jsx(on,{to:"/sticky-notes",className:"ghost-link sticky-panel-link",children:"Open sticky notes"})]}):null,g.jsx("main",{className:"app-main",children:g.jsxs(ak,{children:[g.jsx(Kr,{path:"/",element:g.jsx(yk,{})}),g.jsx(Kr,{path:"/tool",element:g.jsx(BP,{stickyNotes:i})}),g.jsx(Kr,{path:"/meeting-minutes/new",element:g.jsx(HP,{})}),g.jsx(Kr,{path:"/meeting-minutes/:id",element:g.jsx(UP,{})}),g.jsx(Kr,{path:"/sticky-notes",element:g.jsx(VP,{stickyNotes:i,onDeleteStickyNotes:o})}),g.jsx(Kr,{path:"/paper/:id",element:g.jsx($P,{})})]})})]})}fx(document.getElementById("root")).render(g.jsx(uA.StrictMode,{children:g.jsx(fk,{children:g.jsx(GP,{})})}));
