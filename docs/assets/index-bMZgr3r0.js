var C_=Object.defineProperty;var s0=n=>{throw TypeError(n)};var k_=(n,e,t)=>e in n?C_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Y=(n,e,t)=>k_(n,typeof e!="symbol"?e+"":e,t),Jp=(n,e,t)=>e.has(n)||s0("Cannot "+t);var l=(n,e,t)=>(Jp(n,e,"read from private field"),t?t.call(n):e.get(n)),S=(n,e,t)=>e.has(n)?s0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),g=(n,e,t,i)=>(Jp(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),x=(n,e,t)=>(Jp(n,e,"access private method"),t);var Ot=(n,e,t,i)=>({set _(s){g(n,e,s,t)},get _(){return l(n,e,i)}});function T_(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in n)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function P_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ww={exports:{}},bp={},Gw={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nd=Symbol.for("react.element"),N_=Symbol.for("react.portal"),R_=Symbol.for("react.fragment"),L_=Symbol.for("react.strict_mode"),M_=Symbol.for("react.profiler"),I_=Symbol.for("react.provider"),D_=Symbol.for("react.context"),F_=Symbol.for("react.forward_ref"),O_=Symbol.for("react.suspense"),j_=Symbol.for("react.memo"),z_=Symbol.for("react.lazy"),r0=Symbol.iterator;function B_(n){return n===null||typeof n!="object"?null:(n=r0&&n[r0]||n["@@iterator"],typeof n=="function"?n:null)}var Xw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qw=Object.assign,Yw={};function mc(n,e,t){this.props=n,this.context=e,this.refs=Yw,this.updater=t||Xw}mc.prototype.isReactComponent={};mc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};mc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Kw(){}Kw.prototype=mc.prototype;function Vy(n,e,t){this.props=n,this.context=e,this.refs=Yw,this.updater=t||Xw}var Wy=Vy.prototype=new Kw;Wy.constructor=Vy;qw(Wy,mc.prototype);Wy.isPureReactComponent=!0;var a0=Array.isArray,Qw=Object.prototype.hasOwnProperty,Gy={current:null},Jw={key:!0,ref:!0,__self:!0,__source:!0};function Zw(n,e,t){var i,s={},r=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)Qw.call(e,i)&&!Jw.hasOwnProperty(i)&&(s[i]=e[i]);var o=arguments.length-2;if(o===1)s.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(n&&n.defaultProps)for(i in o=n.defaultProps,o)s[i]===void 0&&(s[i]=o[i]);return{$$typeof:nd,type:n,key:r,ref:a,props:s,_owner:Gy.current}}function H_(n,e){return{$$typeof:nd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Xy(n){return typeof n=="object"&&n!==null&&n.$$typeof===nd}function U_(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var o0=/\/+/g;function Zp(n,e){return typeof n=="object"&&n!==null&&n.key!=null?U_(""+n.key):e.toString(36)}function Md(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case nd:case N_:a=!0}}if(a)return a=n,s=s(a),n=i===""?"."+Zp(a,0):i,a0(s)?(t="",n!=null&&(t=n.replace(o0,"$&/")+"/"),Md(s,e,t,"",function(u){return u})):s!=null&&(Xy(s)&&(s=H_(s,t+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(o0,"$&/")+"/")+n)),e.push(s)),1;if(a=0,i=i===""?".":i+":",a0(n))for(var o=0;o<n.length;o++){r=n[o];var c=i+Zp(r,o);a+=Md(r,e,t,c,s)}else if(c=B_(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=i+Zp(r,o++),a+=Md(r,e,t,c,s);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function dd(n,e,t){if(n==null)return n;var i=[],s=0;return Md(n,i,"","",function(r){return e.call(t,r,s++)}),i}function $_(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var qt={current:null},Id={transition:null},V_={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:Id,ReactCurrentOwner:Gy};function eA(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:dd,forEach:function(n,e,t){dd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return dd(n,function(){e++}),e},toArray:function(n){return dd(n,function(e){return e})||[]},only:function(n){if(!Xy(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};le.Component=mc;le.Fragment=R_;le.Profiler=M_;le.PureComponent=Vy;le.StrictMode=L_;le.Suspense=O_;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V_;le.act=eA;le.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=qw({},n.props),s=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=Gy.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)Qw.call(e,c)&&!Jw.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];i.children=o}return{$$typeof:nd,type:n.type,key:s,ref:r,props:i,_owner:a}};le.createContext=function(n){return n={$$typeof:D_,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:I_,_context:n},n.Consumer=n};le.createElement=Zw;le.createFactory=function(n){var e=Zw.bind(null,n);return e.type=n,e};le.createRef=function(){return{current:null}};le.forwardRef=function(n){return{$$typeof:F_,render:n}};le.isValidElement=Xy;le.lazy=function(n){return{$$typeof:z_,_payload:{_status:-1,_result:n},_init:$_}};le.memo=function(n,e){return{$$typeof:j_,type:n,compare:e===void 0?null:e}};le.startTransition=function(n){var e=Id.transition;Id.transition={};try{n()}finally{Id.transition=e}};le.unstable_act=eA;le.useCallback=function(n,e){return qt.current.useCallback(n,e)};le.useContext=function(n){return qt.current.useContext(n)};le.useDebugValue=function(){};le.useDeferredValue=function(n){return qt.current.useDeferredValue(n)};le.useEffect=function(n,e){return qt.current.useEffect(n,e)};le.useId=function(){return qt.current.useId()};le.useImperativeHandle=function(n,e,t){return qt.current.useImperativeHandle(n,e,t)};le.useInsertionEffect=function(n,e){return qt.current.useInsertionEffect(n,e)};le.useLayoutEffect=function(n,e){return qt.current.useLayoutEffect(n,e)};le.useMemo=function(n,e){return qt.current.useMemo(n,e)};le.useReducer=function(n,e,t){return qt.current.useReducer(n,e,t)};le.useRef=function(n){return qt.current.useRef(n)};le.useState=function(n){return qt.current.useState(n)};le.useSyncExternalStore=function(n,e,t){return qt.current.useSyncExternalStore(n,e,t)};le.useTransition=function(){return qt.current.useTransition()};le.version="18.3.1";Gw.exports=le;var N=Gw.exports;const tA=P_(N),W_=T_({__proto__:null,default:tA},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_=N,X_=Symbol.for("react.element"),q_=Symbol.for("react.fragment"),Y_=Object.prototype.hasOwnProperty,K_=G_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q_={key:!0,ref:!0,__self:!0,__source:!0};function nA(n,e,t){var i,s={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)Y_.call(e,i)&&!Q_.hasOwnProperty(i)&&(s[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:X_,type:n,key:r,ref:a,props:s,_owner:K_.current}}bp.Fragment=q_;bp.jsx=nA;bp.jsxs=nA;Ww.exports=bp;var v=Ww.exports,iA={exports:{}},Nn={},sA={exports:{}},rA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(I,X){var q=I.length;I.push(X);e:for(;0<q;){var ae=q-1>>>1,oe=I[ae];if(0<s(oe,X))I[ae]=X,I[q]=oe,q=ae;else break e}}function t(I){return I.length===0?null:I[0]}function i(I){if(I.length===0)return null;var X=I[0],q=I.pop();if(q!==X){I[0]=q;e:for(var ae=0,oe=I.length,be=oe>>>1;ae<be;){var ft=2*(ae+1)-1,cn=I[ft],Ee=ft+1,ue=I[Ee];if(0>s(cn,q))Ee<oe&&0>s(ue,cn)?(I[ae]=ue,I[Ee]=q,ae=Ee):(I[ae]=cn,I[ft]=q,ae=ft);else if(Ee<oe&&0>s(ue,q))I[ae]=ue,I[Ee]=q,ae=Ee;else break e}}return X}function s(I,X){var q=I.sortIndex-X.sortIndex;return q!==0?q:I.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,A=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var X=t(u);X!==null;){if(X.callback===null)i(u);else if(X.startTime<=I)i(u),X.sortIndex=X.expirationTime,e(c,X);else break;X=t(u)}}function E(I){if(A=!1,b(I),!m)if(t(c)!==null)m=!0,j(C);else{var X=t(u);X!==null&&W(E,X.startTime-I)}}function C(I,X){m=!1,A&&(A=!1,y(P),P=-1),p=!0;var q=f;try{for(b(X),d=t(c);d!==null&&(!(d.expirationTime>X)||I&&!$());){var ae=d.callback;if(typeof ae=="function"){d.callback=null,f=d.priorityLevel;var oe=ae(d.expirationTime<=X);X=n.unstable_now(),typeof oe=="function"?d.callback=oe:d===t(c)&&i(c),b(X)}else i(c);d=t(c)}if(d!==null)var be=!0;else{var ft=t(u);ft!==null&&W(E,ft.startTime-X),be=!1}return be}finally{d=null,f=q,p=!1}}var T=!1,k=null,P=-1,D=5,M=-1;function $(){return!(n.unstable_now()-M<D)}function O(){if(k!==null){var I=n.unstable_now();M=I;var X=!0;try{X=k(!0,I)}finally{X?Z():(T=!1,k=null)}}else T=!1}var Z;if(typeof w=="function")Z=function(){w(O)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,Ae=J.port2;J.port1.onmessage=O,Z=function(){Ae.postMessage(null)}}else Z=function(){_(O,0)};function j(I){k=I,T||(T=!0,Z())}function W(I,X){P=_(function(){I(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_continueExecution=function(){m||p||(m=!0,j(C))},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(I){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var q=f;f=X;try{return I()}finally{f=q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(I,X){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var q=f;f=I;try{return X()}finally{f=q}},n.unstable_scheduleCallback=function(I,X,q){var ae=n.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?ae+q:ae):q=ae,I){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=q+oe,I={id:h++,callback:X,priorityLevel:I,startTime:q,expirationTime:oe,sortIndex:-1},q>ae?(I.sortIndex=q,e(u,I),t(c)===null&&I===t(u)&&(A?(y(P),P=-1):A=!0,W(E,q-ae))):(I.sortIndex=oe,e(c,I),m||p||(m=!0,j(C))),I},n.unstable_shouldYield=$,n.unstable_wrapCallback=function(I){var X=f;return function(){var q=f;f=X;try{return I.apply(this,arguments)}finally{f=q}}}})(rA);sA.exports=rA;var J_=sA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_=N,Pn=J_;function L(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var aA=new Set,cu={};function wo(n,e){lc(n,e),lc(n+"Capture",e)}function lc(n,e){for(cu[n]=e,n=0;n<e.length;n++)aA.add(e[n])}var Ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mg=Object.prototype.hasOwnProperty,eE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,l0={},c0={};function tE(n){return Mg.call(c0,n)?!0:Mg.call(l0,n)?!1:eE.test(n)?c0[n]=!0:(l0[n]=!0,!1)}function nE(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function iE(n,e,t,i){if(e===null||typeof e>"u"||nE(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yt(n,e,t,i,s,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){bt[n]=new Yt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];bt[e]=new Yt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){bt[n]=new Yt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){bt[n]=new Yt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){bt[n]=new Yt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){bt[n]=new Yt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){bt[n]=new Yt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){bt[n]=new Yt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){bt[n]=new Yt(n,5,!1,n.toLowerCase(),null,!1,!1)});var qy=/[\-:]([a-z])/g;function Yy(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(qy,Yy);bt[e]=new Yt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(qy,Yy);bt[e]=new Yt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(qy,Yy);bt[e]=new Yt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){bt[n]=new Yt(n,1,!1,n.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Yt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){bt[n]=new Yt(n,1,!1,n.toLowerCase(),null,!0,!0)});function Ky(n,e,t,i){var s=bt.hasOwnProperty(e)?bt[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(iE(e,t,s,i)&&(t=null),i||s===null?tE(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,i=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var zs=Z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fd=Symbol.for("react.element"),Do=Symbol.for("react.portal"),Fo=Symbol.for("react.fragment"),Qy=Symbol.for("react.strict_mode"),Ig=Symbol.for("react.profiler"),oA=Symbol.for("react.provider"),lA=Symbol.for("react.context"),Jy=Symbol.for("react.forward_ref"),Dg=Symbol.for("react.suspense"),Fg=Symbol.for("react.suspense_list"),Zy=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),cA=Symbol.for("react.offscreen"),u0=Symbol.iterator;function Ac(n){return n===null||typeof n!="object"?null:(n=u0&&n[u0]||n["@@iterator"],typeof n=="function"?n:null)}var Be=Object.assign,eg;function Lc(n){if(eg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);eg=e&&e[1]||""}return`
`+eg+n}var tg=!1;function ng(n,e){if(!n||tg)return"";tg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),r=i.stack.split(`
`),a=s.length-1,o=r.length-1;1<=a&&0<=o&&s[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==r[o]){var c=`
`+s[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{tg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Lc(n):""}function sE(n){switch(n.tag){case 5:return Lc(n.type);case 16:return Lc("Lazy");case 13:return Lc("Suspense");case 19:return Lc("SuspenseList");case 0:case 2:case 15:return n=ng(n.type,!1),n;case 11:return n=ng(n.type.render,!1),n;case 1:return n=ng(n.type,!0),n;default:return""}}function Og(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Fo:return"Fragment";case Do:return"Portal";case Ig:return"Profiler";case Qy:return"StrictMode";case Dg:return"Suspense";case Fg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case lA:return(n.displayName||"Context")+".Consumer";case oA:return(n._context.displayName||"Context")+".Provider";case Jy:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Zy:return e=n.displayName||null,e!==null?e:Og(n.type)||"Memo";case Us:e=n._payload,n=n._init;try{return Og(n(e))}catch{}}return null}function rE(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Og(e);case 8:return e===Qy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function uA(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aE(n){var e=uA(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){i=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function pd(n){n._valueTracker||(n._valueTracker=aE(n))}function hA(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=uA(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function bf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function jg(n,e){var t=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function h0(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Fr(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function dA(n,e){e=e.checked,e!=null&&Ky(n,"checked",e,!1)}function zg(n,e){dA(n,e);var t=Fr(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Bg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Bg(n,e.type,Fr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function d0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Bg(n,e,t){(e!=="number"||bf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Mc=Array.isArray;function Yo(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Fr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Hg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function f0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(L(92));if(Mc(t)){if(1<t.length)throw Error(L(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Fr(t)}}function fA(n,e){var t=Fr(e.value),i=Fr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function p0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function pA(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ug(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?pA(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var gd,gA=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(gd=gd||document.createElement("div"),gd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function uu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Jc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oE=["Webkit","ms","Moz","O"];Object.keys(Jc).forEach(function(n){oE.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Jc[e]=Jc[n]})});function mA(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Jc.hasOwnProperty(n)&&Jc[n]?(""+e).trim():e+"px"}function yA(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,s=mA(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,s):n[t]=s}}var lE=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $g(n,e){if(e){if(lE[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Vg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wg=null;function ev(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gg=null,Ko=null,Qo=null;function g0(n){if(n=rd(n)){if(typeof Gg!="function")throw Error(L(280));var e=n.stateNode;e&&(e=Tp(e),Gg(n.stateNode,n.type,e))}}function vA(n){Ko?Qo?Qo.push(n):Qo=[n]:Ko=n}function wA(){if(Ko){var n=Ko,e=Qo;if(Qo=Ko=null,g0(n),e)for(n=0;n<e.length;n++)g0(e[n])}}function AA(n,e){return n(e)}function SA(){}var ig=!1;function xA(n,e,t){if(ig)return n(e,t);ig=!0;try{return AA(n,e,t)}finally{ig=!1,(Ko!==null||Qo!==null)&&(SA(),wA())}}function hu(n,e){var t=n.stateNode;if(t===null)return null;var i=Tp(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(L(231,e,typeof t));return t}var Xg=!1;if(Ms)try{var Sc={};Object.defineProperty(Sc,"passive",{get:function(){Xg=!0}}),window.addEventListener("test",Sc,Sc),window.removeEventListener("test",Sc,Sc)}catch{Xg=!1}function cE(n,e,t,i,s,r,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Zc=!1,_f=null,Ef=!1,qg=null,uE={onError:function(n){Zc=!0,_f=n}};function hE(n,e,t,i,s,r,a,o,c){Zc=!1,_f=null,cE.apply(uE,arguments)}function dE(n,e,t,i,s,r,a,o,c){if(hE.apply(this,arguments),Zc){if(Zc){var u=_f;Zc=!1,_f=null}else throw Error(L(198));Ef||(Ef=!0,qg=u)}}function Ao(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function bA(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function m0(n){if(Ao(n)!==n)throw Error(L(188))}function fE(n){var e=n.alternate;if(!e){if(e=Ao(n),e===null)throw Error(L(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return m0(s),n;if(r===i)return m0(s),e;r=r.sibling}throw Error(L(188))}if(t.return!==i.return)t=s,i=r;else{for(var a=!1,o=s.child;o;){if(o===t){a=!0,t=s,i=r;break}if(o===i){a=!0,i=s,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,i=s;break}if(o===i){a=!0,i=r,t=s;break}o=o.sibling}if(!a)throw Error(L(189))}}if(t.alternate!==i)throw Error(L(190))}if(t.tag!==3)throw Error(L(188));return t.stateNode.current===t?n:e}function _A(n){return n=fE(n),n!==null?EA(n):null}function EA(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=EA(n);if(e!==null)return e;n=n.sibling}return null}var CA=Pn.unstable_scheduleCallback,y0=Pn.unstable_cancelCallback,pE=Pn.unstable_shouldYield,gE=Pn.unstable_requestPaint,We=Pn.unstable_now,mE=Pn.unstable_getCurrentPriorityLevel,tv=Pn.unstable_ImmediatePriority,kA=Pn.unstable_UserBlockingPriority,Cf=Pn.unstable_NormalPriority,yE=Pn.unstable_LowPriority,TA=Pn.unstable_IdlePriority,_p=null,Gi=null;function vE(n){if(Gi&&typeof Gi.onCommitFiberRoot=="function")try{Gi.onCommitFiberRoot(_p,n,void 0,(n.current.flags&128)===128)}catch{}}var yi=Math.clz32?Math.clz32:SE,wE=Math.log,AE=Math.LN2;function SE(n){return n>>>=0,n===0?32:31-(wE(n)/AE|0)|0}var md=64,yd=4194304;function Ic(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function kf(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,s=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~s;o!==0?i=Ic(o):(r&=a,r!==0&&(i=Ic(r)))}else a=t&~s,a!==0?i=Ic(a):r!==0&&(i=Ic(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,r=e&-e,s>=r||s===16&&(r&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-yi(e),s=1<<t,i|=n[t],e&=~s;return i}function xE(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bE(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-yi(r),o=1<<a,c=s[a];c===-1?(!(o&t)||o&i)&&(s[a]=xE(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function Yg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function PA(){var n=md;return md<<=1,!(md&4194240)&&(md=64),n}function sg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function id(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-yi(e),n[e]=t}function _E(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-yi(t),r=1<<s;e[s]=0,i[s]=-1,n[s]=-1,t&=~r}}function nv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-yi(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}var we=0;function NA(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var RA,iv,LA,MA,IA,Kg=!1,vd=[],Cr=null,kr=null,Tr=null,du=new Map,fu=new Map,Vs=[],EE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function v0(n,e){switch(n){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":kr=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":du.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fu.delete(e.pointerId)}}function xc(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=rd(e),e!==null&&iv(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function CE(n,e,t,i,s){switch(e){case"focusin":return Cr=xc(Cr,n,e,t,i,s),!0;case"dragenter":return kr=xc(kr,n,e,t,i,s),!0;case"mouseover":return Tr=xc(Tr,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return du.set(r,xc(du.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,fu.set(r,xc(fu.get(r)||null,n,e,t,i,s)),!0}return!1}function DA(n){var e=Zr(n.target);if(e!==null){var t=Ao(e);if(t!==null){if(e=t.tag,e===13){if(e=bA(t),e!==null){n.blockedOn=e,IA(n.priority,function(){LA(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Dd(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Qg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Wg=i,t.target.dispatchEvent(i),Wg=null}else return e=rd(t),e!==null&&iv(e),n.blockedOn=t,!1;e.shift()}return!0}function w0(n,e,t){Dd(n)&&t.delete(e)}function kE(){Kg=!1,Cr!==null&&Dd(Cr)&&(Cr=null),kr!==null&&Dd(kr)&&(kr=null),Tr!==null&&Dd(Tr)&&(Tr=null),du.forEach(w0),fu.forEach(w0)}function bc(n,e){n.blockedOn===e&&(n.blockedOn=null,Kg||(Kg=!0,Pn.unstable_scheduleCallback(Pn.unstable_NormalPriority,kE)))}function pu(n){function e(s){return bc(s,n)}if(0<vd.length){bc(vd[0],n);for(var t=1;t<vd.length;t++){var i=vd[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Cr!==null&&bc(Cr,n),kr!==null&&bc(kr,n),Tr!==null&&bc(Tr,n),du.forEach(e),fu.forEach(e),t=0;t<Vs.length;t++)i=Vs[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Vs.length&&(t=Vs[0],t.blockedOn===null);)DA(t),t.blockedOn===null&&Vs.shift()}var Jo=zs.ReactCurrentBatchConfig,Tf=!0;function TE(n,e,t,i){var s=we,r=Jo.transition;Jo.transition=null;try{we=1,sv(n,e,t,i)}finally{we=s,Jo.transition=r}}function PE(n,e,t,i){var s=we,r=Jo.transition;Jo.transition=null;try{we=4,sv(n,e,t,i)}finally{we=s,Jo.transition=r}}function sv(n,e,t,i){if(Tf){var s=Qg(n,e,t,i);if(s===null)pg(n,e,i,Pf,t),v0(n,i);else if(CE(s,n,e,t,i))i.stopPropagation();else if(v0(n,i),e&4&&-1<EE.indexOf(n)){for(;s!==null;){var r=rd(s);if(r!==null&&RA(r),r=Qg(n,e,t,i),r===null&&pg(n,e,i,Pf,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else pg(n,e,i,null,t)}}var Pf=null;function Qg(n,e,t,i){if(Pf=null,n=ev(i),n=Zr(n),n!==null)if(e=Ao(n),e===null)n=null;else if(t=e.tag,t===13){if(n=bA(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Pf=n,null}function FA(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mE()){case tv:return 1;case kA:return 4;case Cf:case yE:return 16;case TA:return 536870912;default:return 16}default:return 16}}var br=null,rv=null,Fd=null;function OA(){if(Fd)return Fd;var n,e=rv,t=e.length,i,s="value"in br?br.value:br.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var a=t-n;for(i=1;i<=a&&e[t-i]===s[r-i];i++);return Fd=s.slice(n,1<i?1-i:void 0)}function Od(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function wd(){return!0}function A0(){return!1}function Rn(n){function e(t,i,s,r,a){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?wd:A0,this.isPropagationStopped=A0,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=wd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=wd)},persist:function(){},isPersistent:wd}),e}var yc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},av=Rn(yc),sd=Be({},yc,{view:0,detail:0}),NE=Rn(sd),rg,ag,_c,Ep=Be({},sd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ov,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==_c&&(_c&&n.type==="mousemove"?(rg=n.screenX-_c.screenX,ag=n.screenY-_c.screenY):ag=rg=0,_c=n),rg)},movementY:function(n){return"movementY"in n?n.movementY:ag}}),S0=Rn(Ep),RE=Be({},Ep,{dataTransfer:0}),LE=Rn(RE),ME=Be({},sd,{relatedTarget:0}),og=Rn(ME),IE=Be({},yc,{animationName:0,elapsedTime:0,pseudoElement:0}),DE=Rn(IE),FE=Be({},yc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),OE=Rn(FE),jE=Be({},yc,{data:0}),x0=Rn(jE),zE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UE(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=HE[n])?!!e[n]:!1}function ov(){return UE}var $E=Be({},sd,{key:function(n){if(n.key){var e=zE[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Od(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?BE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ov,charCode:function(n){return n.type==="keypress"?Od(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Od(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),VE=Rn($E),WE=Be({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),b0=Rn(WE),GE=Be({},sd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ov}),XE=Rn(GE),qE=Be({},yc,{propertyName:0,elapsedTime:0,pseudoElement:0}),YE=Rn(qE),KE=Be({},Ep,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),QE=Rn(KE),JE=[9,13,27,32],lv=Ms&&"CompositionEvent"in window,eu=null;Ms&&"documentMode"in document&&(eu=document.documentMode);var ZE=Ms&&"TextEvent"in window&&!eu,jA=Ms&&(!lv||eu&&8<eu&&11>=eu),_0=" ",E0=!1;function zA(n,e){switch(n){case"keyup":return JE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BA(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Oo=!1;function e1(n,e){switch(n){case"compositionend":return BA(e);case"keypress":return e.which!==32?null:(E0=!0,_0);case"textInput":return n=e.data,n===_0&&E0?null:n;default:return null}}function t1(n,e){if(Oo)return n==="compositionend"||!lv&&zA(n,e)?(n=OA(),Fd=rv=br=null,Oo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jA&&e.locale!=="ko"?null:e.data;default:return null}}var n1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!n1[n.type]:e==="textarea"}function HA(n,e,t,i){vA(i),e=Nf(e,"onChange"),0<e.length&&(t=new av("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var tu=null,gu=null;function i1(n){JA(n,0)}function Cp(n){var e=Bo(n);if(hA(e))return n}function s1(n,e){if(n==="change")return e}var UA=!1;if(Ms){var lg;if(Ms){var cg="oninput"in document;if(!cg){var k0=document.createElement("div");k0.setAttribute("oninput","return;"),cg=typeof k0.oninput=="function"}lg=cg}else lg=!1;UA=lg&&(!document.documentMode||9<document.documentMode)}function T0(){tu&&(tu.detachEvent("onpropertychange",$A),gu=tu=null)}function $A(n){if(n.propertyName==="value"&&Cp(gu)){var e=[];HA(e,gu,n,ev(n)),xA(i1,e)}}function r1(n,e,t){n==="focusin"?(T0(),tu=e,gu=t,tu.attachEvent("onpropertychange",$A)):n==="focusout"&&T0()}function a1(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Cp(gu)}function o1(n,e){if(n==="click")return Cp(e)}function l1(n,e){if(n==="input"||n==="change")return Cp(e)}function c1(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var wi=typeof Object.is=="function"?Object.is:c1;function mu(n,e){if(wi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!Mg.call(e,s)||!wi(n[s],e[s]))return!1}return!0}function P0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function N0(n,e){var t=P0(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=P0(t)}}function VA(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?VA(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function WA(){for(var n=window,e=bf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=bf(n.document)}return e}function cv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function u1(n){var e=WA(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&VA(t.ownerDocument.documentElement,t)){if(i!==null&&cv(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=N0(t,r);var a=N0(t,i);s&&a&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var h1=Ms&&"documentMode"in document&&11>=document.documentMode,jo=null,Jg=null,nu=null,Zg=!1;function R0(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Zg||jo==null||jo!==bf(i)||(i=jo,"selectionStart"in i&&cv(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),nu&&mu(nu,i)||(nu=i,i=Nf(Jg,"onSelect"),0<i.length&&(e=new av("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=jo)))}function Ad(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var zo={animationend:Ad("Animation","AnimationEnd"),animationiteration:Ad("Animation","AnimationIteration"),animationstart:Ad("Animation","AnimationStart"),transitionend:Ad("Transition","TransitionEnd")},ug={},GA={};Ms&&(GA=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function kp(n){if(ug[n])return ug[n];if(!zo[n])return n;var e=zo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in GA)return ug[n]=e[t];return n}var XA=kp("animationend"),qA=kp("animationiteration"),YA=kp("animationstart"),KA=kp("transitionend"),QA=new Map,L0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hr(n,e){QA.set(n,e),wo(e,[n])}for(var hg=0;hg<L0.length;hg++){var dg=L0[hg],d1=dg.toLowerCase(),f1=dg[0].toUpperCase()+dg.slice(1);Hr(d1,"on"+f1)}Hr(XA,"onAnimationEnd");Hr(qA,"onAnimationIteration");Hr(YA,"onAnimationStart");Hr("dblclick","onDoubleClick");Hr("focusin","onFocus");Hr("focusout","onBlur");Hr(KA,"onTransitionEnd");lc("onMouseEnter",["mouseout","mouseover"]);lc("onMouseLeave",["mouseout","mouseover"]);lc("onPointerEnter",["pointerout","pointerover"]);lc("onPointerLeave",["pointerout","pointerover"]);wo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wo("onBeforeInput",["compositionend","keypress","textInput","paste"]);wo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dc));function M0(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,dE(i,e,void 0,n),n.currentTarget=null}function JA(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&s.isPropagationStopped())break e;M0(s,o,u),r=c}else for(a=0;a<i.length;a++){if(o=i[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&s.isPropagationStopped())break e;M0(s,o,u),r=c}}}if(Ef)throw n=qg,Ef=!1,qg=null,n}function Te(n,e){var t=e[sm];t===void 0&&(t=e[sm]=new Set);var i=n+"__bubble";t.has(i)||(ZA(e,n,2,!1),t.add(i))}function fg(n,e,t){var i=0;e&&(i|=4),ZA(t,n,i,e)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function yu(n){if(!n[Sd]){n[Sd]=!0,aA.forEach(function(t){t!=="selectionchange"&&(p1.has(t)||fg(t,!1,n),fg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Sd]||(e[Sd]=!0,fg("selectionchange",!1,e))}}function ZA(n,e,t,i){switch(FA(e)){case 1:var s=TE;break;case 4:s=PE;break;default:s=sv}t=s.bind(null,e,t,n),s=void 0,!Xg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function pg(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Zr(o),a===null)return;if(c=a.tag,c===5||c===6){i=r=a;continue e}o=o.parentNode}}i=i.return}xA(function(){var u=r,h=ev(t),d=[];e:{var f=QA.get(n);if(f!==void 0){var p=av,m=n;switch(n){case"keypress":if(Od(t)===0)break e;case"keydown":case"keyup":p=VE;break;case"focusin":m="focus",p=og;break;case"focusout":m="blur",p=og;break;case"beforeblur":case"afterblur":p=og;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=S0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=LE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=XE;break;case XA:case qA:case YA:p=DE;break;case KA:p=YE;break;case"scroll":p=NE;break;case"wheel":p=QE;break;case"copy":case"cut":case"paste":p=OE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=b0}var A=(e&4)!==0,_=!A&&n==="scroll",y=A?f!==null?f+"Capture":null:f;A=[];for(var w=u,b;w!==null;){b=w;var E=b.stateNode;if(b.tag===5&&E!==null&&(b=E,y!==null&&(E=hu(w,y),E!=null&&A.push(vu(w,E,b)))),_)break;w=w.return}0<A.length&&(f=new p(f,m,null,t,h),d.push({event:f,listeners:A}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==Wg&&(m=t.relatedTarget||t.fromElement)&&(Zr(m)||m[Is]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=t.relatedTarget||t.toElement,p=u,m=m?Zr(m):null,m!==null&&(_=Ao(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(A=S0,E="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(A=b0,E="onPointerLeave",y="onPointerEnter",w="pointer"),_=p==null?f:Bo(p),b=m==null?f:Bo(m),f=new A(E,w+"leave",p,t,h),f.target=_,f.relatedTarget=b,E=null,Zr(h)===u&&(A=new A(y,w+"enter",m,t,h),A.target=b,A.relatedTarget=_,E=A),_=E,p&&m)t:{for(A=p,y=m,w=0,b=A;b;b=ko(b))w++;for(b=0,E=y;E;E=ko(E))b++;for(;0<w-b;)A=ko(A),w--;for(;0<b-w;)y=ko(y),b--;for(;w--;){if(A===y||y!==null&&A===y.alternate)break t;A=ko(A),y=ko(y)}A=null}else A=null;p!==null&&I0(d,f,p,A,!1),m!==null&&_!==null&&I0(d,_,m,A,!0)}}e:{if(f=u?Bo(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=s1;else if(C0(f))if(UA)C=l1;else{C=a1;var T=r1}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=o1);if(C&&(C=C(n,u))){HA(d,C,t,h);break e}T&&T(n,f,u),n==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&Bg(f,"number",f.value)}switch(T=u?Bo(u):window,n){case"focusin":(C0(T)||T.contentEditable==="true")&&(jo=T,Jg=u,nu=null);break;case"focusout":nu=Jg=jo=null;break;case"mousedown":Zg=!0;break;case"contextmenu":case"mouseup":case"dragend":Zg=!1,R0(d,t,h);break;case"selectionchange":if(h1)break;case"keydown":case"keyup":R0(d,t,h)}var k;if(lv)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Oo?zA(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(jA&&t.locale!=="ko"&&(Oo||P!=="onCompositionStart"?P==="onCompositionEnd"&&Oo&&(k=OA()):(br=h,rv="value"in br?br.value:br.textContent,Oo=!0)),T=Nf(u,P),0<T.length&&(P=new x0(P,n,null,t,h),d.push({event:P,listeners:T}),k?P.data=k:(k=BA(t),k!==null&&(P.data=k)))),(k=ZE?e1(n,t):t1(n,t))&&(u=Nf(u,"onBeforeInput"),0<u.length&&(h=new x0("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=k))}JA(d,e)})}function vu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Nf(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;s.tag===5&&r!==null&&(s=r,r=hu(n,t),r!=null&&i.unshift(vu(n,r,s)),r=hu(n,e),r!=null&&i.push(vu(n,r,s))),n=n.return}return i}function ko(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function I0(n,e,t,i,s){for(var r=e._reactName,a=[];t!==null&&t!==i;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===i)break;o.tag===5&&u!==null&&(o=u,s?(c=hu(t,r),c!=null&&a.unshift(vu(t,c,o))):s||(c=hu(t,r),c!=null&&a.push(vu(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var g1=/\r\n?/g,m1=/\u0000|\uFFFD/g;function D0(n){return(typeof n=="string"?n:""+n).replace(g1,`
`).replace(m1,"")}function xd(n,e,t){if(e=D0(e),D0(n)!==e&&t)throw Error(L(425))}function Rf(){}var em=null,tm=null;function nm(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var im=typeof setTimeout=="function"?setTimeout:void 0,y1=typeof clearTimeout=="function"?clearTimeout:void 0,F0=typeof Promise=="function"?Promise:void 0,v1=typeof queueMicrotask=="function"?queueMicrotask:typeof F0<"u"?function(n){return F0.resolve(null).then(n).catch(w1)}:im;function w1(n){setTimeout(function(){throw n})}function gg(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(i===0){n.removeChild(s),pu(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=s}while(t);pu(e)}function Pr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function O0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var vc=Math.random().toString(36).slice(2),Wi="__reactFiber$"+vc,wu="__reactProps$"+vc,Is="__reactContainer$"+vc,sm="__reactEvents$"+vc,A1="__reactListeners$"+vc,S1="__reactHandles$"+vc;function Zr(n){var e=n[Wi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Is]||t[Wi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=O0(n);n!==null;){if(t=n[Wi])return t;n=O0(n)}return e}n=t,t=n.parentNode}return null}function rd(n){return n=n[Wi]||n[Is],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Bo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(L(33))}function Tp(n){return n[wu]||null}var rm=[],Ho=-1;function Ur(n){return{current:n}}function Ne(n){0>Ho||(n.current=rm[Ho],rm[Ho]=null,Ho--)}function ke(n,e){Ho++,rm[Ho]=n.current,n.current=e}var Or={},Ft=Ur(Or),an=Ur(!1),lo=Or;function cc(n,e){var t=n.type.contextTypes;if(!t)return Or;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},r;for(r in t)s[r]=e[r];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function on(n){return n=n.childContextTypes,n!=null}function Lf(){Ne(an),Ne(Ft)}function j0(n,e,t){if(Ft.current!==Or)throw Error(L(168));ke(Ft,e),ke(an,t)}function eS(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(L(108,rE(n)||"Unknown",s));return Be({},t,i)}function Mf(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Or,lo=Ft.current,ke(Ft,n),ke(an,an.current),!0}function z0(n,e,t){var i=n.stateNode;if(!i)throw Error(L(169));t?(n=eS(n,e,lo),i.__reactInternalMemoizedMergedChildContext=n,Ne(an),Ne(Ft),ke(Ft,n)):Ne(an),ke(an,t)}var ts=null,Pp=!1,mg=!1;function tS(n){ts===null?ts=[n]:ts.push(n)}function x1(n){Pp=!0,tS(n)}function $r(){if(!mg&&ts!==null){mg=!0;var n=0,e=we;try{var t=ts;for(we=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}ts=null,Pp=!1}catch(s){throw ts!==null&&(ts=ts.slice(n+1)),CA(tv,$r),s}finally{we=e,mg=!1}}return null}var Uo=[],$o=0,If=null,Df=0,Hn=[],Un=0,co=null,Ts=1,Ps="";function Gr(n,e){Uo[$o++]=Df,Uo[$o++]=If,If=n,Df=e}function nS(n,e,t){Hn[Un++]=Ts,Hn[Un++]=Ps,Hn[Un++]=co,co=n;var i=Ts;n=Ps;var s=32-yi(i)-1;i&=~(1<<s),t+=1;var r=32-yi(e)+s;if(30<r){var a=s-s%5;r=(i&(1<<a)-1).toString(32),i>>=a,s-=a,Ts=1<<32-yi(e)+s|t<<s|i,Ps=r+n}else Ts=1<<r|t<<s|i,Ps=n}function uv(n){n.return!==null&&(Gr(n,1),nS(n,1,0))}function hv(n){for(;n===If;)If=Uo[--$o],Uo[$o]=null,Df=Uo[--$o],Uo[$o]=null;for(;n===co;)co=Hn[--Un],Hn[Un]=null,Ps=Hn[--Un],Hn[Un]=null,Ts=Hn[--Un],Hn[Un]=null}var kn=null,Cn=null,Ie=!1,gi=null;function iS(n,e){var t=Wn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function B0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,kn=n,Cn=Pr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,kn=n,Cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=co!==null?{id:Ts,overflow:Ps}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Wn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,kn=n,Cn=null,!0):!1;default:return!1}}function am(n){return(n.mode&1)!==0&&(n.flags&128)===0}function om(n){if(Ie){var e=Cn;if(e){var t=e;if(!B0(n,e)){if(am(n))throw Error(L(418));e=Pr(t.nextSibling);var i=kn;e&&B0(n,e)?iS(i,t):(n.flags=n.flags&-4097|2,Ie=!1,kn=n)}}else{if(am(n))throw Error(L(418));n.flags=n.flags&-4097|2,Ie=!1,kn=n}}}function H0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;kn=n}function bd(n){if(n!==kn)return!1;if(!Ie)return H0(n),Ie=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!nm(n.type,n.memoizedProps)),e&&(e=Cn)){if(am(n))throw sS(),Error(L(418));for(;e;)iS(n,e),e=Pr(e.nextSibling)}if(H0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(L(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Cn=Pr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Cn=null}}else Cn=kn?Pr(n.stateNode.nextSibling):null;return!0}function sS(){for(var n=Cn;n;)n=Pr(n.nextSibling)}function uc(){Cn=kn=null,Ie=!1}function dv(n){gi===null?gi=[n]:gi.push(n)}var b1=zs.ReactCurrentBatchConfig;function Ec(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(L(309));var i=t.stateNode}if(!i)throw Error(L(147,n));var s=i,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=s.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(L(284));if(!t._owner)throw Error(L(290,n))}return n}function _d(n,e){throw n=Object.prototype.toString.call(e),Error(L(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function U0(n){var e=n._init;return e(n._payload)}function rS(n){function e(y,w){if(n){var b=y.deletions;b===null?(y.deletions=[w],y.flags|=16):b.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function i(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function s(y,w){return y=Mr(y,w),y.index=0,y.sibling=null,y}function r(y,w,b){return y.index=b,n?(b=y.alternate,b!==null?(b=b.index,b<w?(y.flags|=2,w):b):(y.flags|=2,w)):(y.flags|=1048576,w)}function a(y){return n&&y.alternate===null&&(y.flags|=2),y}function o(y,w,b,E){return w===null||w.tag!==6?(w=bg(b,y.mode,E),w.return=y,w):(w=s(w,b),w.return=y,w)}function c(y,w,b,E){var C=b.type;return C===Fo?h(y,w,b.props.children,E,b.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Us&&U0(C)===w.type)?(E=s(w,b.props),E.ref=Ec(y,w,b),E.return=y,E):(E=Vd(b.type,b.key,b.props,null,y.mode,E),E.ref=Ec(y,w,b),E.return=y,E)}function u(y,w,b,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=_g(b,y.mode,E),w.return=y,w):(w=s(w,b.children||[]),w.return=y,w)}function h(y,w,b,E,C){return w===null||w.tag!==7?(w=oo(b,y.mode,E,C),w.return=y,w):(w=s(w,b),w.return=y,w)}function d(y,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=bg(""+w,y.mode,b),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fd:return b=Vd(w.type,w.key,w.props,null,y.mode,b),b.ref=Ec(y,null,w),b.return=y,b;case Do:return w=_g(w,y.mode,b),w.return=y,w;case Us:var E=w._init;return d(y,E(w._payload),b)}if(Mc(w)||Ac(w))return w=oo(w,y.mode,b,null),w.return=y,w;_d(y,w)}return null}function f(y,w,b,E){var C=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:o(y,w,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case fd:return b.key===C?c(y,w,b,E):null;case Do:return b.key===C?u(y,w,b,E):null;case Us:return C=b._init,f(y,w,C(b._payload),E)}if(Mc(b)||Ac(b))return C!==null?null:h(y,w,b,E,null);_d(y,b)}return null}function p(y,w,b,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(b)||null,o(w,y,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case fd:return y=y.get(E.key===null?b:E.key)||null,c(w,y,E,C);case Do:return y=y.get(E.key===null?b:E.key)||null,u(w,y,E,C);case Us:var T=E._init;return p(y,w,b,T(E._payload),C)}if(Mc(E)||Ac(E))return y=y.get(b)||null,h(w,y,E,C,null);_d(w,E)}return null}function m(y,w,b,E){for(var C=null,T=null,k=w,P=w=0,D=null;k!==null&&P<b.length;P++){k.index>P?(D=k,k=null):D=k.sibling;var M=f(y,k,b[P],E);if(M===null){k===null&&(k=D);break}n&&k&&M.alternate===null&&e(y,k),w=r(M,w,P),T===null?C=M:T.sibling=M,T=M,k=D}if(P===b.length)return t(y,k),Ie&&Gr(y,P),C;if(k===null){for(;P<b.length;P++)k=d(y,b[P],E),k!==null&&(w=r(k,w,P),T===null?C=k:T.sibling=k,T=k);return Ie&&Gr(y,P),C}for(k=i(y,k);P<b.length;P++)D=p(k,y,P,b[P],E),D!==null&&(n&&D.alternate!==null&&k.delete(D.key===null?P:D.key),w=r(D,w,P),T===null?C=D:T.sibling=D,T=D);return n&&k.forEach(function($){return e(y,$)}),Ie&&Gr(y,P),C}function A(y,w,b,E){var C=Ac(b);if(typeof C!="function")throw Error(L(150));if(b=C.call(b),b==null)throw Error(L(151));for(var T=C=null,k=w,P=w=0,D=null,M=b.next();k!==null&&!M.done;P++,M=b.next()){k.index>P?(D=k,k=null):D=k.sibling;var $=f(y,k,M.value,E);if($===null){k===null&&(k=D);break}n&&k&&$.alternate===null&&e(y,k),w=r($,w,P),T===null?C=$:T.sibling=$,T=$,k=D}if(M.done)return t(y,k),Ie&&Gr(y,P),C;if(k===null){for(;!M.done;P++,M=b.next())M=d(y,M.value,E),M!==null&&(w=r(M,w,P),T===null?C=M:T.sibling=M,T=M);return Ie&&Gr(y,P),C}for(k=i(y,k);!M.done;P++,M=b.next())M=p(k,y,P,M.value,E),M!==null&&(n&&M.alternate!==null&&k.delete(M.key===null?P:M.key),w=r(M,w,P),T===null?C=M:T.sibling=M,T=M);return n&&k.forEach(function(O){return e(y,O)}),Ie&&Gr(y,P),C}function _(y,w,b,E){if(typeof b=="object"&&b!==null&&b.type===Fo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case fd:e:{for(var C=b.key,T=w;T!==null;){if(T.key===C){if(C=b.type,C===Fo){if(T.tag===7){t(y,T.sibling),w=s(T,b.props.children),w.return=y,y=w;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Us&&U0(C)===T.type){t(y,T.sibling),w=s(T,b.props),w.ref=Ec(y,T,b),w.return=y,y=w;break e}t(y,T);break}else e(y,T);T=T.sibling}b.type===Fo?(w=oo(b.props.children,y.mode,E,b.key),w.return=y,y=w):(E=Vd(b.type,b.key,b.props,null,y.mode,E),E.ref=Ec(y,w,b),E.return=y,y=E)}return a(y);case Do:e:{for(T=b.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(y,w.sibling),w=s(w,b.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=_g(b,y.mode,E),w.return=y,y=w}return a(y);case Us:return T=b._init,_(y,w,T(b._payload),E)}if(Mc(b))return m(y,w,b,E);if(Ac(b))return A(y,w,b,E);_d(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(y,w.sibling),w=s(w,b),w.return=y,y=w):(t(y,w),w=bg(b,y.mode,E),w.return=y,y=w),a(y)):t(y,w)}return _}var hc=rS(!0),aS=rS(!1),Ff=Ur(null),Of=null,Vo=null,fv=null;function pv(){fv=Vo=Of=null}function gv(n){var e=Ff.current;Ne(Ff),n._currentValue=e}function lm(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Zo(n,e){Of=n,fv=Vo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(rn=!0),n.firstContext=null)}function Yn(n){var e=n._currentValue;if(fv!==n)if(n={context:n,memoizedValue:e,next:null},Vo===null){if(Of===null)throw Error(L(308));Vo=n,Of.dependencies={lanes:0,firstContext:n}}else Vo=Vo.next=n;return e}var ea=null;function mv(n){ea===null?ea=[n]:ea.push(n)}function oS(n,e,t,i){var s=e.interleaved;return s===null?(t.next=t,mv(e)):(t.next=s.next,s.next=t),e.interleaved=t,Ds(n,i)}function Ds(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var $s=!1;function yv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ns(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Nr(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,he&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,Ds(n,t)}return s=i.interleaved,s===null?(e.next=e,mv(i)):(e.next=s.next,s.next=e),i.interleaved=e,Ds(n,t)}function jd(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,nv(n,t)}}function $0(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?s=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function jf(n,e,t,i){var s=n.updateQueue;$s=!1;var r=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=c))}if(r!==null){var d=s.baseState;a=0,h=u=c=null,o=r;do{var f=o.lane,p=o.eventTime;if((i&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=n,A=o;switch(f=e,p=t,A.tag){case 1:if(m=A.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=A.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=Be({},d,f);break e;case 2:$s=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=p,c=d):h=h.next=p,a|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else r===null&&(s.shared.lanes=0);ho|=a,n.lanes=a,n.memoizedState=d}}function V0(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],s=i.callback;if(s!==null){if(i.callback=null,i=t,typeof s!="function")throw Error(L(191,s));s.call(i)}}}var ad={},Xi=Ur(ad),Au=Ur(ad),Su=Ur(ad);function ta(n){if(n===ad)throw Error(L(174));return n}function vv(n,e){switch(ke(Su,e),ke(Au,n),ke(Xi,ad),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ug(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Ug(e,n)}Ne(Xi),ke(Xi,e)}function dc(){Ne(Xi),Ne(Au),Ne(Su)}function cS(n){ta(Su.current);var e=ta(Xi.current),t=Ug(e,n.type);e!==t&&(ke(Au,n),ke(Xi,t))}function wv(n){Au.current===n&&(Ne(Xi),Ne(Au))}var Oe=Ur(0);function zf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yg=[];function Av(){for(var n=0;n<yg.length;n++)yg[n]._workInProgressVersionPrimary=null;yg.length=0}var zd=zs.ReactCurrentDispatcher,vg=zs.ReactCurrentBatchConfig,uo=0,ze=null,nt=null,ht=null,Bf=!1,iu=!1,xu=0,_1=0;function _t(){throw Error(L(321))}function Sv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!wi(n[t],e[t]))return!1;return!0}function xv(n,e,t,i,s,r){if(uo=r,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zd.current=n===null||n.memoizedState===null?T1:P1,n=t(i,s),iu){r=0;do{if(iu=!1,xu=0,25<=r)throw Error(L(301));r+=1,ht=nt=null,e.updateQueue=null,zd.current=N1,n=t(i,s)}while(iu)}if(zd.current=Hf,e=nt!==null&&nt.next!==null,uo=0,ht=nt=ze=null,Bf=!1,e)throw Error(L(300));return n}function bv(){var n=xu!==0;return xu=0,n}function ki(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?ze.memoizedState=ht=n:ht=ht.next=n,ht}function Kn(){if(nt===null){var n=ze.alternate;n=n!==null?n.memoizedState:null}else n=nt.next;var e=ht===null?ze.memoizedState:ht.next;if(e!==null)ht=e,nt=n;else{if(n===null)throw Error(L(310));nt=n,n={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},ht===null?ze.memoizedState=ht=n:ht=ht.next=n}return ht}function bu(n,e){return typeof e=="function"?e(n):e}function wg(n){var e=Kn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var i=nt,s=i.baseQueue,r=t.pending;if(r!==null){if(s!==null){var a=s.next;s.next=r.next,r.next=a}i.baseQueue=s=r,t.pending=null}if(s!==null){r=s.next,i=i.baseState;var o=a=null,c=null,u=r;do{var h=u.lane;if((uo&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,a=i):c=c.next=d,ze.lanes|=h,ho|=h}u=u.next}while(u!==null&&u!==r);c===null?a=i:c.next=o,wi(i,e.memoizedState)||(rn=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=c,t.lastRenderedState=i}if(n=t.interleaved,n!==null){s=n;do r=s.lane,ze.lanes|=r,ho|=r,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Ag(n){var e=Kn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var a=s=s.next;do r=n(r,a.action),a=a.next;while(a!==s);wi(r,e.memoizedState)||(rn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function uS(){}function hS(n,e){var t=ze,i=Kn(),s=e(),r=!wi(i.memoizedState,s);if(r&&(i.memoizedState=s,rn=!0),i=i.queue,_v(pS.bind(null,t,i,n),[n]),i.getSnapshot!==e||r||ht!==null&&ht.memoizedState.tag&1){if(t.flags|=2048,_u(9,fS.bind(null,t,i,s,e),void 0,null),dt===null)throw Error(L(349));uo&30||dS(t,e,s)}return s}function dS(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function fS(n,e,t,i){e.value=t,e.getSnapshot=i,gS(e)&&mS(n)}function pS(n,e,t){return t(function(){gS(e)&&mS(n)})}function gS(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!wi(n,t)}catch{return!0}}function mS(n){var e=Ds(n,1);e!==null&&vi(e,n,1,-1)}function W0(n){var e=ki();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:n},e.queue=n,n=n.dispatch=k1.bind(null,ze,n),[e.memoizedState,n]}function _u(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function yS(){return Kn().memoizedState}function Bd(n,e,t,i){var s=ki();ze.flags|=n,s.memoizedState=_u(1|e,t,void 0,i===void 0?null:i)}function Np(n,e,t,i){var s=Kn();i=i===void 0?null:i;var r=void 0;if(nt!==null){var a=nt.memoizedState;if(r=a.destroy,i!==null&&Sv(i,a.deps)){s.memoizedState=_u(e,t,r,i);return}}ze.flags|=n,s.memoizedState=_u(1|e,t,r,i)}function G0(n,e){return Bd(8390656,8,n,e)}function _v(n,e){return Np(2048,8,n,e)}function vS(n,e){return Np(4,2,n,e)}function wS(n,e){return Np(4,4,n,e)}function AS(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function SS(n,e,t){return t=t!=null?t.concat([n]):null,Np(4,4,AS.bind(null,e,n),t)}function Ev(){}function xS(n,e){var t=Kn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Sv(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function bS(n,e){var t=Kn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Sv(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function _S(n,e,t){return uo&21?(wi(t,e)||(t=PA(),ze.lanes|=t,ho|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,rn=!0),n.memoizedState=t)}function E1(n,e){var t=we;we=t!==0&&4>t?t:4,n(!0);var i=vg.transition;vg.transition={};try{n(!1),e()}finally{we=t,vg.transition=i}}function ES(){return Kn().memoizedState}function C1(n,e,t){var i=Lr(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},CS(n))kS(e,t);else if(t=oS(n,e,t,i),t!==null){var s=Vt();vi(t,n,i,s),TS(t,e,i)}}function k1(n,e,t){var i=Lr(n),s={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(CS(n))kS(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(s.hasEagerState=!0,s.eagerState=o,wi(o,a)){var c=e.interleaved;c===null?(s.next=s,mv(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}t=oS(n,e,s,i),t!==null&&(s=Vt(),vi(t,n,i,s),TS(t,e,i))}}function CS(n){var e=n.alternate;return n===ze||e!==null&&e===ze}function kS(n,e){iu=Bf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function TS(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,nv(n,t)}}var Hf={readContext:Yn,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},T1={readContext:Yn,useCallback:function(n,e){return ki().memoizedState=[n,e===void 0?null:e],n},useContext:Yn,useEffect:G0,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Bd(4194308,4,AS.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Bd(4194308,4,n,e)},useInsertionEffect:function(n,e){return Bd(4,2,n,e)},useMemo:function(n,e){var t=ki();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=ki();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=C1.bind(null,ze,n),[i.memoizedState,n]},useRef:function(n){var e=ki();return n={current:n},e.memoizedState=n},useState:W0,useDebugValue:Ev,useDeferredValue:function(n){return ki().memoizedState=n},useTransition:function(){var n=W0(!1),e=n[0];return n=E1.bind(null,n[1]),ki().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=ze,s=ki();if(Ie){if(t===void 0)throw Error(L(407));t=t()}else{if(t=e(),dt===null)throw Error(L(349));uo&30||dS(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,G0(pS.bind(null,i,r,n),[n]),i.flags|=2048,_u(9,fS.bind(null,i,r,t,e),void 0,null),t},useId:function(){var n=ki(),e=dt.identifierPrefix;if(Ie){var t=Ps,i=Ts;t=(i&~(1<<32-yi(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=xu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=_1++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},P1={readContext:Yn,useCallback:xS,useContext:Yn,useEffect:_v,useImperativeHandle:SS,useInsertionEffect:vS,useLayoutEffect:wS,useMemo:bS,useReducer:wg,useRef:yS,useState:function(){return wg(bu)},useDebugValue:Ev,useDeferredValue:function(n){var e=Kn();return _S(e,nt.memoizedState,n)},useTransition:function(){var n=wg(bu)[0],e=Kn().memoizedState;return[n,e]},useMutableSource:uS,useSyncExternalStore:hS,useId:ES,unstable_isNewReconciler:!1},N1={readContext:Yn,useCallback:xS,useContext:Yn,useEffect:_v,useImperativeHandle:SS,useInsertionEffect:vS,useLayoutEffect:wS,useMemo:bS,useReducer:Ag,useRef:yS,useState:function(){return Ag(bu)},useDebugValue:Ev,useDeferredValue:function(n){var e=Kn();return nt===null?e.memoizedState=n:_S(e,nt.memoizedState,n)},useTransition:function(){var n=Ag(bu)[0],e=Kn().memoizedState;return[n,e]},useMutableSource:uS,useSyncExternalStore:hS,useId:ES,unstable_isNewReconciler:!1};function ei(n,e){if(n&&n.defaultProps){e=Be({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function cm(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Be({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Rp={isMounted:function(n){return(n=n._reactInternals)?Ao(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Vt(),s=Lr(n),r=Ns(i,s);r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(vi(e,n,s,i),jd(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Vt(),s=Lr(n),r=Ns(i,s);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(vi(e,n,s,i),jd(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Vt(),i=Lr(n),s=Ns(t,i);s.tag=2,e!=null&&(s.callback=e),e=Nr(n,s,i),e!==null&&(vi(e,n,i,t),jd(e,n,i))}};function X0(n,e,t,i,s,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,a):e.prototype&&e.prototype.isPureReactComponent?!mu(t,i)||!mu(s,r):!0}function PS(n,e,t){var i=!1,s=Or,r=e.contextType;return typeof r=="object"&&r!==null?r=Yn(r):(s=on(e)?lo:Ft.current,i=e.contextTypes,r=(i=i!=null)?cc(n,s):Or),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Rp,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=r),e}function q0(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&Rp.enqueueReplaceState(e,e.state,null)}function um(n,e,t,i){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},yv(n);var r=e.contextType;typeof r=="object"&&r!==null?s.context=Yn(r):(r=on(e)?lo:Ft.current,s.context=cc(n,r)),s.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(cm(n,e,r,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Rp.enqueueReplaceState(s,s.state,null),jf(n,t,s,i),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function fc(n,e){try{var t="",i=e;do t+=sE(i),i=i.return;while(i);var s=t}catch(r){s=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:s,digest:null}}function Sg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function hm(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var R1=typeof WeakMap=="function"?WeakMap:Map;function NS(n,e,t){t=Ns(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){$f||($f=!0,Sm=i),hm(n,e)},t}function RS(n,e,t){t=Ns(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;t.payload=function(){return i(s)},t.callback=function(){hm(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){hm(n,e),typeof i!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Y0(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new R1;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(s.add(t),n=W1.bind(null,n,e,t),e.then(n,n))}function K0(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Q0(n,e,t,i,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ns(-1,1),e.tag=2,Nr(t,e,1))),t.lanes|=1),n)}var L1=zs.ReactCurrentOwner,rn=!1;function $t(n,e,t,i){e.child=n===null?aS(e,null,t,i):hc(e,n.child,t,i)}function J0(n,e,t,i,s){t=t.render;var r=e.ref;return Zo(e,s),i=xv(n,e,t,i,r,s),t=bv(),n!==null&&!rn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Fs(n,e,s)):(Ie&&t&&uv(e),e.flags|=1,$t(n,e,i,s),e.child)}function Z0(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!Mv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,LS(n,e,r,i,s)):(n=Vd(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&s)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:mu,t(a,i)&&n.ref===e.ref)return Fs(n,e,s)}return e.flags|=1,n=Mr(r,i),n.ref=e.ref,n.return=e,e.child=n}function LS(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(mu(r,i)&&n.ref===e.ref)if(rn=!1,e.pendingProps=i=r,(n.lanes&s)!==0)n.flags&131072&&(rn=!0);else return e.lanes=n.lanes,Fs(n,e,s)}return dm(n,e,t,i,s)}function MS(n,e,t){var i=e.pendingProps,s=i.children,r=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(Go,bn),bn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ke(Go,bn),bn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:t,ke(Go,bn),bn|=i}else r!==null?(i=r.baseLanes|t,e.memoizedState=null):i=t,ke(Go,bn),bn|=i;return $t(n,e,s,t),e.child}function IS(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function dm(n,e,t,i,s){var r=on(t)?lo:Ft.current;return r=cc(e,r),Zo(e,s),t=xv(n,e,t,i,r,s),i=bv(),n!==null&&!rn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Fs(n,e,s)):(Ie&&i&&uv(e),e.flags|=1,$t(n,e,t,s),e.child)}function ew(n,e,t,i,s){if(on(t)){var r=!0;Mf(e)}else r=!1;if(Zo(e,s),e.stateNode===null)Hd(n,e),PS(e,t,i),um(e,t,i,s),i=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Yn(u):(u=on(t)?lo:Ft.current,u=cc(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||c!==u)&&q0(e,a,i,u),$s=!1;var f=e.memoizedState;a.state=f,jf(e,i,a,s),c=e.memoizedState,o!==i||f!==c||an.current||$s?(typeof h=="function"&&(cm(e,t,h,i),c=e.memoizedState),(o=$s||X0(e,t,o,i,f,c,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),a.props=i,a.state=c,a.context=u,i=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,lS(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:ei(e.type,o),a.props=u,d=e.pendingProps,f=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=Yn(c):(c=on(t)?lo:Ft.current,c=cc(e,c));var p=t.getDerivedStateFromProps;(h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==c)&&q0(e,a,i,c),$s=!1,f=e.memoizedState,a.state=f,jf(e,i,a,s);var m=e.memoizedState;o!==d||f!==m||an.current||$s?(typeof p=="function"&&(cm(e,t,p,i),m=e.memoizedState),(u=$s||X0(e,t,u,i,f,m,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),a.props=i,a.state=m,a.context=c,i=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),i=!1)}return fm(n,e,t,i,r,s)}function fm(n,e,t,i,s,r){IS(n,e);var a=(e.flags&128)!==0;if(!i&&!a)return s&&z0(e,t,!1),Fs(n,e,r);i=e.stateNode,L1.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&a?(e.child=hc(e,n.child,null,r),e.child=hc(e,null,o,r)):$t(n,e,o,r),e.memoizedState=i.state,s&&z0(e,t,!0),e.child}function DS(n){var e=n.stateNode;e.pendingContext?j0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&j0(n,e.context,!1),vv(n,e.containerInfo)}function tw(n,e,t,i,s){return uc(),dv(s),e.flags|=256,$t(n,e,t,i),e.child}var pm={dehydrated:null,treeContext:null,retryLane:0};function gm(n){return{baseLanes:n,cachePool:null,transitions:null}}function FS(n,e,t){var i=e.pendingProps,s=Oe.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(s&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),ke(Oe,s&1),n===null)return om(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,n=i.fallback,r?(i=e.mode,r=e.child,a={mode:"hidden",children:a},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=Ip(a,i,0,null),n=oo(n,i,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=gm(t),e.memoizedState=pm,n):Cv(e,a));if(s=n.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return M1(n,e,a,i,o,s,t);if(r){r=i.fallback,a=e.mode,s=n.child,o=s.sibling;var c={mode:"hidden",children:i.children};return!(a&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=Mr(s,c),i.subtreeFlags=s.subtreeFlags&14680064),o!==null?r=Mr(o,r):(r=oo(r,a,t,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,a=n.child.memoizedState,a=a===null?gm(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=pm,i}return r=n.child,n=r.sibling,i=Mr(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Cv(n,e){return e=Ip({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ed(n,e,t,i){return i!==null&&dv(i),hc(e,n.child,null,t),n=Cv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function M1(n,e,t,i,s,r,a){if(t)return e.flags&256?(e.flags&=-257,i=Sg(Error(L(422))),Ed(n,e,a,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=i.fallback,s=e.mode,i=Ip({mode:"visible",children:i.children},s,0,null),r=oo(r,s,a,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&hc(e,n.child,null,a),e.child.memoizedState=gm(a),e.memoizedState=pm,r);if(!(e.mode&1))return Ed(n,e,a,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var o=i.dgst;return i=o,r=Error(L(419)),i=Sg(r,i,void 0),Ed(n,e,a,i)}if(o=(a&n.childLanes)!==0,rn||o){if(i=dt,i!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|a)?0:s,s!==0&&s!==r.retryLane&&(r.retryLane=s,Ds(n,s),vi(i,n,s,-1))}return Lv(),i=Sg(Error(L(421))),Ed(n,e,a,i)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=G1.bind(null,n),s._reactRetry=e,null):(n=r.treeContext,Cn=Pr(s.nextSibling),kn=e,Ie=!0,gi=null,n!==null&&(Hn[Un++]=Ts,Hn[Un++]=Ps,Hn[Un++]=co,Ts=n.id,Ps=n.overflow,co=e),e=Cv(e,i.children),e.flags|=4096,e)}function nw(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),lm(n.return,e,t)}function xg(n,e,t,i,s){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=t,r.tailMode=s)}function OS(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if($t(n,e,i.children,t),i=Oe.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&nw(n,t,e);else if(n.tag===19)nw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(ke(Oe,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&zf(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),xg(e,!1,s,t,r);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&zf(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}xg(e,!0,t,null,r);break;case"together":xg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hd(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Fs(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ho|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(L(153));if(e.child!==null){for(n=e.child,t=Mr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function I1(n,e,t){switch(e.tag){case 3:DS(e),uc();break;case 5:cS(e);break;case 1:on(e.type)&&Mf(e);break;case 4:vv(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;ke(Ff,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ke(Oe,Oe.current&1),e.flags|=128,null):t&e.child.childLanes?FS(n,e,t):(ke(Oe,Oe.current&1),n=Fs(n,e,t),n!==null?n.sibling:null);ke(Oe,Oe.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return OS(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ke(Oe,Oe.current),i)break;return null;case 22:case 23:return e.lanes=0,MS(n,e,t)}return Fs(n,e,t)}var jS,mm,zS,BS;jS=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};mm=function(){};zS=function(n,e,t,i){var s=n.memoizedProps;if(s!==i){n=e.stateNode,ta(Xi.current);var r=null;switch(t){case"input":s=jg(n,s),i=jg(n,i),r=[];break;case"select":s=Be({},s,{value:void 0}),i=Be({},i,{value:void 0}),r=[];break;case"textarea":s=Hg(n,s),i=Hg(n,i),r=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Rf)}$g(t,i);var a;t=null;for(u in s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(cu.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in i){var c=i[u];if(o=s!=null?s[u]:void 0,i.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(cu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",n),r||o===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};BS=function(n,e,t,i){t!==i&&(e.flags|=4)};function Cc(n,e){if(!Ie)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Et(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function D1(n,e,t){var i=e.pendingProps;switch(hv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return on(e.type)&&Lf(),Et(e),null;case 3:return i=e.stateNode,dc(),Ne(an),Ne(Ft),Av(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(bd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gi!==null&&(_m(gi),gi=null))),mm(n,e),Et(e),null;case 5:wv(e);var s=ta(Su.current);if(t=e.type,n!==null&&e.stateNode!=null)zS(n,e,t,i,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(L(166));return Et(e),null}if(n=ta(Xi.current),bd(e)){i=e.stateNode,t=e.type;var r=e.memoizedProps;switch(i[Wi]=e,i[wu]=r,n=(e.mode&1)!==0,t){case"dialog":Te("cancel",i),Te("close",i);break;case"iframe":case"object":case"embed":Te("load",i);break;case"video":case"audio":for(s=0;s<Dc.length;s++)Te(Dc[s],i);break;case"source":Te("error",i);break;case"img":case"image":case"link":Te("error",i),Te("load",i);break;case"details":Te("toggle",i);break;case"input":h0(i,r),Te("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},Te("invalid",i);break;case"textarea":f0(i,r),Te("invalid",i)}$g(t,r),s=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?i.textContent!==o&&(r.suppressHydrationWarning!==!0&&xd(i.textContent,o,n),s=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&xd(i.textContent,o,n),s=["children",""+o]):cu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Te("scroll",i)}switch(t){case"input":pd(i),d0(i,r,!0);break;case"textarea":pd(i),p0(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=Rf)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=pA(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=a.createElement(t,{is:i.is}):(n=a.createElement(t),t==="select"&&(a=n,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):n=a.createElementNS(n,t),n[Wi]=e,n[wu]=i,jS(n,e,!1,!1),e.stateNode=n;e:{switch(a=Vg(t,i),t){case"dialog":Te("cancel",n),Te("close",n),s=i;break;case"iframe":case"object":case"embed":Te("load",n),s=i;break;case"video":case"audio":for(s=0;s<Dc.length;s++)Te(Dc[s],n);s=i;break;case"source":Te("error",n),s=i;break;case"img":case"image":case"link":Te("error",n),Te("load",n),s=i;break;case"details":Te("toggle",n),s=i;break;case"input":h0(n,i),s=jg(n,i),Te("invalid",n);break;case"option":s=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},s=Be({},i,{value:void 0}),Te("invalid",n);break;case"textarea":f0(n,i),s=Hg(n,i),Te("invalid",n);break;default:s=i}$g(t,s),o=s;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?yA(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gA(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&uu(n,c):typeof c=="number"&&uu(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(cu.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Te("scroll",n):c!=null&&Ky(n,r,c,a))}switch(t){case"input":pd(n),d0(n,i,!1);break;case"textarea":pd(n),p0(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Fr(i.value));break;case"select":n.multiple=!!i.multiple,r=i.value,r!=null?Yo(n,!!i.multiple,r,!1):i.defaultValue!=null&&Yo(n,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Rf)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(n&&e.stateNode!=null)BS(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(L(166));if(t=ta(Su.current),ta(Xi.current),bd(e)){if(i=e.stateNode,t=e.memoizedProps,i[Wi]=e,(r=i.nodeValue!==t)&&(n=kn,n!==null))switch(n.tag){case 3:xd(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&xd(i.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Wi]=e,e.stateNode=i}return Et(e),null;case 13:if(Ne(Oe),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ie&&Cn!==null&&e.mode&1&&!(e.flags&128))sS(),uc(),e.flags|=98560,r=!1;else if(r=bd(e),i!==null&&i.dehydrated!==null){if(n===null){if(!r)throw Error(L(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(L(317));r[Wi]=e}else uc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Et(e),r=!1}else gi!==null&&(_m(gi),gi=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Oe.current&1?it===0&&(it=3):Lv())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return dc(),mm(n,e),n===null&&yu(e.stateNode.containerInfo),Et(e),null;case 10:return gv(e.type._context),Et(e),null;case 17:return on(e.type)&&Lf(),Et(e),null;case 19:if(Ne(Oe),r=e.memoizedState,r===null)return Et(e),null;if(i=(e.flags&128)!==0,a=r.rendering,a===null)if(i)Cc(r,!1);else{if(it!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=zf(n),a!==null){for(e.flags|=128,Cc(r,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)r=t,n=i,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ke(Oe,Oe.current&1|2),e.child}n=n.sibling}r.tail!==null&&We()>pc&&(e.flags|=128,i=!0,Cc(r,!1),e.lanes=4194304)}else{if(!i)if(n=zf(a),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Cc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Ie)return Et(e),null}else 2*We()-r.renderingStartTime>pc&&t!==1073741824&&(e.flags|=128,i=!0,Cc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=We(),e.sibling=null,t=Oe.current,ke(Oe,i?t&1|2:t&1),e):(Et(e),null);case 22:case 23:return Rv(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?bn&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function F1(n,e){switch(hv(e),e.tag){case 1:return on(e.type)&&Lf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return dc(),Ne(an),Ne(Ft),Av(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return wv(e),null;case 13:if(Ne(Oe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(L(340));uc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ne(Oe),null;case 4:return dc(),null;case 10:return gv(e.type._context),null;case 22:case 23:return Rv(),null;case 24:return null;default:return null}}var Cd=!1,It=!1,O1=typeof WeakSet=="function"?WeakSet:Set,H=null;function Wo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Ue(n,e,i)}else t.current=null}function ym(n,e,t){try{t()}catch(i){Ue(n,e,i)}}var iw=!1;function j1(n,e){if(em=Tf,n=WA(),cv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var p;d!==t||s!==0&&d.nodeType!==3||(o=a+s),d!==r||i!==0&&d.nodeType!==3||(c=a+i),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===n)break t;if(f===t&&++u===s&&(o=a),f===r&&++h===i&&(c=a),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(tm={focusedElem:n,selectionRange:t},Tf=!1,H=e;H!==null;)if(e=H,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,H=n;else for(;H!==null;){e=H;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var A=m.memoizedProps,_=m.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?A:ei(e.type,A),_);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(E){Ue(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}return m=iw,iw=!1,m}function su(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&n)===n){var r=s.destroy;s.destroy=void 0,r!==void 0&&ym(e,t,r)}s=s.next}while(s!==i)}}function Lp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function vm(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function HS(n){var e=n.alternate;e!==null&&(n.alternate=null,HS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Wi],delete e[wu],delete e[sm],delete e[A1],delete e[S1])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function US(n){return n.tag===5||n.tag===3||n.tag===4}function sw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||US(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function wm(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Rf));else if(i!==4&&(n=n.child,n!==null))for(wm(n,e,t),n=n.sibling;n!==null;)wm(n,e,t),n=n.sibling}function Am(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Am(n,e,t),n=n.sibling;n!==null;)Am(n,e,t),n=n.sibling}var At=null,pi=!1;function Bs(n,e,t){for(t=t.child;t!==null;)$S(n,e,t),t=t.sibling}function $S(n,e,t){if(Gi&&typeof Gi.onCommitFiberUnmount=="function")try{Gi.onCommitFiberUnmount(_p,t)}catch{}switch(t.tag){case 5:It||Wo(t,e);case 6:var i=At,s=pi;At=null,Bs(n,e,t),At=i,pi=s,At!==null&&(pi?(n=At,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):At.removeChild(t.stateNode));break;case 18:At!==null&&(pi?(n=At,t=t.stateNode,n.nodeType===8?gg(n.parentNode,t):n.nodeType===1&&gg(n,t),pu(n)):gg(At,t.stateNode));break;case 4:i=At,s=pi,At=t.stateNode.containerInfo,pi=!0,Bs(n,e,t),At=i,pi=s;break;case 0:case 11:case 14:case 15:if(!It&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var r=s,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&ym(t,e,a),s=s.next}while(s!==i)}Bs(n,e,t);break;case 1:if(!It&&(Wo(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(o){Ue(t,e,o)}Bs(n,e,t);break;case 21:Bs(n,e,t);break;case 22:t.mode&1?(It=(i=It)||t.memoizedState!==null,Bs(n,e,t),It=i):Bs(n,e,t);break;default:Bs(n,e,t)}}function rw(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new O1),e.forEach(function(i){var s=X1.bind(null,n,i);t.has(i)||(t.add(i),i.then(s,s))})}}function Jn(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:At=o.stateNode,pi=!1;break e;case 3:At=o.stateNode.containerInfo,pi=!0;break e;case 4:At=o.stateNode.containerInfo,pi=!0;break e}o=o.return}if(At===null)throw Error(L(160));$S(r,a,s),At=null,pi=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Ue(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VS(e,n),e=e.sibling}function VS(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Jn(e,n),bi(n),i&4){try{su(3,n,n.return),Lp(3,n)}catch(A){Ue(n,n.return,A)}try{su(5,n,n.return)}catch(A){Ue(n,n.return,A)}}break;case 1:Jn(e,n),bi(n),i&512&&t!==null&&Wo(t,t.return);break;case 5:if(Jn(e,n),bi(n),i&512&&t!==null&&Wo(t,t.return),n.flags&32){var s=n.stateNode;try{uu(s,"")}catch(A){Ue(n,n.return,A)}}if(i&4&&(s=n.stateNode,s!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&dA(s,r),Vg(o,a);var u=Vg(o,r);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];h==="style"?yA(s,d):h==="dangerouslySetInnerHTML"?gA(s,d):h==="children"?uu(s,d):Ky(s,h,d,u)}switch(o){case"input":zg(s,r);break;case"textarea":fA(s,r);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?Yo(s,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?Yo(s,!!r.multiple,r.defaultValue,!0):Yo(s,!!r.multiple,r.multiple?[]:"",!1))}s[wu]=r}catch(A){Ue(n,n.return,A)}}break;case 6:if(Jn(e,n),bi(n),i&4){if(n.stateNode===null)throw Error(L(162));s=n.stateNode,r=n.memoizedProps;try{s.nodeValue=r}catch(A){Ue(n,n.return,A)}}break;case 3:if(Jn(e,n),bi(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{pu(e.containerInfo)}catch(A){Ue(n,n.return,A)}break;case 4:Jn(e,n),bi(n);break;case 13:Jn(e,n),bi(n),s=n.child,s.flags&8192&&(r=s.memoizedState!==null,s.stateNode.isHidden=r,!r||s.alternate!==null&&s.alternate.memoizedState!==null||(Pv=We())),i&4&&rw(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(It=(u=It)||h,Jn(e,n),It=u):Jn(e,n),bi(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(H=n,h=n.child;h!==null;){for(d=H=h;H!==null;){switch(f=H,p=f.child,f.tag){case 0:case 11:case 14:case 15:su(4,f,f.return);break;case 1:Wo(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){i=f,t=f.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(A){Ue(i,t,A)}}break;case 5:Wo(f,f.return);break;case 22:if(f.memoizedState!==null){ow(d);continue}}p!==null?(p.return=f,H=p):ow(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,u?(r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,c=d.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=mA("display",a))}catch(A){Ue(n,n.return,A)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(A){Ue(n,n.return,A)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jn(e,n),bi(n),i&4&&rw(n);break;case 21:break;default:Jn(e,n),bi(n)}}function bi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(US(t)){var i=t;break e}t=t.return}throw Error(L(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(uu(s,""),i.flags&=-33);var r=sw(n);Am(n,r,s);break;case 3:case 4:var a=i.stateNode.containerInfo,o=sw(n);wm(n,o,a);break;default:throw Error(L(161))}}catch(c){Ue(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function z1(n,e,t){H=n,WS(n)}function WS(n,e,t){for(var i=(n.mode&1)!==0;H!==null;){var s=H,r=s.child;if(s.tag===22&&i){var a=s.memoizedState!==null||Cd;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||It;o=Cd;var u=It;if(Cd=a,(It=c)&&!u)for(H=s;H!==null;)a=H,c=a.child,a.tag===22&&a.memoizedState!==null?lw(s):c!==null?(c.return=a,H=c):lw(s);for(;r!==null;)H=r,WS(r),r=r.sibling;H=s,Cd=o,It=u}aw(n)}else s.subtreeFlags&8772&&r!==null?(r.return=s,H=r):aw(n)}}function aw(n){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Lp(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!It)if(t===null)i.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:ei(e.type,t.memoizedProps);i.componentDidUpdate(s,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&V0(e,r,i);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}V0(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&pu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}It||e.flags&512&&vm(e)}catch(f){Ue(e,e.return,f)}}if(e===n){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function ow(n){for(;H!==null;){var e=H;if(e===n){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function lw(n){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Lp(4,e)}catch(c){Ue(e,t,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(c){Ue(e,s,c)}}var r=e.return;try{vm(e)}catch(c){Ue(e,r,c)}break;case 5:var a=e.return;try{vm(e)}catch(c){Ue(e,a,c)}}}catch(c){Ue(e,e.return,c)}if(e===n){H=null;break}var o=e.sibling;if(o!==null){o.return=e.return,H=o;break}H=e.return}}var B1=Math.ceil,Uf=zs.ReactCurrentDispatcher,kv=zs.ReactCurrentOwner,Xn=zs.ReactCurrentBatchConfig,he=0,dt=null,qe=null,xt=0,bn=0,Go=Ur(0),it=0,Eu=null,ho=0,Mp=0,Tv=0,ru=null,sn=null,Pv=0,pc=1/0,Ji=null,$f=!1,Sm=null,Rr=null,kd=!1,_r=null,Vf=0,au=0,xm=null,Ud=-1,$d=0;function Vt(){return he&6?We():Ud!==-1?Ud:Ud=We()}function Lr(n){return n.mode&1?he&2&&xt!==0?xt&-xt:b1.transition!==null?($d===0&&($d=PA()),$d):(n=we,n!==0||(n=window.event,n=n===void 0?16:FA(n.type)),n):1}function vi(n,e,t,i){if(50<au)throw au=0,xm=null,Error(L(185));id(n,t,i),(!(he&2)||n!==dt)&&(n===dt&&(!(he&2)&&(Mp|=t),it===4&&Ws(n,xt)),ln(n,i),t===1&&he===0&&!(e.mode&1)&&(pc=We()+500,Pp&&$r()))}function ln(n,e){var t=n.callbackNode;bE(n,e);var i=kf(n,n===dt?xt:0);if(i===0)t!==null&&y0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&y0(t),e===1)n.tag===0?x1(cw.bind(null,n)):tS(cw.bind(null,n)),v1(function(){!(he&6)&&$r()}),t=null;else{switch(NA(i)){case 1:t=tv;break;case 4:t=kA;break;case 16:t=Cf;break;case 536870912:t=TA;break;default:t=Cf}t=ZS(t,GS.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function GS(n,e){if(Ud=-1,$d=0,he&6)throw Error(L(327));var t=n.callbackNode;if(el()&&n.callbackNode!==t)return null;var i=kf(n,n===dt?xt:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Wf(n,i);else{e=i;var s=he;he|=2;var r=qS();(dt!==n||xt!==e)&&(Ji=null,pc=We()+500,ao(n,e));do try{$1();break}catch(o){XS(n,o)}while(!0);pv(),Uf.current=r,he=s,qe!==null?e=0:(dt=null,xt=0,e=it)}if(e!==0){if(e===2&&(s=Yg(n),s!==0&&(i=s,e=bm(n,s))),e===1)throw t=Eu,ao(n,0),Ws(n,i),ln(n,We()),t;if(e===6)Ws(n,i);else{if(s=n.current.alternate,!(i&30)&&!H1(s)&&(e=Wf(n,i),e===2&&(r=Yg(n),r!==0&&(i=r,e=bm(n,r))),e===1))throw t=Eu,ao(n,0),Ws(n,i),ln(n,We()),t;switch(n.finishedWork=s,n.finishedLanes=i,e){case 0:case 1:throw Error(L(345));case 2:Xr(n,sn,Ji);break;case 3:if(Ws(n,i),(i&130023424)===i&&(e=Pv+500-We(),10<e)){if(kf(n,0)!==0)break;if(s=n.suspendedLanes,(s&i)!==i){Vt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=im(Xr.bind(null,n,sn,Ji),e);break}Xr(n,sn,Ji);break;case 4:if(Ws(n,i),(i&4194240)===i)break;for(e=n.eventTimes,s=-1;0<i;){var a=31-yi(i);r=1<<a,a=e[a],a>s&&(s=a),i&=~r}if(i=s,i=We()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*B1(i/1960))-i,10<i){n.timeoutHandle=im(Xr.bind(null,n,sn,Ji),i);break}Xr(n,sn,Ji);break;case 5:Xr(n,sn,Ji);break;default:throw Error(L(329))}}}return ln(n,We()),n.callbackNode===t?GS.bind(null,n):null}function bm(n,e){var t=ru;return n.current.memoizedState.isDehydrated&&(ao(n,e).flags|=256),n=Wf(n,e),n!==2&&(e=sn,sn=t,e!==null&&_m(e)),n}function _m(n){sn===null?sn=n:sn.push.apply(sn,n)}function H1(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!wi(r(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ws(n,e){for(e&=~Tv,e&=~Mp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-yi(e),i=1<<t;n[t]=-1,e&=~i}}function cw(n){if(he&6)throw Error(L(327));el();var e=kf(n,0);if(!(e&1))return ln(n,We()),null;var t=Wf(n,e);if(n.tag!==0&&t===2){var i=Yg(n);i!==0&&(e=i,t=bm(n,i))}if(t===1)throw t=Eu,ao(n,0),Ws(n,e),ln(n,We()),t;if(t===6)throw Error(L(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Xr(n,sn,Ji),ln(n,We()),null}function Nv(n,e){var t=he;he|=1;try{return n(e)}finally{he=t,he===0&&(pc=We()+500,Pp&&$r())}}function fo(n){_r!==null&&_r.tag===0&&!(he&6)&&el();var e=he;he|=1;var t=Xn.transition,i=we;try{if(Xn.transition=null,we=1,n)return n()}finally{we=i,Xn.transition=t,he=e,!(he&6)&&$r()}}function Rv(){bn=Go.current,Ne(Go)}function ao(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,y1(t)),qe!==null)for(t=qe.return;t!==null;){var i=t;switch(hv(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Lf();break;case 3:dc(),Ne(an),Ne(Ft),Av();break;case 5:wv(i);break;case 4:dc();break;case 13:Ne(Oe);break;case 19:Ne(Oe);break;case 10:gv(i.type._context);break;case 22:case 23:Rv()}t=t.return}if(dt=n,qe=n=Mr(n.current,null),xt=bn=e,it=0,Eu=null,Tv=Mp=ho=0,sn=ru=null,ea!==null){for(e=0;e<ea.length;e++)if(t=ea[e],i=t.interleaved,i!==null){t.interleaved=null;var s=i.next,r=t.pending;if(r!==null){var a=r.next;r.next=s,i.next=a}t.pending=i}ea=null}return n}function XS(n,e){do{var t=qe;try{if(pv(),zd.current=Hf,Bf){for(var i=ze.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Bf=!1}if(uo=0,ht=nt=ze=null,iu=!1,xu=0,kv.current=null,t===null||t.return===null){it=1,Eu=e,qe=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=xt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=K0(a);if(p!==null){p.flags&=-257,Q0(p,a,o,r,e),p.mode&1&&Y0(r,u,e),e=p,c=u;var m=e.updateQueue;if(m===null){var A=new Set;A.add(c),e.updateQueue=A}else m.add(c);break e}else{if(!(e&1)){Y0(r,u,e),Lv();break e}c=Error(L(426))}}else if(Ie&&o.mode&1){var _=K0(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Q0(_,a,o,r,e),dv(fc(c,o));break e}}r=c=fc(c,o),it!==4&&(it=2),ru===null?ru=[r]:ru.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var y=NS(r,c,e);$0(r,y);break e;case 1:o=c;var w=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Rr===null||!Rr.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=RS(r,o,e);$0(r,E);break e}}r=r.return}while(r!==null)}KS(t)}catch(C){e=C,qe===t&&t!==null&&(qe=t=t.return);continue}break}while(!0)}function qS(){var n=Uf.current;return Uf.current=Hf,n===null?Hf:n}function Lv(){(it===0||it===3||it===2)&&(it=4),dt===null||!(ho&268435455)&&!(Mp&268435455)||Ws(dt,xt)}function Wf(n,e){var t=he;he|=2;var i=qS();(dt!==n||xt!==e)&&(Ji=null,ao(n,e));do try{U1();break}catch(s){XS(n,s)}while(!0);if(pv(),he=t,Uf.current=i,qe!==null)throw Error(L(261));return dt=null,xt=0,it}function U1(){for(;qe!==null;)YS(qe)}function $1(){for(;qe!==null&&!pE();)YS(qe)}function YS(n){var e=JS(n.alternate,n,bn);n.memoizedProps=n.pendingProps,e===null?KS(n):qe=e,kv.current=null}function KS(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=F1(t,e),t!==null){t.flags&=32767,qe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{it=6,qe=null;return}}else if(t=D1(t,e,bn),t!==null){qe=t;return}if(e=e.sibling,e!==null){qe=e;return}qe=e=n}while(e!==null);it===0&&(it=5)}function Xr(n,e,t){var i=we,s=Xn.transition;try{Xn.transition=null,we=1,V1(n,e,t,i)}finally{Xn.transition=s,we=i}return null}function V1(n,e,t,i){do el();while(_r!==null);if(he&6)throw Error(L(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(L(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(_E(n,r),n===dt&&(qe=dt=null,xt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||kd||(kd=!0,ZS(Cf,function(){return el(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Xn.transition,Xn.transition=null;var a=we;we=1;var o=he;he|=4,kv.current=null,j1(n,t),VS(t,n),u1(tm),Tf=!!em,tm=em=null,n.current=t,z1(t),gE(),he=o,we=a,Xn.transition=r}else n.current=t;if(kd&&(kd=!1,_r=n,Vf=s),r=n.pendingLanes,r===0&&(Rr=null),vE(t.stateNode),ln(n,We()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],i(s.value,{componentStack:s.stack,digest:s.digest});if($f)throw $f=!1,n=Sm,Sm=null,n;return Vf&1&&n.tag!==0&&el(),r=n.pendingLanes,r&1?n===xm?au++:(au=0,xm=n):au=0,$r(),null}function el(){if(_r!==null){var n=NA(Vf),e=Xn.transition,t=we;try{if(Xn.transition=null,we=16>n?16:n,_r===null)var i=!1;else{if(n=_r,_r=null,Vf=0,he&6)throw Error(L(331));var s=he;for(he|=4,H=n.current;H!==null;){var r=H,a=r.child;if(H.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(H=u;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:su(8,h,r)}var d=h.child;if(d!==null)d.return=h,H=d;else for(;H!==null;){h=H;var f=h.sibling,p=h.return;if(HS(h),h===u){H=null;break}if(f!==null){f.return=p,H=f;break}H=p}}}var m=r.alternate;if(m!==null){var A=m.child;if(A!==null){m.child=null;do{var _=A.sibling;A.sibling=null,A=_}while(A!==null)}}H=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,H=a;else e:for(;H!==null;){if(r=H,r.flags&2048)switch(r.tag){case 0:case 11:case 15:su(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,H=y;break e}H=r.return}}var w=n.current;for(H=w;H!==null;){a=H;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,H=b;else e:for(a=w;H!==null;){if(o=H,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Lp(9,o)}}catch(C){Ue(o,o.return,C)}if(o===a){H=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,H=E;break e}H=o.return}}if(he=s,$r(),Gi&&typeof Gi.onPostCommitFiberRoot=="function")try{Gi.onPostCommitFiberRoot(_p,n)}catch{}i=!0}return i}finally{we=t,Xn.transition=e}}return!1}function uw(n,e,t){e=fc(t,e),e=NS(n,e,1),n=Nr(n,e,1),e=Vt(),n!==null&&(id(n,1,e),ln(n,e))}function Ue(n,e,t){if(n.tag===3)uw(n,n,t);else for(;e!==null;){if(e.tag===3){uw(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Rr===null||!Rr.has(i))){n=fc(t,n),n=RS(e,n,1),e=Nr(e,n,1),n=Vt(),e!==null&&(id(e,1,n),ln(e,n));break}}e=e.return}}function W1(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Vt(),n.pingedLanes|=n.suspendedLanes&t,dt===n&&(xt&t)===t&&(it===4||it===3&&(xt&130023424)===xt&&500>We()-Pv?ao(n,0):Tv|=t),ln(n,e)}function QS(n,e){e===0&&(n.mode&1?(e=yd,yd<<=1,!(yd&130023424)&&(yd=4194304)):e=1);var t=Vt();n=Ds(n,e),n!==null&&(id(n,e,t),ln(n,t))}function G1(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),QS(n,t)}function X1(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(L(314))}i!==null&&i.delete(e),QS(n,t)}var JS;JS=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||an.current)rn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return rn=!1,I1(n,e,t);rn=!!(n.flags&131072)}else rn=!1,Ie&&e.flags&1048576&&nS(e,Df,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Hd(n,e),n=e.pendingProps;var s=cc(e,Ft.current);Zo(e,t),s=xv(null,e,i,n,s,t);var r=bv();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(i)?(r=!0,Mf(e)):r=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,yv(e),s.updater=Rp,e.stateNode=s,s._reactInternals=e,um(e,i,n,t),e=fm(null,e,i,!0,r,t)):(e.tag=0,Ie&&r&&uv(e),$t(null,e,s,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Hd(n,e),n=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=Y1(i),n=ei(i,n),s){case 0:e=dm(null,e,i,n,t);break e;case 1:e=ew(null,e,i,n,t);break e;case 11:e=J0(null,e,i,n,t);break e;case 14:e=Z0(null,e,i,ei(i.type,n),t);break e}throw Error(L(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),dm(n,e,i,s,t);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),ew(n,e,i,s,t);case 3:e:{if(DS(e),n===null)throw Error(L(387));i=e.pendingProps,r=e.memoizedState,s=r.element,lS(n,e),jf(e,i,null,t);var a=e.memoizedState;if(i=a.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){s=fc(Error(L(423)),e),e=tw(n,e,i,t,s);break e}else if(i!==s){s=fc(Error(L(424)),e),e=tw(n,e,i,t,s);break e}else for(Cn=Pr(e.stateNode.containerInfo.firstChild),kn=e,Ie=!0,gi=null,t=aS(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(uc(),i===s){e=Fs(n,e,t);break e}$t(n,e,i,t)}e=e.child}return e;case 5:return cS(e),n===null&&om(e),i=e.type,s=e.pendingProps,r=n!==null?n.memoizedProps:null,a=s.children,nm(i,s)?a=null:r!==null&&nm(i,r)&&(e.flags|=32),IS(n,e),$t(n,e,a,t),e.child;case 6:return n===null&&om(e),null;case 13:return FS(n,e,t);case 4:return vv(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=hc(e,null,i,t):$t(n,e,i,t),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),J0(n,e,i,s,t);case 7:return $t(n,e,e.pendingProps,t),e.child;case 8:return $t(n,e,e.pendingProps.children,t),e.child;case 12:return $t(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,r=e.memoizedProps,a=s.value,ke(Ff,i._currentValue),i._currentValue=a,r!==null)if(wi(r.value,a)){if(r.children===s.children&&!an.current){e=Fs(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===i){if(r.tag===1){c=Ns(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),lm(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(L(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),lm(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}$t(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,Zo(e,t),s=Yn(s),i=i(s),e.flags|=1,$t(n,e,i,t),e.child;case 14:return i=e.type,s=ei(i,e.pendingProps),s=ei(i.type,s),Z0(n,e,i,s,t);case 15:return LS(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),Hd(n,e),e.tag=1,on(i)?(n=!0,Mf(e)):n=!1,Zo(e,t),PS(e,i,s),um(e,i,s,t),fm(null,e,i,!0,n,t);case 19:return OS(n,e,t);case 22:return MS(n,e,t)}throw Error(L(156,e.tag))};function ZS(n,e){return CA(n,e)}function q1(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(n,e,t,i){return new q1(n,e,t,i)}function Mv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Y1(n){if(typeof n=="function")return Mv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Jy)return 11;if(n===Zy)return 14}return 2}function Mr(n,e){var t=n.alternate;return t===null?(t=Wn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Vd(n,e,t,i,s,r){var a=2;if(i=n,typeof n=="function")Mv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Fo:return oo(t.children,s,r,e);case Qy:a=8,s|=8;break;case Ig:return n=Wn(12,t,e,s|2),n.elementType=Ig,n.lanes=r,n;case Dg:return n=Wn(13,t,e,s),n.elementType=Dg,n.lanes=r,n;case Fg:return n=Wn(19,t,e,s),n.elementType=Fg,n.lanes=r,n;case cA:return Ip(t,s,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oA:a=10;break e;case lA:a=9;break e;case Jy:a=11;break e;case Zy:a=14;break e;case Us:a=16,i=null;break e}throw Error(L(130,n==null?n:typeof n,""))}return e=Wn(a,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function oo(n,e,t,i){return n=Wn(7,n,i,e),n.lanes=t,n}function Ip(n,e,t,i){return n=Wn(22,n,i,e),n.elementType=cA,n.lanes=t,n.stateNode={isHidden:!1},n}function bg(n,e,t){return n=Wn(6,n,null,e),n.lanes=t,n}function _g(n,e,t){return e=Wn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function K1(n,e,t,i,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sg(0),this.expirationTimes=sg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sg(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Iv(n,e,t,i,s,r,a,o,c){return n=new K1(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Wn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},yv(r),n}function Q1(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Do,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function ex(n){if(!n)return Or;n=n._reactInternals;e:{if(Ao(n)!==n||n.tag!==1)throw Error(L(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(n.tag===1){var t=n.type;if(on(t))return eS(n,t,e)}return e}function tx(n,e,t,i,s,r,a,o,c){return n=Iv(t,i,!0,n,s,r,a,o,c),n.context=ex(null),t=n.current,i=Vt(),s=Lr(t),r=Ns(i,s),r.callback=e??null,Nr(t,r,s),n.current.lanes=s,id(n,s,i),ln(n,i),n}function Dp(n,e,t,i){var s=e.current,r=Vt(),a=Lr(s);return t=ex(t),e.context===null?e.context=t:e.pendingContext=t,e=Ns(r,a),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Nr(s,e,a),n!==null&&(vi(n,s,a,r),jd(n,s,a)),a}function Gf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function hw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Dv(n,e){hw(n,e),(n=n.alternate)&&hw(n,e)}function J1(){return null}var nx=typeof reportError=="function"?reportError:function(n){console.error(n)};function Fv(n){this._internalRoot=n}Fp.prototype.render=Fv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(L(409));Dp(n,e,null,null)};Fp.prototype.unmount=Fv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;fo(function(){Dp(null,n,null,null)}),e[Is]=null}};function Fp(n){this._internalRoot=n}Fp.prototype.unstable_scheduleHydration=function(n){if(n){var e=MA();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Vs.length&&e!==0&&e<Vs[t].priority;t++);Vs.splice(t,0,n),t===0&&DA(n)}};function Ov(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Op(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function dw(){}function Z1(n,e,t,i,s){if(s){if(typeof i=="function"){var r=i;i=function(){var u=Gf(a);r.call(u)}}var a=tx(e,i,n,0,null,!1,!1,"",dw);return n._reactRootContainer=a,n[Is]=a.current,yu(n.nodeType===8?n.parentNode:n),fo(),a}for(;s=n.lastChild;)n.removeChild(s);if(typeof i=="function"){var o=i;i=function(){var u=Gf(c);o.call(u)}}var c=Iv(n,0,!1,null,null,!1,!1,"",dw);return n._reactRootContainer=c,n[Is]=c.current,yu(n.nodeType===8?n.parentNode:n),fo(function(){Dp(e,c,t,i)}),c}function jp(n,e,t,i,s){var r=t._reactRootContainer;if(r){var a=r;if(typeof s=="function"){var o=s;s=function(){var c=Gf(a);o.call(c)}}Dp(e,a,n,s)}else a=Z1(t,e,n,s,i);return Gf(a)}RA=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ic(e.pendingLanes);t!==0&&(nv(e,t|1),ln(e,We()),!(he&6)&&(pc=We()+500,$r()))}break;case 13:fo(function(){var i=Ds(n,1);if(i!==null){var s=Vt();vi(i,n,1,s)}}),Dv(n,1)}};iv=function(n){if(n.tag===13){var e=Ds(n,134217728);if(e!==null){var t=Vt();vi(e,n,134217728,t)}Dv(n,134217728)}};LA=function(n){if(n.tag===13){var e=Lr(n),t=Ds(n,e);if(t!==null){var i=Vt();vi(t,n,e,i)}Dv(n,e)}};MA=function(){return we};IA=function(n,e){var t=we;try{return we=n,e()}finally{we=t}};Gg=function(n,e,t){switch(e){case"input":if(zg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=Tp(i);if(!s)throw Error(L(90));hA(i),zg(i,s)}}}break;case"textarea":fA(n,t);break;case"select":e=t.value,e!=null&&Yo(n,!!t.multiple,e,!1)}};AA=Nv;SA=fo;var eC={usingClientEntryPoint:!1,Events:[rd,Bo,Tp,vA,wA,Nv]},kc={findFiberByHostInstance:Zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tC={bundleType:kc.bundleType,version:kc.version,rendererPackageName:kc.rendererPackageName,rendererConfig:kc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=_A(n),n===null?null:n.stateNode},findFiberByHostInstance:kc.findFiberByHostInstance||J1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{_p=Td.inject(tC),Gi=Td}catch{}}Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eC;Nn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ov(e))throw Error(L(200));return Q1(n,e,null,t)};Nn.createRoot=function(n,e){if(!Ov(n))throw Error(L(299));var t=!1,i="",s=nx;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Iv(n,1,!1,null,null,t,!1,i,s),n[Is]=e.current,yu(n.nodeType===8?n.parentNode:n),new Fv(e)};Nn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(L(188)):(n=Object.keys(n).join(","),Error(L(268,n)));return n=_A(e),n=n===null?null:n.stateNode,n};Nn.flushSync=function(n){return fo(n)};Nn.hydrate=function(n,e,t){if(!Op(e))throw Error(L(200));return jp(null,n,e,!0,t)};Nn.hydrateRoot=function(n,e,t){if(!Ov(n))throw Error(L(405));var i=t!=null&&t.hydratedSources||null,s=!1,r="",a=nx;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=tx(e,null,n,1,t??null,s,!1,r,a),n[Is]=e.current,yu(n),i)for(n=0;n<i.length;n++)t=i[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Fp(e)};Nn.render=function(n,e,t){if(!Op(e))throw Error(L(200));return jp(null,n,e,!1,t)};Nn.unmountComponentAtNode=function(n){if(!Op(n))throw Error(L(40));return n._reactRootContainer?(fo(function(){jp(null,null,n,!1,function(){n._reactRootContainer=null,n[Is]=null})}),!0):!1};Nn.unstable_batchedUpdates=Nv;Nn.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!Op(t))throw Error(L(200));if(n==null||n._reactInternals===void 0)throw Error(L(38));return jp(n,e,t,!1,i)};Nn.version="18.3.1-next-f1338f8080-20240426";function ix(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ix)}catch(n){console.error(n)}}ix(),iA.exports=Nn;var nC=iA.exports,sx,fw=nC;sx=fw.createRoot,fw.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cu(){return Cu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Cu.apply(this,arguments)}var Er;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Er||(Er={}));const pw="popstate";function iC(n){n===void 0&&(n={});function e(s,r){let{pathname:a="/",search:o="",hash:c=""}=So(s.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Em("",{pathname:a,search:o,hash:c},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){let a=s.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");o=u===-1?c:c.slice(0,u)}return o+"#"+(typeof r=="string"?r:Xf(r))}function i(s,r){zp(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(r)+")")}return rC(e,t,i,n)}function Ke(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zp(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sC(){return Math.random().toString(36).substr(2,8)}function gw(n,e){return{usr:n.state,key:n.key,idx:e}}function Em(n,e,t,i){return t===void 0&&(t=null),Cu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?So(e):e,{state:t,key:e&&e.key||i||sC()})}function Xf(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function So(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function rC(n,e,t,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:r=!1}=i,a=s.history,o=Er.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(Cu({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function d(){o=Er.Pop;let _=h(),y=_==null?null:_-u;u=_,c&&c({action:o,location:A.location,delta:y})}function f(_,y){o=Er.Push;let w=Em(A.location,_,y);t&&t(w,_),u=h()+1;let b=gw(w,u),E=A.createHref(w);try{a.pushState(b,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(E)}r&&c&&c({action:o,location:A.location,delta:1})}function p(_,y){o=Er.Replace;let w=Em(A.location,_,y);t&&t(w,_),u=h();let b=gw(w,u),E=A.createHref(w);a.replaceState(b,"",E),r&&c&&c({action:o,location:A.location,delta:0})}function m(_){let y=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof _=="string"?_:Xf(_);return w=w.replace(/ $/,"%20"),Ke(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let A={get action(){return o},get location(){return n(s,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(pw,d),c=_,()=>{s.removeEventListener(pw,d),c=null}},createHref(_){return e(s,_)},createURL:m,encodeLocation(_){let y=m(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:p,go(_){return a.go(_)}};return A}var mw;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(mw||(mw={}));function aC(n,e,t){return t===void 0&&(t="/"),oC(n,e,t)}function oC(n,e,t,i){let s=typeof e=="string"?So(e):e,r=jv(s.pathname||"/",t);if(r==null)return null;let a=rx(n);lC(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=AC(r);o=yC(a[c],u)}return o}function rx(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let s=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(Ke(c.relativePath.startsWith(i),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(i.length));let u=Ir([i,c.relativePath]),h=t.concat(c);r.children&&r.children.length>0&&(Ke(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),rx(r.children,e,h,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:gC(u,r.index),routesMeta:h})};return n.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))s(r,a);else for(let c of ax(r.path))s(r,a,c)}),e}function ax(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(i.length===0)return s?[r,""]:[r];let a=ax(i.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),s&&o.push(...a),o.map(c=>n.startsWith("/")&&c===""?"/":c)}function lC(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:mC(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const cC=/^:[\w-]+$/,uC=3,hC=2,dC=1,fC=10,pC=-2,yw=n=>n==="*";function gC(n,e){let t=n.split("/"),i=t.length;return t.some(yw)&&(i+=pC),e&&(i+=hC),t.filter(s=>!yw(s)).reduce((s,r)=>s+(cC.test(r)?uC:r===""?dC:fC),i)}function mC(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function yC(n,e,t){let{routesMeta:i}=n,s={},r="/",a=[];for(let o=0;o<i.length;++o){let c=i[o],u=o===i.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=vC({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(s,d.params),a.push({params:s,pathname:Ir([r,d.pathname]),pathnameBase:EC(Ir([r,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(r=Ir([r,d.pathnameBase]))}return a}function vC(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=wC(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let r=s[0],a=r.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:i.reduce((u,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let A=o[d]||"";a=r.slice(0,r.length-A.length).replace(/(.)\/+$/,"$1")}const m=o[d];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:n}}function wC(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),zp(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(i.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function AC(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zp(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function jv(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}const SC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xC=n=>SC.test(n);function bC(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?So(n):n,r;if(t)if(xC(t))r=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),zp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?r=vw(t.substring(1),"/"):r=vw(t,e)}else r=e;return{pathname:r,search:CC(i),hash:kC(s)}}function vw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Eg(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _C(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ox(n,e){let t=_C(n);return e?t.map((i,s)=>s===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function lx(n,e,t,i){i===void 0&&(i=!1);let s;typeof n=="string"?s=So(n):(s=Cu({},n),Ke(!s.pathname||!s.pathname.includes("?"),Eg("?","pathname","search",s)),Ke(!s.pathname||!s.pathname.includes("#"),Eg("#","pathname","hash",s)),Ke(!s.search||!s.search.includes("#"),Eg("#","search","hash",s)));let r=n===""||s.pathname==="",a=r?"/":s.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!i&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}o=d>=0?e[d]:"/"}let c=bC(s,o),u=a&&a!=="/"&&a.endsWith("/"),h=(r||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const Ir=n=>n.join("/").replace(/\/\/+/g,"/"),EC=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),CC=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,kC=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function TC(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const cx=["post","put","patch","delete"];new Set(cx);const PC=["get",...cx];new Set(PC);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ku.apply(this,arguments)}const zv=N.createContext(null),NC=N.createContext(null),xo=N.createContext(null),Bp=N.createContext(null),Vr=N.createContext({outlet:null,matches:[],isDataRoute:!1}),ux=N.createContext(null);function RC(n,e){let{relative:t}=e===void 0?{}:e;od()||Ke(!1);let{basename:i,navigator:s}=N.useContext(xo),{hash:r,pathname:a,search:o}=dx(n,{relative:t}),c=a;return i!=="/"&&(c=a==="/"?i:Ir([i,a])),s.createHref({pathname:c,search:o,hash:r})}function od(){return N.useContext(Bp)!=null}function Hp(){return od()||Ke(!1),N.useContext(Bp).location}function hx(n){N.useContext(xo).static||N.useLayoutEffect(n)}function LC(){let{isDataRoute:n}=N.useContext(Vr);return n?GC():MC()}function MC(){od()||Ke(!1);let n=N.useContext(zv),{basename:e,future:t,navigator:i}=N.useContext(xo),{matches:s}=N.useContext(Vr),{pathname:r}=Hp(),a=JSON.stringify(ox(s,t.v7_relativeSplatPath)),o=N.useRef(!1);return hx(()=>{o.current=!0}),N.useCallback(function(u,h){if(h===void 0&&(h={}),!o.current)return;if(typeof u=="number"){i.go(u);return}let d=lx(u,JSON.parse(a),r,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ir([e,d.pathname])),(h.replace?i.replace:i.push)(d,h.state,h)},[e,i,a,r,n])}function IC(){let{matches:n}=N.useContext(Vr),e=n[n.length-1];return e?e.params:{}}function dx(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=N.useContext(xo),{matches:s}=N.useContext(Vr),{pathname:r}=Hp(),a=JSON.stringify(ox(s,i.v7_relativeSplatPath));return N.useMemo(()=>lx(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function DC(n,e){return FC(n,e)}function FC(n,e,t,i){od()||Ke(!1);let{navigator:s}=N.useContext(xo),{matches:r}=N.useContext(Vr),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=Hp(),h;if(e){var d;let _=typeof e=="string"?So(e):e;c==="/"||(d=_.pathname)!=null&&d.startsWith(c)||Ke(!1),h=_}else h=u;let f=h.pathname||"/",p=f;if(c!=="/"){let _=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let m=aC(n,{pathname:p}),A=HC(m&&m.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:Ir([c,s.encodeLocation?s.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Ir([c,s.encodeLocation?s.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),r,t,i);return e&&A?N.createElement(Bp.Provider,{value:{location:ku({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Er.Pop}},A):A}function OC(){let n=WC(),e=TC(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),t?N.createElement("pre",{style:s},t):null,null)}const jC=N.createElement(OC,null);class zC extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?N.createElement(Vr.Provider,{value:this.props.routeContext},N.createElement(ux.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function BC(n){let{routeContext:e,match:t,children:i}=n,s=N.useContext(zv);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),N.createElement(Vr.Provider,{value:e},i)}function HC(n,e,t,i){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=i)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(s=t)==null?void 0:s.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||Ke(!1),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t&&i&&i.v7_partialHydration)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:p}=t,m=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||m){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,f)=>{let p,m=!1,A=null,_=null;t&&(p=o&&d.route.id?o[d.route.id]:void 0,A=d.route.errorElement||jC,c&&(u<0&&f===0?(XC("route-fallback"),m=!0,_=null):u===f&&(m=!0,_=d.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,f+1)),w=()=>{let b;return p?b=A:m?b=_:d.route.Component?b=N.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=h,N.createElement(BC,{match:d,routeContext:{outlet:h,matches:y,isDataRoute:t!=null},children:b})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?N.createElement(zC,{location:t.location,revalidation:t.revalidation,component:A,error:p,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var fx=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(fx||{}),px=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(px||{});function UC(n){let e=N.useContext(zv);return e||Ke(!1),e}function $C(n){let e=N.useContext(NC);return e||Ke(!1),e}function VC(n){let e=N.useContext(Vr);return e||Ke(!1),e}function gx(n){let e=VC(),t=e.matches[e.matches.length-1];return t.route.id||Ke(!1),t.route.id}function WC(){var n;let e=N.useContext(ux),t=$C(),i=gx();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function GC(){let{router:n}=UC(fx.UseNavigateStable),e=gx(px.UseNavigateStable),t=N.useRef(!1);return hx(()=>{t.current=!0}),N.useCallback(function(s,r){r===void 0&&(r={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,ku({fromRouteId:e},r)))},[n,e])}const ww={};function XC(n,e,t){ww[n]||(ww[n]=!0)}function qC(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Wd(n){Ke(!1)}function YC(n){let{basename:e="/",children:t=null,location:i,navigationType:s=Er.Pop,navigator:r,static:a=!1,future:o}=n;od()&&Ke(!1);let c=e.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:c,navigator:r,static:a,future:ku({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof i=="string"&&(i=So(i));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:m="default"}=i,A=N.useMemo(()=>{let _=jv(h,c);return _==null?null:{location:{pathname:_,search:d,hash:f,state:p,key:m},navigationType:s}},[c,h,d,f,p,m,s]);return A==null?null:N.createElement(xo.Provider,{value:u},N.createElement(Bp.Provider,{children:t,value:A}))}function KC(n){let{children:e,location:t}=n;return DC(Cm(e),t)}new Promise(()=>{});function Cm(n,e){e===void 0&&(e=[]);let t=[];return N.Children.forEach(n,(i,s)=>{if(!N.isValidElement(i))return;let r=[...e,s];if(i.type===N.Fragment){t.push.apply(t,Cm(i.props.children,r));return}i.type!==Wd&&Ke(!1),!i.props.index||!i.props.children||Ke(!1);let a={id:i.props.id||r.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=Cm(i.props.children,r)),t.push(a)}),t}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function km(){return km=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},km.apply(this,arguments)}function QC(n,e){if(n==null)return{};var t={},i=Object.keys(n),s,r;for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function JC(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function ZC(n,e){return n.button===0&&(!e||e==="_self")&&!JC(n)}const ek=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],tk="6";try{window.__reactRouterVersion=tk}catch{}const nk="startTransition",Aw=W_[nk];function ik(n){let{basename:e,children:t,future:i,window:s}=n,r=N.useRef();r.current==null&&(r.current=iC({window:s,v5Compat:!0}));let a=r.current,[o,c]=N.useState({action:a.action,location:a.location}),{v7_startTransition:u}=i||{},h=N.useCallback(d=>{u&&Aw?Aw(()=>c(d)):c(d)},[c,u]);return N.useLayoutEffect(()=>a.listen(h),[a,h]),N.useEffect(()=>qC(i),[i]),N.createElement(YC,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:i})}const sk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,po=N.forwardRef(function(e,t){let{onClick:i,relative:s,reloadDocument:r,replace:a,state:o,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,f=QC(e,ek),{basename:p}=N.useContext(xo),m,A=!1;if(typeof u=="string"&&rk.test(u)&&(m=u,sk))try{let b=new URL(window.location.href),E=u.startsWith("//")?new URL(b.protocol+u):new URL(u),C=jv(E.pathname,p);E.origin===b.origin&&C!=null?u=C+E.search+E.hash:A=!0}catch{}let _=RC(u,{relative:s}),y=ak(u,{replace:a,state:o,target:c,preventScrollReset:h,relative:s,viewTransition:d});function w(b){i&&i(b),b.defaultPrevented||y(b)}return N.createElement("a",km({},f,{href:m||_,onClick:A||r?i:w,ref:t,target:c}))});var Sw;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Sw||(Sw={}));var xw;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(xw||(xw={}));function ak(n,e){let{target:t,replace:i,state:s,preventScrollReset:r,relative:a,viewTransition:o}=e===void 0?{}:e,c=LC(),u=Hp(),h=dx(n,{relative:a});return N.useCallback(d=>{if(ZC(d,t)){d.preventDefault();let f=i!==void 0?i:Xf(u)===Xf(h);c(n,{replace:f,state:s,preventScrollReset:r,relative:a,viewTransition:o})}},[u,c,h,i,s,t,n,r,a,o])}function ok(){return v.jsxs("div",{className:"landing",children:[v.jsxs("section",{className:"landing-hero",children:[v.jsxs("div",{className:"hero-copy",children:[v.jsx("p",{className:"eyebrow",children:"Literature Desk"}),v.jsx("h1",{children:"Write research notes the way you think  not the way databases demand"}),v.jsx("p",{className:"muted",children:"Instead of manually filling out forms, Literature Desk lets you paste raw notes or citations while AI extracts the structure you need and helps you explore connections across your work."}),v.jsx("div",{className:"cta-row",children:v.jsx(po,{to:"/tool",className:"primary-cta",children:"Open the tool"})})]}),v.jsxs("div",{className:"hero-visual",children:[v.jsxs("div",{className:"hero-card",children:[v.jsxs("div",{className:"hero-card-top",children:[v.jsx("span",{className:"pill",children:"Live extraction"}),v.jsx("span",{className:"pill",children:"Local AI"})]}),v.jsx("h2",{children:"Paste anything, get structured metadata."}),v.jsx("p",{className:"muted",children:"Turn abstracts, citations, and raw notes into a sortable literature index in seconds."}),v.jsxs("div",{className:"hero-metrics",children:[v.jsxs("div",{children:[v.jsx("h3",{children:"Free-form"}),v.jsx("span",{className:"muted",children:"Write naturally"})]}),v.jsxs("div",{children:[v.jsx("h3",{children:"Local-first"}),v.jsx("span",{className:"muted",children:"Private + offline"})]})]})]}),v.jsxs("div",{className:"hero-orbit","aria-hidden":"true",children:[v.jsx("span",{className:"orbit-dot"}),v.jsx("span",{className:"orbit-dot"}),v.jsx("span",{className:"orbit-dot"})]})]})]}),v.jsxs("section",{className:"landing-features",children:[v.jsxs("div",{className:"snapshots-header",children:[v.jsx("h2",{children:"Features"}),v.jsx("p",{className:"muted",children:"Purpose-built for literature reviews that stay focused and connected."})]}),v.jsxs("div",{className:"features-grid",children:[v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Free-form research notes"}),v.jsx("p",{className:"muted",children:"Write or paste notes, abstracts, or citations without worrying about structure."})]}),v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Automatic metadata extraction"}),v.jsx("p",{className:"muted",children:"AI extracts key details like authors, publication year, and links to build a live literature index."})]}),v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Search and query across your notes"}),v.jsx("p",{className:"muted",children:"Ask questions across your entire archive to surface themes, patterns, and connections."})]}),v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Literature timeline with trend tracking"}),v.jsx("p",{className:"muted",children:"Ollama extracts key terms from your notes so you can visualise how topics and ideas evolve over time."})]}),v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Smart paper recommendations"}),v.jsx("p",{className:"muted",children:"Suggests the next paper to read by analysing citations from uploaded PDFs, your research scope, and what you've already covered."})]}),v.jsxs("article",{className:"feature-card",children:[v.jsx("h3",{children:"Local-first and private"}),v.jsx("p",{className:"muted",children:"Runs entirely on your machine using Ollama - no paid APIs, no data leaving your system."})]})]})]}),v.jsxs("section",{className:"landing-preview",id:"tool-preview",children:[v.jsxs("div",{className:"snapshots-header",children:[v.jsx("h2",{children:"Tool preview"}),v.jsx("p",{className:"muted",children:"Exact components, pre-filled with example entries."})]}),v.jsx("div",{className:"landing-tool-preview",children:v.jsxs("div",{className:"grid-layout",children:[v.jsxs("div",{className:"column left-column",children:[v.jsxs("section",{className:"card note-card preview-card",children:[v.jsx("h2",{children:"New Research Note"}),v.jsx("p",{className:"muted",children:"Paste your raw note, abstract, or citation. The AI will extract the core details and log it for you."}),v.jsxs("form",{className:"note-form",onSubmit:n=>n.preventDefault(),children:[v.jsx("textarea",{defaultValue:`Nguyen et al. (2021) show that mixed-modality prompts improved recall in screening tasks.
Key variables: dataset size, prompt length, reviewer fatigue. DOI: 10.1234/example`,rows:8,readOnly:!0}),v.jsx("div",{className:"note-actions",children:v.jsx("button",{type:"button",disabled:!0,children:"Extract & Save"})})]}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Free-form research notes so you can capture ideas first and structure them later."})})]}),v.jsxs("section",{className:"card note-card preview-card",children:[v.jsx("h2",{children:"Literature Query"}),v.jsx("p",{className:"muted",children:"Ask questions about your saved notes. Ollama will answer using only your local database."}),v.jsxs("form",{className:"note-form",onSubmit:n=>n.preventDefault(),children:[v.jsx("textarea",{defaultValue:"What themes repeat across the last three vision-language papers?",rows:5,readOnly:!0}),v.jsxs("div",{className:"note-actions",children:[v.jsx("button",{type:"button",disabled:!0,children:"Ask"}),v.jsx("button",{type:"button",className:"clear-button",disabled:!0,children:"Clear answer"})]})]}),v.jsx("div",{className:"answer-box",children:"Methods emphasize prompt tuning, multi-view retrieval, and reducing review fatigue via auto-tagging."}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Search and query across your notes to surface themes, patterns, and connections."})})]})]}),v.jsxs("div",{className:"column right-column",children:[v.jsxs("section",{className:"card note-card preview-card",children:[v.jsx("h2",{children:"Research Scope"}),v.jsx("p",{className:"muted",children:"Define the boundaries of your review so notes stay aligned with your research question."}),v.jsxs("div",{className:"scope-tags",children:[v.jsx("span",{className:"keyword-chip",children:"vision-language"}),v.jsx("span",{className:"keyword-chip",children:"screening UX"}),v.jsx("span",{className:"keyword-chip",children:"metadata triage"}),v.jsx("span",{className:"keyword-chip",children:"2021-2024"})]}),v.jsx("textarea",{defaultValue:"Focus on HCI + ML tools that reduce reviewer fatigue during systematic screening. Exclude clinical-only datasets.",rows:4,readOnly:!0}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Set the guardrails for your review so every note stays on scope."})})]}),v.jsxs("section",{className:"card notepad-card preview-card",children:[v.jsx("div",{className:"table-header",children:v.jsx("h2",{children:"Notepad"})}),v.jsx("textarea",{className:"notepad-textarea",defaultValue:`- Build the screening rubric
- Ask advisor about dataset access
- Compare citation counts`,rows:6,readOnly:!0}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Track quick tasks and follow-ups while you read."})})]}),v.jsxs("section",{className:"card table-card preview-card",children:[v.jsxs("div",{className:"table-header",children:[v.jsx("h2",{children:"Literature Index"}),v.jsx("div",{className:"table-actions",children:v.jsxs("div",{className:"count-group",children:[v.jsx("span",{className:"count",children:"3 papers"}),v.jsx("button",{type:"button",className:"add-button",disabled:!0,children:"+"})]})})]}),v.jsx("div",{className:"table-wrap",children:v.jsxs("table",{children:[v.jsx("thead",{children:v.jsxs("tr",{children:[v.jsx("th",{className:"checkbox-cell",children:v.jsx("input",{type:"checkbox",checked:!0,readOnly:!0})}),v.jsx("th",{children:"Code"}),v.jsx("th",{children:"Author"}),v.jsx("th",{children:"Title"}),v.jsx("th",{children:"Link"}),v.jsx("th",{children:"Published"}),v.jsx("th",{children:"Citations"})]})}),v.jsx("tbody",{children:[{id:1,code:"N21",author:"Nguyen",title:"Prompting for Recall",published:"2021",citations:184},{id:2,code:"K22",author:"Keller",title:"Screening Workflows",published:"2022",citations:92},{id:3,code:"M23",author:"Moss",title:"Metadata Triage",published:"2023",citations:41}].map(n=>v.jsxs("tr",{children:[v.jsx("td",{className:"checkbox-cell",children:v.jsx("input",{type:"checkbox",checked:!0,readOnly:!0})}),v.jsx("td",{className:"code-cell",children:n.code}),v.jsx("td",{children:n.author}),v.jsx("td",{children:n.title}),v.jsx("td",{children:v.jsx("span",{className:"ghost-link",children:"Open"})}),v.jsx("td",{children:n.published}),v.jsx("td",{children:n.citations})]},n.id))})]})}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Automatic metadata extraction builds a live literature index for fast reference."})})]})]}),v.jsxs("section",{className:"card timeline-card full-width preview-card",children:[v.jsx("h2",{children:"Literature Timeline"}),v.jsx("p",{className:"muted",children:"A quick, visual sweep of your notes by date."}),v.jsx("div",{className:"timeline-track",children:[{id:1,year:"2021",code:"N21",title:"Prompting for Recall",keywords:["prompting","screening"]},{id:2,year:"2022",code:"K22",title:"Screening Workflows",keywords:["workflow","triage"]},{id:3,year:"2023",code:"M23",title:"Metadata Triage",keywords:["metadata","tags"]}].map(n=>v.jsxs("div",{className:"timeline-item",children:[v.jsx("div",{className:"timeline-dot"}),v.jsxs("div",{className:"timeline-meta",children:[v.jsx("span",{className:"timeline-year",children:n.year}),v.jsx("span",{className:"timeline-code",children:n.code})]}),v.jsx("div",{className:"timeline-title",children:n.title}),v.jsx("div",{className:"timeline-keywords",children:n.keywords.map(e=>v.jsx("span",{className:"keyword-chip",children:e},e))})]},n.id))}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Literature timeline with trend tracking to see how topics evolve over time."})})]}),v.jsxs("section",{className:"card detail-card preview-card full-width",children:[v.jsxs("div",{className:"detail-header",children:[v.jsxs("div",{children:[v.jsx("p",{className:"app-kicker",children:"Paper Detail"}),v.jsx("h2",{children:"Computing Machinery and Intelligence"})]}),v.jsxs("div",{className:"detail-header-actions",children:[v.jsx("button",{type:"button",className:"edit-toggle",disabled:!0,children:"End edit"}),v.jsx("span",{className:"ghost-link",children:"Back to dashboard"})]})]}),v.jsxs("dl",{className:"detail-list",children:[v.jsxs("div",{children:[v.jsx("dt",{children:"Author"}),v.jsx("dd",{children:v.jsx("input",{className:"detail-input",value:"Alan M. Turing",readOnly:!0})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Published"}),v.jsx("dd",{children:v.jsx("input",{className:"detail-input",value:"1950",readOnly:!0})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Citations"}),v.jsx("dd",{children:v.jsx("input",{className:"detail-input",value:"12000",readOnly:!0})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Link"}),v.jsx("dd",{children:v.jsx("input",{className:"detail-input",value:"https://doi.org/10.1093/mind/LIX.236.433",readOnly:!0})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Title"}),v.jsx("dd",{children:v.jsx("input",{className:"detail-input",value:"Computing Machinery and Intelligence",readOnly:!0})})]})]}),v.jsxs("div",{className:"detail-actions",children:[v.jsx("button",{type:"button",disabled:!0,children:"Save changes"}),v.jsx("span",{className:"muted",children:"Saved."})]}),v.jsxs("div",{className:"pdf-block",children:[v.jsx("h3",{children:"Paper PDF"}),v.jsxs("div",{className:"pdf-actions",children:[v.jsx("input",{type:"file",accept:"application/pdf",disabled:!0}),v.jsx("span",{className:"ghost-link",children:"Open PDF"}),v.jsx("span",{className:"muted",children:"turing1950.pdf"}),v.jsx("button",{type:"button",className:"ghost-link",disabled:!0,children:"Remove"})]})]}),v.jsxs("div",{className:"notes-block",children:[v.jsx("h3",{children:"Original Note"}),v.jsx("textarea",{className:"detail-input detail-textarea",value:`proposes the imitation game as a test for machine intelligence
focuses on behavioral criteria over internal mechanism
addresses objections: theological, consciousness, mathematical limits
predicts machines could pass with 30% success by 2000`,rows:4,readOnly:!0}),v.jsx("div",{className:"references-block",children:v.jsx("button",{type:"button",className:"ghost-link",disabled:!0,children:"Display references"})})]}),v.jsx("div",{className:"preview-overlay",children:v.jsx("p",{children:"Edit individual papers to refine metadata, notes, and links as your review evolves."})})]})]})})]}),v.jsxs("section",{className:"landing-cta",children:[v.jsxs("div",{children:[v.jsx("h2",{children:"Ready to build your literature desk?"}),v.jsx("p",{className:"muted",children:"Start with a note, add a paper manually, or query your archive in minutes."})]}),v.jsx(po,{to:"/tool",className:"primary-cta",children:"Launch the tool"})]})]})}var ou={};ou.d=(n,e)=>{for(var t in e)ou.o(e,t)&&!ou.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};ou.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Q=globalThis.pdfjsLib={};ou.d(Q,{AbortException:()=>jr,AnnotationEditorLayer:()=>Fy,AnnotationEditorParamsType:()=>ce,AnnotationEditorType:()=>te,AnnotationEditorUIManager:()=>mo,AnnotationLayer:()=>nP,AnnotationMode:()=>Gs,ColorPicker:()=>Zf,DOMSVGFactory:()=>qv,DrawLayer:()=>zy,FeatureTest:()=>Wt,GlobalWorkerOptions:()=>ks,ImageKind:()=>Gd,InvalidPDFException:()=>Pm,MissingPDFException:()=>Tu,OPS:()=>ti,OutputScale:()=>Rm,PDFDataRangeTransport:()=>yb,PDFDateString:()=>Vv,PDFWorker:()=>nl,PasswordResponses:()=>hk,PermissionFlag:()=>uk,PixelsPerInch:()=>zr,RenderingCancelledException:()=>Uv,TextLayer:()=>Pu,TouchManager:()=>Qf,UnexpectedResponseException:()=>qf,Util:()=>G,VerbosityLevel:()=>Up,XfaLayer:()=>wb,build:()=>FT,createValidAbsoluteUrl:()=>gk,fetchData:()=>Gp,getDocument:()=>kT,getFilenameFromUrl:()=>_k,getPdfFilenameFromUrl:()=>Ek,getXfaPageViewport:()=>Ck,isDataScheme:()=>Xp,isPdfFile:()=>$v,noContextMenu:()=>Ai,normalizeUnicode:()=>Sk,setLayerDimensions:()=>go,shadow:()=>re,stopEvent:()=>En,version:()=>DT});const Dt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),mx=[1,0,0,1,0,0],Tm=[.001,0,0,.001,0,0],lk=1e7,Cg=1.35,xn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Gs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ck="pdfjs_internal_editor_",te={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ce={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},uk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ct={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Gd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Je={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Tc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Up={ERRORS:0,WARNINGS:1,INFOS:5},ti={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},hk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let $p=Up.WARNINGS;function dk(n){Number.isInteger(n)&&($p=n)}function fk(){return $p}function Vp(n){$p>=Up.INFOS&&console.log(`Info: ${n}`)}function ne(n){$p>=Up.WARNINGS&&console.log(`Warning: ${n}`)}function _e(n){throw new Error(n)}function Ye(n,e){n||_e(e)}function pk(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function gk(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Ak(n)}catch{}}const i=e?new URL(n,e):new URL(n);if(pk(i))return i}catch{}return null}function re(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Wr=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class bw extends Wr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class kg extends Wr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Pm extends Wr{constructor(e){super(e,"InvalidPDFException")}}class Tu extends Wr{constructor(e){super(e,"MissingPDFException")}}class qf extends Wr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class mk extends Wr{constructor(e){super(e,"FormatError")}}class jr extends Wr{constructor(e){super(e,"AbortException")}}function yx(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&_e("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Wp(n){typeof n!="string"&&_e("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function yk(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Bv(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function vk(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function wk(){try{return new Function(""),!0}catch{return!1}}class Wt{static get isLittleEndian(){return re(this,"isLittleEndian",vk())}static get isEvalSupported(){return re(this,"isEvalSupported",wk())}static get isOffscreenCanvasSupported(){return re(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return re(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?re(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):re(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return re(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Tg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Rs,Xd,Nm;class G{static makeHexColor(e,t,i){return`#${Tg[e]}${Tg[t]}${Tg[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,r]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],r[0],a[0]),Math.min(i[1],s[1],r[1],a[1]),Math.max(i[0],s[0],r[0],a[0]),Math.max(i[1],s[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(i+a)/2,c=Math.sqrt((i+a)**2-4*(i*a-r*s))/2,u=o+c||1,h=o-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static bezierBoundingBox(e,t,i,s,r,a,o,c,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,c)):u=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],x(this,Rs,Nm).call(this,e,i,r,o,t,s,a,c,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),u),x(this,Rs,Nm).call(this,e,i,r,o,t,s,a,c,3*(-t+3*(s-a)+c),6*(t-2*s+a),3*(s-t),u),u}}Rs=new WeakSet,Xd=function(e,t,i,s,r,a,o,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,p=f*u,m=d*(d*(d*e+3*u*t)+3*f*i)+p*s,A=d*(d*(d*r+3*u*a)+3*f*o)+p*c;h[0]=Math.min(h[0],m),h[1]=Math.min(h[1],A),h[2]=Math.max(h[2],m),h[3]=Math.max(h[3],A)},Nm=function(e,t,i,s,r,a,o,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&x(this,Rs,Xd).call(this,e,t,i,s,r,a,o,c,-d/h,f);return}const p=h**2-4*d*u;if(p<0)return;const m=Math.sqrt(p),A=2*u;x(this,Rs,Xd).call(this,e,t,i,s,r,a,o,c,(-h+m)/A,f),x(this,Rs,Xd).call(this,e,t,i,s,r,a,o,c,(-h-m)/A,f)},S(G,Rs);function Ak(n){return decodeURIComponent(escape(n))}let Pg=null,_w=null;function Sk(n){return Pg||(Pg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_w=new Map([["","t"]])),n.replaceAll(Pg,(e,t,i)=>t?t.normalize("NFKC"):_w.get(i))}function xk(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),yx(n)}const Hv="pdfjs_internal_id_";function bk(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(yx(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Yi="http://www.w3.org/2000/svg",Qr=class Qr{};Y(Qr,"CSS",96),Y(Qr,"PDF",72),Y(Qr,"PDF_TO_CSS_UNITS",Qr.CSS/Qr.PDF);let zr=Qr;async function Gp(n,e="text"){if(Fc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class ld{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,p;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,d=0,f=0,p=1;break;case 90:h=0,d=1,f=1,p=0;break;case 270:h=0,d=-1,f=-1,p=0;break;case 0:h=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let m,A,_,y;h===0?(m=Math.abs(u-e[1])*i+r,A=Math.abs(c-e[0])*i+a,_=(e[3]-e[1])*i,y=(e[2]-e[0])*i):(m=Math.abs(c-e[0])*i+r,A=Math.abs(u-e[1])*i+a,_=(e[2]-e[0])*i,y=(e[3]-e[1])*i),this.transform=[h*i,d*i,f*i,p*i,m-h*i*c-f*i*u,A-d*i*c-p*i*u],this.width=_,this.height=y}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(s=>s*e);return re(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new ld({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){return G.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=G.applyTransform([e[0],e[1]],this.transform),i=G.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return G.applyInverseTransform([e,t],this.transform)}}class Uv extends Wr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Xp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function $v(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function _k(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Ek(n,e="document.pdf"){if(typeof n!="string")return e;if(Xp(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Ew{constructor(){Y(this,"started",Object.create(null));Y(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Fc(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Ai(n){n.preventDefault()}function En(n){n.preventDefault(),n.stopPropagation()}var Ru;class Vv{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Ru)||g(this,Ru,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Ru).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,o+=d):u==="+"&&(a-=h,o-=d),new Date(Date.UTC(i,s,r,a,o,c))}}Ru=new WeakMap,S(Vv,Ru);function Ck(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new ld({viewBox:r,userUnit:1,scale:e,rotation:t})}function Wv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function kk(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,Wv(i))}e.remove()}function Le(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function _i(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function go(n,e,t=!1,i=!0){if(e instanceof ld){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=Wt.isCSSRoundSupported,c=`var(--scale-factor) * ${s}px`,u=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class Rm{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Xs,na,ni,ia,Lu,Mu,sp,vx,Gt,wx,Ax,qd,Sx,Mm;const Zi=class Zi{constructor(e){S(this,Gt);S(this,Xs,null);S(this,na,null);S(this,ni);S(this,ia,null);S(this,Lu,null);g(this,ni,e),l(Zi,Mu)||g(Zi,Mu,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=g(this,Xs,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,ni)._uiManager._signal;e.addEventListener("contextmenu",Ai,{signal:t}),e.addEventListener("pointerdown",x(Zi,sp,vx),{signal:t});const i=g(this,ia,document.createElement("div"));i.className="buttons",e.append(i);const s=l(this,ni).toolbarPosition;if(s){const{style:r}=e,a=l(this,ni)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return x(this,Gt,Sx).call(this),e}get div(){return l(this,Xs)}hide(){var e;l(this,Xs).classList.add("hidden"),(e=l(this,na))==null||e.hideDropdown()}show(){var e;l(this,Xs).classList.remove("hidden"),(e=l(this,Lu))==null||e.shown()}async addAltText(e){const t=await e.render();x(this,Gt,qd).call(this,t),l(this,ia).prepend(t,l(this,Gt,Mm)),g(this,Lu,e)}addColorPicker(e){g(this,na,e);const t=e.renderButton();x(this,Gt,qd).call(this,t),l(this,ia).prepend(t,l(this,Gt,Mm))}remove(){var e;l(this,Xs).remove(),(e=l(this,na))==null||e.destroy(),g(this,na,null)}};Xs=new WeakMap,na=new WeakMap,ni=new WeakMap,ia=new WeakMap,Lu=new WeakMap,Mu=new WeakMap,sp=new WeakSet,vx=function(e){e.stopPropagation()},Gt=new WeakSet,wx=function(e){l(this,ni)._focusEventsAllowed=!1,En(e)},Ax=function(e){l(this,ni)._focusEventsAllowed=!0,En(e)},qd=function(e){const t=l(this,ni)._uiManager._signal;e.addEventListener("focusin",x(this,Gt,wx).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",x(this,Gt,Ax).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ai,{signal:t})},Sx=function(){const{editorType:e,_uiManager:t}=l(this,ni),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",l(Zi,Mu)[e]),x(this,Gt,qd).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),l(this,ia).append(i)},Mm=function(){const e=document.createElement("div");return e.className="divider",e},S(Zi,sp),S(Zi,Mu,null);let Lm=Zi;var Iu,sa,ra,Br,xx,bx,_x;class Tk{constructor(e){S(this,Br);S(this,Iu,null);S(this,sa,null);S(this,ra);g(this,ra,e)}show(e,t,i){const[s,r]=x(this,Br,bx).call(this,t,i),{style:a}=l(this,sa)||g(this,sa,x(this,Br,xx).call(this));e.append(l(this,sa)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,sa).remove()}}Iu=new WeakMap,sa=new WeakMap,ra=new WeakMap,Br=new WeakSet,xx=function(){const e=g(this,sa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ai,{signal:l(this,ra)._signal});const t=g(this,Iu,document.createElement("div"));return t.className="buttons",e.append(t),x(this,Br,_x).call(this),e},bx=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},_x=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=l(this,ra)._signal;e.addEventListener("contextmenu",Ai,{signal:i}),e.addEventListener("click",()=>{l(this,ra).highlightSelection("floating_button")},{signal:i}),l(this,Iu).append(e)};function Yf(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var rp;class Pk{constructor(){S(this,rp,0)}get id(){return`${ck}${Ot(this,rp)._++}`}}rp=new WeakMap;var il,Du,Pt,sl,Yd;const Kv=class Kv{constructor(){S(this,sl);S(this,il,xk());S(this,Du,0);S(this,Pt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return re(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return x(this,sl,Yd).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return x(this,sl,Yd).call(this,e,e)}async getFromBlob(e,t){const i=await t;return x(this,sl,Yd).call(this,e,i)}async getFromId(e){l(this,Pt)||g(this,Pt,new Map);const t=l(this,Pt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Pt)||g(this,Pt,new Map);let i=l(this,Pt).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${l(this,il)}_${Ot(this,Du)._++}`,refCounter:1,isSvg:!1},l(this,Pt).set(e,i),l(this,Pt).set(i.id,i),i}getSvgUrl(e){const t=l(this,Pt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;l(this,Pt)||g(this,Pt,new Map);const t=l(this,Pt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,il)}_`)}};il=new WeakMap,Du=new WeakMap,Pt=new WeakMap,sl=new WeakSet,Yd=async function(e,t){l(this,Pt)||g(this,Pt,new Map);let i=l(this,Pt).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${l(this,il)}_${Ot(this,Du)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await Gp(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=Kv._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((u,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,u()},a.onload=async()=>{const d=i.svgUrl=a.result;o.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(s),await c}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){ne(s),i=null}return l(this,Pt).set(e,i),i&&l(this,Pt).set(i.id,i),i};let Im=Kv;var $e,qs,Fu,De;class Nk{constructor(e=128){S(this,$e,[]);S(this,qs,!1);S(this,Fu);S(this,De,-1);g(this,Fu,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),l(this,qs))return;const c={cmd:e,undo:t,post:i,type:r};if(l(this,De)===-1){l(this,$e).length>0&&(l(this,$e).length=0),g(this,De,0),l(this,$e).push(c);return}if(a&&l(this,$e)[l(this,De)].type===r){o&&(c.undo=l(this,$e)[l(this,De)].undo),l(this,$e)[l(this,De)]=c;return}const u=l(this,De)+1;u===l(this,Fu)?l(this,$e).splice(0,1):(g(this,De,u),u<l(this,$e).length&&l(this,$e).splice(u)),l(this,$e).push(c)}undo(){if(l(this,De)===-1)return;g(this,qs,!0);const{undo:e,post:t}=l(this,$e)[l(this,De)];e(),t==null||t(),g(this,qs,!1),g(this,De,l(this,De)-1)}redo(){if(l(this,De)<l(this,$e).length-1){g(this,De,l(this,De)+1),g(this,qs,!0);const{cmd:e,post:t}=l(this,$e)[l(this,De)];e(),t==null||t(),g(this,qs,!1)}}hasSomethingToUndo(){return l(this,De)!==-1}hasSomethingToRedo(){return l(this,De)<l(this,$e).length-1}cleanType(e){if(l(this,De)!==-1){for(let t=l(this,De);t>=0;t--)if(l(this,$e)[t].type!==e){l(this,$e).splice(t+1,l(this,De)-t),g(this,De,t);return}l(this,$e).length=0,g(this,De,-1)}}destroy(){g(this,$e,null)}}$e=new WeakMap,qs=new WeakMap,Fu=new WeakMap,De=new WeakMap;var ap,Ex;class cd{constructor(e){S(this,ap);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Wt.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(x(this,ap,Ex).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||En(t))}}ap=new WeakSet,Ex=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const op=class op{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return kk(e),re(this,"_colors",e)}convert(e){const t=Wv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return op._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?G.makeHexColor(...t):e}};Y(op,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Dm=op;var rl,un,et,gt,al,ns,ol,In,Ys,aa,ll,oa,Ti,ii,la,Ou,ju,cl,zu,Pi,Ks,ul,Qs,Ni,lp,Js,Bu,Zs,ca,Hu,Uu,rt,ye,is,ua,$u,Vu,er,Ri,ss,Wu,Dn,F,Kd,Fm,Cx,kx,Qd,Tx,Px,Nx,Om,Rx,jm,zm,Lx,jt,Ki,Mx,Ix,Bm,Dx,Oc,Hm;const Xo=class Xo{constructor(e,t,i,s,r,a,o,c,u,h,d,f,p){S(this,F);S(this,rl,new AbortController);S(this,un,null);S(this,et,new Map);S(this,gt,new Map);S(this,al,null);S(this,ns,null);S(this,ol,null);S(this,In,new Nk);S(this,Ys,null);S(this,aa,null);S(this,ll,0);S(this,oa,new Set);S(this,Ti,null);S(this,ii,null);S(this,la,new Set);Y(this,"_editorUndoBar",null);S(this,Ou,!1);S(this,ju,!1);S(this,cl,!1);S(this,zu,null);S(this,Pi,null);S(this,Ks,null);S(this,ul,null);S(this,Qs,!1);S(this,Ni,null);S(this,lp,new Pk);S(this,Js,!1);S(this,Bu,!1);S(this,Zs,null);S(this,ca,null);S(this,Hu,null);S(this,Uu,null);S(this,rt,te.NONE);S(this,ye,new Set);S(this,is,null);S(this,ua,null);S(this,$u,null);S(this,Vu,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});S(this,er,[0,0]);S(this,Ri,null);S(this,ss,null);S(this,Wu,null);S(this,Dn,null);const m=this._signal=l(this,rl).signal;g(this,ss,e),g(this,Wu,t),g(this,al,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:m}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),s._on("setpreference",this.onSetPreference.bind(this),{signal:m}),s._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:m}),x(this,F,Tx).call(this),x(this,F,Lx).call(this),x(this,F,Om).call(this),g(this,ns,r.annotationStorage),g(this,zu,r.filterFactory),g(this,ua,a),g(this,ul,o||null),g(this,Ou,c),g(this,ju,u),g(this,cl,h),g(this,Uu,d||null),this.viewParameters={realScale:zr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const e=Xo.prototype,t=a=>l(a,ss).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return re(this,"_keyboardManager",new cd([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ss).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,ss).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r;(e=l(this,Dn))==null||e.resolve(),g(this,Dn,null),(t=l(this,rl))==null||t.abort(),g(this,rl,null),this._signal=null;for(const a of l(this,gt).values())a.destroy();l(this,gt).clear(),l(this,et).clear(),l(this,la).clear(),g(this,un,null),l(this,ye).clear(),l(this,In).destroy(),(i=l(this,al))==null||i.destroy(),(s=l(this,Ni))==null||s.hide(),g(this,Ni,null),l(this,Pi)&&(clearTimeout(l(this,Pi)),g(this,Pi,null)),l(this,Ri)&&(clearTimeout(l(this,Ri)),g(this,Ri,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,Uu)}get useNewAltTextFlow(){return l(this,ju)}get useNewAltTextWhenAddingImage(){return l(this,cl)}get hcmFilter(){return re(this,"hcmFilter",l(this,ua)?l(this,zu).addHCMFilter(l(this,ua).foreground,l(this,ua).background):"none")}get direction(){return re(this,"direction",getComputedStyle(l(this,ss)).direction)}get highlightColors(){return re(this,"highlightColors",l(this,ul)?new Map(l(this,ul).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return re(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,aa,e)}setMainHighlightColorPicker(e){g(this,Hu,e)}editAltText(e,t=!1){var i;(i=l(this,al))==null||i.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":g(this,cl,t);break}}onPageChanging({pageNumber:e}){g(this,ll,e-1)}focusMainContainer(){l(this,ss).focus()}findParent(e,t){for(const i of l(this,gt).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){l(this,Wu).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,la).add(e)}removeShouldRescale(e){l(this,la).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*zr.PDF_TO_CSS_UNITS;for(const i of l(this,la))i.onScaleChanging();(t=l(this,aa))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a}=t,o=t.toString(),u=x(this,F,Kd).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const d=x(this,F,Fm).call(this,u),f=l(this,rt)===te.NONE,p=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:a,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(te.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,ns)&&!l(this,ns).has(e.id)&&l(this,ns).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,Qs)&&(g(this,Qs,!1),x(this,F,Qd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,ye))if(t.div.contains(e)){g(this,ca,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,ca))return;const[e,t]=l(this,ca);g(this,ca,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){x(this,F,Om).call(this),x(this,F,jm).call(this)}removeEditListeners(){x(this,F,Rx).call(this),x(this,F,zm).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of l(this,ii))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of l(this,ii))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=l(this,un))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of l(this,ye)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,ii))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const c of i){const u=await s.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)x(this,F,Bm).call(this,c);x(this,F,Hm).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,rt)!==te.NONE&&!this.isEditorHandlingKeyboard&&Xo._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Qs)&&(g(this,Qs,!1),x(this,F,Qd).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(x(this,F,Px).call(this),x(this,F,jm).call(this),x(this,F,jt).call(this,{isEditing:l(this,rt)!==te.NONE,isEmpty:x(this,F,Oc).call(this),hasSomethingToUndo:l(this,In).hasSomethingToUndo(),hasSomethingToRedo:l(this,In).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,F,Nx).call(this),x(this,F,zm).call(this),x(this,F,jt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,ii)){g(this,ii,e);for(const t of l(this,ii))x(this,F,Ki).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,lp).id}get currentLayer(){return l(this,gt).get(l(this,ll))}getLayer(e){return l(this,gt).get(e)}get currentPageIndex(){return l(this,ll)}addLayer(e){l(this,gt).set(e.pageIndex,e),l(this,Js)?e.enable():e.disable()}removeLayer(e){l(this,gt).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){var s;if(l(this,rt)!==e&&!(l(this,Dn)&&(await l(this,Dn).promise,!l(this,Dn)))){if(g(this,Dn,Promise.withResolvers()),g(this,rt,e),e===te.NONE){this.setEditingState(!1),x(this,F,Ix).call(this),(s=this._editorUndoBar)==null||s.hide(),l(this,Dn).resolve();return}this.setEditingState(!0),await x(this,F,Mx).call(this),this.unselectAll();for(const r of l(this,gt).values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),l(this,Dn).resolve();return}for(const r of l(this,et).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,Dn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,rt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var i;if(l(this,ii)){switch(e){case ce.CREATE:this.currentLayer.addNewEditor();return;case ce.HIGHLIGHT_DEFAULT_COLOR:(i=l(this,Hu))==null||i.updateColor(t);break;case ce.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,$u)||g(this,$u,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of l(this,ye))s.updateParams(e,t);for(const s of l(this,ii))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of l(this,et).values())a.editorType===e&&a.show(t);(((r=l(this,$u))==null?void 0:r.get(ce.HIGHLIGHT_SHOW_ALL))??!0)!==t&&x(this,F,Ki).call(this,[[ce.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,Bu)!==e){g(this,Bu,e);for(const t of l(this,gt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of l(this,et).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return l(this,et).get(e)}addEditor(e){l(this,et).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,Pi)&&clearTimeout(l(this,Pi)),g(this,Pi,setTimeout(()=>{this.focusMainContainer(),g(this,Pi,null)},0))),l(this,et).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,oa).has(e.annotationElementId))&&((t=l(this,ns))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,oa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,oa).has(e)}removeDeletedAnnotationElement(e){l(this,oa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,un)!==e&&(g(this,un,e),e&&x(this,F,Ki).call(this,e.propertiesToUpdate))}updateUI(e){l(this,F,Dx)===e&&x(this,F,Ki).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){x(this,F,Ki).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,ye).has(e)){l(this,ye).delete(e),e.unselect(),x(this,F,jt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,ye).add(e),e.select(),x(this,F,Ki).call(this,e.propertiesToUpdate),x(this,F,jt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,aa))==null||t.commitOrRemove();for(const i of l(this,ye))i!==e&&i.unselect();l(this,ye).clear(),l(this,ye).add(e),e.select(),x(this,F,Ki).call(this,e.propertiesToUpdate),x(this,F,jt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,ye).has(e)}get firstSelectedEditor(){return l(this,ye).values().next().value}unselect(e){e.unselect(),l(this,ye).delete(e),x(this,F,jt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,ye).size!==0}get isEnterHandled(){return l(this,ye).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,In).undo(),x(this,F,jt).call(this,{hasSomethingToUndo:l(this,In).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,F,Oc).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,In).redo(),x(this,F,jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,In).hasSomethingToRedo(),isEmpty:x(this,F,Oc).call(this)})}addCommands(e){l(this,In).add(e),x(this,F,jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,F,Oc).call(this)})}cleanUndoStack(e){l(this,In).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,ye)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)x(this,F,Bm).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=l(this,un))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,un)||this.hasSelection}selectAll(){for(const e of l(this,ye))e.commit();x(this,F,Hm).call(this,l(this,et).values())}unselectAll(){var e;if(!(l(this,un)&&(l(this,un).commitOrRemove(),l(this,rt)!==te.NONE))&&!((e=l(this,aa))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,ye))t.unselect();l(this,ye).clear(),x(this,F,jt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;l(this,er)[0]+=e,l(this,er)[1]+=t;const[s,r]=l(this,er),a=[...l(this,ye)],o=1e3;l(this,Ri)&&clearTimeout(l(this,Ri)),g(this,Ri,setTimeout(()=>{g(this,Ri,null),l(this,er)[0]=l(this,er)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,et).has(c.id)&&c.translateInPage(s,r)},undo:()=>{for(const c of a)l(this,et).has(c.id)&&c.translateInPage(-s,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,Ti,new Map);for(const e of l(this,ye))l(this,Ti).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Ti))return!1;this.disableUserSelect(!1);const e=l(this,Ti);g(this,Ti,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(l(this,et).has(s.id)){const c=l(this,gt).get(o);c?s._setParentAndPosition(c,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Ti))for(const i of l(this,Ti).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,ye).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,un)===e}getActive(){return l(this,un)}getMode(){return l(this,rt)}get imageManager(){return re(this,"imageManager",new Im)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,d,f)=>({x:(h-s)/a,y:1-(u+d-i)/r,width:f/a,height:d/r});break;case"180":o=(u,h,d,f)=>({x:1-(u+d-i)/r,y:1-(h+f-s)/a,width:d/r,height:f/a});break;case"270":o=(u,h,d,f)=>({x:1-(h+f-s)/a,y:(u-i)/r,width:f/a,height:d/r});break;default:o=(u,h,d,f)=>({x:(u-i)/r,y:(h-s)/a,width:d/r,height:f/a});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:p,width:m,height:A}of d.getClientRects())m===0||A===0||c.push(o(f,p,m,A))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,ol)||g(this,ol,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,ol))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=l(this,ol))==null?void 0:s.get(e.data.id);if(!t)return;const i=l(this,ns).getRawValue(t);i&&(l(this,rt)===te.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}};rl=new WeakMap,un=new WeakMap,et=new WeakMap,gt=new WeakMap,al=new WeakMap,ns=new WeakMap,ol=new WeakMap,In=new WeakMap,Ys=new WeakMap,aa=new WeakMap,ll=new WeakMap,oa=new WeakMap,Ti=new WeakMap,ii=new WeakMap,la=new WeakMap,Ou=new WeakMap,ju=new WeakMap,cl=new WeakMap,zu=new WeakMap,Pi=new WeakMap,Ks=new WeakMap,ul=new WeakMap,Qs=new WeakMap,Ni=new WeakMap,lp=new WeakMap,Js=new WeakMap,Bu=new WeakMap,Zs=new WeakMap,ca=new WeakMap,Hu=new WeakMap,Uu=new WeakMap,rt=new WeakMap,ye=new WeakMap,is=new WeakMap,ua=new WeakMap,$u=new WeakMap,Vu=new WeakMap,er=new WeakMap,Ri=new WeakMap,ss=new WeakMap,Wu=new WeakMap,Dn=new WeakMap,F=new WeakSet,Kd=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Fm=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of l(this,gt).values())if(i.hasTextLayer(e))return i;return null},Cx=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=x(this,F,Kd).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(l(this,Ni)||g(this,Ni,new Tk(this)),l(this,Ni).show(i,s,this.direction==="ltr"))},kx=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,is)&&((r=l(this,Ni))==null||r.hide(),g(this,is,null),x(this,F,jt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,is))return;const s=x(this,F,Kd).call(this,e).closest(".textLayer");if(!s){l(this,is)&&((a=l(this,Ni))==null||a.hide(),g(this,is,null),x(this,F,jt).call(this,{hasSelectedText:!1}));return}if((o=l(this,Ni))==null||o.hide(),g(this,is,t),x(this,F,jt).call(this,{hasSelectedText:!0}),!(l(this,rt)!==te.HIGHLIGHT&&l(this,rt)!==te.NONE)&&(l(this,rt)===te.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,Qs,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,rt)===te.HIGHLIGHT?x(this,F,Fm).call(this,s):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&x(this,F,Qd).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},Qd=function(e=""){l(this,rt)===te.HIGHLIGHT?this.highlightSelection(e):l(this,Ou)&&x(this,F,Cx).call(this)},Tx=function(){document.addEventListener("selectionchange",x(this,F,kx).bind(this),{signal:this._signal})},Px=function(){if(l(this,Ks))return;g(this,Ks,new AbortController);const e=this.combinedSignal(l(this,Ks));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Nx=function(){var e;(e=l(this,Ks))==null||e.abort(),g(this,Ks,null)},Om=function(){if(l(this,Zs))return;g(this,Zs,new AbortController);const e=this.combinedSignal(l(this,Zs));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Rx=function(){var e;(e=l(this,Zs))==null||e.abort(),g(this,Zs,null)},jm=function(){if(l(this,Ys))return;g(this,Ys,new AbortController);const e=this.combinedSignal(l(this,Ys));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},zm=function(){var e;(e=l(this,Ys))==null||e.abort(),g(this,Ys,null)},Lx=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},jt=function(e){Object.entries(e).some(([i,s])=>l(this,Vu)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,Vu),e)}),l(this,rt)===te.HIGHLIGHT&&e.hasSelectedEditor===!1&&x(this,F,Ki).call(this,[[ce.HIGHLIGHT_FREE,!0]]))},Ki=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Mx=async function(){if(!l(this,Js)){g(this,Js,!0);const e=[];for(const t of l(this,gt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,et).values())t.enable()}},Ix=function(){if(this.unselectAll(),l(this,Js)){g(this,Js,!1);for(const e of l(this,gt).values())e.disable();for(const e of l(this,et).values())e.disable()}},Bm=function(e){const t=l(this,gt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Dx=function(){let e=null;for(e of l(this,ye));return e},Oc=function(){if(l(this,et).size===0)return!0;if(l(this,et).size===1)for(const e of l(this,et).values())return e.isEmpty();return!1},Hm=function(e){for(const t of l(this,ye))t.unselect();l(this,ye).clear();for(const t of e)t.isEmpty()||(l(this,ye).add(t),t.select());x(this,F,jt).call(this,{hasSelectedEditor:this.hasSelection})},Y(Xo,"TRANSLATE_SMALL",1),Y(Xo,"TRANSLATE_BIG",10);let mo=Xo;var at,Li,si,hl,Mi,hn,dl,Ii,Zt,rs,ha,Di,tr,mi,jc,Jd;const zt=class zt{constructor(e){S(this,mi);S(this,at,null);S(this,Li,!1);S(this,si,null);S(this,hl,null);S(this,Mi,null);S(this,hn,null);S(this,dl,!1);S(this,Ii,null);S(this,Zt,null);S(this,rs,null);S(this,ha,null);S(this,Di,!1);g(this,Zt,e),g(this,Di,e._uiManager.useNewAltTextFlow),l(zt,tr)||g(zt,tr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){zt._l10n??(zt._l10n=e)}async render(){const e=g(this,si,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=g(this,hl,document.createElement("span"));e.append(t),l(this,Di)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(zt,tr).missing),t.setAttribute("data-l10n-id",l(zt,tr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=l(this,Zt)._uiManager._signal;e.addEventListener("contextmenu",Ai,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),l(this,Zt)._uiManager.editAltText(l(this,Zt)),l(this,Di)&&l(this,Zt)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,mi,jc)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(g(this,dl,!0),s(r))},{signal:i}),await x(this,mi,Jd).call(this),e}finish(){l(this,si)&&(l(this,si).focus({focusVisible:l(this,dl)}),g(this,dl,!1))}isEmpty(){return l(this,Di)?l(this,at)===null:!l(this,at)&&!l(this,Li)}hasData(){return l(this,Di)?l(this,at)!==null||!!l(this,rs):this.isEmpty()}get guessedText(){return l(this,rs)}async setGuessedText(e){l(this,at)===null&&(g(this,rs,e),g(this,ha,await zt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),x(this,mi,Jd).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,Di)||l(this,at)){(t=l(this,Ii))==null||t.remove(),g(this,Ii,null);return}if(!l(this,Ii)){const i=g(this,Ii,document.createElement("div"));i.className="noAltTextBadge",l(this,Zt).div.append(i)}l(this,Ii).classList.toggle("hidden",!e)}serialize(e){let t=l(this,at);return!e&&l(this,rs)===t&&(t=l(this,ha)),{altText:t,decorative:l(this,Li),guessedText:l(this,rs),textWithDisclaimer:l(this,ha)}}get data(){return{altText:l(this,at),decorative:l(this,Li)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(g(this,rs,i),g(this,ha,s)),!(l(this,at)===e&&l(this,Li)===t)&&(r||(g(this,at,e),g(this,Li,t)),x(this,mi,Jd).call(this))}toggle(e=!1){l(this,si)&&(!e&&l(this,hn)&&(clearTimeout(l(this,hn)),g(this,hn,null)),l(this,si).disabled=!e)}shown(){l(this,Zt)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,mi,jc)}})}destroy(){var e,t;(e=l(this,si))==null||e.remove(),g(this,si,null),g(this,hl,null),g(this,Mi,null),(t=l(this,Ii))==null||t.remove(),g(this,Ii,null)}};at=new WeakMap,Li=new WeakMap,si=new WeakMap,hl=new WeakMap,Mi=new WeakMap,hn=new WeakMap,dl=new WeakMap,Ii=new WeakMap,Zt=new WeakMap,rs=new WeakMap,ha=new WeakMap,Di=new WeakMap,tr=new WeakMap,mi=new WeakSet,jc=function(){return l(this,at)&&"added"||l(this,at)===null&&this.guessedText&&"review"||"missing"},Jd=async function(){var s,r,a;const e=l(this,si);if(!e)return;if(l(this,Di)){if(e.classList.toggle("done",!!l(this,at)),e.setAttribute("data-l10n-id",l(zt,tr)[l(this,mi,jc)]),(s=l(this,hl))==null||s.setAttribute("data-l10n-id",l(zt,tr)[`${l(this,mi,jc)}-label`]),!l(this,at)){(r=l(this,Mi))==null||r.remove();return}}else{if(!l(this,at)&&!l(this,Li)){e.classList.remove("done"),(a=l(this,Mi))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,Mi);if(!t){g(this,Mi,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,Zt).id}`;const o=100,c=l(this,Zt)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,hn)),g(this,hn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{g(this,hn,setTimeout(()=>{g(this,hn,null),l(this,Mi).classList.add("show"),l(this,Zt)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,hn)&&(clearTimeout(l(this,hn)),g(this,hn,null)),(u=l(this,Mi))==null||u.classList.remove("show")},{signal:c})}l(this,Li)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,at)),t.parentNode||e.append(t);const i=l(this,Zt).getImageForAltText();i==null||i.setAttribute("aria-describedby",t.id)},S(zt,tr,null),Y(zt,"_l10n",null);let Kf=zt;var Gu,da,Xu,qu,Yu,Ku,Qu,fl,as,fa,nr,Os,Fx,Ox,Um;const Qv=class Qv{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){S(this,Os);S(this,Gu);S(this,da,!1);S(this,Xu,null);S(this,qu);S(this,Yu);S(this,Ku);S(this,Qu);S(this,fl);S(this,as,null);S(this,fa);S(this,nr,null);g(this,Gu,e),g(this,Xu,i),g(this,qu,t),g(this,Yu,s),g(this,Ku,r),g(this,Qu,a),g(this,fa,new AbortController),g(this,fl,AbortSignal.any([o,l(this,fa).signal])),e.addEventListener("touchstart",x(this,Os,Fx).bind(this),{passive:!1,signal:l(this,fl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return re(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,fa))==null||e.abort(),g(this,fa,null)}};Gu=new WeakMap,da=new WeakMap,Xu=new WeakMap,qu=new WeakMap,Yu=new WeakMap,Ku=new WeakMap,Qu=new WeakMap,fl=new WeakMap,as=new WeakMap,fa=new WeakMap,nr=new WeakMap,Os=new WeakSet,Fx=function(e){var s,r,a;if((s=l(this,qu))!=null&&s.call(this)||e.touches.length<2)return;if(!l(this,nr)){g(this,nr,new AbortController);const o=AbortSignal.any([l(this,fl),l(this,nr).signal]),c=l(this,Gu),u={signal:o,passive:!1};c.addEventListener("touchmove",x(this,Os,Ox).bind(this),u),c.addEventListener("touchend",x(this,Os,Um).bind(this),u),c.addEventListener("touchcancel",x(this,Os,Um).bind(this),u),(r=l(this,Yu))==null||r.call(this)}if(En(e),e.touches.length!==2||(a=l(this,Xu))!=null&&a.call(this)){g(this,as,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),g(this,as,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},Ox=function(e){var E;if(!l(this,as)||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,c=l(this,as),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,p=d-u,m=f-h,A=a-s,_=o-r,y=Math.hypot(A,_)||1,w=Math.hypot(p,m)||1;if(!l(this,da)&&Math.abs(w-y)<=Qv.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=s,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,da)){g(this,da,!0);return}const b=[(s+a)/2,(r+o)/2];(E=l(this,Ku))==null||E.call(this,b,w,y)},Um=function(e){var t;l(this,nr).abort(),g(this,nr,null),(t=l(this,Qu))==null||t.call(this),l(this,as)&&(e.preventDefault(),g(this,as,null),g(this,da,!1))};let Qf=Qv;var pa,ri,Pe,pl,ir,Ju,ga,mt,ma,os,sr,Zu,ya,dn,eh,va,ls,Fi,gl,ml,Fn,wa,th,cp,K,$m,nh,Vm,Zd,jx,zx,Wm,ef,Gm,Bx,Hx,Ux,Xm,$x,qm,Vx,Wx,Gx,Ym,zc;const ie=class ie{constructor(e){S(this,K);S(this,pa,null);S(this,ri,null);S(this,Pe,null);S(this,pl,!1);S(this,ir,null);S(this,Ju,"");S(this,ga,!1);S(this,mt,null);S(this,ma,null);S(this,os,null);S(this,sr,null);S(this,Zu,"");S(this,ya,!1);S(this,dn,null);S(this,eh,!1);S(this,va,!1);S(this,ls,!1);S(this,Fi,null);S(this,gl,0);S(this,ml,0);S(this,Fn,null);S(this,wa,null);Y(this,"_editToolbar",null);Y(this,"_initialOptions",Object.create(null));Y(this,"_initialData",null);Y(this,"_isVisible",!0);Y(this,"_uiManager",null);Y(this,"_focusEventsAllowed",!0);S(this,th,!1);S(this,cp,ie._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ie.prototype._resizeWithKeyboard,t=mo.TRANSLATE_SMALL,i=mo.TRANSLATE_BIG;return re(this,"_resizerKeyboardManager",new cd([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return re(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Rk({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ie._l10n??(ie._l10n=e),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){_e("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,th)}set _isDraggable(e){var t;g(this,th,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,cp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):x(this,K,zc).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,ya)?g(this,ya,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}translate(e,t){x(this,K,$m).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,dn)||g(this,dn,[this.x,this.y,this.width,this.height]),x(this,K,$m).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,dn)||g(this,dn,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,u]=this.getBaseTranslation();a+=c,o+=u;const{style:h}=i;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,dn)&&(l(this,dn)[0]!==this.x||l(this,dn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,dn)&&(l(this,dn)[2]!==this.width||l(this,dn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=ie,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=i,c*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(i-o,r)),a=Math.max(0,Math.min(s-c,a));break;case 90:r=Math.max(0,Math.min(i-c,r)),a=Math.min(s,Math.max(o,a));break;case 180:r=Math.min(i,Math.max(o,r)),a=Math.min(s,Math.max(c,a));break;case 270:r=Math.min(i,Math.max(c,r)),a=Math.max(0,Math.min(s-o,a));break}this.x=r/=i,this.y=a/=s;const[u,h]=this.getBaseTranslation();r+=u,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return x(i=ie,nh,Vm).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return x(i=ie,nh,Vm).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,l(this,ga)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!l(this,ga)&&t.endsWith("%");if(s&&r)return;const[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!l(this,ga)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Pe))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,va)?this._editToolbar:(this._editToolbar=new Lm(this),this.div.append(this._editToolbar.render()),l(this,Pe)&&await this._editToolbar.addAltText(l(this,Pe)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Pe))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Pe)||(Kf.initialize(ie._l10n),g(this,Pe,new Kf(this)),l(this,pa)&&(l(this,Pe).data=l(this,pa),g(this,pa,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Pe))==null?void 0:e.data}set altTextData(e){l(this,Pe)&&(l(this,Pe).data=e)}get guessedAltText(){var e;return(e=l(this,Pe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Pe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Pe))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Pe)&&!l(this,Pe).isEmpty()}hasAltTextData(){var e;return((e=l(this,Pe))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,pl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),x(this,K,qm).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Yf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,wa)||g(this,wa,new Qf({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:x(this,K,Bx).bind(this),onPinching:x(this,K,Hx).bind(this),onPinchEnd:x(this,K,Ux).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Wt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(g(this,ya,!0),this._isDraggable){x(this,K,$x).call(this,e);return}x(this,K,Xm).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,Fi)&&clearTimeout(l(this,Fi)),g(this,Fi,setTimeout(()=>{var e;g(this,Fi,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,u=e/s,h=t/s,d=this.x*r,f=this.y*a,p=this.width*r,m=this.height*a;switch(i){case 0:return[d+u+o,a-f-h-m+c,d+u+p+o,a-f-h+c];case 90:return[d+h+o,a-f+u+c,d+h+m+o,a-f+u+p+c];case 180:return[d-u-p+o,a-f+h+c,d-u+o,a-f+h+m+c];case 270:return[d-h-m+o,a-f-u-p+c,d-h+o,a-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,c=a-s;switch(this.rotation){case 0:return[i,t-a,o,c];case 90:return[i,t-s,c,o];case 180:return[r,t-s,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){g(this,va,!0)}disableEditMode(){g(this,va,!1)}isInEditMode(){return l(this,va)}shouldGetKeyboardEvents(){return l(this,ls)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){x(this,K,qm).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){_e("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,g(s,pa,e.accessibilityData);const[r,a]=s.pageDimensions,[o,c,u,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=c/a,s.width=u/r,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,sr))==null||e.abort(),g(this,sr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,Fi)&&(clearTimeout(l(this,Fi)),g(this,Fi,null)),x(this,K,zc).call(this),this.removeEditToolbar(),l(this,Fn)){for(const i of l(this,Fn).values())clearTimeout(i);g(this,Fn,null)}this.parent=null,(t=l(this,wa))==null||t.destroy(),g(this,wa,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,K,jx).call(this),l(this,mt).classList.remove("hidden"),Yf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),g(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,mt).children;if(!l(this,ri)){g(this,ri,Array.from(t));const a=x(this,K,Vx).bind(this),o=x(this,K,Wx).bind(this),c=this._uiManager._signal;for(const u of l(this,ri)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",x(this,K,Gx).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[h])}}const i=l(this,ri)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,ri).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)l(this,mt).append(l(this,mt).firstChild);else if(r>s)for(let o=0;o<r-s;o++)l(this,mt).firstChild.before(l(this,mt).lastChild);let a=0;for(const o of t){const u=l(this,ri)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",ie._l10nResizer[u])}}x(this,K,Ym).call(this,0),g(this,ls,!0),l(this,mt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,ls)&&x(this,K,Gm).call(this,l(this,Zu),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){x(this,K,zc).call(this),this.div.focus()}select(){var e,t,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=l(this,Pe))==null||i.toggleAltTextBadge(!1)}unselect(){var e,t,i,s,r;(e=l(this,mt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=l(this,Pe))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,eh)}set isEditing(e){g(this,eh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){g(this,ga,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,Fn)||g(this,Fn,new Map);const{action:i}=e;let s=l(this,Fn).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),l(this,Fn).delete(i),l(this,Fn).size===0&&g(this,Fn,null)},ie._telemetryTimeout),l(this,Fn).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),g(this,pl,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,pl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};pa=new WeakMap,ri=new WeakMap,Pe=new WeakMap,pl=new WeakMap,ir=new WeakMap,Ju=new WeakMap,ga=new WeakMap,mt=new WeakMap,ma=new WeakMap,os=new WeakMap,sr=new WeakMap,Zu=new WeakMap,ya=new WeakMap,dn=new WeakMap,eh=new WeakMap,va=new WeakMap,ls=new WeakMap,Fi=new WeakMap,gl=new WeakMap,ml=new WeakMap,Fn=new WeakMap,wa=new WeakMap,th=new WeakMap,cp=new WeakMap,K=new WeakSet,$m=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},nh=new WeakSet,Vm=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Zd=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},jx=function(){if(l(this,mt))return;g(this,mt,document.createElement("div")),l(this,mt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");l(this,mt).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",x(this,K,zx).bind(this,i),{signal:t}),s.addEventListener("contextmenu",Ai,{signal:t}),s.tabIndex=-1}this.div.prepend(l(this,mt))},zx=function(e,t){var h;t.preventDefault();const{isMac:i}=Wt.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=l(this,Pe))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,g(this,ma,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,K,Gm).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",En,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ai,{signal:a}),g(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=l(this,Pe))==null||d.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=c,x(this,K,ef).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},Wm=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*i,a*s),this.fixAndSetPosition(),this._onResized()},ef=function(){if(!l(this,os))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=l(this,os);g(this,os,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===i&&c===s||this.addCommands({cmd:x(this,K,Wm).bind(this,r,a,o,c),undo:x(this,K,Wm).bind(this,e,t,i,s),mustExec:!0})},Gm=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,u=ie.MIN_SIZE/i,h=ie.MIN_SIZE/s,d=x(this,K,Zd).call(this,this.rotation),f=(j,W)=>[d[0]*j+d[2]*W,d[1]*j+d[3]*W],p=x(this,K,Zd).call(this,360-this.rotation),m=(j,W)=>[p[0]*j+p[2]*W,p[1]*j+p[3]*W];let A,_,y=!1,w=!1;switch(e){case"topLeft":y=!0,A=(j,W)=>[0,0],_=(j,W)=>[j,W];break;case"topMiddle":A=(j,W)=>[j/2,0],_=(j,W)=>[j/2,W];break;case"topRight":y=!0,A=(j,W)=>[j,0],_=(j,W)=>[0,W];break;case"middleRight":w=!0,A=(j,W)=>[j,W/2],_=(j,W)=>[0,W/2];break;case"bottomRight":y=!0,A=(j,W)=>[j,W],_=(j,W)=>[0,0];break;case"bottomMiddle":A=(j,W)=>[j/2,W],_=(j,W)=>[j/2,0];break;case"bottomLeft":y=!0,A=(j,W)=>[0,W],_=(j,W)=>[j,0];break;case"middleLeft":w=!0,A=(j,W)=>[0,W/2],_=(j,W)=>[j,W/2];break}const b=A(o,c),E=_(o,c);let C=f(...E);const T=ie._round(r+C[0]),k=ie._round(a+C[1]);let P=1,D=1,M,$;if(t.fromKeyboard)({deltaX:M,deltaY:$}=t);else{const{screenX:j,screenY:W}=t,[I,X]=l(this,ma);[M,$]=this.screenToPageTranslation(j-I,W-X),l(this,ma)[0]=j,l(this,ma)[1]=W}if([M,$]=m(M/i,$/s),y){const j=Math.hypot(o,c);P=D=Math.max(Math.min(Math.hypot(E[0]-b[0]-M,E[1]-b[1]-$)/j,1/o,1/c),u/o,h/c)}else w?P=Math.max(u,Math.min(1,Math.abs(E[0]-b[0]-M)))/o:D=Math.max(h,Math.min(1,Math.abs(E[1]-b[1]-$)))/c;const O=ie._round(o*P),Z=ie._round(c*D);C=f(..._(O,Z));const J=T-C[0],Ae=k-C[1];l(this,dn)||g(this,dn,[this.x,this.y,this.width,this.height]),this.width=O,this.height=Z,this.x=J,this.y=Ae,this.setDims(i*O,s*Z),this.fixAndSetPosition(),this._onResizing()},Bx=function(){var e;g(this,os,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Pe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Hx=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=x(this,K,Zd).call(this,this.rotation),o=(T,k)=>[a[0]*T+a[2]*k,a[1]*T+a[3]*k],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,p=this.height,m=ie.MIN_SIZE/c,A=ie.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),m/f,A/p);const _=ie._round(f*r),y=ie._round(p*r);if(_===f&&y===p)return;l(this,dn)||g(this,dn,[h,d,f,p]);const w=o(f/2,p/2),b=ie._round(h+w[0]),E=ie._round(d+w[1]),C=o(_/2,y/2);this.x=b-C[0],this.y=E-C[1],this.width=_,this.height=y,this.setDims(c*_,u*y),this.fixAndSetPosition(),this._onResizing()},Ux=function(){var e;(e=l(this,Pe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),x(this,K,ef).call(this)},Xm=function(e){const{isMac:t}=Wt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},$x=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=u=>{s.abort(),g(this,ir,null),g(this,ya,!1),this._uiManager.endDragSession()||x(this,K,Xm).call(this,u),i&&this._onStopDragging()};t&&(g(this,gl,e.clientX),g(this,ml,e.clientY),g(this,ir,e.pointerId),g(this,Ju,e.pointerType),window.addEventListener("pointermove",u=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==l(this,ir)){En(u);return}const[p,m]=this.screenToPageTranslation(h-l(this,gl),d-l(this,ml));g(this,gl,h),g(this,ml,d),this._uiManager.dragSelectedEditors(p,m)},a),window.addEventListener("touchmove",En,a),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,Ju)&&(l(this,wa)||u.isPrimary)&&o(u),En(u)},a));const c=u=>{if(!l(this,ir)||l(this,ir)===u.pointerId){o(u);return}En(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},qm=function(){if(l(this,sr)||!this.div)return;g(this,sr,new AbortController);const e=this._uiManager.combinedSignal(l(this,sr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Vx=function(e){ie._resizerKeyboardManager.exec(this,e)},Wx=function(e){var t;l(this,ls)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,mt)&&x(this,K,zc).call(this)},Gx=function(e){g(this,Zu,l(this,ls)?e:"")},Ym=function(e){if(l(this,ri))for(const t of l(this,ri))t.tabIndex=e},zc=function(){g(this,ls,!1),x(this,K,Ym).call(this,-1),x(this,K,ef).call(this)},S(ie,nh),Y(ie,"_l10n",null),Y(ie,"_l10nResizer",null),Y(ie,"_borderLineWidth",-1),Y(ie,"_colorManager",new Dm),Y(ie,"_zIndex",1),Y(ie,"_telemetryTimeout",1e3);let je=ie;class Rk extends je{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Cw=3285377520,Mn=4294901760,Ei=65535;class Xx{constructor(e){this.h1=e?e&4294967295:Cw,this.h2=e?e&4294967295:Cw}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let A=0,_=e.length;A<_;A++){const y=e.charCodeAt(A);y<=255?t[i++]=y:(t[i++]=y>>>8,t[i++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,p=d&Ei,m=f&Ei;for(let A=0;A<s;A++)A&1?(o=a[A],o=o*d&Mn|o*p&Ei,o=o<<15|o>>>17,o=o*f&Mn|o*m&Ei,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[A],c=c*d&Mn|c*p&Ei,c=c<<15|c>>>17,c=c*f&Mn|c*m&Ei,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*d&Mn|o*p&Ei,o=o<<15|o>>>17,o=o*f&Mn|o*m&Ei,s&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Mn|e*36045&Ei,t=t*4283543511&Mn|((t<<16|e>>>16)*2950163797&Mn)>>>16,e^=t>>>1,e=e*444984403&Mn|e*60499&Ei,t=t*3301882366&Mn|((t<<16|e>>>16)*3120437893&Mn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Km=Object.freeze({map:null,hash:"",transfer:void 0});var Aa,Sa,ot,up,qx;class Gv{constructor(){S(this,up);S(this,Aa,!1);S(this,Sa,null);S(this,ot,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=l(this,ot).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return l(this,ot).get(e)}remove(e){if(l(this,ot).delete(e),l(this,ot).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,ot).values())if(t instanceof je)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=l(this,ot).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,l(this,ot).set(e,t);s&&x(this,up,qx).call(this),t instanceof je&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,ot).has(e)}getAll(){return l(this,ot).size>0?Bv(l(this,ot)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return l(this,ot).size}resetModified(){l(this,Aa)&&(g(this,Aa,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Yx(this)}get serializable(){if(l(this,ot).size===0)return Km;const e=new Map,t=new Xx,i=[],s=Object.create(null);let r=!1;for(const[a,o]of l(this,ot)){const c=o instanceof je?o.serialize(!1,s):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:Km}get editorStats(){let e=null;const t=new Map;for(const i of l(this,ot).values()){if(!(i instanceof je))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(s)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){g(this,Sa,null)}get modifiedIds(){if(l(this,Sa))return l(this,Sa);const e=[];for(const t of l(this,ot).values())!(t instanceof je)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return g(this,Sa,{ids:new Set(e),hash:e.join(",")})}}Aa=new WeakMap,Sa=new WeakMap,ot=new WeakMap,up=new WeakSet,qx=function(){l(this,Aa)||(g(this,Aa,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var ih;class Yx extends Gv{constructor(t){super();S(this,ih);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);g(this,ih,{map:a,hash:s,transfer:r})}get print(){_e("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,ih)}get modifiedIds(){return re(this,"modifiedIds",{ids:new Set,hash:""})}}ih=new WeakMap;var yl;class Lk{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){S(this,yl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,yl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,yl).has(e.loadedName))){if(Ye(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=e,a=new FontFace(i,s,r);this.addNativeFontFace(a);try{await a.load(),l(this,yl).add(i),t==null||t(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}_e("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ne(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return re(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Dt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),re(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ye(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return re(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function s(E,C,T,k){const P=E.substring(0,C),D=E.substring(C+T);return P+k+D}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function h(E,C){if(++u>30){ne("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,E,C))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=s(f,976,d.length,d);const m=16,A=1482184792;let _=i(f,m);for(r=0,a=d.length-3;r<a;r+=4)_=_-A+i(d,r)|0;r<d.length&&(_=_-A+i(d+"XXX",r)|0),f=s(f,m,4,yk(_));const y=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${d}";src:${y}}`;this.insertRule(w);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const E of[e.loadedName,d]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,b.append(C)}this._document.body.append(b),h(d,()=>{b.remove(),t.complete()})}}yl=new WeakMap;class Mk{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${bk(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){ne(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}const Pd={DATA:1,ERROR:2},Xe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function kw(){}function Qt(n){if(n instanceof jr||n instanceof Pm||n instanceof Tu||n instanceof bw||n instanceof qf||n instanceof kg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||_e('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new jr(n.message);case"InvalidPDFException":return new Pm(n.message);case"MissingPDFException":return new Tu(n.message);case"PasswordException":return new bw(n.message,n.code);case"UnexpectedResponseException":return new qf(n.message,n.status);case"UnknownErrorException":return new kg(n.message,n.details)}return new kg(n.message,n.toString())}var vl,qn,Kx,Qx,Jx,tf;class Bc{constructor(e,t,i){S(this,qn);S(this,vl,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",x(this,qn,Kx).bind(this),{signal:l(this,vl).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},s),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:o,stream:Xe.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Ye(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Xe.CANCEL,streamId:r,reason:Qt(u)}),h.promise}},i)}destroy(){var e;(e=l(this,vl))==null||e.abort(),g(this,vl,null)}}vl=new WeakMap,qn=new WeakSet,Kx=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){x(this,qn,Jx).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Pd.DATA)s.resolve(e.data);else if(e.callback===Pd.ERROR)s.reject(Qt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:Pd.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:Pd.ERROR,callbackId:e.callbackId,reason:Qt(a)})});return}if(e.streamId){x(this,qn,Qx).call(this,e);return}t(e.data)},Qx=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Xe.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Xe.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Ye(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Xe.ERROR,streamId:t,reason:Qt(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Xe.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Xe.START_COMPLETE,streamId:t,reason:Qt(u)})})},Jx=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Xe.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Qt(e.reason));break;case Xe.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Qt(e.reason));break;case Xe.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:Xe.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||kw).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Xe.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Xe.PULL_COMPLETE,streamId:t,reason:Qt(u)})});break;case Xe.ENQUEUE:if(Ye(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Xe.CLOSE:if(Ye(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),x(this,qn,tf).call(this,a,t);break;case Xe.ERROR:Ye(a,"error should have stream controller"),a.controller.error(Qt(e.reason)),x(this,qn,tf).call(this,a,t);break;case Xe.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Qt(e.reason)),x(this,qn,tf).call(this,a,t);break;case Xe.CANCEL:if(!o)break;const c=Qt(e.reason);Promise.try(o.onCancel||kw,c).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Xe.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Xe.CANCEL_COMPLETE,streamId:t,reason:Qt(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},tf=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var sh;class Zx{constructor({enableHWA:e=!1}){S(this,sh,!1);g(this,sh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!l(this,sh)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){_e("Abstract method `_createCanvas` called.")}}sh=new WeakMap;class Ik extends Zx{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class eb{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class tb extends eb{async _fetch(e){const t=await Gp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Wp(t)}}class nb{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var xa,wl,cs,us,Nt,ba,_a,z,kt,Hc,To,nf,Po,ib,Qm,No,Uc,$c,Jm,Vc;class Dk extends nb{constructor({docId:t,ownerDocument:i=globalThis.document}){super();S(this,z);S(this,xa);S(this,wl);S(this,cs);S(this,us);S(this,Nt);S(this,ba);S(this,_a,0);g(this,us,t),g(this,Nt,i)}addFilter(t){if(!t)return"none";let i=l(this,z,kt).get(t);if(i)return i;const[s,r,a]=x(this,z,nf).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=l(this,z,kt).get(o),i)return l(this,z,kt).set(t,i),i;const c=`g_${l(this,us)}_transfer_map_${Ot(this,_a)._++}`,u=x(this,z,Po).call(this,c);l(this,z,kt).set(t,u),l(this,z,kt).set(o,u);const h=x(this,z,No).call(this,c);return x(this,z,$c).call(this,s,r,a,h),u}addHCMFilter(t,i){var m;const s=`${t}-${i}`,r="base";let a=l(this,z,Hc).get(r);if((a==null?void 0:a.key)===s||(a?((m=a.filter)==null||m.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},l(this,z,Hc).set(r,a)),!t||!i))return a.url;const o=x(this,z,Vc).call(this,t);t=G.makeHexColor(...o);const c=x(this,z,Vc).call(this,i);if(i=G.makeHexColor(...c),l(this,z,To).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const u=new Array(256);for(let A=0;A<=255;A++){const _=A/255;u[A]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),d=`g_${l(this,us)}_hcm_filter`,f=a.filter=x(this,z,No).call(this,d);x(this,z,$c).call(this,h,h,h,f),x(this,z,Qm).call(this,f);const p=(A,_)=>{const y=o[A]/255,w=c[A]/255,b=new Array(_+1);for(let E=0;E<=_;E++)b[E]=y+E/_*(w-y);return b.join(",")};return x(this,z,$c).call(this,p(0,5),p(1,5),p(2,5),f),a.url=x(this,z,Po).call(this,d),a.url}addAlphaFilter(t){let i=l(this,z,kt).get(t);if(i)return i;const[s]=x(this,z,nf).call(this,[t]),r=`alpha_${s}`;if(i=l(this,z,kt).get(r),i)return l(this,z,kt).set(t,i),i;const a=`g_${l(this,us)}_alpha_map_${Ot(this,_a)._++}`,o=x(this,z,Po).call(this,a);l(this,z,kt).set(t,o),l(this,z,kt).set(r,o);const c=x(this,z,No).call(this,a);return x(this,z,Jm).call(this,s,c),o}addLuminosityFilter(t){let i=l(this,z,kt).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=x(this,z,nf).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=l(this,z,kt).get(r),i)return l(this,z,kt).set(t,i),i;const a=`g_${l(this,us)}_luminosity_map_${Ot(this,_a)._++}`,o=x(this,z,Po).call(this,a);l(this,z,kt).set(t,o),l(this,z,kt).set(r,o);const c=x(this,z,No).call(this,a);return x(this,z,ib).call(this,c),t&&x(this,z,Jm).call(this,s,c),o}addHighlightHCMFilter(t,i,s,r,a){var w;const o=`${i}-${s}-${r}-${a}`;let c=l(this,z,Hc).get(t);if((c==null?void 0:c.key)===o||(c?((w=c.filter)==null||w.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,z,Hc).set(t,c)),!i||!s))return c.url;const[u,h]=[i,s].map(x(this,z,Vc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,m]=[r,a].map(x(this,z,Vc).bind(this));f<d&&([d,f,p,m]=[f,d,m,p]),l(this,z,To).style.color="";const A=(b,E,C)=>{const T=new Array(256),k=(f-d)/C,P=b/255,D=(E-b)/(255*C);let M=0;for(let $=0;$<=C;$++){const O=Math.round(d+$*k),Z=P+$*D;for(let J=M;J<=O;J++)T[J]=Z;M=O+1}for(let $=M;$<256;$++)T[$]=T[M-1];return T.join(",")},_=`g_${l(this,us)}_hcm_${t}_filter`,y=c.filter=x(this,z,No).call(this,_);return x(this,z,Qm).call(this,y),x(this,z,$c).call(this,A(p[0],m[0],5),A(p[1],m[1],5),A(p[2],m[2],5),y),c.url=x(this,z,Po).call(this,_),c.url}destroy(t=!1){var i,s,r,a;t&&((i=l(this,ba))!=null&&i.size)||((s=l(this,cs))==null||s.parentNode.parentNode.remove(),g(this,cs,null),(r=l(this,wl))==null||r.clear(),g(this,wl,null),(a=l(this,ba))==null||a.clear(),g(this,ba,null),g(this,_a,0))}}xa=new WeakMap,wl=new WeakMap,cs=new WeakMap,us=new WeakMap,Nt=new WeakMap,ba=new WeakMap,_a=new WeakMap,z=new WeakSet,kt=function(){return l(this,wl)||g(this,wl,new Map)},Hc=function(){return l(this,ba)||g(this,ba,new Map)},To=function(){if(!l(this,cs)){const t=l(this,Nt).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=l(this,Nt).createElementNS(Yi,"svg");s.setAttribute("width",0),s.setAttribute("height",0),g(this,cs,l(this,Nt).createElementNS(Yi,"defs")),t.append(s),s.append(l(this,cs)),l(this,Nt).body.append(t)}return l(this,cs)},nf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[i,s,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=i[u]/255,o[u]=s[u]/255,c[u]=r[u]/255;return[a.join(","),o.join(","),c.join(",")]},Po=function(t){if(l(this,xa)===void 0){g(this,xa,"");const i=l(this,Nt).URL;i!==l(this,Nt).baseURI&&(Xp(i)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,xa,i.split("#",1)[0]))}return`url(${l(this,xa)}#${t})`},ib=function(t){const i=l(this,Nt).createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},Qm=function(t){const i=l(this,Nt).createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},No=function(t){const i=l(this,Nt).createElementNS(Yi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),l(this,z,To).append(i),i},Uc=function(t,i,s){const r=l(this,Nt).createElementNS(Yi,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},$c=function(t,i,s,r){const a=l(this,Nt).createElementNS(Yi,"feComponentTransfer");r.append(a),x(this,z,Uc).call(this,a,"feFuncR",t),x(this,z,Uc).call(this,a,"feFuncG",i),x(this,z,Uc).call(this,a,"feFuncB",s)},Jm=function(t,i){const s=l(this,Nt).createElementNS(Yi,"feComponentTransfer");i.append(s),x(this,z,Uc).call(this,s,"feFuncA",t)},Vc=function(t){return l(this,z,To).style.color=t,Wv(getComputedStyle(l(this,z,To)).getPropertyValue("color"))};class sb{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class rb extends sb{async _fetch(e){const t=await Gp(e,"arraybuffer");return new Uint8Array(t)}}Dt&&ne("Please use the `legacy` build in Node.js environments.");async function ab(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class Fk extends nb{}class Ok extends Zx{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class jk extends eb{async _fetch(e){return ab(e)}}class zk extends sb{async _fetch(e){return ab(e)}}const Mt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Zm(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class Xv{getPattern(){_e("Abstract method `getPattern` called.")}}class Bk extends Xv{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===Mt.STROKE||s===Mt.FILL){const a=t.current.getClippedPathBoundingBox(s,Le(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=G.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),Zm(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(i);r.setTransform(d)}else Zm(e,this._bbox),r=this._createGradient(e);return r}}function Ng(n,e,t,i,s,r,a,o){const c=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;c[t+1]>c[i+1]&&(f=t,t=i,i=f,f=r,r=a,a=f),c[i+1]>c[s+1]&&(f=i,i=s,s=f,f=a,a=o,o=f),c[t+1]>c[i+1]&&(f=t,t=i,i=f,f=r,r=a,a=f);const p=(c[t]+e.offsetX)*e.scaleX,m=(c[t+1]+e.offsetY)*e.scaleY,A=(c[i]+e.offsetX)*e.scaleX,_=(c[i+1]+e.offsetY)*e.scaleY,y=(c[s]+e.offsetX)*e.scaleX,w=(c[s+1]+e.offsetY)*e.scaleY;if(m>=w)return;const b=u[r],E=u[r+1],C=u[r+2],T=u[a],k=u[a+1],P=u[a+2],D=u[o],M=u[o+1],$=u[o+2],O=Math.round(m),Z=Math.round(w);let J,Ae,j,W,I,X,q,ae;for(let oe=O;oe<=Z;oe++){if(oe<_){const ue=oe<m?0:(m-oe)/(m-_);J=p-(p-A)*ue,Ae=b-(b-T)*ue,j=E-(E-k)*ue,W=C-(C-P)*ue}else{let ue;oe>w?ue=1:_===w?ue=0:ue=(_-oe)/(_-w),J=A-(A-y)*ue,Ae=T-(T-D)*ue,j=k-(k-M)*ue,W=P-(P-$)*ue}let be;oe<m?be=0:oe>w?be=1:be=(m-oe)/(m-w),I=p-(p-y)*be,X=b-(b-D)*be,q=E-(E-M)*be,ae=C-(C-$)*be;const ft=Math.round(Math.min(J,I)),cn=Math.round(Math.max(J,I));let Ee=d*oe+ft*4;for(let ue=ft;ue<=cn;ue++)be=(J-ue)/(J-I),be<0?be=0:be>1&&(be=1),h[Ee++]=Ae-(Ae-X)*be|0,h[Ee++]=j-(j-q)*be|0,h[Ee++]=W-(W-ae)*be|0,h[Ee++]=255}}function Hk(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(i.length/o)-1,u=o-1;for(r=0;r<c;r++){let h=r*o;for(let d=0;d<u;d++,h++)Ng(n,t,i[h],i[h+1],i[h+o],s[h],s[h+1],s[h+o]),Ng(n,t,i[h+o+1],i[h+1],i[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)Ng(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class Uk extends Xv{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),p=u/d,m=h/f,A={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/p,scaleY:1/m},_=d+2*2,y=f+2*2,w=i.getCanvas("mesh",_,y),b=w.context,E=b.createImageData(d,f);if(t){const T=E.data;for(let k=0,P=T.length;k<P;k+=4)T[k]=t[0],T[k+1]=t[1],T[k+2]=t[2],T[k+3]=255}for(const T of this._figures)Hk(E,T,A);return b.putImageData(E,2,2),{canvas:w.canvas,offsetX:o-2*p,offsetY:c-2*m,scaleX:p,scaleY:m}}getPattern(e,t,i,s){Zm(e,this._bbox);let r;if(s===Mt.SHADING)r=G.singularValueDecompose2dScale(Le(e));else if(r=G.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=G.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,s===Mt.SHADING?null:this._background,t.cachedCanvases);return s!==Mt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class $k extends Xv{getPattern(){return"hotpink"}}function Vk(n){switch(n[0]){case"RadialAxial":return new Bk(n);case"Mesh":return new Uk(n);case"Dummy":return new $k}throw new Error(`Unknown IR type: ${n[0]}`)}const Tw={COLORED:1,UNCOLORED:2},hp=class hp{constructor(e,t,i,s,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Vp("TilingType: "+r);const h=t[0],d=t[1],f=t[2],p=t[3],m=f-h,A=p-d,_=G.singularValueDecompose2dScale(this.matrix),y=G.singularValueDecompose2dScale(this.baseTransform),w=_[0]*y[0],b=_[1]*y[1];let E=m,C=A,T=!1,k=!1;const P=Math.ceil(c*w),D=Math.ceil(u*b),M=Math.ceil(m*w),$=Math.ceil(A*b);P>=M?E=c:T=!0,D>=$?C=u:k=!0;const O=this.getSizeAndScale(E,this.ctx.canvas.width,w),Z=this.getSizeAndScale(C,this.ctx.canvas.height,b),J=e.cachedCanvases.getCanvas("pattern",O.size,Z.size),Ae=J.context,j=o.createCanvasGraphics(Ae);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,s,a),Ae.translate(-O.scale*h,-Z.scale*d),j.transform(O.scale,0,0,Z.scale,0,0),Ae.save(),this.clipBbox(j,h,d,f,p),j.baseTransform=Le(j.ctx),j.executeOperatorList(i),j.endDrawing(),Ae.restore(),T||k){const W=J.canvas;T&&(E=c),k&&(C=u);const I=this.getSizeAndScale(E,this.ctx.canvas.width,w),X=this.getSizeAndScale(C,this.ctx.canvas.height,b),q=I.size,ae=X.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",q,ae),be=oe.context,ft=T?Math.floor(m/c):0,cn=k?Math.floor(A/u):0;for(let Ee=0;Ee<=ft;Ee++)for(let ue=0;ue<=cn;ue++)be.drawImage(W,q*Ee,ae*ue,q,ae,0,0,q,ae);return{canvas:oe.canvas,scaleX:I.scale,scaleY:X.scale,offsetX:h,offsetY:d}}return{canvas:J.canvas,scaleX:O.scale,scaleY:Z.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,i){const s=Math.max(hp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),e.current.updateRectMinMax(Le(e.ctx),[t,i,s,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case Tw.COLORED:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Tw.UNCOLORED:const o=G.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new mk(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,s){let r=i;s!==Mt.SHADING&&(r=G.transform(r,t.baseTransform),this.matrix&&(r=G.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};Y(hp,"MAX_PATTERN_SIZE",3e3);let ey=hp;function Wk({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Wt.isLittleEndian?4278190080:255,[c,u]=a?[r,o]:[o,r],h=i>>3,d=i&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let m=0;m<s;m++){for(const _=e+h;e<_;e++){const y=e<f?n[e]:255;t[p++]=y&128?u:c,t[p++]=y&64?u:c,t[p++]=y&32?u:c,t[p++]=y&16?u:c,t[p++]=y&8?u:c,t[p++]=y&4?u:c,t[p++]=y&2?u:c,t[p++]=y&1?u:c}if(d===0)continue;const A=e<f?n[e++]:255;for(let _=0;_<d;_++)t[p++]=A&1<<7-_?u:c}return{srcPos:e,destPos:p}}const Pw=16,Nw=100,Gk=15,Rw=10,Lw=1e3,nn=16;function Xk(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,a,o,c){e.transform(i,s,r,a,o,c),this.__originalTransform(i,s,r,a,o,c)},n.setTransform=function(i,s,r,a,o,c){e.setTransform(i,s,r,a,o,c),this.__originalSetTransform(i,s,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class qk{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Nd(n,e,t,i,s,r,a,o,c,u){const[h,d,f,p,m,A]=Le(n);if(d===0&&f===0){const w=a*h+m,b=Math.round(w),E=o*p+A,C=Math.round(E),T=(a+c)*h+m,k=Math.abs(Math.round(T)-b)||1,P=(o+u)*p+A,D=Math.abs(Math.round(P)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(p),b,C),n.drawImage(e,t,i,s,r,0,0,k,D),n.setTransform(h,d,f,p,m,A),[k,D]}if(h===0&&p===0){const w=o*f+m,b=Math.round(w),E=a*d+A,C=Math.round(E),T=(o+u)*f+m,k=Math.abs(Math.round(T)-b)||1,P=(a+c)*d+A,D=Math.abs(Math.round(P)-C)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,b,C),n.drawImage(e,t,i,s,r,0,0,D,k),n.setTransform(h,d,f,p,m,A),[D,k]}n.drawImage(e,t,i,s,r,a,o,c,u);const _=Math.hypot(h,d),y=Math.hypot(f,p);return[_*c,y*u]}function Yk(n){const{width:e,height:t}=n;if(e>Lw||t>Lw)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,u;const h=e+7&-8;let d=new Uint8Array(h*t),f=0;for(const y of n.data){let w=128;for(;w>0;)d[f++]=y&w?0:255,w>>=1}let p=0;for(f=0,d[f]!==0&&(a[0]=1,++p),c=1;c<e;c++)d[f]!==d[f+1]&&(a[c]=d[f]?2:1,++p),f++;for(d[f]!==0&&(a[c]=2,++p),o=1;o<t;o++){f=o*h,u=o*r,d[f-h]!==d[f]&&(a[u]=d[f]?1:8,++p);let y=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<e;c++)y=(y>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),s[y]&&(a[u+c]=s[y],++p),f++;if(d[f-h]!==d[f]&&(a[u+c]=d[f]?2:4,++p),p>i)return null}for(f=h*(t-1),u=o*r,d[f]!==0&&(a[u]=8,++p),c=1;c<e;c++)d[f]!==d[f+1]&&(a[u+c]=d[f]?4:8,++p),f++;if(d[f]!==0&&(a[u+c]=4,++p),p>i)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),A=new Path2D;for(o=0;p&&o<=t;o++){let y=o*r;const w=y+e;for(;y<w&&!a[y];)y++;if(y===w)continue;A.moveTo(y%r,o);const b=y;let E=a[y];do{const C=m[E];do y+=C;while(!a[y]);const T=a[y];T!==5&&T!==10?(E=T,a[y]=0):(E=T&51*E>>4,a[y]&=E>>2|E<<2),A.lineTo(y%r,y/r|0),a[y]||--p}while(b!==y);--o}return d=null,a=null,function(y){y.save(),y.scale(1/e,-1/t),y.translate(0,-t),y.fill(A),y.beginPath(),y.restore()}}class Mw{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=mx,this.textMatrixScale=1,this.fontMatrix=Tm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ct.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=G.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=G.applyTransform(t,e),s=G.applyTransform(t.slice(2),e),r=G.applyTransform([t[0],t[3]],e),a=G.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],r[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],a[1])}updateScalingPathMinMax(e,t){G.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,r,a,o,c,u,h){const d=G.bezierBoundingBox(t,i,s,r,a,o,c,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Mt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Mt.STROKE){t||_e("Stroke bounding box must include transform.");const s=G.singularValueDecompose2dScale(t),r=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=a,i[2]+=r,i[3]+=a}return i}updateClipFromPath(){const e=G.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Mt.FILL,t=null){return G.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Iw(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%nn,r=(t-s)/nn,a=s===0?r:r+1,o=n.createImageData(i,nn);let c=0,u;const h=e.data,d=o.data;let f,p,m,A;if(e.kind===Gd.GRAYSCALE_1BPP){const _=h.byteLength,y=new Uint32Array(d.buffer,0,d.byteLength>>2),w=y.length,b=i+7>>3,E=4294967295,C=Wt.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(m=f<r?nn:s,u=0,p=0;p<m;p++){const T=_-c;let k=0;const P=T>b?i:T*8-7,D=P&-8;let M=0,$=0;for(;k<D;k+=8)$=h[c++],y[u++]=$&128?E:C,y[u++]=$&64?E:C,y[u++]=$&32?E:C,y[u++]=$&16?E:C,y[u++]=$&8?E:C,y[u++]=$&4?E:C,y[u++]=$&2?E:C,y[u++]=$&1?E:C;for(;k<P;k++)M===0&&($=h[c++],M=128),y[u++]=$&M?E:C,M>>=1}for(;u<w;)y[u++]=0;n.putImageData(o,0,f*nn)}}else if(e.kind===Gd.RGBA_32BPP){for(p=0,A=i*nn*4,f=0;f<r;f++)d.set(h.subarray(c,c+A)),c+=A,n.putImageData(o,0,p),p+=nn;f<a&&(A=i*s*4,d.set(h.subarray(c,c+A)),n.putImageData(o,0,p))}else if(e.kind===Gd.RGB_24BPP)for(m=nn,A=i*m,f=0;f<a;f++){for(f>=r&&(m=s,A=i*m),u=0,p=A;p--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;n.putImageData(o,0,f*nn)}else throw new Error(`bad image kind: ${e.kind}`)}function Dw(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%nn,r=(t-s)/nn,a=s===0?r:r+1,o=n.createImageData(i,nn);let c=0;const u=e.data,h=o.data;for(let d=0;d<a;d++){const f=d<r?nn:s;({srcPos:c}=Wk({src:u,srcPos:c,dest:h,width:i,height:f,nonBlackColor:0})),n.putImageData(o,0,d*nn)}}function Pc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Rd(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Dt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Fw(n,e){if(e)return!0;const t=G.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*zr.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const Kk=["butt","round","square"],Qk=["miter","round","bevel"],Jk={},Ow={};var Si,ty,ny,iy;const Jv=class Jv{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},c,u){S(this,Si);this.ctx=e,this.current=new Mw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new qk(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Le(this.compositeCtx))}this.ctx.save(),Rd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Le(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const u=c-o>Rw&&typeof i=="function",h=u?Date.now()+Gk:0;let d=0;const f=this.commonObjs,p=this.objs;let m;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(m=a[o],m!==ti.dependency)this[m].apply(this,r[o]);else for(const A of r[o]){const _=A.startsWith("g_")?f:p;if(!_.has(A))return _.get(A,i),o}if(o++,o===c)return o;if(u&&++d>Rw){if(Date.now()>h)return i(),o;d=0}}}endDrawing(){x(this,Si,ty).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),x(this,Si,ny).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,c=s,u="prescale1",h,d;for(;r>2&&o>1||a>2&&c>1;){let f=o,p=c;r>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/f),a>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/p),h=this.cachedCanvases.getCanvas(u,f,p),d=h.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,o,c,0,0,f,p),e=h.canvas,o=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,a=this.current.patternFill,o=Le(t);let c,u,h,d;if((e.bitmap||e.data)&&e.count>1){const P=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(P),c||(c=new Map,this._cachedBitmapsMap.set(P,c));const D=c.get(u);if(D&&!a){const M=Math.round(Math.min(o[0],o[2])+o[4]),$=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:D,offsetX:M,offsetY:$}}h=D}h||(d=this.cachedCanvases.getCanvas("maskCanvas",i,s),Dw(d.context,e));let f=G.transform(o,[1/i,0,0,-1/s,0,0]);f=G.transform(f,[1,0,0,1,0,-s]);const[p,m,A,_]=G.getAxialAlignedBoundingBox([0,0,i,s],f),y=Math.round(A-p)||1,w=Math.round(_-m)||1,b=this.cachedCanvases.getCanvas("fillCanvas",y,w),E=b.context,C=p,T=m;E.translate(-C,-T),E.transform(...f),h||(h=this._scaleImage(d.canvas,_i(E)),h=h.img,c&&a&&c.set(u,h)),E.imageSmoothingEnabled=Fw(Le(E),e.interpolate),Nd(E,h,0,0,h.width,h.height,0,0,i,s),E.globalCompositeOperation="source-in";const k=G.transform(_i(E),[1,0,0,1,-C,-T]);return E.fillStyle=a?r.getPattern(t,this,k,Mt.FILL):r,E.fillRect(0,0,i,s),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,b.canvas)),{canvas:b.canvas,offsetX:Math.round(C),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Kk[e]}setLineJoin(e){this.ctx.lineJoin=Qk[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...Le(this.suspendedCtx)),Pc(this.suspendedCtx,r),Xk(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,c=s[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,i,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,c,u,h,d){let f=e.canvas,p=c-h,m=u-d;if(a){const _=G.makeHexColor(...a);if(p<0||m<0||p+i>f.width||m+s>f.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,s),w=y.context;w.drawImage(f,-p,-m),w.globalCompositeOperation="destination-atop",w.fillStyle=_,w.fillRect(0,0,i,s),w.globalCompositeOperation="source-over",f=y.canvas,p=m=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(p,m,i,s),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=_,e.fillRect(p,m,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const A=new Path2D;A.rect(c,u,i,s),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(f,p,m,i,s,c,u,i,s),t.restore()}save(){this.inSMaskMode?(Pc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Pc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,r,a){this.ctx.transform(e,t,i,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const s=this.ctx,r=this.current;let a=r.x,o=r.y,c,u;const h=Le(s),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?i.slice(0):null;for(let p=0,m=0,A=e.length;p<A;p++)switch(e[p]|0){case ti.rectangle:a=t[m++],o=t[m++];const _=t[m++],y=t[m++],w=a+_,b=o+y;s.moveTo(a,o),_===0||y===0?s.lineTo(w,b):(s.lineTo(w,o),s.lineTo(w,b),s.lineTo(a,b)),d||r.updateRectMinMax(h,[a,o,w,b]),s.closePath();break;case ti.moveTo:a=t[m++],o=t[m++],s.moveTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ti.lineTo:a=t[m++],o=t[m++],s.lineTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ti.curveTo:c=a,u=o,a=t[m+4],o=t[m+5],s.bezierCurveTo(t[m],t[m+1],t[m+2],t[m+3],a,o),r.updateCurvePathMinMax(h,c,u,t[m],t[m+1],t[m+2],t[m+3],a,o,f),m+=6;break;case ti.curveTo2:c=a,u=o,s.bezierCurveTo(a,o,t[m],t[m+1],t[m+2],t[m+3]),r.updateCurvePathMinMax(h,c,u,a,o,t[m],t[m+1],t[m+2],t[m+3],f),a=t[m+2],o=t[m+3],m+=4;break;case ti.curveTo3:c=a,u=o,a=t[m+2],o=t[m+3],s.bezierCurveTo(t[m],t[m+1],a,o,a,o),r.updateCurvePathMinMax(h,c,u,t[m],t[m+1],a,o,a,o,f),m+=4;break;case ti.closePath:s.closePath();break}d&&r.updateScalingPathMinMax(h,f),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(t.save(),t.strokeStyle=i.getPattern(t,this,_i(t),Mt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,_i(t),Mt.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Jk}eoClip(){this.pendingClip=Ow}beginText(){this.current.textMatrix=mx,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:u}of e)i.addPath(u,new DOMMatrix(r).preMultiplySelf(s).translate(a,o).scale(c,-c));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||Tm,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",a=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const c=i.italic?"italic":"normal";let u=t;t<Pw?u=Pw:t>Nw&&(u=Nw),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,r,a){this.current.textMatrix=[e,t,i,s,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const a=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=u&Ct.FILL_STROKE_MASK,f=!!(u&Ct.ADD_TO_PATH_FLAG),p=o.patternFill&&!c.missingFile,m=o.patternStroke&&!c.missingFile;let A;if((c.disableFontFace||f||p||m)&&(A=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||m){if(a.save(),a.translate(t,i),a.scale(h,-h),d===Ct.FILL||d===Ct.FILL_STROKE)if(s){const _=a.getTransform();a.setTransform(...s),a.fill(x(this,Si,iy).call(this,A,_,s))}else a.fill(A);if(d===Ct.STROKE||d===Ct.FILL_STROKE)if(r){const _=a.getTransform();a.setTransform(...r),a.stroke(x(this,Si,iy).call(this,A,_,r))}else a.lineWidth/=h,a.stroke(A);a.restore()}else(d===Ct.FILL||d===Ct.FILL_STROKE)&&a.fillText(e,t,i),(d===Ct.STROKE||d===Ct.FILL_STROKE)&&a.strokeText(e,t,i);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Le(a),x:t,y:i,fontSize:h,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return re(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,f=i.vertical,p=f?1:-1,m=i.defaultVMetrics,A=s*t.fontMatrix[0],_=t.textRenderingMode===Ct.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let y,w;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,_i(r),Mt.FILL);y=Le(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,_i(r),Mt.STROKE);w=Le(r),r.restore(),r.strokeStyle=k}let b=t.lineWidth;const E=t.textMatrixScale;if(E===0||b===0){const k=t.textRenderingMode&Ct.FILL_STROKE_MASK;(k===Ct.STROKE||k===Ct.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=E;if(a!==1&&(r.scale(a,a),b/=a),r.lineWidth=b,i.isInvalidPDFjsFont){const k=[];let P=0;for(const D of e)k.push(D.unicode),P+=D.width;r.fillText(k.join(""),0,0),t.x+=P*A*h,r.restore(),this.compose();return}let C=0,T;for(T=0;T<d;++T){const k=e[T];if(typeof k=="number"){C+=p*k*s/1e3;continue}let P=!1;const D=(k.isSpace?c:0)+o,M=k.fontChar,$=k.accent;let O,Z,J=k.width;if(f){const j=k.vmetric||m,W=-(k.vmetric?j[1]:J*.5)*A,I=j[2]*A;J=j?-j[0]:J,O=W/a,Z=(C+I)/a}else O=C/a,Z=0;if(i.remeasure&&J>0){const j=r.measureText(M).width*1e3/s*a;if(J<j&&this.isFontSubpixelAAEnabled){const W=J/j;P=!0,r.save(),r.scale(W,1),O/=W}else J!==j&&(O+=(J-j)/2e3*s/a)}if(this.contentVisible&&(k.isInFont||i.missingFile)){if(_&&!$)r.fillText(M,O,Z);else if(this.paintChar(M,O,Z,y,w),$){const j=O+s*$.offset.x/a,W=Z-s*$.offset.y/a;this.paintChar($.fontChar,j,W,y,w)}}const Ae=f?J*A-D*u:J*A+D*u;C+=Ae,P&&r.restore()}f?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,c=i.charSpacing,u=i.wordSpacing,h=i.textHScale*a,d=i.fontMatrix||Tm,f=e.length,p=i.textRenderingMode===Ct.INVISIBLE;let m,A,_,y;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(h,a),m=0;m<f;++m){if(A=e[m],typeof A=="number"){y=o*A*r/1e3,this.ctx.translate(y,0),i.x+=y*h;continue}const w=(A.isSpace?u:0)+c,b=s.charProcOperatorList[A.operatorListId];if(!b){ne(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),t.scale(r,r),t.transform(...d),this.executeOperatorList(b),this.restore()),_=G.applyTransform([A.width,0],d)[0]*r+w,t.translate(_,0),i.x+=_*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,a){this.ctx.rect(i,s,r-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],s=this.baseTransform||Le(this.ctx),r={createCanvasGraphics:a=>new Jv(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ey(e,i,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=G.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=G.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=Vk(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,_i(t),Mt.SHADING);const s=_i(t);if(s){const{width:r,height:a}=t.canvas,[o,c,u,h]=G.getAxialAlignedBoundingBox([0,0,r,a],s);this.ctx.fillRect(o,c,u-o,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){_e("Should not call beginInlineImage")}beginImageData(){_e("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Le(this.ctx),t)){const i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(Le(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Vp("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const i=Le(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=G.getAxialAlignedBoundingBox(e.bbox,Le(t));const r=[0,0,t.canvas.width,t.canvas.height];s=G.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),c=Math.max(Math.ceil(s[2])-a,1),u=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-a,-o),f.transform(...i),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Pc(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=Le(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=G.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(x(this,Si,ty).call(this),Rd(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,u]=G.singularValueDecompose2dScale(Le(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),f=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,o*u),Rd(this.ctx)}else Rd(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Mw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),x(this,Si,ny).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=Yk(e)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(e),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=Le(o);o.transform(t,i,s,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=a.length;h<d;h+=2){const f=G.transform(c,[t,i,s,r,a[h],a[h+1]]),[p,m]=G.applyTransform([0,0],f);o.drawImage(u.canvas,p,m)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),d=h.context;d.save();const f=this.getObject(a,r);Dw(d,f),d.globalCompositeOperation="source-in",d.fillStyle=s?i.getPattern(d,this,_i(t),Mt.FILL):i,d.fillRect(0,0,o,c),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),Nd(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ne("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let u=0,h=s.length;u<h;u+=2)c.push({transform:[t,0,0,i,s[u],s[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;if(this.save(),!Dt){const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/t,-1/i);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Iw(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,_i(s));s.imageSmoothingEnabled=Fw(Le(s),e.interpolate),Nd(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;Iw(c,e),s=this.applyTransferMapsToCanvas(c)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),Nd(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===Ow?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Le(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=o=1/c;else{const h=c*e;a=o=h<1?1/h:1}else if(e===0)a=1/c,o=1/u;else{const h=c*e,d=u*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const c=Math.abs(t*r-i*s),u=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)a=h/c,o=u/c;else{const d=e*c;a=h>d?h/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(s,r),a.length>0){const o=Math.max(s,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Si=new WeakSet,ty=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ny=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},iy=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let tl=Jv;for(const n in ti)tl.prototype[n]!==void 0&&(tl.prototype[ti[n]]=tl.prototype[n]);var rh,ah;class ks{static get workerPort(){return l(this,rh)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");g(this,rh,e)}static get workerSrc(){return l(this,ah)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");g(this,ah,e)}}rh=new WeakMap,ah=new WeakMap,S(ks,rh,null),S(ks,ah,"");var Ea,oh;class Zk{constructor({parsedData:e,rawData:t}){S(this,Ea);S(this,oh);g(this,Ea,e),g(this,oh,t)}getRaw(){return l(this,oh)}get(e){return l(this,Ea).get(e)??null}getAll(){return Bv(l(this,Ea))}has(e){return l(this,Ea).has(e)}}Ea=new WeakMap,oh=new WeakMap;const Ro=Symbol("INTERNAL");var lh,ch,uh,Al;class eT{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){S(this,lh,!1);S(this,ch,!1);S(this,uh,!1);S(this,Al,!0);g(this,lh,!!(e&xn.DISPLAY)),g(this,ch,!!(e&xn.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(l(this,uh))return l(this,Al);if(!l(this,Al))return!1;const{print:e,view:t}=this.usage;return l(this,lh)?(t==null?void 0:t.viewState)!=="OFF":l(this,ch)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Ro&&_e("Internal method `_setVisible` called."),g(this,uh,i),g(this,Al,t)}}lh=new WeakMap,ch=new WeakMap,uh=new WeakMap,Al=new WeakMap;var rr,ve,Sl,xl,hh,sy;class tT{constructor(e,t=xn.DISPLAY){S(this,hh);S(this,rr,null);S(this,ve,new Map);S(this,Sl,null);S(this,xl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,g(this,xl,e.order);for(const i of e.groups)l(this,ve).set(i.id,new eT(t,i));if(e.baseState==="OFF")for(const i of l(this,ve).values())i._setVisible(Ro,!1);for(const i of e.on)l(this,ve).get(i)._setVisible(Ro,!0);for(const i of e.off)l(this,ve).get(i)._setVisible(Ro,!1);g(this,Sl,this.getHash())}}isVisible(e){if(l(this,ve).size===0)return!0;if(!e)return Vp("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,ve).has(e.id)?l(this,ve).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return x(this,hh,sy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,ve).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,ve).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,ve).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,ve).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,ve).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,ve).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=l(this,ve).get(e);if(!s){ne(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=l(this,ve).get(o))==null||r._setVisible(Ro,!1,!0));s._setVisible(Ro,!!t,!0),g(this,rr,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=l(this,ve).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}g(this,rr,null)}get hasInitialVisibility(){return l(this,Sl)===null||this.getHash()===l(this,Sl)}getOrder(){return l(this,ve).size?l(this,xl)?l(this,xl).slice():[...l(this,ve).keys()]:null}getGroups(){return l(this,ve).size>0?Bv(l(this,ve)):null}getGroup(e){return l(this,ve).get(e)||null}getHash(){if(l(this,rr)!==null)return l(this,rr);const e=new Xx;for(const[t,i]of l(this,ve))e.update(`${t}:${i.visible}`);return g(this,rr,e.hexdigest())}}rr=new WeakMap,ve=new WeakMap,Sl=new WeakMap,xl=new WeakMap,hh=new WeakSet,sy=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=x(this,hh,sy).call(this,r);else if(l(this,ve).has(r))a=l(this,ve).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class nT{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Ye(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});Ye(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ye(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new iT(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new sT(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class iT{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=$v(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class sT{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function rT(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=u(h),r(h)}if(t=a(n),t){const h=u(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),r(h)}function i(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function s(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),p=Wp(d);d=f.decode(p),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const d=[];let f;const p=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(h))!==null;){let[,A,_,y]=f;if(A=parseInt(A,10),A in d){if(A===0)break;continue}d[A]=[_,y]}const m=[];for(let A=0;A<d.length&&A in d;++A){let[_,y]=d[A];y=o(y),_&&(y=unescape(y),A===0&&(y=c(y))),m.push(y)}return m.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),m=h.slice(d+1).replace(/^[^']*'/,"");return s(f,m)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,_){return String.fromCharCode(parseInt(_,16))}),s(f,m);try{m=atob(m)}catch{}return s(f,m)})}return""}function ob(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function qp(n){try{return new URL(n).origin}catch{}return null}function lb({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function cb(n){const e=n.get("Content-Disposition");if(e){let t=rT(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if($v(t))return t}return null}function Yp(n,e){return n===404||n===0&&e.startsWith("file:")?new Tu('Missing PDF "'+e+'".'):new qf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function ub(n){return n===200||n===206}function hb(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function db(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class jw{constructor(e){Y(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=ob(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new aT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new oT(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class aT{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,hb(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=qp(r.url),!ub(r.status))throw Yp(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=lb({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=cb(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new jr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:db(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class oT{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const a=s.url;fetch(a,hb(r,this._withCredentials,this._abortController)).then(o=>{const c=qp(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!ub(o.status))throw Yp(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:db(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Rg=200,Lg=206;function lT(n){const e=n.response;return typeof e!="string"?e:Wp(e).buffer}class cT{constructor({url:e,httpHeaders:t,withCredentials:i}){Y(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=ob(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Lg):s.expectedStatus=Rg,t.responseType="arraybuffer",Ye(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||Rg;if(!(r===Rg&&i.expectedStatus===Lg)&&r!==i.expectedStatus){i.onError(s.status);return}const o=lT(s);if(r===Lg){const c=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?i.onDone({begin:parseInt(u[1],10),chunk:o}):(ne('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class uT{constructor(e){this._source=e,this._manager=new cT(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ye(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hT(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new dT(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class hT{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=qp(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=lb({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=cb(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Yp(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class dT{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=qp((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Yp(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const fT=/^[a-z][a-z0-9\-+.]+:/i;function pT(n){if(fT.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class gT{constructor(e){this.source=e,this.url=pT(e.url),Ye(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ye(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new mT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new yT(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class mT{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Tu(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new jr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class yT{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vT=1e5,Kt=30,wT=.8;var Vw,ar,en,dh,fh,Ca,hs,ph,gh,ka,bl,_l,or,El,mh,Cl,Ta,yh,vh,Pa,Na,wh,lr,kl,js,fb,pb,ry,Tn,sf,ay,gb,mb;const Ze=class Ze{constructor({textContentSource:e,container:t,viewport:i}){S(this,js);S(this,ar,Promise.withResolvers());S(this,en,null);S(this,dh,!1);S(this,fh,!!((Vw=globalThis.FontInspector)!=null&&Vw.enabled));S(this,Ca,null);S(this,hs,null);S(this,ph,0);S(this,gh,0);S(this,ka,null);S(this,bl,null);S(this,_l,0);S(this,or,0);S(this,El,Object.create(null));S(this,mh,[]);S(this,Cl,null);S(this,Ta,[]);S(this,yh,new WeakMap);S(this,vh,null);var c;if(e instanceof ReadableStream)g(this,Cl,e);else if(typeof e=="object")g(this,Cl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,en,g(this,bl,t)),g(this,or,i.scale*(globalThis.devicePixelRatio||1)),g(this,_l,i.rotation),g(this,hs,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;g(this,vh,[1,0,0,-1,-a,o+r]),g(this,gh,s),g(this,ph,r),x(c=Ze,Tn,gb).call(c),go(t,i),l(this,ar).promise.finally(()=>{l(Ze,kl).delete(this),g(this,hs,null),g(this,El,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Wt.platform;return re(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,ka).read().then(({value:t,done:i})=>{if(i){l(this,ar).resolve();return}l(this,Ca)??g(this,Ca,t.lang),Object.assign(l(this,El),t.styles),x(this,js,fb).call(this,t.items),e()},l(this,ar).reject)};return g(this,ka,l(this,Cl).getReader()),l(Ze,kl).add(this),e(),l(this,ar).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==l(this,_l)&&(t==null||t(),g(this,_l,s),go(l(this,bl),{rotation:s})),i!==l(this,or)){t==null||t(),g(this,or,i);const a={div:null,properties:null,ctx:x(r=Ze,Tn,sf).call(r,l(this,Ca))};for(const o of l(this,Ta))a.properties=l(this,yh).get(o),a.div=o,x(this,js,ry).call(this,a)}}cancel(){var t;const e=new jr("TextLayer task cancelled.");(t=l(this,ka))==null||t.cancel(e).catch(()=>{}),g(this,ka,null),l(this,ar).reject(e)}get textDivs(){return l(this,Ta)}get textContentItemsStr(){return l(this,mh)}static cleanup(){if(!(l(this,kl).size>0)){l(this,Pa).clear();for(const{canvas:e}of l(this,Na).values())e.remove();l(this,Na).clear()}}};ar=new WeakMap,en=new WeakMap,dh=new WeakMap,fh=new WeakMap,Ca=new WeakMap,hs=new WeakMap,ph=new WeakMap,gh=new WeakMap,ka=new WeakMap,bl=new WeakMap,_l=new WeakMap,or=new WeakMap,El=new WeakMap,mh=new WeakMap,Cl=new WeakMap,Ta=new WeakMap,yh=new WeakMap,vh=new WeakMap,Pa=new WeakMap,Na=new WeakMap,wh=new WeakMap,lr=new WeakMap,kl=new WeakMap,js=new WeakSet,fb=function(e){var s,r;if(l(this,dh))return;(r=l(this,hs)).ctx??(r.ctx=x(s=Ze,Tn,sf).call(s,l(this,Ca)));const t=l(this,Ta),i=l(this,mh);for(const a of e){if(t.length>vT){ne("Ignoring additional textDivs for performance reasons."),g(this,dh,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,en);g(this,en,document.createElement("span")),l(this,en).classList.add("markedContent"),a.id!==null&&l(this,en).setAttribute("id",`${a.id}`),o.append(l(this,en))}else a.type==="endMarkedContent"&&g(this,en,l(this,en).parentNode);continue}i.push(a.str),x(this,js,pb).call(this,a)}},pb=function(e){var A;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ta).push(t);const s=G.transform(l(this,vh),e.transform);let r=Math.atan2(s[1],s[0]);const a=l(this,El)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,fh)&&a.fontSubstitution||a.fontFamily;o=Ze.fontFamilyMap.get(o)||o;const c=Math.hypot(s[2],s[3]),u=c*x(A=Ze,Tn,mb).call(A,o,l(this,Ca));let h,d;r===0?(h=s[4],d=s[5]-u):(h=s[4]+u*Math.sin(r),d=s[5]-u*Math.cos(r));const f="calc(var(--scale-factor)*",p=t.style;l(this,en)===l(this,bl)?(p.left=`${(100*h/l(this,gh)).toFixed(2)}%`,p.top=`${(100*d/l(this,ph)).toFixed(2)}%`):(p.left=`${f}${h.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(l(Ze,lr)*c).toFixed(2)}px)`,p.fontFamily=o,i.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,fh)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);_!==y&&Math.max(_,y)/Math.min(_,y)>1.5&&(m=!0)}if(m&&(i.canvasWidth=a.vertical?e.height:e.width),l(this,yh).set(t,i),l(this,hs).div=t,l(this,hs).properties=i,x(this,js,ry).call(this,l(this,hs)),i.hasText&&l(this,en).append(t),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),l(this,en).append(_)}},ry=function(e){var o;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let a="";if(l(Ze,lr)>1&&(a=`scale(${1/l(Ze,lr)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=i;x(o=Ze,Tn,ay).call(o,s,h*l(this,or),c);const{width:d}=s.measureText(t.textContent);d>0&&(a=`scaleX(${u*l(this,or)/d}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Tn=new WeakSet,sf=function(e=null){let t=l(this,Na).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Na).set(e,t),l(this,wh).set(t,{size:0,family:""})}return t},ay=function(e,t,i){const s=l(this,wh).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},gb=function(){if(l(this,lr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),g(this,lr,e.getBoundingClientRect().height),e.remove()},mb=function(e,t){const i=l(this,Pa).get(e);if(i)return i;const s=x(this,Tn,sf).call(this,t);s.canvas.width=s.canvas.height=Kt,x(this,Tn,ay).call(this,s,Kt,e);const r=s.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return l(this,Pa).set(e,h),s.canvas.width=s.canvas.height=0,h}s.strokeStyle="red",s.clearRect(0,0,Kt,Kt),s.strokeText("g",0,0);let c=s.getImageData(0,0,Kt,Kt).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/Kt);break}s.clearRect(0,0,Kt,Kt),s.strokeText("A",0,Kt),c=s.getImageData(0,0,Kt,Kt).data,a=0;for(let h=0,d=c.length;h<d;h+=4)if(c[h]>0){a=Kt-Math.floor(h/4/Kt);break}s.canvas.width=s.canvas.height=0;const u=a?a/(a+o):wT;return l(this,Pa).set(e,u),u},S(Ze,Tn),S(Ze,Pa,new Map),S(Ze,Na,new Map),S(Ze,wh,new WeakMap),S(Ze,lr,null),S(Ze,kl,new Set);let Pu=Ze;class Nu{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Nu.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)s(u)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const AT=65536,ST=100,xT=5e3,bT=Dt?Ok:Ik,_T=Dt?jk:tb,ET=Dt?Fk:Dk,CT=Dt?zk:rb;function kT(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new oy,{docId:t}=e,i=n.url?TT(n.url):null,s=n.data?PT(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof yb?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:AT;let h=n.worker instanceof nl?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Xp(n.docBaseUrl)?n.docBaseUrl:null,p=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,A=n.CMapReaderFactory||_T,_=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,y=n.StandardFontDataFactory||CT,w=n.stopAtErrors!==!0,b=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Dt,T=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Dt&&(Wt.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,P=typeof n.disableFontFace=="boolean"?n.disableFontFace:Dt,D=n.fontExtraProperties===!0,M=n.enableXfa===!0,$=n.ownerDocument||globalThis.document,O=n.disableRange===!0,Z=n.disableStream===!0,J=n.disableAutoFetch===!0,Ae=n.pdfBug===!0,j=n.CanvasFactory||bT,W=n.FilterFactory||ET,I=n.enableHWA===!0,X=c?c.length:n.length??NaN,q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Dt&&!P,ae=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:A===tb&&y===rb&&p&&_&&Fc(p,document.baseURI)&&Fc(_,document.baseURI),oe=null;dk(d);const be={canvasFactory:new j({ownerDocument:$,enableHWA:I}),filterFactory:new W({docId:t,ownerDocument:$}),cMapReaderFactory:ae?null:new A({baseUrl:p,isCompressed:m}),standardFontDataFactory:ae?null:new y({baseUrl:_})};if(!h){const Ee={verbosity:d,port:ks.workerPort};h=Ee.port?nl.fromPort(Ee):new nl(Ee),e._worker=h}const ft={docId:t,apiVersion:"4.10.38",data:s,password:o,disableAutoFetch:J,rangeChunkSize:u,length:X,docBaseUrl:f,enableXfa:M,evaluatorOptions:{maxImageSize:b,disableFontFace:P,ignoreErrors:w,isEvalSupported:E,isOffscreenCanvasSupported:C,isImageDecoderSupported:T,canvasMaxAreaInBytes:k,fontExtraProperties:D,useSystemFonts:q,cMapUrl:ae?p:null,standardFontDataUrl:ae?_:null}},cn={disableFontFace:P,fontExtraProperties:D,ownerDocument:$,pdfBug:Ae,styleElement:oe,loadingParams:{disableAutoFetch:J,enableXfa:M}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ee=h.messageHandler.sendWithPromise("GetDocRequest",ft,s?[s.buffer]:null);let ue;if(c)ue=new nT(c,{disableRange:O,disableStream:Z});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Qn;if(Dt)if(Fc(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Qn=jw}else Qn=gT;else Qn=Fc(i)?jw:uT;ue=new Qn({url:i,length:X,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:O,disableStream:Z})}return Ee.then(Qn=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const _o=new Bc(t,Qn,h.port),hd=new MT(_o,e,ue,cn,be);e._transport=hd,_o.send("Ready",null)})}).catch(e._capability.reject),e}function TT(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Dt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function PT(n){if(Dt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Wp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function zw(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var dp;const fp=class fp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ot(fp,dp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};dp=new WeakMap,S(fp,dp,0);let oy=fp;class yb{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){_e("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class NT{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var cr,ds,$n,Lo,rf;class RT{constructor(e,t,i,s=!1){S(this,$n);S(this,cr,null);S(this,ds,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new Ew:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new vb,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new ld({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=Gs.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const f=this._transport.getRenderingIntent(i,s,h,d),{renderingIntent:p,cacheKey:m}=f;g(this,ds,!1),x(this,$n,rf).call(this),o||(o=this._transport.getOptionalContentConfig(p));let A=this._intentStates.get(m);A||(A=Object.create(null),this._intentStates.set(m,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const _=!!(p&xn.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(f));const y=T=>{var k;A.renderTasks.delete(w),(this._maybeCleanupAfterRender||_)&&g(this,ds,!0),x(this,$n,Lo).call(this,!_),T?(w.capability.reject(T),this._abortOperatorList({intentState:A,reason:T instanceof Error?T:new Error(T)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new cy({callback:y,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:u});(A.renderTasks||(A.renderTasks=new Set)).add(w);const b=w.task;return Promise.all([A.displayReadyCapability.promise,o]).then(([T,k])=>{var P;if(this.destroyed){y();return}if((P=this._stats)==null||P.time("Rendering"),!(k.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:T,optionalContentConfig:k}),w.operatorListChanged()}).catch(y),b}getOperatorList({intent:e="display",annotationMode:t=Gs.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Nu.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:c,done:u}){if(u){i(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),g(this,ds,!1),x(this,$n,rf).call(this),Promise.all(e)}cleanup(e=!1){g(this,ds,!0);const t=x(this,$n,Lo).call(this,!1);return e&&t&&this._stats&&(this._stats=new Ew),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&x(this,$n,Lo).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();x(this,$n,Lo).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Uv){let s=ST;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new jr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}cr=new WeakMap,ds=new WeakMap,$n=new WeakSet,Lo=function(e=!1){if(x(this,$n,rf).call(this),!l(this,ds)||this.destroyed)return!1;if(e)return g(this,cr,setTimeout(()=>{g(this,cr,null),x(this,$n,Lo).call(this,!1)},xT)),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,ds,!1),!0},rf=function(){l(this,cr)&&(clearTimeout(l(this,cr)),g(this,cr,null))};var fs,pp;class LT{constructor(){S(this,fs,new Map);S(this,pp,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};l(this,pp).then(()=>{for(const[s]of l(this,fs))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,fs).set(t,s)}removeEventListener(e,t){const i=l(this,fs).get(t);i==null||i(),l(this,fs).delete(t)}terminate(){for(const[,e]of l(this,fs))e==null||e();l(this,fs).clear()}}fs=new WeakMap,pp=new WeakMap;var gp,Ra,La,Tl,af,Pl,of;const Re=class Re{constructor({name:e=null,port:t=null,verbosity:i=fk()}={}){S(this,Tl);var s;if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=l(Re,La))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(Re,La)||g(Re,La,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Bc("main","worker",e),this._messageHandler.on("ready",function(){}),x(this,Tl,af).call(this)}_initialize(){if(l(Re,Ra)||l(Re,Pl,of)){this._setupFakeWorker();return}let{workerSrc:e}=Re;try{Re._isSameOrigin(window.location.href,e)||(e=Re._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Bc("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,x(this,Tl,af).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Vp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Re,Ra)||(ne("Setting up fake worker."),g(Re,Ra,!0)),Re._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LT;this._port=t;const i=`fake${Ot(Re,gp)._++}`,s=new Bc(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new Bc(i,i+"_worker",t),x(this,Tl,af).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,i;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(Re,La))==null||t.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(e){var i;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(i=l(this,La))==null?void 0:i.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Re(e)}static get workerSrc(){if(ks.workerSrc)return ks.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return re(this,"_setupFakeWorkerGlobal",(async()=>l(this,Pl,of)?l(this,Pl,of):(await import(this.workerSrc)).WorkerMessageHandler)())}};gp=new WeakMap,Ra=new WeakMap,La=new WeakMap,Tl=new WeakSet,af=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Pl=new WeakSet,of=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},S(Re,Pl),S(Re,gp,0),S(Re,Ra,!1),S(Re,La),Dt&&(g(Re,Ra,!0),ks.workerSrc||(ks.workerSrc="./pdf.worker.mjs")),Re._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(t,i);return i.origin===s.origin},Re._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let nl=Re;var ps,Oi,Nl,Rl,gs,Ma,Wc;class MT{constructor(e,t,i,s,r){S(this,Ma);S(this,ps,new Map);S(this,Oi,new Map);S(this,Nl,new Map);S(this,Rl,new Map);S(this,gs,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new vb,this.fontLoader=new Lk({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return re(this,"annotationStorage",new Gv)}getRenderingIntent(e,t=Gs.ENABLE,i=null,s=!1,r=!1){let a=xn.DISPLAY,o=Km;switch(e){case"any":a=xn.ANY;break;case"display":break;case"print":a=xn.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=a&xn.PRINT&&i instanceof Yx?i:this.annotationStorage;switch(t){case Gs.DISABLE:a+=xn.ANNOTATIONS_DISABLE;break;case Gs.ENABLE:break;case Gs.ENABLE_FORMS:a+=xn.ANNOTATIONS_FORMS;break;case Gs.ENABLE_STORAGE:a+=xn.ANNOTATIONS_STORAGE,o=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=xn.IS_EDITING),r&&(a+=xn.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=l(this,gs))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of l(this,Oi).values())e.push(s._destroy());l(this,Oi).clear(),l(this,Nl).clear(),l(this,Rl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,ps).clear(),this.filterFactory.destroy(),Pu.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new jr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Ye(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){s.close();return}Ye(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{Ye(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}Ye(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new NT(i,this))}),e.on("DocException",i=>{t._capability.reject(Qt(i))}),e.on("PasswordRequest",i=>{g(this,gs,Promise.withResolvers());try{if(!t.onPassword)throw Qt(i);const s=r=>{r instanceof Error?l(this,gs).reject(r):l(this,gs).resolve({password:r})};t.onPassword(s,i.code)}catch(s){l(this,gs).reject(s)}return l(this,gs).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;l(this,Oi).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const p=r.error;ne(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const h=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,d=new Mk(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=r;Ye(f,"The imageRef must be defined.");for(const p of l(this,Oi).values())for(const[,m]of p.objs)if((m==null?void 0:m.ref)===f)return m.dataLen?(this.commonObjs.resolve(i,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var c;if(this.destroyed)return;const o=l(this,Oi).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(i,a),(a==null?void 0:a.dataLen)>lk&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=l(this,Nl).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Rl).set(r.refStr,e);const a=new RT(t,r,this,this._params.pdfBug);return l(this,Oi).set(t,a),a});return l(this,Nl).set(t,s),s}getPageIndex(e){return zw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return x(this,Ma,Wc).call(this,"GetFieldObjects")}hasJSActions(){return x(this,Ma,Wc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return x(this,Ma,Wc).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return x(this,Ma,Wc).call(this,"GetOptionalContentConfig").then(t=>new tT(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,ps).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new Zk(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,ps).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,Oi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,ps).clear(),this.filterFactory.destroy(!0),Pu.cleanup()}}cachedPageNumber(e){if(!zw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Rl).get(t)??null}}ps=new WeakMap,Oi=new WeakMap,Nl=new WeakMap,Rl=new WeakMap,gs=new WeakMap,Ma=new WeakSet,Wc=function(e,t=null){const i=l(this,ps).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return l(this,ps).set(e,s),s};const Nc=Symbol("INITIAL_DATA");var fn,Ah,ly;class vb{constructor(){S(this,Ah);S(this,fn,Object.create(null))}get(e,t=null){if(t){const s=x(this,Ah,ly).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=l(this,fn)[e];if(!i||i.data===Nc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=l(this,fn)[e];return!!t&&t.data!==Nc}delete(e){const t=l(this,fn)[e];return!t||t.data===Nc?!1:(delete l(this,fn)[e],!0)}resolve(e,t=null){const i=x(this,Ah,ly).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in l(this,fn)){const{data:i}=l(this,fn)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}g(this,fn,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,fn)){const{data:t}=l(this,fn)[e];t!==Nc&&(yield[e,t])}}}fn=new WeakMap,Ah=new WeakSet,ly=function(e){var t;return(t=l(this,fn))[e]||(t[e]={...Promise.withResolvers(),data:Nc})};var ur;class IT{constructor(e){S(this,ur,null);g(this,ur,e),this.onContinue=null}get promise(){return l(this,ur).capability.promise}cancel(e=0){l(this,ur).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,ur).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,ur);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ur=new WeakMap;var hr,Ia;const Jr=class Jr{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){S(this,hr,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new IT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(Jr,Ia).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Jr,Ia).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:a}=this.params;this.gfx=new tl(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),l(this,hr)&&(window.cancelAnimationFrame(l(this,hr)),g(this,hr,null)),l(Jr,Ia).delete(this._canvas),this.callback(e||new Uv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,hr,window.requestAnimationFrame(()=>{g(this,hr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Jr,Ia).delete(this._canvas),this.callback())))}};hr=new WeakMap,Ia=new WeakMap,S(Jr,Ia,new WeakSet);let cy=Jr;const DT="4.10.38",FT="f9bea397f";function Bw(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Rc(n){return Math.max(0,Math.min(255,255*n))}class Hw{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Rc(e),[e,e,e]}static G_HTML([e]){const t=Bw(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Rc)}static RGB_HTML(e){return`#${e.map(Bw).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Rc(1-Math.min(1,e+s)),Rc(1-Math.min(1,i+s)),Rc(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class OT{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){_e("Abstract method `_createSVG` called.")}}class qv extends OT{_createSVG(e){return document.createElementNS(Yi,e)}}class wb{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;s.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var d,f;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);a.append(p),o&&Nu.shouldBuildText(s.name)&&u.push(p)}return{textDivs:u}}const h=[[s,-1,a]];for(;h.length>0;){const[p,m,A]=h.at(-1);if(m+1===p.children.length){h.pop();continue}const _=p.children[++h.at(-1)[1]];if(_===null)continue;const{name:y}=_;if(y==="#text"){const b=document.createTextNode(_.value);u.push(b),A.append(b);continue}const w=(d=_==null?void 0:_.attributes)!=null&&d.xmlns?document.createElementNS(_.attributes.xmlns,y):document.createElement(y);if(A.append(w),_.attributes&&this.setAttributes({html:w,element:_,storage:t,intent:r,linkService:i}),((f=_.children)==null?void 0:f.length)>0)h.push([_,-1,w]);else if(_.value){const b=document.createTextNode(_.value);o&&Nu.shouldBuildText(y)&&u.push(b),w.append(b)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ud=1e3,jT=9,yo=new WeakSet;function Dr(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class zT{static create(e){switch(e.data.annotationType){case Je.LINK:return new Ab(e);case Je.TEXT:return new BT(e);case Je.WIDGET:switch(e.data.fieldType){case"Tx":return new HT(e);case"Btn":return e.data.radioButton?new bb(e):e.data.checkBox?new $T(e):new VT(e);case"Ch":return new WT(e);case"Sig":return new UT(e)}return new bo(e);case Je.POPUP:return new hy(e);case Je.FREETEXT:return new Tb(e);case Je.LINE:return new XT(e);case Je.SQUARE:return new qT(e);case Je.CIRCLE:return new YT(e);case Je.POLYLINE:return new Pb(e);case Je.CARET:return new QT(e);case Je.INK:return new Yv(e);case Je.POLYGON:return new KT(e);case Je.HIGHLIGHT:return new Nb(e);case Je.UNDERLINE:return new JT(e);case Je.SQUIGGLY:return new ZT(e);case Je.STRIKEOUT:return new eP(e);case Je.STAMP:return new Rb(e);case Je.FILEATTACHMENT:return new tP(e);default:return new Ge(e)}}}var Da,Ll,Ml,Sh,uy;const Zv=class Zv{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){S(this,Sh);S(this,Da,null);S(this,Ll,!1);S(this,Ml,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e!=null&&e.str||t!=null&&t.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Zv._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;l(this,Da)||g(this,Da,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&x(this,Sh,uy).call(this,t),(i=l(this,Ml))==null||i.popup.updateEdited(e)}resetEdited(){var e;l(this,Da)&&(x(this,Sh,uy).call(this,l(this,Da).rect),(e=l(this,Ml))==null||e.popup.resetEdited(),g(this,Da,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof bo||(r.tabIndex=ud);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof hy){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,r),r}const{width:o,height:c}=Dr(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(A>0||_>0){const w=`calc(${A}px * var(--scale-factor)) / calc(${_}px * var(--scale-factor))`;a.borderRadius=w}else if(this instanceof bb){const w=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=w}switch(t.borderStyle.style){case Tc.SOLID:a.borderStyle="solid";break;case Tc.DASHED:a.borderStyle="dashed";break;case Tc.BEVELED:ne("Unimplemented border style: beveled");break;case Tc.INSET:ne("Unimplemented border style: inset");break;case Tc.UNDERLINE:a.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(g(this,Ll,!0),a.borderColor=G.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):a.borderWidth=0}const u=G.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:p}=s.rawDims;a.left=`${100*(u[0]-f)/h}%`,a.top=`${100*(u[1]-p)/d}%`;const{rotation:m}=t;return t.hasOwnCanvas||m===0?(a.width=`${100*o/h}%`,a.height=`${100*c/d}%`):this.setRotation(m,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:a}=Dr(this.data.rect);let o,c;e%180===0?(o=100*r/i,c=100*a/s):(o=100*a/i,c=100*r/s),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=Hw[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Hw[`${a}_rgb`](o)})};return re(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,_,y,w]=e.subarray(2,6);if(s===A&&r===_&&t===y&&i===w)return}const{style:a}=this.container;let o;if(l(this,Ll)){const{borderColor:A,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const c=s-t,u=r-i,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const p=h.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let A=2,_=e.length;A<_;A+=8){const y=e[A],w=e[A+1],b=e[A+2],E=e[A+3],C=h.createElement("rect"),T=(b-t)/c,k=(r-w)/u,P=(y-b)/c,D=(w-E)/u;C.setAttribute("x",T),C.setAttribute("y",k),C.setAttribute("width",P),C.setAttribute("height",D),p.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${k}" width="${P}" height="${D}"/>`)}l(this,Ll)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{data:e}=this,t=g(this,Ml,new hy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){_e("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!yo.has(u)){ne(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:c,domElement:u})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&yo.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Da=new WeakMap,Ll=new WeakMap,Ml=new WeakMap,Sh=new WeakSet,uy=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;i==null||i.splice(0,4,...e);const{width:u,height:h}=Dr(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,s===0?(t.width=`${100*u/r}%`,t.height=`${100*h/a}%`):this.setRotation(s)};let Ge=Zv;var _n,qr,Sb,xb;class Ab extends Ge{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});S(this,_n);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(x(this,_n,Sb).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(x(this,_n,xb).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&x(this,_n,qr).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),x(this,_n,qr).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),x(this,_n,qr).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),x(this,_n,qr).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var d;s==null||s();const{fields:r,refs:a,include:o}=i,c=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:A}of m)f.add(A)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===o&&c.push(m)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:p}=f;switch(h.push(p),f.type){case"text":{const A=f.defaultValue||"";u.setValue(p,{value:A});break}case"checkbox":case"radiobutton":{const A=f.defaultValue===f.exportValues;u.setValue(p,{value:A});break}case"combobox":case"listbox":{const A=f.defaultValue||"";u.setValue(p,{value:A});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!yo.has(m)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}_n=new WeakSet,qr=function(){this.container.setAttribute("data-internal-link","")},Sb=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},x(this,_n,qr).call(this)},xb=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),x(this,_n,qr).call(this)};class BT extends Ge{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class bo extends Ge{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Wt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[c,u]of i)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,s),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":G.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||jT,r=e.style;let a;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(Cg*s))||1,d=u/h;a=Math.min(s,c(d/Cg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,c(u/Cg))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=G.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class HT extends bo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",u??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),yo.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=ud,this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";i.value=h.userValue=p,h.formattedValue=null});let d=f=>{const{formattedValue:p}=h;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",p=>{var A;if(h.focused)return;const{target:m}=p;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(A=this.data.actions)!=null&&A.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(A){h.userValue=A.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),A.target.value=h.userValue},formattedValue(A){const{formattedValue:_}=A.detail;h.formattedValue=_,_!=null&&A.target!==document.activeElement&&(A.target.value=_),e.setValue(t,{formattedValue:_})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{var b;const{charLimit:_}=A.detail,{target:y}=A;if(_===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",_);let w=h.userValue;!w||w.length<=_||(w=w.slice(0,_),y.value=h.userValue=w,e.setValue(t,{value:w}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),i.addEventListener("keydown",p=>{var _;h.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:A}=p.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=d;d=null,i.addEventListener("blur",p=>{var A,_;if(!h.focused||!p.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(h.focused=!1);const{value:m}=p.target;h.userValue=m,h.lastCommittedValue!==m&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",p=>{var C;h.lastCommittedValue=null;const{data:m,target:A}=p,{value:_,selectionStart:y,selectionEnd:w}=A;let b=y,E=w;switch(p.inputType){case"deleteWordBackward":{const T=_.substring(0,y).match(/\w*[^\w]*$/);T&&(b-=T[0].length);break}case"deleteWordForward":{const T=_.substring(y).match(/^[^\w]*\w*/);T&&(E+=T[0].length);break}case"deleteContentBackward":y===w&&(b-=1);break;case"deleteContentForward":y===w&&(E+=1);break}p.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:m||"",willCommit:!1,selStart:b,selEnd:E}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class UT extends bo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class $T extends bo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return yo.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=ud,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,i)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(i,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class bb extends bo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(yo.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=ud,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,i))e.setValue(u.id,{value:!1});e.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===i;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class VT extends Ab{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class WT extends bo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");yo.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=ud;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of s.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,i.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),s.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:f,multiple:p}=s;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=o(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const d={value(f){a==null||a();const p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(const A of s.options)A.selected=m.has(A.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(f){s.multiple=!0},remove(f){const p=s.options,m=f.detail.remove;p[m].selected=!1,s.remove(m),p.length>0&&Array.prototype.findIndex.call(p,_=>_.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},clear(f){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(f){const{index:p,displayValue:m,exportValue:A}=f.detail.insert,_=s.children[p],y=document.createElement("option");y.textContent=m,y.value=A,_?_.before(y):s.append(y),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},items(f){const{items:p}=f.detail;for(;s.length!==0;)s.remove(0);for(const m of p){const{displayValue:A,exportValue:_}=m,y=document.createElement("option");y.textContent=A,y.value=_,s.append(y)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},indices(f){const p=new Set(f.detail.indices);for(const m of f.target.options)m.selected=p.has(m.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),s.addEventListener("input",h=>{var p;const d=o(!0),f=o(!1);e.setValue(t,{value:d}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hy extends Ge{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Ge._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new GT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Hv}${i}`).join(",")),this.container}}var Il,mp,yp,Dl,Fa,He,ms,Fl,xh,bh,Ol,ys,ai,vs,_h,ws,Eh,Oa,ja,xe,lf,dy,_b,Eb,Cb,kb,cf,uf,fy;class GT{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:u,parentRect:h,open:d}){S(this,xe);S(this,Il,x(this,xe,Cb).bind(this));S(this,mp,x(this,xe,fy).bind(this));S(this,yp,x(this,xe,uf).bind(this));S(this,Dl,x(this,xe,cf).bind(this));S(this,Fa,null);S(this,He,null);S(this,ms,null);S(this,Fl,null);S(this,xh,null);S(this,bh,null);S(this,Ol,null);S(this,ys,!1);S(this,ai,null);S(this,vs,null);S(this,_h,null);S(this,ws,null);S(this,Eh,null);S(this,Oa,null);S(this,ja,!1);var f;g(this,He,e),g(this,Eh,s),g(this,ms,a),g(this,ws,o),g(this,bh,c),g(this,Fa,t),g(this,_h,u),g(this,Ol,h),g(this,xh,i),g(this,Fl,Vv.toDateObject(r)),this.trigger=i.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Dl)),p.addEventListener("mouseenter",l(this,yp)),p.addEventListener("mouseleave",l(this,mp)),p.classList.add("popupTriggerArea");for(const p of i)(f=p.container)==null||f.addEventListener("keydown",l(this,Il));l(this,He).hidden=!0,d&&x(this,xe,cf).call(this)}render(){if(l(this,ai))return;const e=g(this,ai,document.createElement("div"));if(e.className="popup",l(this,Fa)){const r=e.style.outlineColor=G.makeHexColor(...l(this,Fa));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=G.makeHexColor(...l(this,Fa).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=l(this,Eh),e.append(t),l(this,Fl)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Fl).valueOf()})),t.append(r)}const s=l(this,xe,lf);if(s)wb.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,ms));e.append(r)}l(this,He).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,a=s.length;r<a;++r){const o=s[r];i.append(document.createTextNode(o)),r<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;l(this,Oa)||g(this,Oa,{contentsObj:l(this,ms),richText:l(this,ws)}),e&&g(this,vs,null),t&&(g(this,ws,x(this,xe,Eb).call(this,t)),g(this,ms,null)),(i=l(this,ai))==null||i.remove(),g(this,ai,null)}resetEdited(){var e;l(this,Oa)&&({contentsObj:Ot(this,ms)._,richText:Ot(this,ws)._}=l(this,Oa),g(this,Oa,null),(e=l(this,ai))==null||e.remove(),g(this,ai,null),g(this,vs,null))}forceHide(){g(this,ja,this.isVisible),l(this,ja)&&(l(this,He).hidden=!0)}maybeShow(){l(this,ja)&&(l(this,ai)||x(this,xe,uf).call(this),g(this,ja,!1),l(this,He).hidden=!1)}get isVisible(){return l(this,He).hidden===!1}}Il=new WeakMap,mp=new WeakMap,yp=new WeakMap,Dl=new WeakMap,Fa=new WeakMap,He=new WeakMap,ms=new WeakMap,Fl=new WeakMap,xh=new WeakMap,bh=new WeakMap,Ol=new WeakMap,ys=new WeakMap,ai=new WeakMap,vs=new WeakMap,_h=new WeakMap,ws=new WeakMap,Eh=new WeakMap,Oa=new WeakMap,ja=new WeakMap,xe=new WeakSet,lf=function(){const e=l(this,ws),t=l(this,ms);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,ws).html||null},dy=function(){var e,t,i;return((i=(t=(e=l(this,xe,lf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},_b=function(){var e,t,i;return((i=(t=(e=l(this,xe,lf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},Eb=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:l(this,xe,_b),fontSize:l(this,xe,dy)?`calc(${l(this,xe,dy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},Cb=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,ys))&&x(this,xe,cf).call(this)},kb=function(){if(l(this,vs)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=l(this,bh);let a=!!l(this,Ol),o=a?l(this,Ol):l(this,_h);for(const m of l(this,xh))if(!o||G.intersect(m.data.rect,o)!==null){o=m.data.rect,a=!0;break}const c=G.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=c[0]+h,f=c[1];g(this,vs,[100*(d-s)/t,100*(f-r)/i]);const{style:p}=l(this,He);p.left=`${l(this,vs)[0]}%`,p.top=`${l(this,vs)[1]}%`},cf=function(){g(this,ys,!l(this,ys)),l(this,ys)?(x(this,xe,uf).call(this),l(this,He).addEventListener("click",l(this,Dl)),l(this,He).addEventListener("keydown",l(this,Il))):(x(this,xe,fy).call(this),l(this,He).removeEventListener("click",l(this,Dl)),l(this,He).removeEventListener("keydown",l(this,Il)))},uf=function(){l(this,ai)||this.render(),this.isVisible?l(this,ys)&&l(this,He).classList.add("focused"):(x(this,xe,kb).call(this),l(this,He).hidden=!1,l(this,He).style.zIndex=parseInt(l(this,He).style.zIndex)+1e3)},fy=function(){l(this,He).classList.remove("focused"),!(l(this,ys)||!this.isVisible)&&(l(this,He).hidden=!0,l(this,He).style.zIndex=parseInt(l(this,He).style.zIndex)-1e3)};class Tb extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=te.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ch;class XT extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Ch,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:i,height:s}=Dr(t.rect),r=this.svgFactory.create(i,s,!0),a=g(this,Ch,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Ch)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ch=new WeakMap;var kh;class qT extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,kh,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:i,height:s}=Dr(t.rect),r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=g(this,kh,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,kh)}addHighlightArea(){this.container.classList.add("highlightArea")}}kh=new WeakMap;var Th;class YT extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Th,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:i,height:s}=Dr(t.rect),r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=g(this,Th,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Th)}addHighlightArea(){this.container.classList.add("highlightArea")}}Th=new WeakMap;var Ph;class Pb extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Ph,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r}}=this;if(!i)return this.container;const{width:a,height:o}=Dr(t),c=this.svgFactory.create(a,o,!0);let u=[];for(let d=0,f=i.length;d<f;d+=2){const p=i[d]-t[0],m=t[3]-i[d+1];u.push(`${p},${m}`)}u=u.join(" ");const h=g(this,Ph,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Ph)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ph=new WeakMap;class KT extends Pb{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class QT extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Nh,za,Rh,py;class Yv extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Rh);S(this,Nh,null);S(this,za,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?te.HIGHLIGHT:te.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:u}=x(this,Rh,py).call(this,i,t),h=this.svgFactory.create(c,u,!0),d=g(this,Nh,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let f=0,p=s.length;f<p;f++){const m=this.svgFactory.createElement(this.svgElementName);l(this,za).push(m),m.setAttribute("points",s[f].join(",")),d.append(m)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=l(this,Nh);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,c=l(this,za).length;o<c;o++)l(this,za)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:c,height:u}=x(this,Rh,py).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,za)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nh=new WeakMap,za=new WeakMap,Rh=new WeakSet,py=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class Nb extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=te.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class JT extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ZT extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class eP extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Rb extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=te.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Lh,Mh,gy;class tP extends Ge{constructor(t){var s;super(t,{isRenderable:!0});S(this,Mh);S(this,Lh,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",x(this,Mh,gy).bind(this)),g(this,Lh,s);const{isMac:r}=Wt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&x(this,Mh,gy).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return l(this,Lh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lh=new WeakMap,Mh=new WeakSet,gy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Ih,Ba,Ha,Dh,vo,Lb,my;class nP{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o}){S(this,vo);S(this,Ih,null);S(this,Ba,null);S(this,Ha,new Map);S(this,Dh,null);this.div=e,g(this,Ih,t),g(this,Ba,i),g(this,Dh,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return l(this,Ha).size>0}async render(e){var a;const{annotations:t}=e,i=this.div;go(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new qv,annotationStorage:e.annotationStorage||new Gv,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===Je.POPUP;if(c){const d=s.get(o.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=Dr(o.rect);if(d<=0||f<=0)continue}r.data=o;const u=zT.create(r);if(!u.isRenderable)continue;if(!c&&o.popupRef){const d=s.get(o.popupRef);d?d.push(u):s.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await x(this,vo,Lb).call(this,h,o.id),u._isEditable&&(l(this,Ha).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}x(this,vo,my).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,go(t,{rotation:e.rotation}),x(this,vo,my).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,Ha).values())}getEditableAnnotation(e){return l(this,Ha).get(e)}}Ih=new WeakMap,Ba=new WeakMap,Ha=new WeakMap,Dh=new WeakMap,vo=new WeakSet,Lb=async function(e,t){var a,o;const i=e.firstChild||e,s=i.id=`${Hv}${t}`,r=await((a=l(this,Dh))==null?void 0:a.getAriaAttributes(s));if(r)for(const[c,u]of r)i.setAttribute(c,u);this.div.append(e),(o=l(this,Ih))==null||o.moveElementInDOM(this.div,e,i,!1)},my=function(){if(!l(this,Ba))return;const e=this.div;for(const[t,i]of l(this,Ba)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}l(this,Ba).clear()};const Ld=/\r\n?|\n/g;var oi,pn,Fh,Ua,gn,Qe,Mb,Ib,Db,hf,Ls,df,ff,Fb,vy,Ob;const Ce=class Ce extends je{constructor(t){super({...t,name:"freeTextEditor"});S(this,Qe);S(this,oi);S(this,pn,"");S(this,Fh,`${this.id}-editor`);S(this,Ua,null);S(this,gn);g(this,oi,t.color||Ce._defaultColor||je._defaultLineColor),g(this,gn,t.fontSize||Ce._defaultFontSize)}static get _keyboardManager(){const t=Ce.prototype,i=a=>a.isEmpty(),s=mo.TRANSLATE_SMALL,r=mo.TRANSLATE_BIG;return re(this,"_keyboardManager",new cd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){je.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case ce.FREETEXT_SIZE:Ce._defaultFontSize=i;break;case ce.FREETEXT_COLOR:Ce._defaultColor=i;break}}updateParams(t,i){switch(t){case ce.FREETEXT_SIZE:x(this,Qe,Mb).call(this,i);break;case ce.FREETEXT_COLOR:x(this,Qe,Ib).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ce.FREETEXT_SIZE,Ce._defaultFontSize],[ce.FREETEXT_COLOR,Ce._defaultColor||je._defaultLineColor]]}get propertiesToUpdate(){return[[ce.FREETEXT_SIZE,l(this,gn)],[ce.FREETEXT_COLOR,l(this,oi)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ce._internalPadding*t,-(Ce._internalPadding+l(this,gn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(te.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,Ua,new AbortController);const t=this._uiManager.combinedSignal(l(this,Ua));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,Fh)),this._isDraggable=!0,(t=l(this,Ua))==null||t.abort(),g(this,Ua,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,pn),i=g(this,pn,x(this,Qe,Db).call(this).trimEnd());if(t===i)return;const s=r=>{if(g(this,pn,r),!r){this.remove();return}x(this,Qe,ff).call(this),this._uiManager.rebuild(this),x(this,Qe,hf).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),x(this,Qe,hf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ce._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,Fh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${l(this,gn)}px * var(--scale-factor))`,s.color=l(this,oi),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Yf(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,p]=this.pageTranslation;let m,A;switch(this.rotation){case 0:m=t+(o[0]-f)/h,A=i+this.height-(o[1]-p)/d;break;case 90:m=t+(o[0]-f)/h,A=i-(o[1]-p)/d,[c,u]=[u,-c];break;case 180:m=t-this.width+(o[0]-f)/h,A=i-(o[1]-p)/d,[c,u]=[-c,-u];break;case 270:m=t+(o[0]-f-this.height*d)/h,A=i+(o[1]-p-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(m*r,A*a,c,u)}else this.setAt(t*r,i*a,this.width*r,this.height*a);x(this,Qe,ff).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var m,A,_;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=x(m=Ce,Ls,vy).call(m,i.getData("text")||"").replaceAll(Ld,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const y=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(Ld,"")),y!==this.editorDiv){let w=h;for(const b of this.editorDiv.childNodes){if(b===y){w=d;continue}w.push(x(A=Ce,Ls,df).call(A,b))}}h.push(c.nodeValue.slice(0,u).replaceAll(Ld,""))}else if(c===this.editorDiv){let y=h,w=0;for(const b of this.editorDiv.childNodes)w++===u&&(y=d),y.push(x(_=Ce,Ls,df).call(_,b))}g(this,pn,`${h.join(`
`)}${r}${d.join(`
`)}`),x(this,Qe,ff).call(this);const f=new Range;let p=h.reduce((y,w)=>y+w.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const w=y.nodeValue.length;if(p<=w){f.setStart(y,p),f.setEnd(y,p);break}p-=w}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var o;let r=null;if(t instanceof Tb){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:p},textContent:m,textPosition:A,parent:{page:{pageNumber:_}}}=t;if(!m||m.length===0)return null;r=t={annotationType:te.FREETEXT,color:Array.from(u),fontSize:c,value:m.join(`
`),position:A,pageIndex:_-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:p}}const a=await super.deserialize(t,i,s);return g(a,gn,t.fontSize),g(a,oi,G.makeHexColor(...t.color)),g(a,pn,x(o=Ce,Ls,vy).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Ce._internalPadding*this.parentScale,s=this.getRect(i,i),r=je._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,oi)),a={annotationType:te.FREETEXT,color:r,fontSize:l(this,gn),value:x(this,Qe,Fb).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!x(this,Qe,Ob).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${l(this,gn)}px * var(--scale-factor))`,s.color=l(this,oi),i.replaceChildren();for(const a of l(this,pn).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const r=Ce._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,pn)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};oi=new WeakMap,pn=new WeakMap,Fh=new WeakMap,Ua=new WeakMap,gn=new WeakMap,Qe=new WeakSet,Mb=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,gn))*this.parentScale),g(this,gn,r),x(this,Qe,hf).call(this)},s=l(this,gn);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ib=function(t){const i=r=>{g(this,oi,this.editorDiv.style.color=r)},s=l(this,oi);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Db=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(x(s=Ce,Ls,df).call(s,r)),i=r);return t.join(`
`)},hf=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},Ls=new WeakSet,df=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ld,"")},ff=function(){if(this.editorDiv.replaceChildren(),!!l(this,pn))for(const t of l(this,pn).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},Fb=function(){return l(this,pn).replaceAll(""," ")},vy=function(t){return t.replaceAll(" ","")},Ob=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},S(Ce,Ls),Y(Ce,"_freeTextDefaultContent",""),Y(Ce,"_internalPadding",0),Y(Ce,"_defaultColor",null),Y(Ce,"_defaultFontSize",10),Y(Ce,"_type","freetext"),Y(Ce,"_editorType",te.FREETEXT);let yy=Ce;class B{toSVGPath(){_e("Abstract method `toSVGPath` must be implemented.")}get box(){_e("Abstract getter `box` must be implemented.")}serialize(e,t){_e("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}Y(B,"PRECISION",1e-4);var mn,li,jl,zl,ji,se,$a,Va,Oh,jh,Bl,Hl,dr,zh,vp,wp,st,Gc,jb,zb,Bb,Hb,Ub,$b;const es=class es{constructor({x:e,y:t},i,s,r,a,o=0){S(this,st);S(this,mn);S(this,li,[]);S(this,jl);S(this,zl);S(this,ji,[]);S(this,se,new Float32Array(18));S(this,$a);S(this,Va);S(this,Oh);S(this,jh);S(this,Bl);S(this,Hl);S(this,dr,[]);g(this,mn,i),g(this,Hl,r*s),g(this,zl,a),l(this,se).set([NaN,NaN,NaN,NaN,e,t],6),g(this,jl,o),g(this,jh,l(es,zh)*s),g(this,Oh,l(es,wp)*s),g(this,Bl,s),l(this,dr).push(e,t)}isEmpty(){return isNaN(l(this,se)[8])}add({x:e,y:t}){var D;g(this,$a,e),g(this,Va,t);const[i,s,r,a]=l(this,mn);let[o,c,u,h]=l(this,se).subarray(8,12);const d=e-u,f=t-h,p=Math.hypot(d,f);if(p<l(this,Oh))return!1;const m=p-l(this,jh),A=m/p,_=A*d,y=A*f;let w=o,b=c;o=u,c=h,u+=_,h+=y,(D=l(this,dr))==null||D.push(e,t);const E=-y/m,C=_/m,T=E*l(this,Hl),k=C*l(this,Hl);return l(this,se).set(l(this,se).subarray(2,8),0),l(this,se).set([u+T,h+k],4),l(this,se).set(l(this,se).subarray(14,18),12),l(this,se).set([u-T,h-k],16),isNaN(l(this,se)[6])?(l(this,ji).length===0&&(l(this,se).set([o+T,c+k],2),l(this,ji).push(NaN,NaN,NaN,NaN,(o+T-i)/r,(c+k-s)/a),l(this,se).set([o-T,c-k],14),l(this,li).push(NaN,NaN,NaN,NaN,(o-T-i)/r,(c-k-s)/a)),l(this,se).set([w,b,o,c,u,h],6),!this.isEmpty()):(l(this,se).set([w,b,o,c,u,h],6),Math.abs(Math.atan2(b-c,w-o)-Math.atan2(y,_))<Math.PI/2?([o,c,u,h]=l(this,se).subarray(2,6),l(this,ji).push(NaN,NaN,NaN,NaN,((o+u)/2-i)/r,((c+h)/2-s)/a),[o,c,w,b]=l(this,se).subarray(14,18),l(this,li).push(NaN,NaN,NaN,NaN,((w+o)/2-i)/r,((b+c)/2-s)/a),!0):([w,b,o,c,u,h]=l(this,se).subarray(0,6),l(this,ji).push(((w+5*o)/6-i)/r,((b+5*c)/6-s)/a,((5*o+u)/6-i)/r,((5*c+h)/6-s)/a,((o+u)/2-i)/r,((c+h)/2-s)/a),[u,h,o,c,w,b]=l(this,se).subarray(12,18),l(this,li).push(((w+5*o)/6-i)/r,((b+5*c)/6-s)/a,((5*o+u)/6-i)/r,((5*c+h)/6-s)/a,((o+u)/2-i)/r,((c+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,ji),t=l(this,li);if(isNaN(l(this,se)[6])&&!this.isEmpty())return x(this,st,jb).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);x(this,st,Bb).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return x(this,st,zb).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new Vb(e,t,i,s,r,a)}getOutlines(){var d;const e=l(this,ji),t=l(this,li),i=l(this,se),[s,r,a,o]=l(this,mn),c=new Float32Array((((d=l(this,dr))==null?void 0:d.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,dr)[f]-s)/a,c[f+1]=(l(this,dr)[f+1]-r)/o;if(c[c.length-2]=(l(this,$a)-s)/a,c[c.length-1]=(l(this,Va)-r)/o,isNaN(i[6])&&!this.isEmpty())return x(this,st,Hb).call(this,c);const u=new Float32Array(l(this,ji).length+24+l(this,li).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}h=x(this,st,$b).call(this,u,h);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[f+p],u[h+1]=t[f+p+1],h+=2}return x(this,st,Ub).call(this,u,h),this.newFreeDrawOutline(u,c,l(this,mn),l(this,Bl),l(this,jl),l(this,zl))}};mn=new WeakMap,li=new WeakMap,jl=new WeakMap,zl=new WeakMap,ji=new WeakMap,se=new WeakMap,$a=new WeakMap,Va=new WeakMap,Oh=new WeakMap,jh=new WeakMap,Bl=new WeakMap,Hl=new WeakMap,dr=new WeakMap,zh=new WeakMap,vp=new WeakMap,wp=new WeakMap,st=new WeakSet,Gc=function(){const e=l(this,se).subarray(4,6),t=l(this,se).subarray(16,18),[i,s,r,a]=l(this,mn);return[(l(this,$a)+(e[0]-t[0])/2-i)/r,(l(this,Va)+(e[1]-t[1])/2-s)/a,(l(this,$a)+(t[0]-e[0])/2-i)/r,(l(this,Va)+(t[1]-e[1])/2-s)/a]},jb=function(){const[e,t,i,s]=l(this,mn),[r,a,o,c]=x(this,st,Gc).call(this);return`M${(l(this,se)[2]-e)/i} ${(l(this,se)[3]-t)/s} L${(l(this,se)[4]-e)/i} ${(l(this,se)[5]-t)/s} L${r} ${a} L${o} ${c} L${(l(this,se)[16]-e)/i} ${(l(this,se)[17]-t)/s} L${(l(this,se)[14]-e)/i} ${(l(this,se)[15]-t)/s} Z`},zb=function(e){const t=l(this,li);e.push(`L${t[4]} ${t[5]} Z`)},Bb=function(e){const[t,i,s,r]=l(this,mn),a=l(this,se).subarray(4,6),o=l(this,se).subarray(16,18),[c,u,h,d]=x(this,st,Gc).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${c} ${u} L${h} ${d} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},Hb=function(e){const t=l(this,se),[i,s,r,a]=l(this,mn),[o,c,u,h]=x(this,st,Gc).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(d,e,l(this,mn),l(this,Bl),l(this,jl),l(this,zl))},Ub=function(e,t){const i=l(this,li);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},$b=function(e,t){const i=l(this,se).subarray(4,6),s=l(this,se).subarray(16,18),[r,a,o,c]=l(this,mn),[u,h,d,f]=x(this,st,Gc).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c],t),t+=24},S(es,zh,8),S(es,vp,2),S(es,wp,l(es,zh)+l(es,vp));let Jf=es;var Ul,Wa,As,Bh,yn,Hh,Ve,Ap,Wb;class Vb extends B{constructor(t,i,s,r,a,o){super();S(this,Ap);S(this,Ul);S(this,Wa,new Float32Array(4));S(this,As);S(this,Bh);S(this,yn);S(this,Hh);S(this,Ve);g(this,Ve,t),g(this,yn,i),g(this,Ul,s),g(this,Hh,r),g(this,As,a),g(this,Bh,o),this.lastPoint=[NaN,NaN],x(this,Ap,Wb).call(this,o);const[c,u,h,d]=l(this,Wa);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,p=i.length;f<p;f+=2)i[f]=(i[f]-c)/h,i[f+1]=(i[f+1]-u)/d}toSVGPath(){const t=[`M${l(this,Ve)[4]} ${l(this,Ve)[5]}`];for(let i=6,s=l(this,Ve).length;i<s;i+=6){if(isNaN(l(this,Ve)[i])){t.push(`L${l(this,Ve)[i+4]} ${l(this,Ve)[i+5]}`);continue}t.push(`C${l(this,Ve)[i]} ${l(this,Ve)[i+1]} ${l(this,Ve)[i+2]} ${l(this,Ve)[i+3]} ${l(this,Ve)[i+4]} ${l(this,Ve)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,c=r-i;let u,h;switch(a){case 0:u=B._rescale(l(this,Ve),t,r,o,-c),h=B._rescale(l(this,yn),t,r,o,-c);break;case 90:u=B._rescaleAndSwap(l(this,Ve),t,i,o,c),h=B._rescaleAndSwap(l(this,yn),t,i,o,c);break;case 180:u=B._rescale(l(this,Ve),s,i,-o,c),h=B._rescale(l(this,yn),s,i,-o,c);break;case 270:u=B._rescaleAndSwap(l(this,Ve),s,r,-o,-c),h=B._rescaleAndSwap(l(this,yn),s,r,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return l(this,Wa)}newOutliner(t,i,s,r,a,o=0){return new Jf(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=l(this,Wa),[c,u,h,d]=l(this,Ul),f=a*h,p=o*d,m=s*h+c,A=r*d+u,_=this.newOutliner({x:l(this,yn)[0]*f+m,y:l(this,yn)[1]*p+A},l(this,Ul),l(this,Hh),t,l(this,Bh),i??l(this,As));for(let y=2;y<l(this,yn).length;y+=2)_.add({x:l(this,yn)[y]*f+m,y:l(this,yn)[y+1]*p+A});return _.getOutlines()}}Ul=new WeakMap,Wa=new WeakMap,As=new WeakMap,Bh=new WeakMap,yn=new WeakMap,Hh=new WeakMap,Ve=new WeakMap,Ap=new WeakSet,Wb=function(t){const i=l(this,Ve);let s=i[4],r=i[5],a=s,o=r,c=s,u=r,h=s,d=r;const f=t?Math.max:Math.min;for(let m=6,A=i.length;m<A;m+=6){if(isNaN(i[m]))a=Math.min(a,i[m+4]),o=Math.min(o,i[m+5]),c=Math.max(c,i[m+4]),u=Math.max(u,i[m+5]),d<i[m+5]?(h=i[m+4],d=i[m+5]):d===i[m+5]&&(h=f(h,i[m+4]));else{const _=G.bezierBoundingBox(s,r,...i.slice(m,m+6));a=Math.min(a,_[0]),o=Math.min(o,_[1]),c=Math.max(c,_[2]),u=Math.max(u,_[3]),d<_[3]?(h=_[2],d=_[3]):d===_[3]&&(h=f(h,_[2]))}s=i[m+4],r=i[m+5]}const p=l(this,Wa);p[0]=a-l(this,As),p[1]=o-l(this,As),p[2]=c-a+2*l(this,As),p[3]=u-o+2*l(this,As),this.lastPoint=[h,d]};var Uh,$h,fr,ci,Xt,Gb,pf,Xb,qb,Ay;class wy{constructor(e,t=0,i=0,s=!0){S(this,Xt);S(this,Uh);S(this,$h);S(this,fr,[]);S(this,ci,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const u=10**-4;for(const{x:_,y,width:w,height:b}of e){const E=Math.floor((_-t)/u)*u,C=Math.ceil((_+w+t)/u)*u,T=Math.floor((y-t)/u)*u,k=Math.ceil((y+b+t)/u)*u,P=[E,T,k,!0],D=[C,T,k,!1];l(this,fr).push(P,D),r=Math.min(r,E),a=Math.max(a,C),o=Math.min(o,T),c=Math.max(c,k)}const h=a-r+2*i,d=c-o+2*i,f=r-i,p=o-i,m=l(this,fr).at(s?-1:-2),A=[m[0],m[2]];for(const _ of l(this,fr)){const[y,w,b]=_;_[0]=(y-f)/h,_[1]=(w-p)/d,_[2]=(b-p)/d}g(this,Uh,new Float32Array([f,p,h,d])),g(this,$h,A)}getOutlines(){l(this,fr).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of l(this,fr))t[3]?(e.push(...x(this,Xt,Ay).call(this,t)),x(this,Xt,Xb).call(this,t)):(x(this,Xt,qb).call(this,t),e.push(...x(this,Xt,Ay).call(this,t)));return x(this,Xt,Gb).call(this,e)}}Uh=new WeakMap,$h=new WeakMap,fr=new WeakMap,ci=new WeakMap,Xt=new WeakSet,Gb=function(e){const t=[],i=new Set;for(const a of e){const[o,c,u]=a;t.push([o,c,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),i.add(c),i.add(u)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,c,u,h,d]=a;i.delete(a);let f=o,p=c;for(r=[o,u],s.push(r);;){let m;if(i.has(h))m=h;else if(i.has(d))m=d;else break;i.delete(m),[o,c,u,h,d]=m,f!==o&&(r.push(f,p,o,p===c?c:u),f=o),p=p===c?u:c}r.push(f,p)}return new iP(s,l(this,Uh),l(this,$h))},pf=function(e){const t=l(this,ci);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},Xb=function([,e,t]){const i=x(this,Xt,pf).call(this,e);l(this,ci).splice(i,0,[e,t])},qb=function([,e,t]){const i=x(this,Xt,pf).call(this,e);for(let s=i;s<l(this,ci).length;s++){const[r,a]=l(this,ci)[s];if(r!==e)break;if(r===e&&a===t){l(this,ci).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=l(this,ci)[s];if(r!==e)break;if(r===e&&a===t){l(this,ci).splice(s,1);return}}},Ay=function(e){const[t,i,s]=e,r=[[t,i,s]],a=x(this,Xt,pf).call(this,s);for(let o=0;o<a;o++){const[c,u]=l(this,ci)[o];for(let h=0,d=r.length;h<d;h++){const[,f,p]=r[h];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,p>u&&r.push([t,u,p])}}}return r};var Vh,$l;class iP extends B{constructor(t,i,s){super();S(this,Vh);S(this,$l);g(this,$l,t),g(this,Vh,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of l(this,$l)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],c=i[a+1];o===s?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],c=s-t,u=r-i;for(const h of l(this,$l)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*c,d[f+1]=r-h[f+1]*u;o.push(d)}return o}get box(){return l(this,Vh)}get classNamesForOutlining(){return["highlightOutline"]}}Vh=new WeakMap,$l=new WeakMap;class Sy extends Jf{newFreeDrawOutline(e,t,i,s,r,a){return new sP(e,t,i,s,r,a)}}class sP extends Vb{newOutliner(e,t,i,s,r,a=0){return new Sy(e,t,i,s,r,a)}}var ui,Ga,Vl,tt,Wh,Wl,Gh,Xh,pr,hi,Gl,qh,Se,xy,by,_y,Yr,Yb,Hs;const Jt=class Jt{constructor({editor:e=null,uiManager:t=null}){S(this,Se);S(this,ui,null);S(this,Ga,null);S(this,Vl);S(this,tt,null);S(this,Wh,!1);S(this,Wl,!1);S(this,Gh,null);S(this,Xh);S(this,pr,null);S(this,hi,null);S(this,Gl);var i;e?(g(this,Wl,!1),g(this,Gl,ce.HIGHLIGHT_COLOR),g(this,Gh,e)):(g(this,Wl,!0),g(this,Gl,ce.HIGHLIGHT_DEFAULT_COLOR)),g(this,hi,(e==null?void 0:e._uiManager)||t),g(this,Xh,l(this,hi)._eventBus),g(this,Vl,(e==null?void 0:e.color)||((i=l(this,hi))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),l(Jt,qh)||g(Jt,qh,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return re(this,"_keyboardManager",new cd([[["Escape","mac+Escape"],Jt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Jt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Jt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Jt.prototype._moveToPrevious],[["Home","mac+Home"],Jt.prototype._moveToBeginning],[["End","mac+End"],Jt.prototype._moveToEnd]]))}renderButton(){const e=g(this,ui,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,hi)._signal;e.addEventListener("click",x(this,Se,Yr).bind(this),{signal:t}),e.addEventListener("keydown",x(this,Se,_y).bind(this),{signal:t});const i=g(this,Ga,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=l(this,Vl),e.append(i),e}renderMainDropdown(){const e=g(this,tt,x(this,Se,xy).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,ui)){x(this,Se,Yr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&x(this,Se,by).call(this,t,e)}_moveToNext(e){var t,i;if(!l(this,Se,Hs)){x(this,Se,Yr).call(this,e);return}if(e.target===l(this,ui)){(t=l(this,tt).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=l(this,tt))==null?void 0:t.firstChild)||e.target===l(this,ui)){l(this,Se,Hs)&&this._hideDropdownFromKeyboard();return}l(this,Se,Hs)||x(this,Se,Yr).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!l(this,Se,Hs)){x(this,Se,Yr).call(this,e);return}(t=l(this,tt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,Se,Hs)){x(this,Se,Yr).call(this,e);return}(t=l(this,tt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,tt))==null||e.classList.add("hidden"),(t=l(this,pr))==null||t.abort(),g(this,pr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Wl)){if(!l(this,Se,Hs)){(e=l(this,Gh))==null||e.unselect();return}this.hideDropdown(),l(this,ui).focus({preventScroll:!0,focusVisible:l(this,Wh)})}}updateColor(e){if(l(this,Ga)&&(l(this,Ga).style.backgroundColor=e),!l(this,tt))return;const t=l(this,hi).highlightColors.values();for(const i of l(this,tt).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,ui))==null||e.remove(),g(this,ui,null),g(this,Ga,null),(t=l(this,tt))==null||t.remove(),g(this,tt,null)}};ui=new WeakMap,Ga=new WeakMap,Vl=new WeakMap,tt=new WeakMap,Wh=new WeakMap,Wl=new WeakMap,Gh=new WeakMap,Xh=new WeakMap,pr=new WeakMap,hi=new WeakMap,Gl=new WeakMap,qh=new WeakMap,Se=new WeakSet,xy=function(){const e=document.createElement("div"),t=l(this,hi)._signal;e.addEventListener("contextmenu",Ai,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of l(this,hi).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",l(Jt,qh)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.setAttribute("aria-selected",s===l(this,Vl)),r.addEventListener("click",x(this,Se,by).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",x(this,Se,_y).bind(this),{signal:t}),e},by=function(e,t){t.stopPropagation(),l(this,Xh).dispatch("switchannotationeditorparams",{source:this,type:l(this,Gl),value:e})},_y=function(e){Jt._keyboardManager.exec(this,e)},Yr=function(e){if(l(this,Se,Hs)){this.hideDropdown();return}if(g(this,Wh,e.detail===0),l(this,pr)||(g(this,pr,new AbortController),window.addEventListener("pointerdown",x(this,Se,Yb).bind(this),{signal:l(this,hi).combinedSignal(l(this,pr))})),l(this,tt)){l(this,tt).classList.remove("hidden");return}const t=g(this,tt,x(this,Se,xy).call(this));l(this,ui).append(t)},Yb=function(e){var t;(t=l(this,tt))!=null&&t.contains(e.target)||this.hideDropdown()},Hs=function(){return l(this,tt)&&!l(this,tt).classList.contains("hidden")},S(Jt,qh,null);let Zf=Jt;var Xl,Yh,Ss,Xa,ql,tn,Kh,Qh,qa,On,vn,yt,Yl,xs,Rt,Kl,jn,Jh,ee,Ey,gf,Kb,Qb,Jb,Cy,Kr,Vn,Mo,Zb,mf,Xc,e_,t_,n_,i_,s_;const ge=class ge extends je{constructor(t){super({...t,name:"highlightEditor"});S(this,ee);S(this,Xl,null);S(this,Yh,0);S(this,Ss);S(this,Xa,null);S(this,ql,null);S(this,tn,null);S(this,Kh,null);S(this,Qh,0);S(this,qa,null);S(this,On,null);S(this,vn,null);S(this,yt,!1);S(this,Yl,null);S(this,xs);S(this,Rt,null);S(this,Kl,"");S(this,jn);S(this,Jh,"");this.color=t.color||ge._defaultColor,g(this,jn,t.thickness||ge._defaultThickness),g(this,xs,t.opacity||ge._defaultOpacity),g(this,Ss,t.boxes||null),g(this,Jh,t.methodOfCreation||""),g(this,Kl,t.text||""),this._isDraggable=!1,t.highlightId>-1?(g(this,yt,!0),x(this,ee,gf).call(this,t),x(this,ee,Kr).call(this)):l(this,Ss)&&(g(this,Xl,t.anchorNode),g(this,Yh,t.anchorOffset),g(this,Kh,t.focusNode),g(this,Qh,t.focusOffset),x(this,ee,Ey).call(this),x(this,ee,Kr).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ge.prototype;return re(this,"_keyboardManager",new cd([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,yt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,jn),methodOfCreation:l(this,Jh)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;je.initialize(t,i),ge._defaultColor||(ge._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case ce.HIGHLIGHT_DEFAULT_COLOR:ge._defaultColor=i;break;case ce.HIGHLIGHT_THICKNESS:ge._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return l(this,Yl)}updateParams(t,i){switch(t){case ce.HIGHLIGHT_COLOR:x(this,ee,Kb).call(this,i);break;case ce.HIGHLIGHT_THICKNESS:x(this,ee,Qb).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ce.HIGHLIGHT_DEFAULT_COLOR,ge._defaultColor],[ce.HIGHLIGHT_THICKNESS,ge._defaultThickness]]}get propertiesToUpdate(){return[[ce.HIGHLIGHT_COLOR,this.color||ge._defaultColor],[ce.HIGHLIGHT_THICKNESS,l(this,jn)||ge._defaultThickness],[ce.HIGHLIGHT_FREE,l(this,yt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(g(this,ql,new Zf({editor:this})),t.addColorPicker(l(this,ql))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,ee,Xc).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,x(this,ee,Xc).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){x(this,ee,Cy).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,ee,Kr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?x(this,ee,Cy).call(this):t&&(x(this,ee,Kr).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;l(this,yt)?(t=(t-this.rotation+360)%360,s=x(r=ge,Vn,Mo).call(r,l(this,On).box,t)):s=x(a=ge,Vn,Mo).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(l(this,vn),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(l(this,Rt),{bbox:x(o=ge,Vn,Mo).call(o,l(this,tn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,Kl)&&(t.setAttribute("aria-label",l(this,Kl)),t.setAttribute("role","mark")),l(this,yt)?t.classList.add("free"):this.div.addEventListener("keydown",x(this,ee,Zb).bind(this),{signal:this._uiManager._signal});const i=g(this,qa,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=l(this,Xa);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),Yf(this,l(this,qa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:x(this,ee,mf).call(this,!0);break;case 1:case 3:x(this,ee,mf).call(this,!1);break}}select(){var t;super.select(),l(this,Rt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Rt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{selected:!1}}),l(this,yt)||x(this,ee,mf).call(this,!1))}get _mustFixPosition(){return!l(this,yt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,vn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Rt),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:c,width:u,height:h}=s.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),p=m=>{d.abort(),x(this,Vn,i_).call(this,t,m)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",En,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Ai,{signal:f}),s.addEventListener("pointermove",x(this,Vn,n_).bind(this,t),{signal:f}),this._freeHighlight=new Sy({x:r,y:a},[o,c,u,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var A,_,y,w;let r=null;if(t instanceof Nb){const{data:{quadPoints:b,rect:E,rotation:C,id:T,color:k,opacity:P,popupRef:D},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),opacity:P,quadPoints:b,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:D}}else if(t instanceof Yv){const{data:{inkLists:b,rect:E,rotation:C,id:T,color:k,borderStyle:{rawWidth:P},popupRef:D},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),thickness:P,inkLists:b,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:D}}const{color:a,quadPoints:o,inkLists:c,opacity:u}=t,h=await super.deserialize(t,i,s);h.color=G.makeHexColor(...a),g(h,xs,u||1),c&&g(h,jn,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[d,f]=h.pageDimensions,[p,m]=h.pageTranslation;if(o){const b=g(h,Ss,[]);for(let E=0;E<o.length;E+=8)b.push({x:(o[E]-p)/d,y:1-(o[E+1]-m)/f,width:(o[E+2]-o[E])/d,height:(o[E+1]-o[E+5])/f});x(A=h,ee,Ey).call(A),x(_=h,ee,Kr).call(_),h.rotate(h.rotation)}else if(c){g(h,yt,!0);const b=c[0],E={x:b[0]-p,y:f-(b[1]-m)},C=new Sy(E,[0,0,d,f],1,l(h,jn)/2,!0,.001);for(let P=0,D=b.length;P<D;P+=2)E.x=b[P]-p,E.y=f-(b[P+1]-m),C.add(E);const{id:T,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);x(y=h,ee,gf).call(y,{highlightOutlines:C.getOutlines(),highlightId:T,clipPathId:k}),x(w=h,ee,Kr).call(w)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=je._colorManager.convert(this.color),r={annotationType:te.HIGHLIGHT,color:s,opacity:l(this,xs),thickness:l(this,jn),quadPoints:x(this,ee,e_).call(this),outlines:x(this,ee,t_).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:x(this,ee,Xc).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!x(this,ee,s_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Xl=new WeakMap,Yh=new WeakMap,Ss=new WeakMap,Xa=new WeakMap,ql=new WeakMap,tn=new WeakMap,Kh=new WeakMap,Qh=new WeakMap,qa=new WeakMap,On=new WeakMap,vn=new WeakMap,yt=new WeakMap,Yl=new WeakMap,xs=new WeakMap,Rt=new WeakMap,Kl=new WeakMap,jn=new WeakMap,Jh=new WeakMap,ee=new WeakSet,Ey=function(){const t=new wy(l(this,Ss),.001);g(this,On,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,On).box;const i=new wy(l(this,Ss),.0025,.001,this._uiManager.direction==="ltr");g(this,tn,i.getOutlines());const{lastPoint:s}=l(this,tn);g(this,Yl,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},gf=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var d,f;if(g(this,On,t),g(this,tn,t.getNewOutline(l(this,jn)/2+1.5,.0025)),i>=0)g(this,vn,i),g(this,Xa,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),g(this,Rt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,tn).box,path:{d:l(this,tn).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,vn),{bbox:x(d=ge,Vn,Mo).call(d,l(this,On).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Rt),{bbox:x(f=ge,Vn,Mo).call(f,l(this,tn).box,p),path:{d:l(this,tn).toSVGPath()}})}const[a,o,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=u;break;case 90:{const[p,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*m/p,this.height=u*p/m;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*m/p,this.height=u*p/m;break}}const{lastPoint:h}=l(this,tn);g(this,Yl,[(h[0]-a)/c,(h[1]-o)/u])},Kb=function(t){const i=(a,o)=>{var c,u;this.color=a,g(this,xs,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,vn),{root:{fill:a,"fill-opacity":o}}),(u=l(this,ql))==null||u.updateColor(a)},s=this.color,r=l(this,xs);this.addCommands({cmd:i.bind(this,t,ge._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},Qb=function(t){const i=l(this,jn),s=r=>{g(this,jn,r),x(this,ee,Jb).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ce.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},Jb=function(t){if(!l(this,yt))return;x(this,ee,gf).call(this,{highlightOutlines:l(this,On).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},Cy=function(){l(this,vn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,vn)),g(this,vn,null),this.parent.drawLayer.remove(l(this,Rt)),g(this,Rt,null))},Kr=function(t=this.parent){l(this,vn)===null&&({id:Ot(this,vn)._,clipPathId:Ot(this,Xa)._}=t.drawLayer.draw({bbox:l(this,On).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,xs)},rootClass:{highlight:!0,free:l(this,yt)},path:{d:l(this,On).toSVGPath()}},!1,!0),g(this,Rt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,yt)},bbox:l(this,tn).box,path:{d:l(this,tn).toSVGPath()}},l(this,yt))),l(this,qa)&&(l(this,qa).style.clipPath=l(this,Xa)))},Vn=new WeakSet,Mo=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},Zb=function(t){ge._keyboardManager.exec(this,t)},mf=function(t){if(!l(this,Xl))return;const i=window.getSelection();t?i.setPosition(l(this,Xl),l(this,Yh)):i.setPosition(l(this,Kh),l(this,Qh))},Xc=function(){return l(this,yt)?this.rotation:0},e_=function(){if(l(this,yt))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=l(this,Ss),o=new Float32Array(a.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of a){const p=u*t+s,m=(1-h)*i+r;o[c]=o[c+4]=p,o[c+1]=o[c+3]=m,o[c+2]=o[c+6]=p+d*t,o[c+5]=o[c+7]=m-f*i,c+=8}return o},t_=function(t){return l(this,On).serialize(t,x(this,ee,Xc).call(this))},n_=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},i_=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},s_=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},S(ge,Vn),Y(ge,"_defaultColor",null),Y(ge,"_defaultOpacity",1),Y(ge,"_defaultThickness",12),Y(ge,"_type","highlight"),Y(ge,"_editorType",te.HIGHLIGHT),Y(ge,"_freeHighlightId",-1),Y(ge,"_freeHighlight",null),Y(ge,"_freeHighlightClipId","");let ep=ge;var Ya;class rP{constructor(){S(this,Ya,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){l(this,Ya)[e]=t}toSVGProperties(){const e=l(this,Ya);return g(this,Ya,Object.create(null)),{root:e}}reset(){g(this,Ya,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){_e("Not implemented")}}Ya=new WeakMap;var wn,Ql,lt,Ka,Qa,gr,mr,yr,Ja,de,Ty,Py,Ny,qc,r_,yf,Yc,Io;const U=class U extends je{constructor(t){super(t);S(this,de);S(this,wn,null);S(this,Ql);Y(this,"_drawId",null);g(this,Ql,t.mustBeCommitted||!1),t.drawOutlines&&(x(this,de,Ty).call(this,t),x(this,de,qc).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){_e("Not implemented")}static get typesMap(){_e("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(l(U,lt).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=c=>{var h;r.updateProperty(i,c);const u=l(this,wn).updateProperty(i,c);u&&x(this,de,Yc).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,U._mergeSVGProperties(l(this,wn).getPathResizingSVGProperties(x(this,de,yf).call(this)),{bbox:x(this,de,Io).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,U._mergeSVGProperties(l(this,wn).getPathResizedSVGProperties(x(this,de,yf).call(this)),{bbox:x(this,de,Io).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:x(this,de,Io).call(this,t,i)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,U._mergeSVGProperties(l(this,wn).getPathTranslatedSVGProperties(x(this,de,yf).call(this),this.parentDimensions),{bbox:x(this,de,Io).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,Ql)&&(g(this,Ql,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){x(this,de,Ny).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,de,qc).call(this),x(this,de,Yc).call(this,l(this,wn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),x(this,de,Ny).call(this)):t&&(this._uiManager.addShouldRescale(this),x(this,de,qc).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,U._mergeSVGProperties({bbox:x(this,de,Io).call(this)},l(this,wn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&x(this,de,Yc).call(this,l(this,wn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,s,r,a){_e("Not implemented")}static startDrawing(t,i,s,r){var _;const{target:a,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=r;if(l(U,mr)&&l(U,mr)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:p}=a.getBoundingClientRect(),m=g(U,Ka,new AbortController),A=t.combinedSignal(m);if(l(U,gr)||g(U,gr,u),l(U,mr)??g(U,mr,h),window.addEventListener("pointerup",y=>{var w;l(U,gr)===y.pointerId?this._endDraw(y):(w=l(U,yr))==null||w.delete(y.pointerId)},{signal:A}),window.addEventListener("pointercancel",y=>{var w;l(U,gr)===y.pointerId?this._currentParent.endDrawingSession():(w=l(U,yr))==null||w.delete(y.pointerId)},{signal:A}),window.addEventListener("pointerdown",y=>{l(U,mr)===y.pointerType&&((l(U,yr)||g(U,yr,new Set)).add(y.pointerId),l(U,lt).isCancellable()&&(l(U,lt).removeLastElement(),l(U,lt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Ai,{signal:A}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),a.addEventListener("touchmove",y=>{y.timeStamp===l(U,Ja)&&En(y)},{signal:A}),t.toggleDrawing(),(_=i._editorUndoBar)==null||_.hide(),l(U,lt)){t.drawLayer.updateProperties(this._currentDrawId,l(U,lt).startNew(o,c,f,p,d));return}i.updateUIForDefaultProperties(this),g(U,lt,this.createDrawerInstance(o,c,f,p,d)),g(U,Qa,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(U,Qa).toSVGProperties(),l(U,lt).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(g(U,Ja,-1),!l(U,lt))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(l(U,gr)===r){if(((a=l(U,yr))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(U,lt).add(i,s)),g(U,Ja,t.timeStamp),En(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,g(U,lt,null),g(U,Qa,null),g(U,mr,null),g(U,Ja,NaN)),l(U,Ka)&&(l(U,Ka).abort(),g(U,Ka,null),g(U,gr,NaN),g(U,yr,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t&&i.drawLayer.updateProperties(this._currentDrawId,l(U,lt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=l(U,lt),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:ce.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(ce.DRAW_STEP),!l(U,lt).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(U,lt).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:l(U,Qa),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){_e("Not implemented")}static async deserialize(t,i,s){var d,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=i.viewport,u=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),x(d=h,de,Ty).call(d,{drawOutlines:u}),x(f=h,de,qc).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,wn).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};wn=new WeakMap,Ql=new WeakMap,lt=new WeakMap,Ka=new WeakMap,Qa=new WeakMap,gr=new WeakMap,mr=new WeakMap,yr=new WeakMap,Ja=new WeakMap,de=new WeakSet,Ty=function({drawOutlines:t,drawId:i,drawingOptions:s}){g(this,wn,t),this._drawingOptions||(this._drawingOptions=s),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=x(this,de,Py).call(this,t,this.parent),x(this,de,Yc).call(this,t.box)},Py=function(t,i){const{id:s}=i.drawLayer.draw(U._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},Ny=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},qc=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=x(this,de,Py).call(this,l(this,wn),t)}},r_=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},yf=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},Yc=function(t){if([this.x,this.y,this.width,this.height]=x(this,de,r_).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Io=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[c,u]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(c/u),r*(u/c),s*(c/u)];case 5:return[1-i,t,s*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-i,r*(u/c),s*(c/u)];case 7:return[i-s*(c/u),1-t-r*(u/c),s*(c/u),r*(u/c)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(u/c),i,r*(u/c),s*(c/u)];case 13:return[1-i-s*(c/u),t-r*(u/c),s*(c/u),r*(u/c)];case 14:return[1-t,1-i-s*(c/u),r*(u/c),s*(c/u)];case 15:return[i,1-t,s*(c/u),r*(u/c)];default:return[t,i,s,r]}},Y(U,"_currentDrawId",-1),Y(U,"_currentParent",null),S(U,lt,null),S(U,Ka,null),S(U,Qa,null),S(U,gr,NaN),S(U,mr,null),S(U,yr,null),S(U,Ja,NaN),Y(U,"_INNER_MARGIN",3);let ky=U;var zi,ct,ut,Za,Jl,Bt,vt,zn,eo,to,no,Zl,vf;class aP{constructor(e,t,i,s,r,a){S(this,Zl);S(this,zi,new Float64Array(6));S(this,ct);S(this,ut);S(this,Za);S(this,Jl);S(this,Bt);S(this,vt,"");S(this,zn,0);S(this,eo,new tp);S(this,to);S(this,no);g(this,to,i),g(this,no,s),g(this,Za,r),g(this,Jl,a),[e,t]=x(this,Zl,vf).call(this,e,t);const o=g(this,ct,[NaN,NaN,NaN,NaN,e,t]);g(this,Bt,[e,t]),g(this,ut,[{line:o,points:l(this,Bt)}]),l(this,zi).set(o,0)}updateProperty(e,t){e==="stroke-width"&&g(this,Jl,t)}isEmpty(){return!l(this,ut)||l(this,ut).length===0}isCancellable(){return l(this,Bt).length<=10}add(e,t){[e,t]=x(this,Zl,vf).call(this,e,t);const[i,s,r,a]=l(this,zi).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,to)*o,l(this,no)*c)<=2?null:(l(this,Bt).push(e,t),isNaN(i)?(l(this,zi).set([r,a,e,t],2),l(this,ct).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,zi)[0])&&l(this,ct).splice(6,6),l(this,zi).set([i,s,r,a,e,t],0),l(this,ct).push(...B.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(l(this,Bt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){g(this,to,i),g(this,no,s),g(this,Za,r),[e,t]=x(this,Zl,vf).call(this,e,t);const a=g(this,ct,[NaN,NaN,NaN,NaN,e,t]);g(this,Bt,[e,t]);const o=l(this,ut).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,ut).push({line:a,points:l(this,Bt)}),l(this,zi).set(a,0),g(this,zn,0),this.toSVGPath(),null}getLastElement(){return l(this,ut).at(-1)}setLastElement(e){return l(this,ut)?(l(this,ut).push(e),g(this,ct,e.line),g(this,Bt,e.points),g(this,zn,0),{path:{d:this.toSVGPath()}}):l(this,eo).setLastElement(e)}removeLastElement(){if(!l(this,ut))return l(this,eo).removeLastElement();l(this,ut).pop(),g(this,vt,"");for(let e=0,t=l(this,ut).length;e<t;e++){const{line:i,points:s}=l(this,ut)[e];g(this,ct,i),g(this,Bt,s),g(this,zn,0),this.toSVGPath()}return{path:{d:l(this,vt)}}}toSVGPath(){const e=B.svgRound(l(this,ct)[4]),t=B.svgRound(l(this,ct)[5]);if(l(this,Bt).length===2)return g(this,vt,`${l(this,vt)} M ${e} ${t} Z`),l(this,vt);if(l(this,Bt).length<=6){const s=l(this,vt).lastIndexOf("M");g(this,vt,`${l(this,vt).slice(0,s)} M ${e} ${t}`),g(this,zn,6)}if(l(this,Bt).length===4){const s=B.svgRound(l(this,ct)[10]),r=B.svgRound(l(this,ct)[11]);return g(this,vt,`${l(this,vt)} L ${s} ${r}`),g(this,zn,12),l(this,vt)}const i=[];l(this,zn)===0&&(i.push(`M ${e} ${t}`),g(this,zn,6));for(let s=l(this,zn),r=l(this,ct).length;s<r;s+=6){const[a,o,c,u,h,d]=l(this,ct).slice(s,s+6).map(B.svgRound);i.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}return g(this,vt,l(this,vt)+i.join(" ")),g(this,zn,l(this,ct).length),l(this,vt)}getOutlines(e,t,i,s){const r=l(this,ut).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,eo).build(l(this,ut),e,t,i,l(this,Za),l(this,Jl),s),g(this,zi,null),g(this,ct,null),g(this,ut,null),g(this,vt,null),l(this,eo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}zi=new WeakMap,ct=new WeakMap,ut=new WeakMap,Za=new WeakMap,Jl=new WeakMap,Bt=new WeakMap,vt=new WeakMap,zn=new WeakMap,eo=new WeakMap,to=new WeakMap,no=new WeakMap,Zl=new WeakSet,vf=function(e,t){return B._normalizePoint(e,t,l(this,to),l(this,no),l(this,Za))};var Ht,Zh,ed,An,Bi,Hi,ec,tc,nc,St,Qi,a_,o_,l_;const e0=class e0 extends B{constructor(){super(...arguments);S(this,St);S(this,Ht);S(this,Zh,0);S(this,ed);S(this,An);S(this,Bi);S(this,Hi);S(this,ec);S(this,tc);S(this,nc)}build(t,i,s,r,a,o,c){g(this,Bi,i),g(this,Hi,s),g(this,ec,r),g(this,tc,a),g(this,nc,o),g(this,ed,c??0),g(this,An,t),x(this,St,o_).call(this)}setLastElement(t){return l(this,An).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,An).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of l(this,An)){if(t.push(`M${B.svgRound(i[4])} ${B.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12){t.push(`L${B.svgRound(i[10])} ${B.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,c,u,h,d]=i.subarray(s,s+6).map(B.svgRound);t.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],c=[],[u,h,d,f]=x(this,St,a_).call(this);let p,m,A,_,y,w,b,E,C;switch(l(this,tc)){case 0:C=B._rescale,p=t,m=i+r,A=s,_=-r,y=t+u*s,w=i+(1-h-f)*r,b=t+(u+d)*s,E=i+(1-h)*r;break;case 90:C=B._rescaleAndSwap,p=t,m=i,A=s,_=r,y=t+h*s,w=i+u*r,b=t+(h+f)*s,E=i+(u+d)*r;break;case 180:C=B._rescale,p=t+s,m=i,A=-s,_=r,y=t+(1-u-d)*s,w=i+h*r,b=t+(1-u)*s,E=i+(h+f)*r;break;case 270:C=B._rescaleAndSwap,p=t+s,m=i+r,A=-s,_=-r,y=t+(1-h-f)*s,w=i+(1-u-d)*r,b=t+(1-h)*s,E=i+(1-u)*r;break}for(const{line:T,points:k}of l(this,An))o.push(C(T,p,m,A,_,a?new Array(T.length):null)),c.push(C(k,p,m,A,_,a?new Array(k.length):null));return{lines:o,points:c,rect:[y,w,b,E]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:c},rotation:u,thickness:h}){const d=[];let f,p,m,A,_;switch(u){case 0:_=B._rescale,f=-t/s,p=i/r+1,m=1/s,A=-1/r;break;case 90:_=B._rescaleAndSwap,f=-i/r,p=-t/s,m=1/r,A=1/s;break;case 180:_=B._rescale,f=t/s+1,p=-i/r,m=-1/s,A=1/r;break;case 270:_=B._rescaleAndSwap,f=i/r+1,p=t/s+1,m=-1/r,A=-1/s;break}if(!o){o=[];for(const w of c){const b=w.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(b-2));o.push(E);let[C,T,k,P]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,T],0);for(let D=4;D<b;D+=2){const M=w[D],$=w[D+1];E.set(B.createBezierPoints(C,T,k,P,M,$),(D-2)*3),[C,T,k,P]=[k,P,M,$]}}}for(let w=0,b=o.length;w<b;w++)d.push({line:_(o[w].map(E=>E??NaN),f,p,m,A),points:_(c[w].map(E=>E??NaN),f,p,m,A)});const y=new e0;return y.build(d,s,r,1,u,h,a),y}get box(){return l(this,Ht)}updateProperty(t,i){return t==="stroke-width"?x(this,St,l_).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=x(this,St,Qi).call(this);g(this,Bi,t),g(this,Hi,i),g(this,ec,s);const[o,c]=x(this,St,Qi).call(this),u=o-r,h=c-a,d=l(this,Ht);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return g(this,Zh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,Ht).map(B.svgRound).join(" ")}get defaultProperties(){const[t,i]=l(this,Ht);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=l(this,Ht);let s=0,r=0,a=0,o=0,c=0,u=0;switch(l(this,Zh)){case 90:r=i/t,a=-t/i,c=t;break;case 180:s=-1,o=-1,c=t,u=i;break;case 270:r=-i/t,a=t/i,u=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${B.svgRound(c)} ${B.svgRound(u)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=x(this,St,Qi).call(this),[c,u,h,d]=l(this,Ht);if(Math.abs(h-a)<=B.PRECISION||Math.abs(d-o)<=B.PRECISION){const _=t+s/2-(c+h/2),y=i+r/2-(u+d/2);return{path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(i)}`,transform:`${this.rotationTransform} translate(${_} ${y})`}}}const f=(s-2*a)/(h-2*a),p=(r-2*o)/(d-2*o),m=h/s,A=d/r;return{path:{"transform-origin":`${B.svgRound(c)} ${B.svgRound(u)}`,transform:`${this.rotationTransform} scale(${m} ${A}) translate(${B.svgRound(a)} ${B.svgRound(o)}) scale(${f} ${p}) translate(${B.svgRound(-a)} ${B.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=x(this,St,Qi).call(this),c=l(this,Ht),[u,h,d,f]=c;if(c[0]=t,c[1]=i,c[2]=s,c[3]=r,Math.abs(d-a)<=B.PRECISION||Math.abs(f-o)<=B.PRECISION){const y=t+s/2-(u+d/2),w=i+r/2-(h+f/2);for(const{line:b,points:E}of l(this,An))B._translate(b,y,w,b),B._translate(E,y,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(s-2*a)/(d-2*a),m=(r-2*o)/(f-2*o),A=-p*(u+a)+t+a,_=-m*(h+o)+i+o;if(p!==1||m!==1||A!==0||_!==0)for(const{line:y,points:w}of l(this,An))B._rescale(y,A,_,p,m,y),B._rescale(w,A,_,p,m,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${B.svgRound(t)} ${B.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=l(this,Ht),c=t-o[0],u=i-o[1];if(l(this,Bi)===r&&l(this,Hi)===a)for(const{line:h,points:d}of l(this,An))B._translate(h,c,u,h),B._translate(d,c,u,d);else{const h=l(this,Bi)/r,d=l(this,Hi)/a;g(this,Bi,r),g(this,Hi,a);for(const{line:f,points:p}of l(this,An))B._rescale(f,c,u,h,d,f),B._rescale(p,c,u,h,d,p);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${B.svgRound(t)} ${B.svgRound(i)}`}}}get defaultSVGProperties(){const t=l(this,Ht);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${B.svgRound(t[0])} ${B.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Ht=new WeakMap,Zh=new WeakMap,ed=new WeakMap,An=new WeakMap,Bi=new WeakMap,Hi=new WeakMap,ec=new WeakMap,tc=new WeakMap,nc=new WeakMap,St=new WeakSet,Qi=function(t=l(this,nc)){const i=l(this,ed)+t/2*l(this,ec);return l(this,tc)%180===0?[i/l(this,Bi),i/l(this,Hi)]:[i/l(this,Hi),i/l(this,Bi)]},a_=function(){const[t,i,s,r]=l(this,Ht),[a,o]=x(this,St,Qi).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},o_=function(){const t=g(this,Ht,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,An)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[h,d]=r.subarray(c,c+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=r[4],o=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,p,m,A]=r.subarray(c,c+6);G.bezierBoundingBox(a,o,h,d,f,p,m,A,t),a=m,o=A}}const[i,s]=x(this,St,Qi).call(this);t[0]=Math.min(1,Math.max(0,t[0]-i)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+i)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},l_=function(t){const[i,s]=x(this,St,Qi).call(this);g(this,nc,t);const[r,a]=x(this,St,Qi).call(this),[o,c]=[r-i,a-s],u=l(this,Ht);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};let tp=e0;var ic;const t0=class t0 extends rP{constructor(t){super();S(this,ic);g(this,ic,t),super.updateProperties({fill:"none",stroke:je._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=l(this,ic).realScale),super.updateSVGProperty(t,i)}clone(){const t=new t0(l(this,ic));return t.updateAll(this),t}};ic=new WeakMap;let Ry=t0;var Sp,c_;const qo=class qo extends ky{constructor(t){super({...t,name:"inkEditor"});S(this,Sp);this._willKeepAspectRatio=!0}static initialize(t,i){je.initialize(t,i),this._defaultDrawingOptions=new Ry(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return re(this,"typesMap",new Map([[ce.INK_THICKNESS,"stroke-width"],[ce.INK_COLOR,"stroke"],[ce.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new aP(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return tp.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof Yv){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:m},parent:{page:{pageNumber:A}}}=t;r=t={annotationType:te.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:o},boxes:null,pageIndex:A-1,rect:c.slice(0),rotation:u,id:h,deleted:!1,popupRef:m}}const a=await super.deserialize(t,i,s);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=qo.getDefaultDrawingOptions({stroke:G.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:te.INK,color:je._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!x(this,Sp,c_).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};Sp=new WeakSet,c_=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==i[c])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},Y(qo,"_type","ink"),Y(qo,"_editorType",te.INK),Y(qo,"_defaultDrawingOptions",null);let Ly=qo;var Fe,wt,vr,bs,wr,sc,Ui,$i,Sn,rc,pe,Kc,Qc,wf,Iy,Af,Dy,Sf,u_;const lu=class lu extends je{constructor(t){super({...t,name:"stampEditor"});S(this,pe);S(this,Fe,null);S(this,wt,null);S(this,vr,null);S(this,bs,null);S(this,wr,null);S(this,sc,"");S(this,Ui,null);S(this,$i,null);S(this,Sn,!1);S(this,rc,!1);g(this,bs,t.bitmapUrl),g(this,wr,t.bitmapFile)}static initialize(t,i){je.initialize(t,i)}static get supportedTypes(){return re(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return re(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,i){i.pasteEditor(te.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),i&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,wt)&&(g(this,Fe,null),this._uiManager.imageManager.deleteId(l(this,wt)),(t=l(this,Ui))==null||t.remove(),g(this,Ui,null),l(this,$i)&&(clearTimeout(l(this,$i)),g(this,$i,null))),super.remove()}rebuild(){if(!this.parent){l(this,wt)&&x(this,pe,wf).call(this);return}super.rebuild(),this.div!==null&&(l(this,wt)&&l(this,Ui)===null&&x(this,pe,wf).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,vr)||l(this,Fe)||l(this,bs)||l(this,wr)||l(this,wt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,Fe)?x(this,pe,Iy).call(this):x(this,pe,wf).call(this),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,$i)!==null&&clearTimeout(l(this,$i)),g(this,$i,setTimeout(()=>{g(this,$i,null),x(this,pe,Dy).call(this)},200))}copyCanvas(t,i,s=!1){var p;t||(t=224);const{width:r,height:a}=l(this,Fe),o=new Rm;let c=l(this,Fe),u=r,h=a,d=null;if(i){if(r>i||a>i){const P=Math.min(i/r,i/a);u=Math.floor(r*P),h=Math.floor(a*P)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*o.sx),A=d.height=Math.ceil(h*o.sy);l(this,Sn)||(c=x(this,pe,Af).call(this,m,A));const _=d.getContext("2d");_.filter=this._uiManager.hcmFilter;let y="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",w="#42414d");const b=15,E=b*o.sx,C=b*o.sy,T=new OffscreenCanvas(E*2,C*2),k=T.getContext("2d");k.fillStyle=y,k.fillRect(0,0,E*2,C*2),k.fillStyle=w,k.fillRect(0,0,E,C),k.fillRect(E,C,E,C),_.fillStyle=_.createPattern(T,"repeat"),_.fillRect(0,0,m,A),_.drawImage(c,0,0,c.width,c.height,0,0,m,A)}let f=null;if(s){let m,A;if(o.symmetric&&c.width<t&&c.height<t)m=c.width,A=c.height;else if(c=l(this,Fe),r>t||a>t){const w=Math.min(t/r,t/a);m=Math.floor(r*w),A=Math.floor(a*w),l(this,Sn)||(c=x(this,pe,Af).call(this,m,A))}const y=new OffscreenCanvas(m,A).getContext("2d",{willReadFrequently:!0});y.drawImage(c,0,0,c.width,c.height,0,0,m,A),f={width:m,height:A,data:y.getImageData(0,0,m,A).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return l(this,Ui)}static async deserialize(t,i,s){var A;let r=null;if(t instanceof Rb){const{data:{rect:_,rotation:y,id:w,structParent:b,popupRef:E},container:C,parent:{page:{pageNumber:T}}}=t,k=C.querySelector("canvas"),P=s.imageManager.getFromCanvas(C.id,k);k.remove();const D=((A=await i._structTree.getAriaAttributes(`${Hv}${w}`))==null?void 0:A.get("aria-label"))||"";r=t={annotationType:te.STAMP,bitmapId:P.id,bitmap:P.bitmap,pageIndex:T-1,rect:_.slice(0),rotation:y,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:D},isSvg:!1,structParent:b,popupRef:E}}const a=await super.deserialize(t,i,s),{rect:o,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&s.imageManager.isValidId(h)?(g(a,wt,h),c&&g(a,Fe,c)):g(a,bs,u),g(a,Sn,d);const[p,m]=a.pageDimensions;return a.width=(o[2]-o[0])/p,a.height=(o[3]-o[1])/m,a.annotationElementId=t.id||null,f&&(a.altTextData=f),a._initialData=r,g(a,rc,!!r),a}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:te.STAMP,bitmapId:l(this,wt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Sn),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=x(this,pe,Sf).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=x(this,pe,u_).call(this,s);if(c.isSame)return null;c.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const o=l(this,Sn)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(l(this,wt)))i.stamps.set(l(this,wt),{area:o,serialized:s}),s.bitmap=x(this,pe,Sf).call(this,!1);else if(l(this,Sn)){const c=i.stamps.get(l(this,wt));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=x(this,pe,Sf).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Fe=new WeakMap,wt=new WeakMap,vr=new WeakMap,bs=new WeakMap,wr=new WeakMap,sc=new WeakMap,Ui=new WeakMap,$i=new WeakMap,Sn=new WeakMap,rc=new WeakMap,pe=new WeakSet,Kc=function(t,i=!1){if(!t){this.remove();return}g(this,Fe,t.bitmap),i||(g(this,wt,t.id),g(this,Sn,t.isSvg)),t.file&&g(this,sc,t.file.name),x(this,pe,Iy).call(this)},Qc=function(){if(g(this,vr,null),this._uiManager.enableWaiting(!1),!!l(this,Ui)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},wf=function(){if(l(this,wt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,wt)).then(s=>x(this,pe,Kc).call(this,s,!0)).finally(()=>x(this,pe,Qc).call(this));return}if(l(this,bs)){const s=l(this,bs);g(this,bs,null),this._uiManager.enableWaiting(!0),g(this,vr,this._uiManager.imageManager.getFromUrl(s).then(r=>x(this,pe,Kc).call(this,r)).finally(()=>x(this,pe,Qc).call(this)));return}if(l(this,wr)){const s=l(this,wr);g(this,wr,null),this._uiManager.enableWaiting(!0),g(this,vr,this._uiManager.imageManager.getFromFile(s).then(r=>x(this,pe,Kc).call(this,r)).finally(()=>x(this,pe,Qc).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=lu.supportedTypesStr;const i=this._uiManager._signal;g(this,vr,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,pe,Kc).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>x(this,pe,Qc).call(this))),t.click()},Iy=function(){var d;const{div:t}=this;let{width:i,height:s}=l(this,Fe);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const f=Math.min(o*r/i,o*a/s);i*=f,s*=f}const[c,u]=this.parentDimensions;this.setDims(i*c/r,s*u/a),this._uiManager.enableWaiting(!1);const h=g(this,Ui,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/a,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),x(this,pe,Dy).call(this),l(this,rc)||(this.parent.addUndoableEditor(this),g(this,rc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,sc)&&h.setAttribute("aria-label",l(this,sc))},Af=function(t,i){const{width:s,height:r}=l(this,Fe);let a=s,o=r,c=l(this,Fe);for(;a>2*t||o>2*i;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(c,0,0,u,h,0,0,a,o),c=d.transferToImageBitmap()}return c},Dy=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new Rm,o=Math.ceil(s*t*a.sx),c=Math.ceil(r*i*a.sy),u=l(this,Ui);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=l(this,Sn)?l(this,Fe):x(this,pe,Af).call(this,o,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,c)},Sf=function(t){if(t){if(l(this,Sn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,wt));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=l(this,Fe),i.getContext("2d").drawImage(l(this,Fe),0,0),i.toDataURL()}if(l(this,Sn)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*zr.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*zr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,Fe),0,0,l(this,Fe).width,l(this,Fe).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,Fe))},u_=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},Y(lu,"_type","stamp"),Y(lu,"_editorType",te.STAMP);let My=lu;var io,ac,Vi,Ar,_s,Bn,Sr,oc,so,di,Es,Lt,Cs,V,xr,Me,h_,Ci,Oy,jy,xf;const Zn=class Zn{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:u,l10n:h}){S(this,Me);S(this,io);S(this,ac,!1);S(this,Vi,null);S(this,Ar,null);S(this,_s,null);S(this,Bn,new Map);S(this,Sr,!1);S(this,oc,!1);S(this,so,!1);S(this,di,null);S(this,Es,null);S(this,Lt,null);S(this,Cs,null);S(this,V);const d=[...l(Zn,xr).values()];if(!Zn._initialized){Zn._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),g(this,V,e),this.pageIndex=t,this.div=i,g(this,io,r),g(this,Vi,a),this.viewport=u,g(this,Lt,c),this.drawLayer=o,this._structTree=s,l(this,V).addLayer(this)}get isEmpty(){return l(this,Bn).size===0}get isInvisible(){return this.isEmpty&&l(this,V).getMode()===te.NONE}updateToolbar(e){l(this,V).updateToolbar(e)}updateMode(e=l(this,V).getMode()){switch(x(this,Me,xf).call(this),e){case te.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case te.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case te.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of l(Zn,xr).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Lt))==null?void 0:t.div)}setEditingState(e){l(this,V).setEditingState(e)}addCommands(e){l(this,V).addCommands(e)}cleanUndoStack(e){l(this,V).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,Vi))==null||t.div.classList.toggle("disabled",!e)}async enable(){g(this,so,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of l(this,Bn).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(l(this,V).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!l(this,Vi)){g(this,so,!1);return}const t=l(this,Vi).getEditableAnnotations();for(const i of t){if(i.hide(),l(this,V).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}g(this,so,!1)}disable(){var s;g(this,oc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Bn).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(l(this,Vi)){const r=l(this,Vi).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,V).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,V).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}x(this,Me,xf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of l(Zn,xr).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),g(this,oc,!1)}getEditableAnnotation(e){var t;return((t=l(this,Vi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,V).getActive()!==e&&l(this,V).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Lt))!=null&&e.div&&!l(this,Cs)){g(this,Cs,new AbortController);const t=l(this,V).combinedSignal(l(this,Cs));l(this,Lt).div.addEventListener("pointerdown",x(this,Me,h_).bind(this),{signal:t}),l(this,Lt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Lt))!=null&&e.div&&l(this,Cs)&&(l(this,Cs).abort(),g(this,Cs,null),l(this,Lt).div.classList.remove("highlighting"))}enableClick(){if(l(this,Ar))return;g(this,Ar,new AbortController);const e=l(this,V).combinedSignal(l(this,Ar));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Ar))==null||e.abort(),g(this,Ar,null)}attach(e){l(this,Bn).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,V).isDeletedAnnotationElement(t)&&l(this,V).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Bn).delete(e.id),(t=l(this,io))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,oc)&&e.annotationElementId&&l(this,V).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,V).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,V).addDeletedAnnotationElement(e.annotationElementId),je.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,V).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,so)),l(this,V).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,_s)&&(e._focusEventsAllowed=!1,g(this,_s,setTimeout(()=>{g(this,_s,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,V)._signal}),t.focus())},0))),e._structTreeParentId=(i=l(this,io))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return l(this,V).getId()}combinedSignal(e){return l(this,V).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Me,Ci))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,V).updateToolbar(e),l(this,V).updateMode(e);const{offsetX:i,offsetY:s}=x(this,Me,jy).call(this),r=this.getNextId(),a=x(this,Me,Oy).call(this,{parent:this,id:r,x:i,y:s,uiManager:l(this,V),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(Zn,xr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,V)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=x(this,Me,Oy).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:l(this,V),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(x(this,Me,jy).call(this),!0)}setSelected(e){l(this,V).setSelected(e)}toggleSelected(e){l(this,V).toggleSelected(e)}unselect(e){l(this,V).unselect(e)}pointerup(e){var i;const{isMac:t}=Wt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,Sr)&&(g(this,Sr,!1),!((i=l(this,Me,Ci))!=null&&i.isDrawer&&l(this,Me,Ci).supportMultipleDrawings))){if(!l(this,ac)){g(this,ac,!0);return}if(l(this,V).getMode()===te.STAMP){l(this,V).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(l(this,V).getMode()===te.HIGHLIGHT&&this.enableTextSelection(),l(this,Sr)){g(this,Sr,!1);return}const{isMac:t}=Wt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(g(this,Sr,!0),(s=l(this,Me,Ci))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=l(this,V).getActive();g(this,ac,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,di)){l(this,Me,Ci).startDrawing(this,l(this,V),!1,e);return}l(this,V).setCurrentDrawingSession(this),g(this,di,new AbortController);const t=l(this,V).combinedSignal(l(this,di));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(g(this,Es,null),this.commitOrRemove())},{signal:t}),l(this,Me,Ci).startDrawing(this,l(this,V),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&g(this,Es,t);return}l(this,Es)&&setTimeout(()=>{var t;(t=l(this,Es))==null||t.focus(),g(this,Es,null)},0)}endDrawingSession(e=!1){return l(this,di)?(l(this,V).setCurrentDrawingSession(null),l(this,di).abort(),g(this,di,null),g(this,Es,null),l(this,Me,Ci).endDrawing(e)):null}findNewParent(e,t,i){const s=l(this,V).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return l(this,di)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,di)&&l(this,Me,Ci).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,V).getActive())==null?void 0:e.parent)===this&&(l(this,V).commitOrRemove(),l(this,V).setActiveEditor(null)),l(this,_s)&&(clearTimeout(l(this,_s)),g(this,_s,null));for(const i of l(this,Bn).values())(t=l(this,io))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,l(this,Bn).clear(),l(this,V).removeLayer(this)}render({viewport:e}){this.viewport=e,go(this.div,e);for(const t of l(this,V).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,V).commitOrRemove(),x(this,Me,xf).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,go(this.div,{rotation:i}),t!==i)for(const s of l(this,Bn).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,V).viewParameters.realScale}};io=new WeakMap,ac=new WeakMap,Vi=new WeakMap,Ar=new WeakMap,_s=new WeakMap,Bn=new WeakMap,Sr=new WeakMap,oc=new WeakMap,so=new WeakMap,di=new WeakMap,Es=new WeakMap,Lt=new WeakMap,Cs=new WeakMap,V=new WeakMap,xr=new WeakMap,Me=new WeakSet,h_=function(e){l(this,V).unselectAll();const{target:t}=e;if(t===l(this,Lt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Lt).div.contains(t)){const{isMac:i}=Wt.platform;if(e.button!==0||e.ctrlKey&&i)return;l(this,V).showAllEditors("highlight",!0,!0),l(this,Lt).div.classList.add("free"),this.toggleDrawing(),ep.startHighlighting(this,l(this,V).direction==="ltr",{target:l(this,Lt).div,x:e.x,y:e.y}),l(this,Lt).div.addEventListener("pointerup",()=>{l(this,Lt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,V)._signal}),e.preventDefault()}},Ci=function(){return l(Zn,xr).get(l(this,V).getMode())},Oy=function(e){const t=l(this,Me,Ci);return t?new t.prototype.constructor(e):null},jy=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),c=Math.min(window.innerHeight,t+s),u=(r+o)/2-e,h=(a+c)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},xf=function(){for(const e of l(this,Bn).values())e.isEmpty()&&e.remove()},Y(Zn,"_initialized",!1),S(Zn,xr,new Map([yy,Ly,My,ep].map(e=>[e._editorType,e])));let Fy=Zn;var fi,td,Ut,ro,xp,d_,qi,By,f_,Hy;const Tt=class Tt{constructor({pageIndex:e}){S(this,qi);S(this,fi,null);S(this,td,0);S(this,Ut,new Map);S(this,ro,new Map);this.pageIndex=e}setParent(e){if(!l(this,fi)){g(this,fi,e);return}if(l(this,fi)!==e){if(l(this,Ut).size>0)for(const t of l(this,Ut).values())t.remove(),e.append(t);g(this,fi,e)}}static get _svgFactory(){return re(this,"_svgFactory",new qv)}draw(e,t=!1,i=!1){const s=Ot(this,td)._++,r=x(this,qi,By).call(this),a=Tt._svgFactory.createElement("defs");r.append(a);const o=Tt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,ro).set(s,o);const u=i?x(this,qi,f_).call(this,a,c):null,h=Tt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,Ut).set(s,r),{id:s,clipPathId:`url(#${u})`}}drawOutline(e,t){const i=Ot(this,td)._++,s=x(this,qi,By).call(this),r=Tt._svgFactory.createElement("defs");s.append(r);const a=Tt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const d=Tt._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${i}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Tt._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=Tt._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${o}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=Tt._svgFactory.createElement("use");s.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return s.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),l(this,Ut).set(i,s),i}finalizeDraw(e,t){l(this,ro).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,Ut).get(e):e;if(o){if(i&&x(this,qi,Hy).call(this,o,i),s&&x(c=Tt,xp,d_).call(c,o,s),r){const{classList:u}=o;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(a){const h=o.firstChild.firstChild;x(this,qi,Hy).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const i=l(this,Ut).get(e);i&&(l(t,fi).append(i),l(this,Ut).delete(e),l(t,Ut).set(e,i))}remove(e){l(this,ro).delete(e),l(this,fi)!==null&&(l(this,Ut).get(e).remove(),l(this,Ut).delete(e))}destroy(){g(this,fi,null);for(const e of l(this,Ut).values())e.remove();l(this,Ut).clear(),l(this,ro).clear()}};fi=new WeakMap,td=new WeakMap,Ut=new WeakMap,ro=new WeakMap,xp=new WeakSet,d_=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},qi=new WeakSet,By=function(){const e=Tt._svgFactory.create(1,1,!0);return l(this,fi).append(e),e.setAttribute("aria-hidden",!0),e},f_=function(e,t){const i=Tt._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=Tt._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},Hy=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},S(Tt,xp);let zy=Tt;globalThis.pdfjsTestingUtils={HighlightOutliner:wy};Q.AbortException;Q.AnnotationEditorLayer;Q.AnnotationEditorParamsType;Q.AnnotationEditorType;Q.AnnotationEditorUIManager;Q.AnnotationLayer;Q.AnnotationMode;Q.ColorPicker;Q.DOMSVGFactory;Q.DrawLayer;Q.FeatureTest;var oP=Q.GlobalWorkerOptions;Q.ImageKind;Q.InvalidPDFException;Q.MissingPDFException;Q.OPS;Q.OutputScale;Q.PDFDataRangeTransport;Q.PDFDateString;Q.PDFWorker;Q.PasswordResponses;Q.PermissionFlag;Q.PixelsPerInch;Q.RenderingCancelledException;Q.TextLayer;Q.TouchManager;Q.UnexpectedResponseException;Q.Util;Q.VerbosityLevel;Q.XfaLayer;Q.build;Q.createValidAbsoluteUrl;Q.fetchData;var lP=Q.getDocument;Q.getFilenameFromUrl;Q.getPdfFilenameFromUrl;Q.getXfaPageViewport;Q.isDataScheme;Q.isPdfFile;Q.noContextMenu;Q.normalizeUnicode;Q.setLayerDimensions;Q.shadow;Q.stopEvent;Q.version;const cP=""+new URL("pdf.worker.min-yatZIOMy.mjs",import.meta.url).href,uP="fyp-io",hP=1,np="papers",Kp="http://localhost:11434",Qp="llama3.1",Uw={author:"Doe et al.",title:"Dummy Paper for Debugging",url:"https://example.com/paper",published_date:"2023",citation_count:42,note:"This is a placeholder note so you can test the UI without extraction."};function dP(){return new Promise((n,e)=>{const t=indexedDB.open(uP,hP);t.onupgradeneeded=()=>{const i=t.result;i.objectStoreNames.contains(np)||i.createObjectStore(np,{keyPath:"id",autoIncrement:!0})},t.onsuccess=()=>n(t.result),t.onerror=()=>e(t.error)})}async function Gn(n,e){const t=await dP();return new Promise((i,s)=>{const r=t.transaction(np,n),a=r.objectStore(np),o=e(a);r.oncomplete=()=>i(o),r.onerror=()=>s(r.error)})}function Uy(n){try{return JSON.parse(n)}catch{const t=n.match(/\{[\s\S]*\}/);if(!t)return{};try{return JSON.parse(t[0])}catch{return{}}}}function fP(n){const e=Uy(n);if(Array.isArray(e))return e;const t=n.match(/\[[\s\S]*\]/);if(t){const i=Uy(t[0]);return Array.isArray(i)?i:[]}return[]}let $w=!1;async function p_(n){const e=await n.arrayBuffer();$w||(oP.workerSrc=cP,$w=!0);const t=await lP({data:e}).promise;let i="";for(let s=1;s<=t.numPages;s+=1){const a=(await(await t.getPage(s)).getTextContent()).items.map(o=>"str"in o?o.str:"").join(" ");i+=`${a}
`}return i.trim()}function $y(n){if(!n||typeof n!="string")return[];const e=["references","bibliography","works cited","literature cited"],t=n.toLowerCase();let i=-1;for(const h of e){const d=t.lastIndexOf(h);if(d!==-1){i=d;break}}if(i===-1){const h=n.split(`
`),d=h.findIndex(f=>/^\s*(\[\d+\]|\d+\.)/.test(f));if(d===-1)return[];i=h.slice(0,d).join(`
`).length}const s=n.slice(i).split(`
`).slice(1).join(`
`).trim();if(!s)return[];const r=s.split(`
`).map(h=>h.replace(/\s+/g," ").trim()).filter(Boolean).filter(h=>!/^\d+$/.test(h)).filter(h=>!/^\.*$/.test(h)).filter(h=>!/rspa\.royalsocietypublishing\.org/i.test(h)).filter(h=>!/^Downloaded from/i.test(h)),a=[];let o="";for(const h of r)(/^\s*(\[\d+\]|\d+\.)/.test(h)||/^\s*\d+\)/.test(h)||/^[A-Z][a-z]+,\s*[A-Z]/.test(h)||/^\s*[A-Z][a-z]+(?:\s+[A-Z][a-z]+)*\s+et al\./.test(h))&&o?(a.push(o.trim()),o=h):o=o?`${o} ${h}`:h;o&&a.push(o.trim());let c=a;const u=a.join(`
`).split(/\s*(?=\[\d+\]\s+)/);if(u.length>1)c=u;else if(a.length<=1){const h=s.replace(/\s+/g," ").split(/\s*(?=\d+\.\s+)/);h.length>1&&(c=h)}return c.map(h=>h.replace(/\s+/g," ").replace(/^\d+\.\s*/,"").trim()).filter(Boolean).slice(0,150)}function pP(n){if(!n||typeof n!="string")return"X";const e=n.trim().split(/[^a-zA-Z]+/).filter(Boolean);return e.length===0?"X":e.length===1?e[0][0].toUpperCase():`${e[0][0]}${e[1][0]}`.toUpperCase()}function ip(n,e){const t=pP(n);let i=1;for(;e.has(`${t}${i}`);)i+=1;return`${t}${i}`}async function gP(n){var a;const e=`You are a strict JSON generator.
Extract the paper metadata from the note below.
Return ONLY a JSON object with keys: author, title, url, published_date, citation_count.
If a field is unknown, use an empty string or null for citation_count.

NOTE:
${n}`,t=await fetch(`${Kp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:Qp,messages:[{role:"user",content:e}],stream:!1})});if(!t.ok){const o=await t.text();throw new Error(`Ollama error ${t.status}: ${o}`)}const i=await t.json(),s=((a=i==null?void 0:i.message)==null?void 0:a.content)||"{}",r=Uy(s);return{author:typeof r.author=="string"?r.author.trim():"",title:typeof r.title=="string"?r.title.trim():"",url:typeof r.url=="string"?r.url.trim():"",published_date:typeof r.published_date=="string"?r.published_date.trim():"",citation_count:typeof r.citation_count=="number"?r.citation_count:r.citation_count===null?null:Number.isFinite(Number(r.citation_count))?Number(r.citation_count):null}}async function mP(n,e){var o;const t=e.trim();if(!t)throw new Error("Question required");const i=n.slice(0,20).map(c=>({id:c.id,code:c.code,author:c.author,title:c.title,url:c.url,published_date:c.published_date,citation_count:c.citation_count,note:c.note})),s=`You answer questions using only the provided literature notes.
Do not mention author names, titles, or URLs in your answer.
Always include citations for any claim, using this format: [code: <code>].
If the answer is not in the notes, say you don't have enough information and do not invent citations.

NOTES:
${JSON.stringify(i,null,2)}

QUESTION:
${t}`,r=await fetch(`${Kp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:Qp,messages:[{role:"user",content:s}],stream:!1})});if(!r.ok){const c=await r.text();throw new Error(`Ollama error ${r.status}: ${c}`)}const a=await r.json();return((o=a==null?void 0:a.message)==null?void 0:o.content)||""}async function yP(n){var o;const e=n.trim();if(!e)return[];const t=`Extract 5-8 short keywords or phrases from the note.
Return ONLY a JSON array of strings.
Avoid full sentences.

NOTE:
${e}`,i=await fetch(`${Kp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:Qp,messages:[{role:"user",content:t}],stream:!1})});if(!i.ok){const c=await i.text();throw new Error(`Ollama error ${i.status}: ${c}`)}const s=await i.json(),r=((o=s==null?void 0:s.message)==null?void 0:o.content)||"[]",a=fP(r);return[...new Set(a.map(c=>String(c).trim()).filter(Boolean))].slice(0,8)}async function vP(n,e){var c;const t=e.flatMap(u=>Array.isArray(u.references)?u.references:[]).map(u=>String(u).trim()).filter(Boolean),i=e.map(u=>u.title).filter(Boolean);if(t.length===0)return[];const s=`You are selecting papers to read next.
Use ONLY the provided references list.
Use the research scope and existing titles to decide relevance.
Return 10 references, one per line.

RESEARCH SCOPE:
${n||"No scope provided."}

EXISTING TITLES:
${i.join(`
`)}

REFERENCES:
${t.join(`
`)}`,r=await fetch(`${Kp}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:Qp,messages:[{role:"user",content:s}],stream:!1})});if(!r.ok){const u=await r.text();throw new Error(`Ollama error ${r.status}: ${u}`)}const a=await r.json();return(((c=a==null?void 0:a.message)==null?void 0:c.content)||"").split(`
`).map(u=>u.trim()).filter(Boolean).slice(0,10)}async function wP(n){const e=await Gn("readonly",r=>new Promise((a,o)=>{const c=r.getAll();c.onsuccess=()=>a(c.result),c.onerror=()=>o(c.error)})),t=new Set(e.map(r=>r.code).filter(Boolean)),i=await gP(n),s={code:ip(i.author,t),...i,note:n,created_at:new Date().toISOString()};await Gn("readwrite",r=>{r.add(s)})}async function AP(n){const e=await Gn("readonly",a=>new Promise((o,c)=>{const u=a.getAll();u.onsuccess=()=>o(u.result),u.onerror=()=>c(u.error)})),t=new Set(e.map(a=>a.code).filter(Boolean)),i=n.citation_count,s=i===""||i===null||i===void 0?null:Number.isFinite(Number(i))?Number(i):null,r={code:ip(n.author,t),author:n.author||"",title:n.title||"",url:n.url||"",published_date:n.published_date||"",citation_count:s,note:n.note||"",created_at:new Date().toISOString()};await Gn("readwrite",a=>{a.add(r)})}async function SP(){let n=await Gn("readonly",i=>new Promise((s,r)=>{const a=i.getAll();a.onsuccess=()=>s(a.result),a.onerror=()=>r(a.error)}));n.length===0&&(await Gn("readwrite",i=>{i.add({...Uw,code:ip(Uw.author,new Set),created_at:new Date().toISOString()})}),n=await Gn("readonly",i=>new Promise((s,r)=>{const a=i.getAll();a.onsuccess=()=>s(a.result),a.onerror=()=>r(a.error)})));const e=new Set(n.map(i=>i.code).filter(Boolean)),t=[];return n.forEach(i=>{if(!i.code){const s=ip(i.author,e);e.add(s),t.push({...i,code:s})}}),t.length>0&&(await Gn("readwrite",i=>{t.forEach(s=>i.put(s))}),n=n.map(i=>t.find(s=>s.id===i.id)||i)),[...n].sort((i,s)=>s.id-i.id)}async function g_(n){const e=await Gn("readonly",t=>new Promise((i,s)=>{const r=t.get(Number(n));r.onsuccess=()=>i(r.result),r.onerror=()=>s(r.error)}));if(!e)throw new Error("Not found");return e}async function xP(n,e){const t=await p_(e),i=$y(t);return gc(n,{pdf_blob:e,pdf_name:e.name,pdf_text:t,references:i})}async function bP(n){return gc(n,{pdf_blob:null,pdf_name:"",pdf_text:"",references:[]})}async function _P(n){const e=await g_(n);if(!e)throw new Error("Not found");if(e.pdf_blob&&!e.pdf_text){const t=await p_(e.pdf_blob),i=$y(t);return gc(n,{pdf_text:t,references:i})}if(!Array.isArray(e.references)||e.references.length===0){const t=$y(e.pdf_text||"");return t.length===0?e:gc(n,{references:t})}return e}async function gc(n,e){const t=await Gn("readonly",s=>new Promise((r,a)=>{const o=s.get(Number(n));o.onsuccess=()=>r(o.result),o.onerror=()=>a(o.error)}));if(!t)throw new Error("Not found");const i={...t,...e};return await Gn("readwrite",s=>{s.put(i)}),i}async function EP(n){const e=[...new Set(n.map(t=>Number(t)).filter(t=>Number.isInteger(t)))];e.length!==0&&await Gn("readwrite",t=>{e.forEach(i=>t.delete(i))})}function CP(){const[n,e]=N.useState(""),[t,i]=N.useState([]),[s,r]=N.useState([]),[a,o]=N.useState("idle"),[c,u]=N.useState(""),[h,d]=N.useState(""),[f,p]=N.useState(!1),[m,A]=N.useState("idle"),[_,y]=N.useState(""),[w,b]=N.useState(""),[E,C]=N.useState(""),[T,k]=N.useState("idle"),[P,D]=N.useState(""),[M,$]=N.useState({author:"",title:"",url:"",published_date:"",citation_count:"",note:""}),[O,Z]=N.useState([]),[J,Ae]=N.useState(""),[j,W]=N.useState(!0),[I,X]=N.useState({key:"created_at",direction:"desc"}),[q,ae]=N.useState([]),[oe,be]=N.useState("idle"),[ft,cn]=N.useState(""),Ee=N.useRef(null),ue=N.useRef(new Set);async function Qn(){try{const R=await SP();i(R),r(fe=>fe.filter(me=>R.some(pt=>pt.id===me)))}catch{u("Could not load papers.")}}N.useEffect(()=>{Qn()},[]),N.useEffect(()=>{const R=localStorage.getItem("fyp-io-todo");R!==null&&d(R)},[]),N.useEffect(()=>{const R=localStorage.getItem("fyp-io-scope");R!==null&&(Ae(R),W(!0))},[]),N.useEffect(()=>{localStorage.setItem("fyp-io-todo",h)},[h]);const _o=t.length>0&&s.length===t.length,hd=s.length>0&&!_o;N.useEffect(()=>{Ee.current&&(Ee.current.indeterminate=hd)},[hd]),N.useEffect(()=>{let R=!1;async function fe(){for(const me of t){if(R)return;if(!(!me.note||Array.isArray(me.keywords)&&me.keywords.length>0)&&!ue.current.has(me.id)){ue.current.add(me.id),Z(pt=>[...new Set([...pt,me.id])]);try{const pt=await yP(me.note);await gc(me.id,{keywords:pt}),i(Ln=>Ln.map(Co=>Co.id===me.id?{...Co,keywords:pt}:Co))}catch{}finally{ue.current.delete(me.id),R||Z(pt=>pt.filter(Ln=>Ln!==me.id))}break}}}return fe(),()=>{R=!0}},[t]);async function m_(R){if(R.preventDefault(),u(""),!n.trim()){u("Write a note first so I can extract metadata.");return}try{o("loading"),await wP(n.trim()),e(""),await Qn()}catch{u("Extraction failed. Check Ollama and CORS, then try again.")}finally{o("idle")}}function y_(){if(_o){r([]);return}r(t.map(R=>R.id))}function v_(R){r(fe=>fe.includes(R)?fe.filter(me=>me!==R):[...fe,R])}async function w_(){if(s.length!==0)try{o("loading"),await EP(s),r([]),await Qn()}catch{u("Failed to delete selected papers.")}finally{o("idle")}}function A_(R){Ae(R),W(!1)}function S_(){localStorage.setItem("fyp-io-scope",J),W(!0)}function n0(R){X(fe=>fe.key!==R?{key:R,direction:"desc"}:{key:R,direction:fe.direction==="asc"?"desc":"asc"})}function i0(R){const fe=String(R||"").match(/\d{4}/);return fe?Number(fe[0]):null}const x_=[...t].sort((R,fe)=>{const me=I.direction==="asc"?1:-1;if(I.key==="published_date"){const pt=i0(R.published_date)??0,Ln=i0(fe.published_date)??0;return(pt-Ln)*me}if(I.key==="citation_count"){const pt=Number.isFinite(Number(R.citation_count))?Number(R.citation_count):-1,Ln=Number.isFinite(Number(fe.citation_count))?Number(fe.citation_count):-1;return(pt-Ln)*me}return(R.id-fe.id)*me});async function b_(){cn(""),ae([]),be("loading");try{const R=await vP(J,t);ae(R),R.length===0&&cn("No references available to suggest from.");const fe=document.getElementById("next-paper-suggestions");fe&&fe.scrollIntoView({behavior:"smooth",block:"start"})}catch{cn("Suggestion failed. Check Ollama and try again.")}finally{be("idle")}}function Eo(R,fe){$(me=>({...me,[R]:fe})),y("")}async function __(){if(!M.title.trim()&&!M.note.trim()){y("Add at least a title or a note.");return}try{A("loading"),await AP({...M,author:M.author.trim(),title:M.title.trim(),url:M.url.trim(),published_date:M.published_date.trim(),note:M.note.trim()}),$({author:"",title:"",url:"",published_date:"",citation_count:"",note:""}),p(!1),await Qn()}catch{y("Failed to add paper.")}finally{A("idle")}}async function E_(R){if(R.preventDefault(),D(""),C(""),!w.trim()){D("Ask a question first.");return}try{k("loading");const fe=await mP(t,w);C(fe||"No answer returned.")}catch{D("Query failed. Check Ollama and try again.")}finally{k("idle")}}return v.jsxs("div",{className:"grid-layout",children:[v.jsxs("div",{className:"column left-column",children:[v.jsxs("section",{className:"card intro-card",children:[v.jsx("h2",{children:"Literature Desk"}),v.jsx("p",{className:"muted",children:"This page is for capturing research notes, extracting metadata, and keeping a living index of your sources."})]}),v.jsxs("section",{className:"card note-card",children:[v.jsx("h2",{children:"New Research Note"}),v.jsx("p",{className:"muted",children:"Paste your raw note, abstract, or citation. The AI will extract the core details and log it for you."}),v.jsxs("form",{onSubmit:m_,className:"note-form",children:[v.jsx("textarea",{value:n,onChange:R=>e(R.target.value),placeholder:"Example: Smith et al. (2022) found that... DOI: ...",rows:10}),v.jsxs("div",{className:"note-actions",children:[v.jsx("button",{type:"submit",disabled:a==="loading",children:a==="loading"?"Extracting":"Extract & Save"}),c?v.jsx("span",{className:"error",children:c}):null]})]})]}),v.jsxs("section",{className:"card note-card query-card",children:[v.jsx("h2",{children:"Literature Query"}),v.jsx("p",{className:"muted",children:"Ask questions about your saved notes. Ollama will answer using only your local database."}),v.jsxs("form",{onSubmit:E_,className:"note-form",children:[v.jsx("textarea",{value:w,onChange:R=>b(R.target.value),placeholder:"Example: What are common themes across my notes?",rows:6}),v.jsxs("div",{className:"note-actions",children:[v.jsx("button",{type:"submit",disabled:T==="loading",children:T==="loading"?"Thinking":"Ask"}),v.jsx("button",{type:"button",className:"clear-button",onClick:()=>C(""),disabled:!E,children:"Clear answer"}),P?v.jsx("span",{className:"error",children:P}):null]})]}),E?v.jsx("div",{className:"answer-box",children:E}):null]})]}),v.jsxs("div",{className:"column right-column",children:[v.jsxs("section",{className:"card scope-card",children:[v.jsx("div",{className:"table-header",children:v.jsx("h2",{children:"Research Scope"})}),v.jsx("textarea",{className:"notepad-textarea",value:J,onChange:R=>A_(R.target.value),placeholder:"Define the scope and purpose of your research...",rows:5}),v.jsx("div",{className:"note-actions",children:v.jsx("button",{type:"button",onClick:S_,disabled:j,children:j?"Saved":"Save scope"})})]}),v.jsxs("section",{className:"card notepad-card",children:[v.jsx("div",{className:"table-header",children:v.jsx("h2",{children:"Notepad"})}),v.jsx("textarea",{className:"notepad-textarea",value:h,onChange:R=>d(R.target.value),placeholder:"Write your to-do list here...",rows:6})]}),v.jsxs("section",{className:"card table-card",children:[v.jsxs("div",{className:"table-header",children:[v.jsx("h2",{children:"Literature Index"}),v.jsxs("div",{className:"table-actions",children:[s.length>0?v.jsxs("button",{type:"button",className:"danger-button",disabled:a==="loading",onClick:w_,children:["Delete selected (",s.length,")"]}):null,v.jsx("button",{type:"button",className:"suggest-button",onClick:b_,children:"Suggest my next paper"}),v.jsxs("div",{className:"count-group",children:[v.jsxs("span",{className:"count",children:[t.length," papers"]}),v.jsx("button",{type:"button",className:"add-button",onClick:()=>p(R=>!R),"aria-label":"Add paper manually",title:"Add paper",children:"+"})]})]})]}),f?v.jsxs("div",{className:"manual-form",children:[v.jsxs("div",{className:"manual-grid",children:[v.jsx("input",{className:"detail-input",placeholder:"Author",value:M.author,onChange:R=>Eo("author",R.target.value)}),v.jsx("input",{className:"detail-input",placeholder:"Title",value:M.title,onChange:R=>Eo("title",R.target.value)}),v.jsx("input",{className:"detail-input",placeholder:"URL",value:M.url,onChange:R=>Eo("url",R.target.value)}),v.jsx("input",{className:"detail-input",placeholder:"Published",value:M.published_date,onChange:R=>Eo("published_date",R.target.value)}),v.jsx("input",{className:"detail-input",type:"number",min:"0",placeholder:"Citations",value:M.citation_count,onChange:R=>Eo("citation_count",R.target.value)})]}),v.jsx("textarea",{className:"detail-input detail-textarea",placeholder:"Note",value:M.note,onChange:R=>Eo("note",R.target.value),rows:4}),v.jsxs("div",{className:"manual-actions",children:[v.jsx("button",{type:"button",onClick:__,disabled:m==="loading",children:m==="loading"?"Saving":"Add paper"}),v.jsx("button",{type:"button",className:"ghost-link",onClick:()=>p(!1),children:"Cancel"}),_?v.jsx("span",{className:"error",children:_}):null]})]}):null,v.jsx("div",{className:"table-wrap",children:v.jsxs("table",{children:[v.jsx("thead",{children:v.jsxs("tr",{children:[v.jsx("th",{className:"checkbox-cell",children:v.jsx("input",{ref:Ee,type:"checkbox",checked:_o,onChange:y_,"aria-label":"Select all papers"})}),v.jsx("th",{children:"Code"}),v.jsx("th",{children:"Author"}),v.jsx("th",{children:"Title"}),v.jsx("th",{children:"Link"}),v.jsx("th",{children:v.jsxs("button",{type:"button",className:"sort-button",onClick:()=>n0("published_date"),children:["Published",v.jsx("span",{className:"sort-arrow",children:I.key==="published_date"?I.direction==="asc"?"":"":""})]})}),v.jsx("th",{children:v.jsxs("button",{type:"button",className:"sort-button",onClick:()=>n0("citation_count"),children:["Citations",v.jsx("span",{className:"sort-arrow",children:I.key==="citation_count"?I.direction==="asc"?"":"":""})]})})]})}),v.jsx("tbody",{children:t.length===0?v.jsx("tr",{children:v.jsx("td",{colSpan:"7",className:"empty",children:"No notes yet. Add one to populate your table."})}):x_.map(R=>v.jsxs("tr",{children:[v.jsx("td",{className:"checkbox-cell",children:v.jsx("input",{type:"checkbox",checked:s.includes(R.id),onChange:()=>v_(R.id),"aria-label":`Select ${R.title||"paper"}`})}),v.jsx("td",{className:"code-cell",children:R.code||""}),v.jsx("td",{children:v.jsx(po,{to:`/paper/${R.id}`,className:"row-link",children:R.author||"Unknown"})}),v.jsx("td",{children:R.title||"Untitled"}),v.jsx("td",{children:R.url?v.jsx("a",{href:R.url,target:"_blank",rel:"noreferrer",children:"Open"}):""}),v.jsx("td",{children:R.published_date||""}),v.jsx("td",{children:R.citation_count===null||R.citation_count===void 0?"":R.citation_count})]},R.id))})]})})]})]}),v.jsxs("section",{className:"card timeline-card full-width",children:[v.jsx("h2",{children:"Literature Timeline"}),v.jsx("p",{className:"muted",children:"A quick, visual sweep of your notes by date."}),v.jsx("div",{className:"timeline-track",children:t.length===0?v.jsx("p",{className:"muted",children:"Add papers to see them plotted here."}):[...t].slice().sort((R,fe)=>{const me=Co=>{const wc=String(Co||"").match(/\d{4}/);return wc?Number(wc[0]):null},pt=me(R.published_date)??me(R.created_at)??0,Ln=me(fe.published_date)??me(fe.created_at)??0;return pt-Ln}).map(R=>{const fe=R.published_date||R.created_at||"",me=String(fe).match(/\d{4}/),pt=me?me[0]:"",Ln=R.note||"",wc=Ln.split(`
`).map(xi=>xi.trim()).filter(Boolean).filter(xi=>/^[-*]/.test(xi));return wc.length?wc.map(xi=>xi.replace(/^[-*]\s*/,"")).slice(0,2):Ln.split(new RegExp("(?<=[.!?])\\s+")).map(xi=>xi.trim()).filter(Boolean).slice(0,2),v.jsxs("div",{className:"timeline-item",children:[v.jsx("div",{className:"timeline-dot"}),v.jsxs("div",{className:"timeline-meta",children:[v.jsx("span",{className:"timeline-year",children:pt}),v.jsx("span",{className:"timeline-code",children:R.code||""})]}),v.jsx("div",{className:"timeline-title",children:R.title||"Untitled"}),Array.isArray(R.keywords)&&R.keywords.length>0?v.jsx("div",{className:"timeline-keywords",children:R.keywords.map(xi=>v.jsx("span",{className:"keyword-chip",children:xi},xi))}):v.jsx("p",{className:"muted",children:O.includes(R.id)?"Extracting keywords":"No keywords yet."})]},R.id)})})]}),v.jsxs("section",{className:"card info-card full-width suggested-card",id:"next-paper-suggestions",children:[v.jsx("h2",{children:"Suggested Next Papers"}),v.jsx("p",{className:"muted",children:"Ollama is analysing references from uploaded papers..."}),oe==="loading"?v.jsx("p",{className:"muted",children:"Working on suggestions..."}):null,ft?v.jsx("p",{className:"error",children:ft}):null,q.length>0?v.jsx("div",{className:"references-list",children:q.join(`
`)}):null]}),v.jsxs("section",{className:"card info-card full-width",id:"ollama-info",children:[v.jsx("h2",{children:"What is Ollama?"}),v.jsx("p",{className:"muted",children:"Ollama runs language models on your machine. This app connects to it locally so you can extract metadata without a paid API."}),v.jsxs("div",{className:"info-list",children:[v.jsx("span",{className:"info-label",children:"Download"}),v.jsxs("span",{children:["Install from ",v.jsx("a",{href:"https://ollama.com",target:"_blank",rel:"noreferrer",children:"ollama.com"}),"."]})]}),v.jsxs("div",{className:"info-list",children:[v.jsx("span",{className:"info-label",children:"Start"}),v.jsx("span",{children:"Run `ollama serve` to start the local API."})]}),v.jsxs("div",{className:"info-list",children:[v.jsx("span",{className:"info-label",children:"Model"}),v.jsx("span",{children:"Pull a model: `ollama pull llama3.1`."})]}),v.jsxs("div",{className:"info-list",children:[v.jsx("span",{className:"info-label",children:"CORS"}),v.jsx("span",{children:'For GitHub Pages: `OLLAMA_ORIGINS="https://clarabollengandolfo.github.io" ollama serve`.'})]})]})]})}function kP(){const{id:n}=IC(),[e,t]=N.useState(null),[i,s]=N.useState(null),[r,a]=N.useState("idle"),[o,c]=N.useState(""),[u,h]=N.useState(""),[d,f]=N.useState(!1),[p,m]=N.useState(""),[A,_]=N.useState("idle"),[y,w]=N.useState(""),[b,E]=N.useState(!1);function C(O){return{author:O.author||"",title:O.title||"",url:O.url||"",published_date:O.published_date||"",citation_count:O.citation_count===null||O.citation_count===void 0?"":String(O.citation_count),note:O.note||""}}const T=N.useMemo(()=>!i||!e?!1:i.author!==(e.author||"")||i.title!==(e.title||"")||i.url!==(e.url||"")||i.published_date!==(e.published_date||"")||i.citation_count!==(e.citation_count===null||e.citation_count===void 0?"":String(e.citation_count))||i.note!==(e.note||""),[i,e]);N.useEffect(()=>{async function O(){try{const Z=await g_(n);t(Z),s(C(Z))}catch{c("Could not load paper.")}}O()},[n]),N.useEffect(()=>{if(!(e!=null&&e.pdf_blob)){m("");return}const O=URL.createObjectURL(e.pdf_blob);return m(O),()=>{URL.revokeObjectURL(O)}},[e==null?void 0:e.pdf_blob]),N.useEffect(()=>{if(!(e&&b&&e.pdf_blob&&(!e.pdf_text||!Array.isArray(e.references)||e.references.length===0)))return;let Z=!1;async function J(){try{const Ae=await _P(e.id);Z||(t(Ae),s(C(Ae)))}catch{}}return J(),()=>{Z=!0}},[e,b]);function k(O,Z){s(J=>({...J,[O]:Z})),h("")}function P(){if(!d){f(!0);return}f(!1),s(C(e))}async function D(O){var J;const Z=(J=O.target.files)==null?void 0:J[0];if(!(!Z||!e)){_("loading"),w("");try{const Ae=await xP(e.id,Z);t(Ae),s(C(Ae))}catch{w("Failed to attach PDF.")}finally{_("idle"),O.target.value=""}}}async function M(){if(e){_("loading"),w("");try{const O=await bP(e.id);t(O),s(C(O)),E(!1)}catch{w("Failed to remove PDF.")}finally{_("idle")}}}async function $(){if(!(!i||!e||!T)){a("saving"),c(""),h("");try{const O=await gc(e.id,{author:i.author.trim(),title:i.title.trim(),url:i.url.trim(),published_date:i.published_date.trim(),citation_count:i.citation_count===""?null:Number(i.citation_count),note:i.note.trim()});t(O),s(C(O)),h("Saved.")}catch{c("Could not save changes.")}finally{a("idle")}}}return o?v.jsxs("div",{className:"card detail-card",children:[v.jsx("p",{className:"error",children:o}),v.jsx(po,{to:"/",className:"ghost-link",children:"Back to dashboard"})]}):!e||!i?v.jsx("div",{className:"card detail-card",children:v.jsx("p",{className:"muted",children:"Loading paper"})}):v.jsxs("div",{className:"card detail-card",children:[v.jsxs("div",{className:"detail-header",children:[v.jsxs("div",{children:[v.jsx("p",{className:"app-kicker",children:"Paper Detail"}),v.jsx("h2",{children:(d?i.title:e.title)||"Untitled"})]}),v.jsxs("div",{className:"detail-header-actions",children:[v.jsx("button",{type:"button",className:"edit-toggle",onClick:P,children:d?"End edit":"Edit"}),v.jsx(po,{to:"/",className:"ghost-link",children:"Back to dashboard"})]})]}),v.jsxs("dl",{className:"detail-list",children:[v.jsxs("div",{children:[v.jsx("dt",{children:"Author"}),v.jsx("dd",{children:d?v.jsx("input",{className:"detail-input",value:i.author,onChange:O=>k("author",O.target.value),placeholder:"Unknown"}):v.jsx("span",{children:e.author||"Unknown"})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Published"}),v.jsx("dd",{children:d?v.jsx("input",{className:"detail-input",value:i.published_date,onChange:O=>k("published_date",O.target.value),placeholder:""}):v.jsx("span",{children:e.published_date||""})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Citations"}),v.jsx("dd",{children:d?v.jsx("input",{className:"detail-input",type:"number",min:"0",value:i.citation_count,onChange:O=>k("citation_count",O.target.value),placeholder:""}):v.jsx("span",{children:e.citation_count===null||e.citation_count===void 0?"":e.citation_count})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Link"}),v.jsx("dd",{children:d?v.jsx("input",{className:"detail-input",value:i.url,onChange:O=>k("url",O.target.value),placeholder:""}):e.url?v.jsx("a",{href:e.url,target:"_blank",rel:"noreferrer",children:e.url}):v.jsx("span",{children:""})})]}),v.jsxs("div",{children:[v.jsx("dt",{children:"Title"}),v.jsx("dd",{children:d?v.jsx("input",{className:"detail-input",value:i.title,onChange:O=>k("title",O.target.value),placeholder:"Untitled"}):v.jsx("span",{children:e.title||"Untitled"})})]})]}),d?v.jsxs("div",{className:"detail-actions",children:[v.jsx("button",{type:"button",onClick:$,disabled:!T||r==="saving",children:r==="saving"?"Saving":"Save changes"}),u?v.jsx("span",{className:"muted",children:u}):null,o?v.jsx("span",{className:"error",children:o}):null]}):null,v.jsxs("div",{className:"pdf-block",children:[v.jsx("h3",{children:"Paper PDF"}),v.jsxs("div",{className:"pdf-actions",children:[v.jsx("input",{type:"file",accept:"application/pdf",onChange:D}),p?v.jsx("a",{href:p,target:"_blank",rel:"noreferrer",children:"Open PDF"}):null,e.pdf_name?v.jsx("span",{className:"muted",children:e.pdf_name}):null,e.pdf_name?v.jsx("button",{type:"button",className:"ghost-link",onClick:M,disabled:A==="loading",children:"Remove"}):null]}),A==="loading"?v.jsx("p",{className:"muted",children:"Extracting text..."}):null,y?v.jsx("p",{className:"error",children:y}):null]}),v.jsxs("div",{className:"notes-block",children:[v.jsx("h3",{children:"Original Note"}),d?v.jsx("textarea",{className:"detail-input detail-textarea",value:i.note,onChange:O=>k("note",O.target.value),rows:6}):v.jsx("p",{className:"note-text",children:e.note||""}),v.jsxs("div",{className:"references-block",children:[v.jsx("button",{type:"button",className:"ghost-link",onClick:()=>E(O=>!O),children:b?"Hide references":"Display references"}),b?e.references&&e.references.length>0?v.jsx("div",{className:"references-list",children:e.references.join(`
`)}):v.jsx("p",{className:"muted",children:e.pdf_name?"No references found in this PDF.":"Please upload the paper."}):null]})]})]})}function TP(){const[n,e]=N.useState("idle"),[t,i]=N.useState("");async function s(){e("loading"),i("");try{const a=await fetch("http://localhost:11434/api/tags");if(!a.ok)throw new Error(`Ollama returned ${a.status}`);const o=await a.json(),c=Array.isArray(o==null?void 0:o.models)?o.models.length:0;e("success"),i(c>0?`${c} model(s)`:"No models")}catch{e("error"),i("Not reachable")}}function r(){const a=document.getElementById("ollama-info");a&&a.scrollIntoView({behavior:"smooth",block:"start"})}return v.jsxs("div",{className:"ollama-widget",children:[v.jsxs("div",{className:"ollama-widget-header",children:[v.jsx("span",{children:"Ollama"}),v.jsx("button",{type:"button",className:"info-icon",onClick:r,"aria-label":"Learn about Ollama",children:"i"})]}),v.jsx("button",{type:"button",onClick:s,disabled:n==="loading",children:n==="loading"?"Checking":"Test"}),t?v.jsx("span",{className:n==="error"?"error":"muted",children:t}):null]})}function PP(){return v.jsxs("div",{className:"app-shell",children:[v.jsxs("header",{className:"app-header",children:[v.jsxs("div",{children:[v.jsx("a",{href:"https://clarabollengandolfo.github.io/",className:"profile-button",target:"_blank",rel:"noreferrer",children:"clara bollen gandolfo"}),v.jsx("h1",{className:"app-title",children:"Literature Desk"})]}),v.jsxs("div",{className:"app-header-actions",children:[v.jsx(TP,{}),v.jsxs("nav",{children:[v.jsx(po,{to:"/",className:"ghost-link",children:"Home"}),v.jsx(po,{to:"/tool",className:"ghost-link",children:"Tool"})]}),v.jsx("a",{href:"https://www.overleaf.com/project/6967b6d7653766a341e88fa5",className:"report-button",target:"_blank",rel:"noreferrer",children:"Report"})]})]}),v.jsx("main",{className:"app-main",children:v.jsxs(KC,{children:[v.jsx(Wd,{path:"/",element:v.jsx(ok,{})}),v.jsx(Wd,{path:"/tool",element:v.jsx(CP,{})}),v.jsx(Wd,{path:"/paper/:id",element:v.jsx(kP,{})})]})})]})}sx(document.getElementById("root")).render(v.jsx(tA.StrictMode,{children:v.jsx(ik,{children:v.jsx(PP,{})})}));
